using Hr.Models;
using Microsoft.AspNetCore.Authorization;
using Microsoft.AspNetCore.DataProtection;
using Microsoft.AspNetCore.Hosting;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Mvc;
using Microsoft.AspNetCore.Mvc.Rendering;
using Microsoft.EntityFrameworkCore;
using Newtonsoft.Json;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Threading.Tasks;
using System.Data.OleDb;
using Microsoft.Extensions.Configuration;
using System.IO;
using System.Data;
using System.Data.SqlClient;
using jsreport.AspNetCore;
using jsreport.Types;
using AutoMapper;
using Hr.IRepository;
using Hr.Interfaces;
using Oracle.ManagedDataAccess.Client;
using System.Data.Entity.Infrastructure;
using System.Data.Entity.Core.Objects;
using Microsoft.Reporting.NETCore;
using System.Collections;
using Nancy.Json;
using System.Threading;
using System.Text;

namespace Hr.Controllers
{
    public class ViewModelEvalwithother1Controller : Controller
    {
        private readonly IunitOfWork<AGoalsLogs> _AGoalsLogs;
        private readonly IunitOfWork<AEvaluationGoal1> _AEvaluationGoals1;
        private IAGoalLogsRepository _AGoalLogsRepository;
        private readonly IMapper _mapper;
        public IJsReportMVCService JsReportMVCService { get; }
        private readonly hrContext _context;
        private readonly IDataProtector _protector;
        private readonly IHostingEnvironment Environment;
        private readonly IConfiguration Configuration;
        AEvaluationGoal av1, av2, av3, av4, av5, av6;
        AEvaluationCompetenciesM  am1, am2, am3, am4, am5, am6,am7;
        AEvaluationCompetenciesD ad1, ad2, ad3, ad4, ad5, ad6, ad7,
            ad8,ad9,ad10,ad11,ad12,ad13,ad14,ad15,ad16,ad17,ad18,ad19,
            ad20,ad21,ad22,ad23;
        string TNS1 = "Data Source=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=10.18.1.13)(PORT=1521)))(CONNECT_DATA=(SID=sadad)));User ID=eservice;Password=eltizam_sjg";
        string TNS11 = "Data Source=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=10.18.1.140)(PORT=1521)))(CONNECT_DATA=(SID=qassim)));User ID=MADCAP;Password=dba1435sjg*;";
        private readonly IHostingEnvironment _hosting;
        public ViewModelEvalwithother1Controller(hrContext context, IDataProtectionProvider provider, IHostingEnvironment _environment, IConfiguration _configuration, IJsReportMVCService jsReportMVCService, IMapper mapper, IAGoalLogsRepository AGoalLogsRepository, IunitOfWork<AGoalsLogs> AGoalsLogs, IunitOfWork<AEvaluationGoal1> AEvaluationGoals1, IHostingEnvironment hosting)
        {
            _context = context;
            _protector = provider.CreateProtector("Hr.ViewModelEvalwithother1Controller");
            Environment = _environment;
            Configuration = _configuration;
            JsReportMVCService = jsReportMVCService;
            _mapper = mapper;
            _AGoalLogsRepository = AGoalLogsRepository;
            _AGoalsLogs = AGoalsLogs;
            _AEvaluationGoals1 = AEvaluationGoals1;
            _hosting = hosting;
        }
<<<<<<< HEAD

        //public ViewModelEvalwithother1Controller()
        //{
        //}

=======
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
        [HttpGet]
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public IActionResult Eval()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            ViewData["Cempid"] = new SelectList(_context.Cemps.Where(c => c.CEMPADPRTNO == HttpContext.Session.GetString("empdepid") && c.MANAGERID == HttpContext.Session.GetString("username") || c.CEMPNO == HttpContext.Session.GetString("username")), "Cempid", "CEMPNAME");
            var empuser = _context.Cemps.Where(x => x.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
            if (empuser.CROLEID == 5||empuser.CROLEID==7)
            {
                ViewData["Cempid"] = new SelectList(_context.Cemps.ToList(), "Cempid", "CEMPNAME");

            }
            return View();
        }
        //[HttpGet]
        //[Authorize(Roles = "Admin,Manager,User,HR-Admin")]
        //public IActionResult Cr()
        //{
        //    if (HttpContext.Session.GetString("username") == null)
        //    {
        //        return RedirectToAction("Show", "Account", new { area = "" });
        //    }
        //    List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
        //    {
        //        MainMenuId = x.MainMenuId,
        //        SubMenuNamear = x.SubMenuNamear,
        //        id = x.id,
        //        SubMenuNameen = x.SubMenuNameen,
        //        ControllerName = x.ControllerName,
        //        ActionName = x.ActionName,
        //        RoleId = x.RoleId,
        //        mmodule = x.mmodule,
        //        treeroot = x.treeroot
        //        //RoleName = x.tblRole.Roles
        //    }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
        //    //ViewBag.MenuMaster = _menus;
        //    TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
        //    ViewData["Cempid"] = new SelectList(_context.Cemps.Where(c => c.CEMPADPRTNO == HttpContext.Session.GetString("empdepid") && c.MANAGERID == HttpContext.Session.GetString("username") || c.CEMPNO == HttpContext.Session.GetString("username")), "Cempid", "CEMPNAME");
        //    var empuser = _context.Cemps.Where(x => x.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
        //    if (empuser.CROLEID == 5)
        //    {
        //        ViewData["Cempid"] = new SelectList(_context.Cemps.ToList(), "Cempid", "CEMPNAME");

        //    }
        //    return View();
        //}
        //[HttpGet]
        //[Authorize(Roles = "Admin,Manager,User,HR-Admin")]
        //public IActionResult Cr2()
        //{
        //    if (HttpContext.Session.GetString("username") == null)
        //    {
        //        return RedirectToAction("Show", "Account", new { area = "" });
        //    }
        //    List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
        //    {
        //        MainMenuId = x.MainMenuId,
        //        SubMenuNamear = x.SubMenuNamear,
        //        id = x.id,
        //        SubMenuNameen = x.SubMenuNameen,
        //        ControllerName = x.ControllerName,
        //        ActionName = x.ActionName,
        //        RoleId = x.RoleId,
        //        mmodule = x.mmodule,
        //        treeroot = x.treeroot
        //        //RoleName = x.tblRole.Roles
        //    }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
        //    //ViewBag.MenuMaster = _menus;
        //    TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
        //    ViewData["Cempid"] = new SelectList(_context.Cemps.Where(c => c.CEMPADPRTNO == HttpContext.Session.GetString("empdepid") && c.MANAGERID == HttpContext.Session.GetString("username") || c.CEMPNO == HttpContext.Session.GetString("username")), "Cempid", "CEMPNAME");
        //    var empuser = _context.Cemps.Where(x => x.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
        //    if (empuser.CROLEID == 5)
        //    {
        //        ViewData["Cempid"] = new SelectList(_context.Cemps.ToList(), "Cempid", "CEMPNAME");

        //    }
        //    return View();
        //}
        //[HttpGet]
        //[Authorize(Roles = "Admin,Manager,User,HR-Admin")]
        //public IActionResult Cr3()
        //{
        //    if (HttpContext.Session.GetString("username") == null)
        //    {
        //        return RedirectToAction("Show", "Account", new { area = "" });
        //    }
        //    List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
        //    {
        //        MainMenuId = x.MainMenuId,
        //        SubMenuNamear = x.SubMenuNamear,
        //        id = x.id,
        //        SubMenuNameen = x.SubMenuNameen,
        //        ControllerName = x.ControllerName,
        //        ActionName = x.ActionName,
        //        RoleId = x.RoleId,
        //        mmodule = x.mmodule,
        //        treeroot = x.treeroot
        //        //RoleName = x.tblRole.Roles
        //    }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
        //    //ViewBag.MenuMaster = _menus;
        //    TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
        //    ViewData["Cempid"] = new SelectList(_context.Cemps.Where(c => c.CEMPADPRTNO == HttpContext.Session.GetString("empdepid") && c.MANAGERID == HttpContext.Session.GetString("username") || c.CEMPNO == HttpContext.Session.GetString("username")), "Cempid", "CEMPNAME");
        //    var empuser = _context.Cemps.Where(x => x.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
        //    if (empuser.CROLEID == 5)
        //    {
        //        ViewData["Cempid"] = new SelectList(_context.Cemps.ToList(), "Cempid", "CEMPNAME");

        //    }
        //    return View();
        //}
        [HttpGet]
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public IActionResult Cr4()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            ViewData["Cempid"] = new SelectList(_context.Cemps.Where(c => c.CEMPADPRTNO == HttpContext.Session.GetString("empdepid") && c.MANAGERID == HttpContext.Session.GetString("username") || c.CEMPNO == HttpContext.Session.GetString("username")), "Cempid", "CEMPNAME");
            var empuser = _context.Cemps.Where(x => x.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
            if (empuser.CROLEID == 5||empuser.CROLEID==7)
            {
                ViewData["Cempid"] = new SelectList(_context.Cemps.ToList(), "Cempid", "CEMPNAME");

            }
            var cc= _context.Cemps.Where(c => c.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
            return View();
        }
        [HttpGet]
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public IActionResult Cr5()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            ViewData["Cempid"] = new SelectList(_context.Cemps.Where(c => c.CEMPADPRTNO == HttpContext.Session.GetString("empdepid") && c.MANAGERID == HttpContext.Session.GetString("username") || c.CEMPNO == HttpContext.Session.GetString("username")), "Cempid", "CEMPNAME");
            var empuser = _context.Cemps.Where(x => x.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
            if (empuser.CROLEID == 5||empuser.CROLEID==7)
            {
                ViewData["Cempid"] = new SelectList(_context.Cemps.ToList(), "Cempid", "CEMPNAME");

            }
            var cc = _context.Cemps.Where(c => c.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
            return View();
        }

        [HttpGet]
        public IActionResult PayrollReport()
        {
            //var cc = _context.Cemps.Where(c => c.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
            return View();
        }
        [HttpGet]
        public IActionResult IAM()
        {
            //var cc = _context.Cemps.Where(c => c.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
            return View();
        }
        [HttpPost]
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public ActionResult Cr(string Id,string Year)
        {
            var dt = new DataTable();
           // dt = GetEmployeeList(Id, Year);
            dt = GetEmployeeList1( Id, Year);
            string mimetype = "application/pdf";
            string extension = "pdf";
            string renderformat = "pdf";

            //Dictionary<string, string> parameters = new Dictionary<string, string>();
            //parameters.Add("prm", "  ");
            LocalReport lr = new LocalReport();
            lr.DataSources.Add(new ReportDataSource("dsEmployee", dt));
            var parameters = new[] { new ReportParameter("prm", " ") };
            lr.ReportPath = $"{this._hosting.WebRootPath}\\Reports\\Employees1.rdlc";
            lr.SetParameters(parameters);
            var pdf = lr.Render(renderformat);
            return File(pdf, mimetype, "Report." + extension);

           // string mimetype = "";
           // int extension = 1;
           // var path = $"{this._hosting.WebRootPath}\\Reports\\Employees1.rdlc";
           // Dictionary<string, string> parameters = new Dictionary<string, string>();
           // parameters.Add("prm", "  ");
           // LocalReport lr = new LocalReport();
           //lr.DataSources.Add(new ReportDataSource("dsEmployee", dt));
           // var result = lr.Execute(RenderType.Pdf, extension, parameters, mimetype);
           // return File(result.MainStream, "application/pdf");

        }
        [HttpPost]
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public ActionResult Cr2(string Id, string Year)
        {
            var dt = new DataTable();
            // dt = GetEmployeeList(Id, Year);
            dt = GetEmployeeList2(Id, Year);
            string mimetype = "application/pdf";
            string extension = "pdf";
            string renderformat = "pdf";

            //Dictionary<string, string> parameters = new Dictionary<string, string>();
            //parameters.Add("prm", "  ");
            LocalReport lr = new LocalReport();
            lr.DataSources.Add(new ReportDataSource("dsEmployee", dt));
            var parameters = new[] { new ReportParameter("prm", " ") };
            lr.ReportPath = $"{this._hosting.WebRootPath}\\Reports\\Employees2.rdlc";
            lr.SetParameters(parameters);
            var pdf = lr.Render(renderformat);
            return File(pdf, mimetype, "Report." + extension);

            // string mimetype = "";
            // int extension = 1;
            // var path = $"{this._hosting.WebRootPath}\\Reports\\Employees2.rdlc";
            // Dictionary<string, string> parameters = new Dictionary<string, string>();
            // parameters.Add("prm", "  ");
            // LocalReport lr = new LocalReport();
            //lr.DataSources.Add(new ReportDataSource("dsEmployee", dt));
            // var result = lr.Execute(RenderType.Pdf, extension, parameters, mimetype);
            // return File(result.MainStream, "application/pdf");

        }
        [HttpPost]
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public ActionResult Cr3(string Id, string Year)
        {
            var dt = new DataTable();
            // dt = GetEmployeeList(Id, Year);
            dt = GetEmployeeList3(Id, Year);
            string mimetype = "application/pdf";
            string extension = "pdf";
            string renderformat = "pdf";

            //Dictionary<string, string> parameters = new Dictionary<string, string>();
            //parameters.Add("prm", "  ");
            LocalReport lr = new LocalReport();
            lr.DataSources.Add(new ReportDataSource("dsEmployee", dt));
            var parameters = new[] { new ReportParameter("prm", " ") };
            lr.ReportPath = $"{this._hosting.WebRootPath}\\Reports\\Employees3.rdlc";
            lr.SetParameters(parameters);
            var pdf = lr.Render(renderformat);
            return File(pdf, mimetype, "Report." + extension);
            // string mimetype = "";
            // int extension = 1;
            // var path = $"{this._hosting.WebRootPath}\\Reports\\Employees3.rdlc";
            // Dictionary<string, string> parameters = new Dictionary<string, string>();
            // parameters.Add("prm", "  ");
            // LocalReport lr = new LocalReport();
            //lr.DataSources.Add(new ReportDataSource("dsEmployee", dt));
            // var result = lr.Execute(RenderType.Pdf, extension, parameters, mimetype);
            // return File(result.MainStream, "application/pdf");

        }
        [HttpPost]
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public ActionResult Cr4(string Id)
        {
            var dt = new DataTable();
            // dt = GetEmployeeList(Id, Year);
            dt = GetEmployeeList4(Id);

            string mimetype = "application/pdf";
            string extension = "pdf";
            string renderformat = "pdf";

            //Dictionary<string, string> parameters = new Dictionary<string, string>();
            //parameters.Add("prm", "  ");
            LocalReport lr = new LocalReport();
            lr.DataSources.Add(new ReportDataSource("dsEmployee", dt));
            var parameters = new[] { new ReportParameter("prm", " خالد عبدالرحمن عبدالعزيز المشيقح "),new ReportParameter("prm2", "  إبراهيم عبدالرحمن إبراهيم المحيميد "),new ReportParameter("prm3", " Khalid A. Almushayqih "),new ReportParameter("prm4", "  Ibrahim A. Almohemed         ")};
            lr.ReportPath = $"{this._hosting.WebRootPath}\\Reports\\Employees4.rdlc";
            lr.SetParameters(parameters);
            var pdf = lr.Render(renderformat);
            return File(pdf, mimetype, "Report." + extension);
            // string mimetype = "";
            // int extension = 1;
            // var path = $"{this._hosting.WebRootPath}\\Reports\\Employees4.rdlc";
            // Dictionary<string, string> parameters = new Dictionary<string, string>();
            // parameters.Add("prm", " خالد عبدالرحمن عبدالعزيز المشيقح ");
            // parameters.Add("prm2", "  إبراهيم عبدالرحمن إبراهيم المحيميد ");
            // parameters.Add("prm3", " Khalid A. Almushayqih ");
            // parameters.Add("prm4", "  Ibrahim A. Almohemed         ");
            // LocalReport lr = new LocalReport();
            //lr.DataSources.Add(new ReportDataSource("dsEmployee", dt));
            // var result = lr.Execute(RenderType.Pdf, extension, parameters, mimetype);
            // return File(result.MainStream, "application/pdf");

        }
        [HttpPost]
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public ActionResult Cr5(string Id)
        {
            var dt = new DataTable();
            // dt = GetEmployeeList(Id, Year);
            dt = GetEmployeeList5(Id);
            string mimetype = "application/pdf";
            string extension = "pdf";
            string renderformat = "pdf";

            //Dictionary<string, string> parameters = new Dictionary<string, string>();
            //parameters.Add("prm", "  ");
            LocalReport lr = new LocalReport();
            lr.DataSources.Add(new ReportDataSource("dsEmployee", dt));
            var parameters = new[] { new ReportParameter("prm", "خالد عبدالرحمن عبدالعزيز المشيقح "), new ReportParameter("prm2", "إبراهيم عبدالرحمن إبراهيم المحيميد"), new ReportParameter("prm3", "Khalid A. Almushayqih"), new ReportParameter("prm4", "Ibrahim A. Almohemed") };
            lr.ReportPath = $"{this._hosting.WebRootPath}\\Reports\\Employees5.rdlc";
            lr.SetParameters(parameters);
            var pdf = lr.Render(renderformat);
            return File(pdf, mimetype, "Report." + extension);
            // string mimetype = "";
            // int extension = 1;
            // var path = $"{this._hosting.WebRootPath}\\Reports\\Employees5.rdlc";
            // Dictionary<string, string> parameters = new Dictionary<string, string>();
            // parameters.Add("prm", " خالد عبدالرحمن عبدالعزيز المشيقح ");
            // parameters.Add("prm2", "  إبراهيم عبدالرحمن إبراهيم المحيميد ");
            // parameters.Add("prm3", " Khalid A. Almushayqih ");
            // parameters.Add("prm4", "  Ibrahim A. Almohemed         ");
            // LocalReport lr = new LocalReport();
            //lr.DataSources.Add(new ReportDataSource("dsEmployee", dt));
            // var result = lr.Execute(RenderType.Pdf, extension, parameters, mimetype);
            // return File(result.MainStream, "application/pdf");

        }
        [HttpPost]
        public ActionResult PayrollReport(string Id, string Year)
        {
            var dt = new DataTable();
             dt = GetEmployeeList44(Id, Year);
            //dt = GetEmployeeList4();
            string mimetype = "application/pdf";
            string extension = "pdf";
            string renderformat = "pdf";

            //Dictionary<string, string> parameters = new Dictionary<string, string>();
            //parameters.Add("prm", "  ");
            LocalReport lr = new LocalReport();
            lr.DataSources.Add(new ReportDataSource("dsEmployee", dt));
            var parameters = new[] { new ReportParameter("prm", " خالد عبدالرحمن عبدالعزيز المشيقح "), new ReportParameter("prm2", "  إبراهيم عبدالرحمن إبراهيم المحيميد "), new ReportParameter("prm3", " Khalid A. Almushayqih "), new ReportParameter("prm4", "  Ibrahim A. Almohemed         ") };
            lr.ReportPath = $"{this._hosting.WebRootPath}\\Reports\\PayrollReport.rdlc";
            lr.SetParameters(parameters);
            var pdf = lr.Render(renderformat);
            return File(pdf, mimetype, "Report." + extension);

            // string mimetype = "";
            // int extension = 1;
            // var path = $"{this._hosting.WebRootPath}\\Reports\\PayrollReport.rdlc";
            // Dictionary<string, string> parameters = new Dictionary<string, string>();
            // parameters.Add("prm", " خالد عبدالرحمن عبدالعزيز المشيقح ");
            // parameters.Add("prm2", "  إبراهيم عبدالرحمن إبراهيم المحيميد ");
            // parameters.Add("prm3", " Khalid A. Almushayqih ");
            // parameters.Add("prm4", "  Ibrahim A. Almohemed         ");
            // LocalReport lr = new LocalReport();
            //lr.DataSources.Add(new ReportDataSource("dsEmployee", dt));
            // var result = lr.Execute(RenderType.Pdf, extension, parameters, mimetype);
            // return File(result.MainStream, "application/pdf");

        }
        [HttpPost]
        public ActionResult IAM(string Id, string Year)
        {
            var dt = new DataTable();
            dt = GetEmployeeList55(Id, Year);
            string mimetype = "application/pdf";
            string extension = "pdf";
            string renderformat = "pdf";

            //Dictionary<string, string> parameters = new Dictionary<string, string>();
            //parameters.Add("prm", "  ");
            LocalReport lr = new LocalReport();
            lr.DataSources.Add(new ReportDataSource("dsEmployee", dt));
            var parameters = new[] { new ReportParameter("prm", " خالد عبدالرحمن عبدالعزيز المشيقح "), new ReportParameter("prm2", "إبراهيم عبدالرحمن إبراهيم المحيميد "), new ReportParameter("prm3", "Khalid A. Almushayqih "), new ReportParameter("prm4", "Ibrahim A. Almohemed") };
            lr.ReportPath = $"{this._hosting.WebRootPath}\\Reports\\IAM.rdlc";
            lr.SetParameters(parameters);
            var pdf = lr.Render(renderformat);
            return File(pdf, mimetype, "Report." + extension);
            //dt = GetEmployeeList4();
            // string mimetype = "";
            // int extension = 1;
            // var path = $"{this._hosting.WebRootPath}\\Reports\\IAM.rdlc";
            // Dictionary<string, string> parameters = new Dictionary<string, string>();
            // parameters.Add("prm", " خالد عبدالرحمن عبدالعزيز المشيقح ");
            // parameters.Add("prm2", "  إبراهيم عبدالرحمن إبراهيم المحيميد ");
            // parameters.Add("prm3", " Khalid A. Almushayqih ");
            // parameters.Add("prm4", "  Ibrahim A. Almohemed         ");
            // LocalReport lr = new LocalReport();
            //lr.DataSources.Add(new ReportDataSource("dsEmployee", dt));
            // var result = lr.Execute(RenderType.Pdf, extension, parameters, mimetype);
            // return File(result.MainStream, "application/pdf");

        }
        private DataTable GetEmployeeList1(string Id, string Year)
        {
            var dt = new DataTable();
            dt.Columns.Add("EmpId");
            dt.Columns.Add("EmpName");
            dt.Columns.Add("Department");
            dt.Columns.Add("BirthDate");
            dt.Columns.Add("hiring");
            dt.Columns.Add("class");
            dt.Columns.Add("grade");
            dt.Columns.Add("parent");
            dt.Columns.Add("phone");
            dt.Columns.Add("Year");
            DataRow row;
            // for one employee
            //var Cemp = _context.Cemps.Where(xz => xz.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
            //row = dt.NewRow();
            //row["EmpId"] = Cemp.Cempid;
            //row["EmpName"] = Cemp.CEMPNAME;
            //row["Department"] = Cemp.DEP_NAME;
            //row["BirthDate"] =Convert.ToDateTime( Cemp.CEMPLASTUPGRADEHIJRA).ToString("yyyy-MM-dd");
            //dt.Rows.Add(row);

            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail2> EvalDetails2 = _context.EvalDetailss2.ToList();
            List<EvalRequestTypeId2> EvalRequestTypeIds2 = _context.EvalRequestTypeIds2.ToList();
            List<Evalcomment2> evalcommentss = _context.EvalComments2.ToList();
            List<Cemp> cemps = _context.Cemps.ToList();
            var Records = from e in AEvaluationEmps
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join f in EvalDetails2 on e.Idd equals f.CourcesIdoffered into table4
                          from f in table4.ToList()
                          where f.OfferedRequestTypeSatus == 1
                          where f.OfferedRequestFrom == Id & e.year == Year /*HttpContext.Session.GetString("username")*/
                          join h in EvalRequestTypeIds2 on e.Idd equals h.CourcesIdoffered into table5
                          from h in table5.ToList()
                          where h.OfferedRequestType == 1
                          //join mm in evalcommentss on f.OfferedDetailsSerial equals mm.Offerdetailsid into table6
                          //from mm in table6.ToList()
                          //where mm.Offerdetailsid == f.OfferedDetailsSerial
                          join gg in cemps on e.Empno equals Convert.ToInt32(gg.Cempid) into table99
                          from gg in table99.ToList()



                          select new ViewModelEvalwithother
                          {
                              AEvaluationEmp = e,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              evalDetail2 = f,
                              evalRequestTypeId2 = h,
                              //evalcomment2 = mm,
                              cemp = gg,

                          };

            foreach (var cemp in Records)
            {
                row = dt.NewRow();
                row["EmpId"] = cemp.cemp.Cempid;
                row["EmpName"] = cemp.cemp.CEMPNAME;
                row["Department"] = cemp.cemp.DEP_NAME;
                //row["BirthDate"] = Convert.ToDateTime(cemp.cemp.CEMPLASTUPGRADEHIJRA).ToString("yyyy-MM-dd");
                //row["hiring"] = Convert.ToDateTime(cemp.cemp.CEMPHIRINGDATEHIJRA).ToString("yyyy-MM-dd");
                row["class"] = cemp.cemp.CEMPPASSWRD;
                row["grade"] = cemp.cemp.CEMPJOBNAME;
                row["parent"] = cemp.cemp.PARENTNAME;
                row["phone"] = cemp.AEvaluationEmp.Idd;
                row["Year"] = cemp.AEvaluationEmp.year;

                var approveddate = _context.EvalComments2.Where(x => x.Offerdetailsid == cemp.evalDetail2.OfferedDetailsSerial).FirstOrDefault();
                if (approveddate != null)
                {
                    TempData["GRADE1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("yyyy");
                    TempData["GRADEN1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                }
                List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                av1 = vAEvaluationGoals[0];
                av2 = vAEvaluationGoals[1];
                av3 = vAEvaluationGoals[2];
                av4 = vAEvaluationGoals[3];
                if (vAEvaluationGoals.Count > 4)
                {
                    av5 = vAEvaluationGoals[4];

                }
                if (vAEvaluationGoals.Count > 5)
                {
                    av6 = vAEvaluationGoals[5];
                }
                List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                am1 = vAEvaluationCompetenciesMs[0];
                am2 = vAEvaluationCompetenciesMs[1];
                am3 = vAEvaluationCompetenciesMs[2];
                am4 = vAEvaluationCompetenciesMs[3];
                am5 = vAEvaluationCompetenciesMs[4];
                am6 = vAEvaluationCompetenciesMs[5];
                if (vAEvaluationCompetenciesMs.Count > 6)
                {

                    am7 = vAEvaluationCompetenciesMs[6];
                }

                List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                ad1 = vAEvaluationCompetenciesDs[0];
                ad2 = vAEvaluationCompetenciesDs[1];
                ad3 = vAEvaluationCompetenciesDs[2];
                ad4 = vAEvaluationCompetenciesDs[3];
                ad5 = vAEvaluationCompetenciesDs[4];
                ad6 = vAEvaluationCompetenciesDs[5];
                ad7 = vAEvaluationCompetenciesDs[6];
                ad8 = vAEvaluationCompetenciesDs[7];
                ad9 = vAEvaluationCompetenciesDs[8];
                ad10 = vAEvaluationCompetenciesDs[9];
                ad11 = vAEvaluationCompetenciesDs[10];
                ad12 = vAEvaluationCompetenciesDs[11];
                ad13 = vAEvaluationCompetenciesDs[12];
                ad14 = vAEvaluationCompetenciesDs[13];
                ad15 = vAEvaluationCompetenciesDs[14];
                ad16 = vAEvaluationCompetenciesDs[15];
                ad17 = vAEvaluationCompetenciesDs[16];
                ad18 = vAEvaluationCompetenciesDs[17];
                if (vAEvaluationCompetenciesDs.Count > 18)
                {

                    ad19 = vAEvaluationCompetenciesDs[18];
                    ad20 = vAEvaluationCompetenciesDs[19];
                    ad21 = vAEvaluationCompetenciesDs[20];
                    ad22 = vAEvaluationCompetenciesDs[21];
                    ad23 = vAEvaluationCompetenciesDs[22];
                }
                if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                {
                   
                    row["BirthDate"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                  

                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                {
                   
                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                

               
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                   

                  
                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                  

                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                   
                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                 
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                 
                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                  

                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                {
                    
                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                   
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    
                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                  
                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                   
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    
                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                
                }


                dt.Rows.Add(row);

            }
            // test one 
            //for (int i = 1; i < 100; i++)
            //{
            //    row = dt.NewRow();
            //    row["EmpId"] = i;
            //    row["EmpName"] = i.ToString() + " Empl";
            //    row["Department"] = "XXYY";
            //    row["BirthDate"] = DateTime.Now.AddDays(-10000);
            //    dt.Rows.Add(row);
            //}

            return dt;
        }
        private DataTable GetEmployeeList2(string Id, string Year)
        {
            var dt = new DataTable();
            dt.Columns.Add("EmpId");
            dt.Columns.Add("EmpName");
            dt.Columns.Add("Department");
            dt.Columns.Add("BirthDate");
            dt.Columns.Add("hiring");
            dt.Columns.Add("class");
            dt.Columns.Add("grade");
            dt.Columns.Add("parent");
            dt.Columns.Add("phone");
            dt.Columns.Add("Year");
            dt.Columns.Add("Parm1");
            dt.Columns.Add("Parm2");
            dt.Columns.Add("Parm3");
            dt.Columns.Add("Parm4");
            dt.Columns.Add("Parm5");
            dt.Columns.Add("Parm6");
            dt.Columns.Add("Parm7");
            dt.Columns.Add("Parm8");
            dt.Columns.Add("Parm9");
            dt.Columns.Add("Parm10");
            dt.Columns.Add("Parm11");
            dt.Columns.Add("Parm12");
            dt.Columns.Add("Parm13");
            dt.Columns.Add("Parm14");
            dt.Columns.Add("Parm15");
            dt.Columns.Add("Parm16");
            dt.Columns.Add("Parm17");
            dt.Columns.Add("Parm18");
            dt.Columns.Add("Parm19");
            dt.Columns.Add("Parm20");
            dt.Columns.Add("Parm21");
            dt.Columns.Add("Parm22");
            dt.Columns.Add("Parm23");
            dt.Columns.Add("Parm24");
            dt.Columns.Add("Parm25");
            dt.Columns.Add("Parm26");
            dt.Columns.Add("Parm27");
            dt.Columns.Add("Parm28");
            dt.Columns.Add("Parm29");
            dt.Columns.Add("Parm30");
            dt.Columns.Add("Parm31");
            dt.Columns.Add("Parm32");
            dt.Columns.Add("Parm33");
            dt.Columns.Add("Parm34");
            dt.Columns.Add("Parm35");
            dt.Columns.Add("Parm36");
            dt.Columns.Add("Parm37");
            dt.Columns.Add("Parm38");
            dt.Columns.Add("Parm39");
            dt.Columns.Add("Parm40");
            dt.Columns.Add("Parm41");
            dt.Columns.Add("Parm42");
            dt.Columns.Add("Parm43");
            dt.Columns.Add("Parm44");
            dt.Columns.Add("Parm45");
            dt.Columns.Add("Parm46");
            dt.Columns.Add("Parm47");
            dt.Columns.Add("Parm48");
            dt.Columns.Add("Parm49");
            dt.Columns.Add("Parm50");
            dt.Columns.Add("Parm51");
            dt.Columns.Add("Parm52");
            dt.Columns.Add("Parm53");
            dt.Columns.Add("Parm54");
























            DataRow row;
            // for one employee
            //var Cemp = _context.Cemps.Where(xz => xz.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
            //row = dt.NewRow();
            //row["EmpId"] = Cemp.Cempid;
            //row["EmpName"] = Cemp.CEMPNAME;
            //row["Department"] = Cemp.DEP_NAME;
            //row["BirthDate"] =Convert.ToDateTime( Cemp.CEMPLASTUPGRADEHIJRA).ToString("yyyy-MM-dd");
            //dt.Rows.Add(row);

            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail> EvalDetails2 = _context.EvalDetailss.ToList();
            List<EvalRequestTypeId> EvalRequestTypeIds2 = _context.EvalRequestTypeIds.ToList();
            List<Evalcomment2> evalcommentss = _context.EvalComments2.ToList();
            List<Cemp> cemps = _context.Cemps.ToList();
            var Records = from e in AEvaluationEmps
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join f in EvalDetails2 on e.Idd equals f.CourcesIdoffered into table4
                          from f in table4.ToList()
                          where f.OfferedRequestTypeSatus == 1
                          where f.OfferedRequestFrom == Id & e.year == Year /*HttpContext.Session.GetString("username")*/
                          join h in EvalRequestTypeIds2 on e.Idd equals h.CourcesIdoffered into table5
                          from h in table5.ToList()
                          where h.OfferedRequestType == 1
                          //join mm in evalcommentss on f.OfferedDetailsSerial equals mm.Offerdetailsid into table6
                          //from mm in table6.ToList()
                          //where mm.Offerdetailsid == f.OfferedDetailsSerial
                          join gg in cemps on e.Empno equals Convert.ToInt32(gg.Cempid) into table99
                          from gg in table99.ToList()



                          select new ViewModelEvalwithother
                          {
                              AEvaluationEmp = e,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              evalDetail = f,
                              evalRequestTypeId = h,
                              //evalcomment2 = mm,
                              cemp = gg,

                          };

            foreach (var cemp in Records)
            {
                row = dt.NewRow();
                row["EmpId"] = cemp.cemp.Cempid;
                row["EmpName"] = cemp.cemp.CEMPNAME;
                row["Department"] = cemp.cemp.DEP_NAME;
                //row["BirthDate"] = Convert.ToDateTime(cemp.cemp.CEMPLASTUPGRADEHIJRA).ToString("yyyy-MM-dd");
                //row["hiring"] = Convert.ToDateTime(cemp.cemp.CEMPHIRINGDATEHIJRA).ToString("yyyy-MM-dd");
                row["class"] = cemp.cemp.CEMPPASSWRD;
                row["grade"] = cemp.cemp.CEMPJOBNAME;
                row["parent"] = cemp.cemp.PARENTNAME;
                row["phone"] = cemp.AEvaluationEmp.Idd;
                row["Year"] = cemp.AEvaluationEmp.year;

                //var approveddate = _context.EvalComments2.Where(x => x.Offerdetailsid == cemp.evalDetail2.OfferedDetailsSerial).FirstOrDefault();
                //if (approveddate != null)
                //{
                //    TempData["GRADE1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("yyyy");
                //    TempData["GRADEN1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                //}
                List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                av1 = vAEvaluationGoals[0];
                av2 = vAEvaluationGoals[1];
                av3 = vAEvaluationGoals[2];
                av4 = vAEvaluationGoals[3];
                if (vAEvaluationGoals.Count > 4)
                {
                    av5 = vAEvaluationGoals[4];

                }
                if (vAEvaluationGoals.Count > 5)
                {
                    av6 = vAEvaluationGoals[5];
                }
                List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                am1 = vAEvaluationCompetenciesMs[0];
                am2 = vAEvaluationCompetenciesMs[1];
                am3 = vAEvaluationCompetenciesMs[2];
                am4 = vAEvaluationCompetenciesMs[3];
                am5 = vAEvaluationCompetenciesMs[4];
                am6 = vAEvaluationCompetenciesMs[5];
                if (vAEvaluationCompetenciesMs.Count > 6)
                {

                    am7 = vAEvaluationCompetenciesMs[6];
                }

                List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                ad1 = vAEvaluationCompetenciesDs[0];
                ad2 = vAEvaluationCompetenciesDs[1];
                ad3 = vAEvaluationCompetenciesDs[2];
                ad4 = vAEvaluationCompetenciesDs[3];
                ad5 = vAEvaluationCompetenciesDs[4];
                ad6 = vAEvaluationCompetenciesDs[5];
                ad7 = vAEvaluationCompetenciesDs[6];
                ad8 = vAEvaluationCompetenciesDs[7];
                ad9 = vAEvaluationCompetenciesDs[8];
                ad10 = vAEvaluationCompetenciesDs[9];
                ad11 = vAEvaluationCompetenciesDs[10];
                ad12 = vAEvaluationCompetenciesDs[11];
                ad13 = vAEvaluationCompetenciesDs[12];
                ad14 = vAEvaluationCompetenciesDs[13];
                ad15 = vAEvaluationCompetenciesDs[14];
                ad16 = vAEvaluationCompetenciesDs[15];
                ad17 = vAEvaluationCompetenciesDs[16];
                ad18 = vAEvaluationCompetenciesDs[17];
                if (vAEvaluationCompetenciesDs.Count > 18)
                {

                    ad19 = vAEvaluationCompetenciesDs[18];
                    ad20 = vAEvaluationCompetenciesDs[19];
                    ad21 = vAEvaluationCompetenciesDs[20];
                    ad22 = vAEvaluationCompetenciesDs[21];
                    ad23 = vAEvaluationCompetenciesDs[22];
                }
                if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                {

                    row["BirthDate"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";

                    row["Parm1"] = av1.CovenantGoalsName;
                    row["Parm2"] = av2.CovenantGoalsName;
                    row["Parm3"] = av3.CovenantGoalsName;
                    row["Parm4"] = av4.CovenantGoalsName;
                    row["Parm5"] = av5.CovenantGoalsName;
                    //row["Parm54"] = av6.CovenantGoalsName,
                    row["Parm6"] = av1.CovenantMeasurementCriteria;
                    row["Parm7"] = av2.CovenantMeasurementCriteria;
                    row["Parm8"] = av3.CovenantMeasurementCriteria;
                    row["Parm9"] = av4.CovenantMeasurementCriteria;
                    row["Parm10"] = av5.CovenantMeasurementCriteria;
                    //row["Parm11"] = av6.CovenantMeasurementCriteria,
                    row["Parm12"] = av1.CovenantPercentageWeight;
                    row["Parm13"] = av2.CovenantPercentageWeight;
                    row["Parm14"] = av3.CovenantPercentageWeight;
                    row["Parm15"] = av4.CovenantPercentageWeight;
                    row["Parm16"] = av5.CovenantPercentageWeight;
                    //row["Parm17"] = av6.CovenantPercentageWeight,
                    row["Parm18"] = av1.CovenantTargetedOutput;
                    row["Parm19"] = av2.CovenantTargetedOutput;
                    row["Parm20"] = av3.CovenantTargetedOutput;
                    row["Parm21"] = av4.CovenantTargetedOutput;
                    row["Parm22"] = av5.CovenantTargetedOutput;
                    //row["Parm23"] = av6.CovenantTargetedOutput,
                    row["Parm24"] = am1.CovenantWeight;
                    row["Parm25"] = am2.CovenantWeight;
                    row["Parm26"] = am3.CovenantWeight;
                    row["Parm27"] = am4.CovenantWeight;
                    row["Parm28"] = am5.CovenantWeight;
                    row["Parm29"] = am6.CovenantWeight;
                    row["Parm30"] = am7.CovenantWeight;
                    row["Parm31"] = ad1.CovenantCompetenciecDLevel;
                    row["Parm32"] = ad2.CovenantCompetenciecDLevel;
                    row["Parm33"] = ad3.CovenantCompetenciecDLevel;
                    row["Parm34"] = ad4.CovenantCompetenciecDLevel;
                    row["Parm35"] = ad5.CovenantCompetenciecDLevel;
                    row["Parm36"] = ad6.CovenantCompetenciecDLevel;
                    row["Parm37"] = ad7.CovenantCompetenciecDLevel;
                    row["Parm38"] = ad8.CovenantCompetenciecDLevel;
                    row["Parm39"] = ad9.CovenantCompetenciecDLevel;
                    row["Parm40"] = ad10.CovenantCompetenciecDLevel;
                    row["Parm41"] = ad11.CovenantCompetenciecDLevel;
                    row["Parm42"] = ad12.CovenantCompetenciecDLevel;
                    row["Parm43"] = ad13.CovenantCompetenciecDLevel;
                    row["Parm44"] = ad14.CovenantCompetenciecDLevel;
                    row["Parm45"] = ad15.CovenantCompetenciecDLevel;
                    row["Parm46"] = ad16.CovenantCompetenciecDLevel;
                    row["Parm47"] = ad17.CovenantCompetenciecDLevel;
                    row["Parm48"] = ad18.CovenantCompetenciecDLevel;

                    row["Parm49"] = ad19.CovenantCompetenciecDLevel;
                    row["Parm50"] = ad20.CovenantCompetenciecDLevel;
                    row["Parm51"] = ad21.CovenantCompetenciecDLevel;
                    row["Parm52"] = ad22.CovenantCompetenciecDLevel;
                    row["Parm53"] = ad23.CovenantCompetenciecDLevel;

                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                {

                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";

                    row["Parm1"] = av1.CovenantGoalsName;
                    row["Parm2"] = av2.CovenantGoalsName;
                    row["Parm3"] = av3.CovenantGoalsName;
                    row["Parm4"] = av4.CovenantGoalsName;
                    row["Parm5"] = av5.CovenantGoalsName;
                    row["Parm54"] = av6.CovenantGoalsName;
                    row["Parm6"] = av1.CovenantMeasurementCriteria;
                    row["Parm7"] = av2.CovenantMeasurementCriteria;
                    row["Parm8"] = av3.CovenantMeasurementCriteria;
                    row["Parm9"] = av4.CovenantMeasurementCriteria;
                    row["Parm10"] = av5.CovenantMeasurementCriteria;
                    row["Parm11"] = av6.CovenantMeasurementCriteria;
                    row["Parm12"] = av1.CovenantPercentageWeight;
                    row["Parm13"] = av2.CovenantPercentageWeight;
                    row["Parm14"] = av3.CovenantPercentageWeight;
                    row["Parm15"] = av4.CovenantPercentageWeight;
                    row["Parm16"] = av5.CovenantPercentageWeight;
                    row["Parm17"] = av6.CovenantPercentageWeight;
                    row["Parm18"] = av1.CovenantTargetedOutput;
                    row["Parm19"] = av2.CovenantTargetedOutput;
                    row["Parm20"] = av3.CovenantTargetedOutput;
                    row["Parm21"] = av4.CovenantTargetedOutput;
                    row["Parm22"] = av5.CovenantTargetedOutput;
                    row["Parm23"] = av6.CovenantTargetedOutput;
                    row["Parm24"] = am1.CovenantWeight;
                    row["Parm25"] = am2.CovenantWeight;
                    row["Parm26"] = am3.CovenantWeight;
                    row["Parm27"] = am4.CovenantWeight;
                    row["Parm28"] = am5.CovenantWeight;
                    row["Parm29"] = am6.CovenantWeight;
                    row["Parm30"] = am7.CovenantWeight;
                    row["Parm31"] = ad1.CovenantCompetenciecDLevel;
                    row["Parm32"] = ad2.CovenantCompetenciecDLevel;
                    row["Parm33"] = ad3.CovenantCompetenciecDLevel;
                    row["Parm34"] = ad4.CovenantCompetenciecDLevel;
                    row["Parm35"] = ad5.CovenantCompetenciecDLevel;
                    row["Parm36"] = ad6.CovenantCompetenciecDLevel;
                    row["Parm37"] = ad7.CovenantCompetenciecDLevel;
                    row["Parm38"] = ad8.CovenantCompetenciecDLevel;
                    row["Parm39"] = ad9.CovenantCompetenciecDLevel;
                    row["Parm40"] = ad10.CovenantCompetenciecDLevel;
                    row["Parm41"] = ad11.CovenantCompetenciecDLevel;
                    row["Parm42"] = ad12.CovenantCompetenciecDLevel;
                    row["Parm43"] = ad13.CovenantCompetenciecDLevel;
                    row["Parm44"] = ad14.CovenantCompetenciecDLevel;
                    row["Parm45"] = ad15.CovenantCompetenciecDLevel;
                    row["Parm46"] = ad16.CovenantCompetenciecDLevel;
                    row["Parm47"] = ad17.CovenantCompetenciecDLevel;
                    row["Parm48"] = ad18.CovenantCompetenciecDLevel;

                    row["Parm49"] = ad19.CovenantCompetenciecDLevel;
                    row["Parm50"] = ad20.CovenantCompetenciecDLevel;
                    row["Parm51"] = ad21.CovenantCompetenciecDLevel;
                    row["Parm52"] = ad22.CovenantCompetenciecDLevel;
                    row["Parm53"] = ad23.CovenantCompetenciecDLevel;

                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {



                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

                    row["Parm1"] = av1.CovenantGoalsName;
                    row["Parm2"] = av2.CovenantGoalsName;
                    row["Parm3"] = av3.CovenantGoalsName;
                    row["Parm4"] = av4.CovenantGoalsName;
                    row["Parm5"] = av5.CovenantGoalsName;
                    row["Parm54"] = av6.CovenantGoalsName;
                    row["Parm6"] = av1.CovenantMeasurementCriteria;
                    row["Parm7"] = av2.CovenantMeasurementCriteria;
                    row["Parm8"] = av3.CovenantMeasurementCriteria;
                    row["Parm9"] = av4.CovenantMeasurementCriteria;
                    row["Parm10"] = av5.CovenantMeasurementCriteria;
                    row["Parm11"] = av6.CovenantMeasurementCriteria;
                    row["Parm12"] = av1.CovenantPercentageWeight;
                    row["Parm13"] = av2.CovenantPercentageWeight;
                    row["Parm14"] = av3.CovenantPercentageWeight;
                    row["Parm15"] = av4.CovenantPercentageWeight;
                    row["Parm16"] = av5.CovenantPercentageWeight;
                    row["Parm17"] = av6.CovenantPercentageWeight;
                    row["Parm18"] = av1.CovenantTargetedOutput;
                    row["Parm19"] = av2.CovenantTargetedOutput;
                    row["Parm20"] = av3.CovenantTargetedOutput;
                    row["Parm21"] = av4.CovenantTargetedOutput;
                    row["Parm22"] = av5.CovenantTargetedOutput;
                    row["Parm23"] = av6.CovenantTargetedOutput;
                    row["Parm24"] = am1.CovenantWeight;
                    row["Parm25"] = am2.CovenantWeight;
                    row["Parm26"] = am3.CovenantWeight;
                    row["Parm27"] = am4.CovenantWeight;
                    row["Parm28"] = am5.CovenantWeight;
                    row["Parm29"] = am6.CovenantWeight;
                    row["Parm30"] = am7.CovenantWeight;
                    row["Parm31"] = ad1.CovenantCompetenciecDLevel;
                    row["Parm32"] = ad2.CovenantCompetenciecDLevel;
                    row["Parm33"] = ad3.CovenantCompetenciecDLevel;
                    row["Parm34"] = ad4.CovenantCompetenciecDLevel;
                    row["Parm35"] = ad5.CovenantCompetenciecDLevel;
                    row["Parm36"] = ad6.CovenantCompetenciecDLevel;
                    row["Parm37"] = ad7.CovenantCompetenciecDLevel;
                    row["Parm38"] = ad8.CovenantCompetenciecDLevel;
                    row["Parm39"] = ad9.CovenantCompetenciecDLevel;
                    row["Parm40"] = ad10.CovenantCompetenciecDLevel;
                    row["Parm41"] = ad11.CovenantCompetenciecDLevel;
                    row["Parm42"] = ad12.CovenantCompetenciecDLevel;
                    row["Parm43"] = ad13.CovenantCompetenciecDLevel;
                    row["Parm44"] = ad14.CovenantCompetenciecDLevel;
                    row["Parm45"] = ad15.CovenantCompetenciecDLevel;
                    row["Parm46"] = ad16.CovenantCompetenciecDLevel;
                    row["Parm47"] = ad17.CovenantCompetenciecDLevel;
                    row["Parm48"] = ad18.CovenantCompetenciecDLevel;

                    //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
                    //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
                    //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
                    //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
                    //row["Parm53"] = ad23.CovenantCompetenciecDLevel;

                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {

                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

                    row["Parm1"] = av1.CovenantGoalsName;
                    row["Parm2"] = av2.CovenantGoalsName;
                    row["Parm3"] = av3.CovenantGoalsName;
                    row["Parm4"] = av4.CovenantGoalsName;
                    //row["Parm5"] = av5.CovenantGoalsName;
                    //row["Parm54"] = av6.CovenantGoalsName;
                    row["Parm6"] = av1.CovenantMeasurementCriteria;
                    row["Parm7"] = av2.CovenantMeasurementCriteria;
                    row["Parm8"] = av3.CovenantMeasurementCriteria;
                    row["Parm9"] = av4.CovenantMeasurementCriteria;
                    //row["Parm10"] = av5.CovenantMeasurementCriteria;
                    //row["Parm11"] = av6.CovenantMeasurementCriteria;
                    row["Parm12"] = av1.CovenantPercentageWeight;
                    row["Parm13"] = av2.CovenantPercentageWeight;
                    row["Parm14"] = av3.CovenantPercentageWeight;
                    row["Parm15"] = av4.CovenantPercentageWeight;
                    //row["Parm16"] = av5.CovenantPercentageWeight;
                    //row["Parm17"] = av6.CovenantPercentageWeight;
                    row["Parm18"] = av1.CovenantTargetedOutput;
                    row["Parm19"] = av2.CovenantTargetedOutput;
                    row["Parm20"] = av3.CovenantTargetedOutput;
                    row["Parm21"] = av4.CovenantTargetedOutput;
                    //row["Parm22"] = av5.CovenantTargetedOutput;
                    //row["Parm23"] = av6.CovenantTargetedOutput;
                    row["Parm24"] = am1.CovenantWeight;
                    row["Parm25"] = am2.CovenantWeight;
                    row["Parm26"] = am3.CovenantWeight;
                    row["Parm27"] = am4.CovenantWeight;
                    row["Parm28"] = am5.CovenantWeight;
                    row["Parm29"] = am6.CovenantWeight;
                    //row["Parm30"] = am7.CovenantWeight;
                    row["Parm31"] = ad1.CovenantCompetenciecDLevel;
                    row["Parm32"] = ad2.CovenantCompetenciecDLevel;
                    row["Parm33"] = ad3.CovenantCompetenciecDLevel;
                    row["Parm34"] = ad4.CovenantCompetenciecDLevel;
                    row["Parm35"] = ad5.CovenantCompetenciecDLevel;
                    row["Parm36"] = ad6.CovenantCompetenciecDLevel;
                    row["Parm37"] = ad7.CovenantCompetenciecDLevel;
                    row["Parm38"] = ad8.CovenantCompetenciecDLevel;
                    row["Parm39"] = ad9.CovenantCompetenciecDLevel;
                    row["Parm40"] = ad10.CovenantCompetenciecDLevel;
                    row["Parm41"] = ad11.CovenantCompetenciecDLevel;
                    row["Parm42"] = ad12.CovenantCompetenciecDLevel;
                    row["Parm43"] = ad13.CovenantCompetenciecDLevel;
                    row["Parm44"] = ad14.CovenantCompetenciecDLevel;
                    row["Parm45"] = ad15.CovenantCompetenciecDLevel;
                    row["Parm46"] = ad16.CovenantCompetenciecDLevel;
                    row["Parm47"] = ad17.CovenantCompetenciecDLevel;
                    row["Parm48"] = ad18.CovenantCompetenciecDLevel;

                    //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
                    //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
                    //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
                    //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
                    //row["Parm53"] = ad23.CovenantCompetenciecDLevel;

                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {

                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

                    row["Parm1"] = av1.CovenantGoalsName;
                    row["Parm2"] = av2.CovenantGoalsName;
                    row["Parm3"] = av3.CovenantGoalsName;
                    row["Parm4"] = av4.CovenantGoalsName;
                    row["Parm5"] = av5.CovenantGoalsName;
                    //row["Parm54"] = av6.CovenantGoalsName;
                    row["Parm6"] = av1.CovenantMeasurementCriteria;
                    row["Parm7"] = av2.CovenantMeasurementCriteria;
                    row["Parm8"] = av3.CovenantMeasurementCriteria;
                    row["Parm9"] = av4.CovenantMeasurementCriteria;
                    row["Parm10"] = av5.CovenantMeasurementCriteria;
                    //row["Parm11"] = av6.CovenantMeasurementCriteria;
                    row["Parm12"] = av1.CovenantPercentageWeight;
                    row["Parm13"] = av2.CovenantPercentageWeight;
                    row["Parm14"] = av3.CovenantPercentageWeight;
                    row["Parm15"] = av4.CovenantPercentageWeight;
                    row["Parm16"] = av5.CovenantPercentageWeight;
                    //row["Parm17"] = av6.CovenantPercentageWeight;
                    row["Parm18"] = av1.CovenantTargetedOutput;
                    row["Parm19"] = av2.CovenantTargetedOutput;
                    row["Parm20"] = av3.CovenantTargetedOutput;
                    row["Parm21"] = av4.CovenantTargetedOutput;
                    row["Parm22"] = av5.CovenantTargetedOutput;
                    //row["Parm23"] = av6.CovenantTargetedOutput;
                    row["Parm24"] = am1.CovenantWeight;
                    row["Parm25"] = am2.CovenantWeight;
                    row["Parm26"] = am3.CovenantWeight;
                    row["Parm27"] = am4.CovenantWeight;
                    row["Parm28"] = am5.CovenantWeight;
                    row["Parm29"] = am6.CovenantWeight;
                    row["Parm30"] = am7.CovenantWeight;
                    row["Parm31"] = ad1.CovenantCompetenciecDLevel;
                    row["Parm32"] = ad2.CovenantCompetenciecDLevel;
                    row["Parm33"] = ad3.CovenantCompetenciecDLevel;
                    row["Parm34"] = ad4.CovenantCompetenciecDLevel;
                    row["Parm35"] = ad5.CovenantCompetenciecDLevel;
                    row["Parm36"] = ad6.CovenantCompetenciecDLevel;
                    row["Parm37"] = ad7.CovenantCompetenciecDLevel;
                    row["Parm38"] = ad8.CovenantCompetenciecDLevel;
                    row["Parm39"] = ad9.CovenantCompetenciecDLevel;
                    row["Parm40"] = ad10.CovenantCompetenciecDLevel;
                    row["Parm41"] = ad11.CovenantCompetenciecDLevel;
                    row["Parm42"] = ad12.CovenantCompetenciecDLevel;
                    row["Parm43"] = ad13.CovenantCompetenciecDLevel;
                    row["Parm44"] = ad14.CovenantCompetenciecDLevel;
                    row["Parm45"] = ad15.CovenantCompetenciecDLevel;
                    row["Parm46"] = ad16.CovenantCompetenciecDLevel;
                    row["Parm47"] = ad17.CovenantCompetenciecDLevel;
                    row["Parm48"] = ad18.CovenantCompetenciecDLevel;

                    //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
                    //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
                    //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
                    //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
                    //row["Parm53"] = ad23.CovenantCompetenciecDLevel;

                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                {

                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    row["Parm1"] = av1.CovenantGoalsName;
                    row["Parm2"] = av2.CovenantGoalsName;
                    row["Parm3"] = av3.CovenantGoalsName;
                    row["Parm4"] = av4.CovenantGoalsName;
                    //row["Parm5"] = av5.CovenantGoalsName;
                    //row["Parm54"] = av6.CovenantGoalsName;
                    row["Parm6"] = av1.CovenantMeasurementCriteria;
                    row["Parm7"] = av2.CovenantMeasurementCriteria;
                    row["Parm8"] = av3.CovenantMeasurementCriteria;
                    row["Parm9"] = av4.CovenantMeasurementCriteria;
                    //row["Parm10"] = av5.CovenantMeasurementCriteria;
                    //row["Parm11"] = av6.CovenantMeasurementCriteria;
                    row["Parm12"] = av1.CovenantPercentageWeight;
                    row["Parm13"] = av2.CovenantPercentageWeight;
                    row["Parm14"] = av3.CovenantPercentageWeight;
                    row["Parm15"] = av4.CovenantPercentageWeight;
                    //row["Parm16"] = av5.CovenantPercentageWeight;
                    //row["Parm17"] = av6.CovenantPercentageWeight;
                    row["Parm18"] = av1.CovenantTargetedOutput;
                    row["Parm19"] = av2.CovenantTargetedOutput;
                    row["Parm20"] = av3.CovenantTargetedOutput;
                    row["Parm21"] = av4.CovenantTargetedOutput;
                    //row["Parm22"] = av5.CovenantTargetedOutput;
                    //row["Parm23"] = av6.CovenantTargetedOutput;
                    row["Parm24"] = am1.CovenantWeight;
                    row["Parm25"] = am2.CovenantWeight;
                    row["Parm26"] = am3.CovenantWeight;
                    row["Parm27"] = am4.CovenantWeight;
                    row["Parm28"] = am5.CovenantWeight;
                    row["Parm29"] = am6.CovenantWeight;
                    row["Parm30"] = am7.CovenantWeight;
                    row["Parm31"] = ad1.CovenantCompetenciecDLevel;
                    row["Parm32"] = ad2.CovenantCompetenciecDLevel;
                    row["Parm33"] = ad3.CovenantCompetenciecDLevel;
                    row["Parm34"] = ad4.CovenantCompetenciecDLevel;
                    row["Parm35"] = ad5.CovenantCompetenciecDLevel;
                    row["Parm36"] = ad6.CovenantCompetenciecDLevel;
                    row["Parm37"] = ad7.CovenantCompetenciecDLevel;
                    row["Parm38"] = ad8.CovenantCompetenciecDLevel;
                    row["Parm39"] = ad9.CovenantCompetenciecDLevel;
                    row["Parm40"] = ad10.CovenantCompetenciecDLevel;
                    row["Parm41"] = ad11.CovenantCompetenciecDLevel;
                    row["Parm42"] = ad12.CovenantCompetenciecDLevel;
                    row["Parm43"] = ad13.CovenantCompetenciecDLevel;
                    row["Parm44"] = ad14.CovenantCompetenciecDLevel;
                    row["Parm45"] = ad15.CovenantCompetenciecDLevel;
                    row["Parm46"] = ad16.CovenantCompetenciecDLevel;
                    row["Parm47"] = ad17.CovenantCompetenciecDLevel;
                    row["Parm48"] = ad18.CovenantCompetenciecDLevel;

                    row["Parm49"] = ad19.CovenantCompetenciecDLevel;
                    row["Parm50"] = ad20.CovenantCompetenciecDLevel;
                    row["Parm51"] = ad21.CovenantCompetenciecDLevel;
                    row["Parm52"] = ad22.CovenantCompetenciecDLevel;
                    row["Parm53"] = ad23.CovenantCompetenciecDLevel;
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {

                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    row["Parm1"] = av1.CovenantGoalsName;
                    row["Parm2"] = av2.CovenantGoalsName;
                    row["Parm3"] = av3.CovenantGoalsName;
                    row["Parm4"] = av4.CovenantGoalsName;
                    //row["Parm5"] = av5.CovenantGoalsName;
                    //row["Parm54"] = av6.CovenantGoalsName;
                    row["Parm6"] = av1.CovenantMeasurementCriteria;
                    row["Parm7"] = av2.CovenantMeasurementCriteria;
                    row["Parm8"] = av3.CovenantMeasurementCriteria;
                    row["Parm9"] = av4.CovenantMeasurementCriteria;
                    //row["Parm10"] = av5.CovenantMeasurementCriteria;
                    //row["Parm11"] = av6.CovenantMeasurementCriteria;
                    row["Parm12"] = av1.CovenantPercentageWeight;
                    row["Parm13"] = av2.CovenantPercentageWeight;
                    row["Parm14"] = av3.CovenantPercentageWeight;
                    row["Parm15"] = av4.CovenantPercentageWeight;
                    //row["Parm16"] = av5.CovenantPercentageWeight;
                    //row["Parm17"] = av6.CovenantPercentageWeight;
                    row["Parm18"] = av1.CovenantTargetedOutput;
                    row["Parm19"] = av2.CovenantTargetedOutput;
                    row["Parm20"] = av3.CovenantTargetedOutput;
                    row["Parm21"] = av4.CovenantTargetedOutput;
                    //row["Parm22"] = av5.CovenantTargetedOutput;
                    //row["Parm23"] = av6.CovenantTargetedOutput;
                    row["Parm24"] = am1.CovenantWeight;
                    row["Parm25"] = am2.CovenantWeight;
                    row["Parm26"] = am3.CovenantWeight;
                    row["Parm27"] = am4.CovenantWeight;
                    row["Parm28"] = am5.CovenantWeight;
                    row["Parm29"] = am6.CovenantWeight;
                    row["Parm30"] = am7.CovenantWeight;
                    row["Parm31"] = ad1.CovenantCompetenciecDLevel;
                    row["Parm32"] = ad2.CovenantCompetenciecDLevel;
                    row["Parm33"] = ad3.CovenantCompetenciecDLevel;
                    row["Parm34"] = ad4.CovenantCompetenciecDLevel;
                    row["Parm35"] = ad5.CovenantCompetenciecDLevel;
                    row["Parm36"] = ad6.CovenantCompetenciecDLevel;
                    row["Parm37"] = ad7.CovenantCompetenciecDLevel;
                    row["Parm38"] = ad8.CovenantCompetenciecDLevel;
                    row["Parm39"] = ad9.CovenantCompetenciecDLevel;
                    row["Parm40"] = ad10.CovenantCompetenciecDLevel;
                    row["Parm41"] = ad11.CovenantCompetenciecDLevel;
                    row["Parm42"] = ad12.CovenantCompetenciecDLevel;
                    row["Parm43"] = ad13.CovenantCompetenciecDLevel;
                    row["Parm44"] = ad14.CovenantCompetenciecDLevel;
                    row["Parm45"] = ad15.CovenantCompetenciecDLevel;
                    row["Parm46"] = ad16.CovenantCompetenciecDLevel;
                    row["Parm47"] = ad17.CovenantCompetenciecDLevel;
                    row["Parm48"] = ad18.CovenantCompetenciecDLevel;

                    //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
                    //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
                    //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
                    //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
                    //row["Parm53"] = ad23.CovenantCompetenciecDLevel;

                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {

                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    row["Parm1"] = av1.CovenantGoalsName;
                    row["Parm2"] = av2.CovenantGoalsName;
                    row["Parm3"] = av3.CovenantGoalsName;
                    row["Parm4"] = av4.CovenantGoalsName;
                    row["Parm5"] = av5.CovenantGoalsName;
                    //row["Parm54"] = av6.CovenantGoalsName;
                    row["Parm6"] = av1.CovenantMeasurementCriteria;
                    row["Parm7"] = av2.CovenantMeasurementCriteria;
                    row["Parm8"] = av3.CovenantMeasurementCriteria;
                    row["Parm9"] = av4.CovenantMeasurementCriteria;
                    row["Parm10"] = av5.CovenantMeasurementCriteria;
                    //row["Parm11"] = av6.CovenantMeasurementCriteria;
                    row["Parm12"] = av1.CovenantPercentageWeight;
                    row["Parm13"] = av2.CovenantPercentageWeight;
                    row["Parm14"] = av3.CovenantPercentageWeight;
                    row["Parm15"] = av4.CovenantPercentageWeight;
                    row["Parm16"] = av5.CovenantPercentageWeight;
                    //row["Parm17"] = av6.CovenantPercentageWeight;
                    row["Parm18"] = av1.CovenantTargetedOutput;
                    row["Parm19"] = av2.CovenantTargetedOutput;
                    row["Parm20"] = av3.CovenantTargetedOutput;
                    row["Parm21"] = av4.CovenantTargetedOutput;
                    row["Parm22"] = av5.CovenantTargetedOutput;
                    //row["Parm23"] = av6.CovenantTargetedOutput;
                    row["Parm24"] = am1.CovenantWeight;
                    row["Parm25"] = am2.CovenantWeight;
                    row["Parm26"] = am3.CovenantWeight;
                    row["Parm27"] = am4.CovenantWeight;
                    row["Parm28"] = am5.CovenantWeight;
                    row["Parm29"] = am6.CovenantWeight;
                    //row["Parm30"] = am7.CovenantWeight;
                    row["Parm31"] = ad1.CovenantCompetenciecDLevel;
                    row["Parm32"] = ad2.CovenantCompetenciecDLevel;
                    row["Parm33"] = ad3.CovenantCompetenciecDLevel;
                    row["Parm34"] = ad4.CovenantCompetenciecDLevel;
                    row["Parm35"] = ad5.CovenantCompetenciecDLevel;
                    row["Parm36"] = ad6.CovenantCompetenciecDLevel;
                    row["Parm37"] = ad7.CovenantCompetenciecDLevel;
                    row["Parm38"] = ad8.CovenantCompetenciecDLevel;
                    row["Parm39"] = ad9.CovenantCompetenciecDLevel;
                    row["Parm40"] = ad10.CovenantCompetenciecDLevel;
                    row["Parm41"] = ad11.CovenantCompetenciecDLevel;
                    row["Parm42"] = ad12.CovenantCompetenciecDLevel;
                    row["Parm43"] = ad13.CovenantCompetenciecDLevel;
                    row["Parm44"] = ad14.CovenantCompetenciecDLevel;
                    row["Parm45"] = ad15.CovenantCompetenciecDLevel;
                    row["Parm46"] = ad16.CovenantCompetenciecDLevel;
                    row["Parm47"] = ad17.CovenantCompetenciecDLevel;
                    row["Parm48"] = ad18.CovenantCompetenciecDLevel;

                    //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
                    //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
                    //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
                    //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
                    //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {

                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

                    row["Parm1"] = av1.CovenantGoalsName;
                    row["Parm2"] = av2.CovenantGoalsName;
                    row["Parm3"] = av3.CovenantGoalsName;
                    row["Parm4"] = av4.CovenantGoalsName;
                    row["Parm5"] = av5.CovenantGoalsName;
                    row["Parm54"] = av6.CovenantGoalsName;
                    row["Parm6"] = av1.CovenantMeasurementCriteria;
                    row["Parm7"] = av2.CovenantMeasurementCriteria;
                    row["Parm8"] = av3.CovenantMeasurementCriteria;
                    row["Parm9"] = av4.CovenantMeasurementCriteria;
                    row["Parm10"] = av5.CovenantMeasurementCriteria;
                    row["Parm11"] = av6.CovenantMeasurementCriteria;
                    row["Parm12"] = av1.CovenantPercentageWeight;
                    row["Parm13"] = av2.CovenantPercentageWeight;
                    row["Parm14"] = av3.CovenantPercentageWeight;
                    row["Parm15"] = av4.CovenantPercentageWeight;
                    row["Parm16"] = av5.CovenantPercentageWeight;
                    row["Parm17"] = av6.CovenantPercentageWeight;
                    row["Parm18"] = av1.CovenantTargetedOutput;
                    row["Parm19"] = av2.CovenantTargetedOutput;
                    row["Parm20"] = av3.CovenantTargetedOutput;
                    row["Parm21"] = av4.CovenantTargetedOutput;
                    row["Parm22"] = av5.CovenantTargetedOutput;
                    row["Parm23"] = av6.CovenantTargetedOutput;
                    row["Parm24"] = am1.CovenantWeight;
                    row["Parm25"] = am2.CovenantWeight;
                    row["Parm26"] = am3.CovenantWeight;
                    row["Parm27"] = am4.CovenantWeight;
                    row["Parm28"] = am5.CovenantWeight;
                    row["Parm29"] = am6.CovenantWeight;
                    //row["Parm30"] = am7.CovenantWeight;
                    row["Parm31"] = ad1.CovenantCompetenciecDLevel;
                    row["Parm32"] = ad2.CovenantCompetenciecDLevel;
                    row["Parm33"] = ad3.CovenantCompetenciecDLevel;
                    row["Parm34"] = ad4.CovenantCompetenciecDLevel;
                    row["Parm35"] = ad5.CovenantCompetenciecDLevel;
                    row["Parm36"] = ad6.CovenantCompetenciecDLevel;
                    row["Parm37"] = ad7.CovenantCompetenciecDLevel;
                    row["Parm38"] = ad8.CovenantCompetenciecDLevel;
                    row["Parm39"] = ad9.CovenantCompetenciecDLevel;
                    row["Parm40"] = ad10.CovenantCompetenciecDLevel;
                    row["Parm41"] = ad11.CovenantCompetenciecDLevel;
                    row["Parm42"] = ad12.CovenantCompetenciecDLevel;
                    row["Parm43"] = ad13.CovenantCompetenciecDLevel;
                    row["Parm44"] = ad14.CovenantCompetenciecDLevel;
                    row["Parm45"] = ad15.CovenantCompetenciecDLevel;
                    row["Parm46"] = ad16.CovenantCompetenciecDLevel;
                    row["Parm47"] = ad17.CovenantCompetenciecDLevel;
                    row["Parm48"] = ad18.CovenantCompetenciecDLevel;

                    //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
                    //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
                    //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
                    //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
                    //row["Parm53"] = ad23.CovenantCompetenciecDLevel;

                }


                dt.Rows.Add(row);

            }
            // test one 
            //for (int i = 1; i < 100; i++)
            //{
            //    row = dt.NewRow();
            //    row["EmpId"] = i;
            //    row["EmpName"] = i.ToString() + " Empl";
            //    row["Department"] = "XXYY";
            //    row["BirthDate"] = DateTime.Now.AddDays(-10000);
            //    dt.Rows.Add(row);
            //}

            return dt;
        }
        private DataTable GetEmployeeList3(string Id, string Year)
        {
            var dt = new DataTable();
            dt.Columns.Add("EmpId");
            dt.Columns.Add("EmpName");
            dt.Columns.Add("Department");
            dt.Columns.Add("BirthDate");
            dt.Columns.Add("hiring");
            dt.Columns.Add("class");
            dt.Columns.Add("grade");
            dt.Columns.Add("parent");
            dt.Columns.Add("phone");
            dt.Columns.Add("Year");
            dt.Columns.Add("Parm1");
            dt.Columns.Add("Parm2");
            dt.Columns.Add("Parm3");
            dt.Columns.Add("Parm4");
            dt.Columns.Add("Parm5");
            dt.Columns.Add("Parm6");
            dt.Columns.Add("Parm7");
            dt.Columns.Add("Parm8");
            dt.Columns.Add("Parm9");
            dt.Columns.Add("Parm10");
            dt.Columns.Add("Parm11");
            dt.Columns.Add("Parm12");
            dt.Columns.Add("Parm13");
            dt.Columns.Add("Parm14");
            dt.Columns.Add("Parm15");
            dt.Columns.Add("Parm16");
            dt.Columns.Add("Parm17");
            dt.Columns.Add("Parm18");
            dt.Columns.Add("Parm19");
            dt.Columns.Add("Parm20");
            dt.Columns.Add("Parm21");
            dt.Columns.Add("Parm22");
            dt.Columns.Add("Parm23");
            dt.Columns.Add("Parm24");
            dt.Columns.Add("Parm25");
            dt.Columns.Add("Parm26");
            dt.Columns.Add("Parm27");
            dt.Columns.Add("Parm28");
            dt.Columns.Add("Parm29");
            dt.Columns.Add("Parm30");
            dt.Columns.Add("Parm31");
            dt.Columns.Add("Parm32");
            dt.Columns.Add("Parm33");
            dt.Columns.Add("Parm34");
            dt.Columns.Add("Parm35");
            dt.Columns.Add("Parm36");
            dt.Columns.Add("Parm37");
            dt.Columns.Add("Parm38");
            dt.Columns.Add("Parm39");
            dt.Columns.Add("Parm40");
            dt.Columns.Add("Parm41");
            dt.Columns.Add("Parm42");
            dt.Columns.Add("Parm43");
            dt.Columns.Add("Parm44");
            dt.Columns.Add("Parm45");
            dt.Columns.Add("Parm46");
            dt.Columns.Add("Parm47");
            dt.Columns.Add("Parm48");
            dt.Columns.Add("Parm49");
            dt.Columns.Add("Parm50");
            dt.Columns.Add("Parm51");
            dt.Columns.Add("Parm52");
            dt.Columns.Add("Parm53");
            dt.Columns.Add("Parm54");
            dt.Columns.Add("Parm55");
            dt.Columns.Add("Parm56");
























            DataRow row;
            // for one employee
            //var Cemp = _context.Cemps.Where(xz => xz.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
            //row = dt.NewRow();
            //row["EmpId"] = Cemp.Cempid;
            //row["EmpName"] = Cemp.CEMPNAME;
            //row["Department"] = Cemp.DEP_NAME;
            //row["BirthDate"] =Convert.ToDateTime( Cemp.CEMPLASTUPGRADEHIJRA).ToString("yyyy-MM-dd");
            //dt.Rows.Add(row);

            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail> EvalDetails2 = _context.EvalDetailss.ToList();
            List<EvalRequestTypeId> EvalRequestTypeIds2 = _context.EvalRequestTypeIds.ToList();
            List<Evalcomment2> evalcommentss = _context.EvalComments2.ToList();
            List<Cemp> cemps = _context.Cemps.ToList();
            var Records = from e in AEvaluationEmps
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join f in EvalDetails2 on e.Idd equals f.CourcesIdoffered into table4
                          from f in table4.ToList()
                          where f.OfferedRequestTypeSatus == 1
                          where f.OfferedRequestFrom == Id & e.year == Year /*HttpContext.Session.GetString("username")*/
                          join h in EvalRequestTypeIds2 on e.Idd equals h.CourcesIdoffered into table5
                          from h in table5.ToList()
                          where h.OfferedRequestType == 1
                          //join mm in evalcommentss on f.OfferedDetailsSerial equals mm.Offerdetailsid into table6
                          //from mm in table6.ToList()
                          //where mm.Offerdetailsid == f.OfferedDetailsSerial
                          join gg in cemps on e.Empno equals Convert.ToInt32(gg.Cempid) into table99
                          from gg in table99.ToList()



                          select new ViewModelEvalwithother
                          {
                              AEvaluationEmp = e,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              evalDetail = f,
                              evalRequestTypeId = h,
                              //evalcomment2 = mm,
                              cemp = gg,

                          };

            foreach (var cemp in Records)
            {
                row = dt.NewRow();
                row["EmpId"] = cemp.cemp.Cempid;
                row["EmpName"] = cemp.cemp.CEMPNAME;
                row["Department"] = cemp.cemp.DEP_NAME;
                //row["BirthDate"] = Convert.ToDateTime(cemp.cemp.CEMPLASTUPGRADEHIJRA).ToString("yyyy-MM-dd");
                //row["hiring"] = Convert.ToDateTime(cemp.cemp.CEMPHIRINGDATEHIJRA).ToString("yyyy-MM-dd");
                row["class"] = cemp.cemp.CEMPPASSWRD;
                row["grade"] = cemp.cemp.CEMPJOBNAME;
                row["parent"] = cemp.cemp.PARENTNAME;
                row["phone"] = cemp.AEvaluationEmp.Idd;
                row["Year"] = cemp.AEvaluationEmp.year;

                //var approveddate = _context.EvalComments2.Where(x => x.Offerdetailsid == cemp.evalDetail2.OfferedDetailsSerial).FirstOrDefault();
                //if (approveddate != null)
                //{
                //    TempData["GRADE1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("yyyy");
                //    TempData["GRADEN1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                //}
                List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                av1 = vAEvaluationGoals[0];
                av2 = vAEvaluationGoals[1];
                av3 = vAEvaluationGoals[2];
                av4 = vAEvaluationGoals[3];
                if (vAEvaluationGoals.Count > 4)
                {
                    av5 = vAEvaluationGoals[4];

                }
                if (vAEvaluationGoals.Count > 5)
                {
                    av6 = vAEvaluationGoals[5];
                }
                List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                am1 = vAEvaluationCompetenciesMs[0];
                am2 = vAEvaluationCompetenciesMs[1];
                am3 = vAEvaluationCompetenciesMs[2];
                am4 = vAEvaluationCompetenciesMs[3];
                am5 = vAEvaluationCompetenciesMs[4];
                am6 = vAEvaluationCompetenciesMs[5];
                if (vAEvaluationCompetenciesMs.Count > 6)
                {

                    am7 = vAEvaluationCompetenciesMs[6];
                }

                List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                ad1 = vAEvaluationCompetenciesDs[0];
                ad2 = vAEvaluationCompetenciesDs[1];
                ad3 = vAEvaluationCompetenciesDs[2];
                ad4 = vAEvaluationCompetenciesDs[3];
                ad5 = vAEvaluationCompetenciesDs[4];
                ad6 = vAEvaluationCompetenciesDs[5];
                ad7 = vAEvaluationCompetenciesDs[6];
                ad8 = vAEvaluationCompetenciesDs[7];
                ad9 = vAEvaluationCompetenciesDs[8];
                ad10 = vAEvaluationCompetenciesDs[9];
                ad11 = vAEvaluationCompetenciesDs[10];
                ad12 = vAEvaluationCompetenciesDs[11];
                ad13 = vAEvaluationCompetenciesDs[12];
                ad14 = vAEvaluationCompetenciesDs[13];
                ad15 = vAEvaluationCompetenciesDs[14];
                ad16 = vAEvaluationCompetenciesDs[15];
                ad17 = vAEvaluationCompetenciesDs[16];
                ad18 = vAEvaluationCompetenciesDs[17];
                if (vAEvaluationCompetenciesDs.Count > 18)
                {

                    ad19 = vAEvaluationCompetenciesDs[18];
                    ad20 = vAEvaluationCompetenciesDs[19];
                    ad21 = vAEvaluationCompetenciesDs[20];
                    ad22 = vAEvaluationCompetenciesDs[21];
                    ad23 = vAEvaluationCompetenciesDs[22];
                }
                if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                {

                    row["BirthDate"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";

                    row["Parm1"] = av1.CovenantGoalsName;
                    row["Parm2"] = av2.CovenantGoalsName;
                    row["Parm3"] = av3.CovenantGoalsName;
                    row["Parm4"] = av4.CovenantGoalsName;
                    row["Parm5"] = av5.CovenantGoalsName;
                    //row["Parm54"] = av6.CovenantGoalsName,
                    row["Parm6"] = av1.CovenantMeasurementCriteria;
                    row["Parm7"] = av2.CovenantMeasurementCriteria;
                    row["Parm8"] = av3.CovenantMeasurementCriteria;
                    row["Parm9"] = av4.CovenantMeasurementCriteria;
                    row["Parm10"] = av5.CovenantMeasurementCriteria;
                    //row["Parm11"] = av6.CovenantMeasurementCriteria,
                    row["Parm12"] = av1.CovenantPercentageWeight;
                    row["Parm13"] = av2.CovenantPercentageWeight;
                    row["Parm14"] = av3.CovenantPercentageWeight;
                    row["Parm15"] = av4.CovenantPercentageWeight;
                    row["Parm16"] = av5.CovenantPercentageWeight;
                    //row["Parm17"] = av6.CovenantPercentageWeight,
                    row["Parm18"] = av1.CovenantTargetedOutput;
                    row["Parm19"] = av2.CovenantTargetedOutput;
                    row["Parm20"] = av3.CovenantTargetedOutput;
                    row["Parm21"] = av4.CovenantTargetedOutput;
                    row["Parm22"] = av5.CovenantTargetedOutput;
                    //row["Parm23"] = av6.CovenantTargetedOutput,
                    row["Parm24"] = am1.CovenantWeight;
                    row["Parm25"] = am2.CovenantWeight;
                    row["Parm26"] = am3.CovenantWeight;
                    row["Parm27"] = am4.CovenantWeight;
                    row["Parm28"] = am5.CovenantWeight;
                    row["Parm29"] = am6.CovenantWeight;
                    row["Parm30"] = am7.CovenantWeight;
                    row["Parm31"] = ad1.CovenantCompetenciecDLevel;
                    row["Parm32"] = ad2.CovenantCompetenciecDLevel;
                    row["Parm33"] = ad3.CovenantCompetenciecDLevel;
                    row["Parm34"] = ad4.CovenantCompetenciecDLevel;
                    row["Parm35"] = ad5.CovenantCompetenciecDLevel;
                    row["Parm36"] = ad6.CovenantCompetenciecDLevel;
                    row["Parm37"] = ad7.CovenantCompetenciecDLevel;
                    row["Parm38"] = ad8.CovenantCompetenciecDLevel;
                    row["Parm39"] = ad9.CovenantCompetenciecDLevel;
                    row["Parm40"] = ad10.CovenantCompetenciecDLevel;
                    row["Parm41"] = ad11.CovenantCompetenciecDLevel;
                    row["Parm42"] = ad12.CovenantCompetenciecDLevel;
                    row["Parm43"] = ad13.CovenantCompetenciecDLevel;
                    row["Parm44"] = ad14.CovenantCompetenciecDLevel;
                    row["Parm45"] = ad15.CovenantCompetenciecDLevel;
                    row["Parm46"] = ad16.CovenantCompetenciecDLevel;
                    row["Parm47"] = ad17.CovenantCompetenciecDLevel;
                    row["Parm48"] = ad18.CovenantCompetenciecDLevel;

                    row["Parm49"] = ad19.CovenantCompetenciecDLevel;
                    row["Parm50"] = ad20.CovenantCompetenciecDLevel;
                    row["Parm51"] = ad21.CovenantCompetenciecDLevel;
                    row["Parm52"] = ad22.CovenantCompetenciecDLevel;
                    row["Parm53"] = ad23.CovenantCompetenciecDLevel;
                    row["Parm55"] = av1.EvaluationTotal / 100;
                    row["Parm56"] = ad23.EvaluationTotal / 100;

                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                {

                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";

                    row["Parm1"] = av1.CovenantGoalsName;
                    row["Parm2"] = av2.CovenantGoalsName;
                    row["Parm3"] = av3.CovenantGoalsName;
                    row["Parm4"] = av4.CovenantGoalsName;
                    row["Parm5"] = av5.CovenantGoalsName;
                    row["Parm54"] = av6.CovenantGoalsName;
                    row["Parm6"] = av1.CovenantMeasurementCriteria;
                    row["Parm7"] = av2.CovenantMeasurementCriteria;
                    row["Parm8"] = av3.CovenantMeasurementCriteria;
                    row["Parm9"] = av4.CovenantMeasurementCriteria;
                    row["Parm10"] = av5.CovenantMeasurementCriteria;
                    row["Parm11"] = av6.CovenantMeasurementCriteria;
                    row["Parm12"] = av1.CovenantPercentageWeight;
                    row["Parm13"] = av2.CovenantPercentageWeight;
                    row["Parm14"] = av3.CovenantPercentageWeight;
                    row["Parm15"] = av4.CovenantPercentageWeight;
                    row["Parm16"] = av5.CovenantPercentageWeight;
                    row["Parm17"] = av6.CovenantPercentageWeight;
                    row["Parm18"] = av1.CovenantTargetedOutput;
                    row["Parm19"] = av2.CovenantTargetedOutput;
                    row["Parm20"] = av3.CovenantTargetedOutput;
                    row["Parm21"] = av4.CovenantTargetedOutput;
                    row["Parm22"] = av5.CovenantTargetedOutput;
                    row["Parm23"] = av6.CovenantTargetedOutput;
                    row["Parm24"] = am1.CovenantWeight;
                    row["Parm25"] = am2.CovenantWeight;
                    row["Parm26"] = am3.CovenantWeight;
                    row["Parm27"] = am4.CovenantWeight;
                    row["Parm28"] = am5.CovenantWeight;
                    row["Parm29"] = am6.CovenantWeight;
                    row["Parm30"] = am7.CovenantWeight;
                    row["Parm31"] = ad1.CovenantCompetenciecDLevel;
                    row["Parm32"] = ad2.CovenantCompetenciecDLevel;
                    row["Parm33"] = ad3.CovenantCompetenciecDLevel;
                    row["Parm34"] = ad4.CovenantCompetenciecDLevel;
                    row["Parm35"] = ad5.CovenantCompetenciecDLevel;
                    row["Parm36"] = ad6.CovenantCompetenciecDLevel;
                    row["Parm37"] = ad7.CovenantCompetenciecDLevel;
                    row["Parm38"] = ad8.CovenantCompetenciecDLevel;
                    row["Parm39"] = ad9.CovenantCompetenciecDLevel;
                    row["Parm40"] = ad10.CovenantCompetenciecDLevel;
                    row["Parm41"] = ad11.CovenantCompetenciecDLevel;
                    row["Parm42"] = ad12.CovenantCompetenciecDLevel;
                    row["Parm43"] = ad13.CovenantCompetenciecDLevel;
                    row["Parm44"] = ad14.CovenantCompetenciecDLevel;
                    row["Parm45"] = ad15.CovenantCompetenciecDLevel;
                    row["Parm46"] = ad16.CovenantCompetenciecDLevel;
                    row["Parm47"] = ad17.CovenantCompetenciecDLevel;
                    row["Parm48"] = ad18.CovenantCompetenciecDLevel;

                    row["Parm49"] = ad19.CovenantCompetenciecDLevel;
                    row["Parm50"] = ad20.CovenantCompetenciecDLevel;
                    row["Parm51"] = ad21.CovenantCompetenciecDLevel;
                    row["Parm52"] = ad22.CovenantCompetenciecDLevel;
                    row["Parm53"] = ad23.CovenantCompetenciecDLevel;
                    row["Parm55"] = av1.EvaluationTotal / 100;
                    row["Parm56"] = ad23.EvaluationTotal / 100;

                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {



                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

                    row["Parm1"] = av1.CovenantGoalsName;
                    row["Parm2"] = av2.CovenantGoalsName;
                    row["Parm3"] = av3.CovenantGoalsName;
                    row["Parm4"] = av4.CovenantGoalsName;
                    row["Parm5"] = av5.CovenantGoalsName;
                    row["Parm54"] = av6.CovenantGoalsName;
                    row["Parm6"] = av1.CovenantMeasurementCriteria;
                    row["Parm7"] = av2.CovenantMeasurementCriteria;
                    row["Parm8"] = av3.CovenantMeasurementCriteria;
                    row["Parm9"] = av4.CovenantMeasurementCriteria;
                    row["Parm10"] = av5.CovenantMeasurementCriteria;
                    row["Parm11"] = av6.CovenantMeasurementCriteria;
                    row["Parm12"] = av1.CovenantPercentageWeight;
                    row["Parm13"] = av2.CovenantPercentageWeight;
                    row["Parm14"] = av3.CovenantPercentageWeight;
                    row["Parm15"] = av4.CovenantPercentageWeight;
                    row["Parm16"] = av5.CovenantPercentageWeight;
                    row["Parm17"] = av6.CovenantPercentageWeight;
                    row["Parm18"] = av1.CovenantTargetedOutput;
                    row["Parm19"] = av2.CovenantTargetedOutput;
                    row["Parm20"] = av3.CovenantTargetedOutput;
                    row["Parm21"] = av4.CovenantTargetedOutput;
                    row["Parm22"] = av5.CovenantTargetedOutput;
                    row["Parm23"] = av6.CovenantTargetedOutput;
                    row["Parm24"] = am1.CovenantWeight;
                    row["Parm25"] = am2.CovenantWeight;
                    row["Parm26"] = am3.CovenantWeight;
                    row["Parm27"] = am4.CovenantWeight;
                    row["Parm28"] = am5.CovenantWeight;
                    row["Parm29"] = am6.CovenantWeight;
                    row["Parm30"] = am7.CovenantWeight;
                    row["Parm31"] = ad1.CovenantCompetenciecDLevel;
                    row["Parm32"] = ad2.CovenantCompetenciecDLevel;
                    row["Parm33"] = ad3.CovenantCompetenciecDLevel;
                    row["Parm34"] = ad4.CovenantCompetenciecDLevel;
                    row["Parm35"] = ad5.CovenantCompetenciecDLevel;
                    row["Parm36"] = ad6.CovenantCompetenciecDLevel;
                    row["Parm37"] = ad7.CovenantCompetenciecDLevel;
                    row["Parm38"] = ad8.CovenantCompetenciecDLevel;
                    row["Parm39"] = ad9.CovenantCompetenciecDLevel;
                    row["Parm40"] = ad10.CovenantCompetenciecDLevel;
                    row["Parm41"] = ad11.CovenantCompetenciecDLevel;
                    row["Parm42"] = ad12.CovenantCompetenciecDLevel;
                    row["Parm43"] = ad13.CovenantCompetenciecDLevel;
                    row["Parm44"] = ad14.CovenantCompetenciecDLevel;
                    row["Parm45"] = ad15.CovenantCompetenciecDLevel;
                    row["Parm46"] = ad16.CovenantCompetenciecDLevel;
                    row["Parm47"] = ad17.CovenantCompetenciecDLevel;
                    row["Parm48"] = ad18.CovenantCompetenciecDLevel;

                    //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
                    //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
                    //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
                    //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
                    //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
                    row["Parm55"] = av1.EvaluationTotal / 100;
                    row["Parm56"] = ad18.EvaluationTotal / 100;
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {

                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

                    row["Parm1"] = av1.CovenantGoalsName;
                    row["Parm2"] = av2.CovenantGoalsName;
                    row["Parm3"] = av3.CovenantGoalsName;
                    row["Parm4"] = av4.CovenantGoalsName;
                    //row["Parm5"] = av5.CovenantGoalsName;
                    //row["Parm54"] = av6.CovenantGoalsName;
                    row["Parm6"] = av1.CovenantMeasurementCriteria;
                    row["Parm7"] = av2.CovenantMeasurementCriteria;
                    row["Parm8"] = av3.CovenantMeasurementCriteria;
                    row["Parm9"] = av4.CovenantMeasurementCriteria;
                    //row["Parm10"] = av5.CovenantMeasurementCriteria;
                    //row["Parm11"] = av6.CovenantMeasurementCriteria;
                    row["Parm12"] = av1.CovenantPercentageWeight;
                    row["Parm13"] = av2.CovenantPercentageWeight;
                    row["Parm14"] = av3.CovenantPercentageWeight;
                    row["Parm15"] = av4.CovenantPercentageWeight;
                    //row["Parm16"] = av5.CovenantPercentageWeight;
                    //row["Parm17"] = av6.CovenantPercentageWeight;
                    row["Parm18"] = av1.CovenantTargetedOutput;
                    row["Parm19"] = av2.CovenantTargetedOutput;
                    row["Parm20"] = av3.CovenantTargetedOutput;
                    row["Parm21"] = av4.CovenantTargetedOutput;
                    //row["Parm22"] = av5.CovenantTargetedOutput;
                    //row["Parm23"] = av6.CovenantTargetedOutput;
                    row["Parm24"] = am1.CovenantWeight;
                    row["Parm25"] = am2.CovenantWeight;
                    row["Parm26"] = am3.CovenantWeight;
                    row["Parm27"] = am4.CovenantWeight;
                    row["Parm28"] = am5.CovenantWeight;
                    row["Parm29"] = am6.CovenantWeight;
                    //row["Parm30"] = am7.CovenantWeight;
                    row["Parm31"] = ad1.CovenantCompetenciecDLevel;
                    row["Parm32"] = ad2.CovenantCompetenciecDLevel;
                    row["Parm33"] = ad3.CovenantCompetenciecDLevel;
                    row["Parm34"] = ad4.CovenantCompetenciecDLevel;
                    row["Parm35"] = ad5.CovenantCompetenciecDLevel;
                    row["Parm36"] = ad6.CovenantCompetenciecDLevel;
                    row["Parm37"] = ad7.CovenantCompetenciecDLevel;
                    row["Parm38"] = ad8.CovenantCompetenciecDLevel;
                    row["Parm39"] = ad9.CovenantCompetenciecDLevel;
                    row["Parm40"] = ad10.CovenantCompetenciecDLevel;
                    row["Parm41"] = ad11.CovenantCompetenciecDLevel;
                    row["Parm42"] = ad12.CovenantCompetenciecDLevel;
                    row["Parm43"] = ad13.CovenantCompetenciecDLevel;
                    row["Parm44"] = ad14.CovenantCompetenciecDLevel;
                    row["Parm45"] = ad15.CovenantCompetenciecDLevel;
                    row["Parm46"] = ad16.CovenantCompetenciecDLevel;
                    row["Parm47"] = ad17.CovenantCompetenciecDLevel;
                    row["Parm48"] = ad18.CovenantCompetenciecDLevel;

                    //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
                    //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
                    //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
                    //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
                    //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
                    row["Parm55"] = av1.EvaluationTotal / 100;
                    row["Parm56"] = ad18.EvaluationTotal / 100;
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {

                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

                    row["Parm1"] = av1.CovenantGoalsName;
                    row["Parm2"] = av2.CovenantGoalsName;
                    row["Parm3"] = av3.CovenantGoalsName;
                    row["Parm4"] = av4.CovenantGoalsName;
                    row["Parm5"] = av5.CovenantGoalsName;
                    //row["Parm54"] = av6.CovenantGoalsName;
                    row["Parm6"] = av1.CovenantMeasurementCriteria;
                    row["Parm7"] = av2.CovenantMeasurementCriteria;
                    row["Parm8"] = av3.CovenantMeasurementCriteria;
                    row["Parm9"] = av4.CovenantMeasurementCriteria;
                    row["Parm10"] = av5.CovenantMeasurementCriteria;
                    //row["Parm11"] = av6.CovenantMeasurementCriteria;
                    row["Parm12"] = av1.CovenantPercentageWeight;
                    row["Parm13"] = av2.CovenantPercentageWeight;
                    row["Parm14"] = av3.CovenantPercentageWeight;
                    row["Parm15"] = av4.CovenantPercentageWeight;
                    row["Parm16"] = av5.CovenantPercentageWeight;
                    //row["Parm17"] = av6.CovenantPercentageWeight;
                    row["Parm18"] = av1.CovenantTargetedOutput;
                    row["Parm19"] = av2.CovenantTargetedOutput;
                    row["Parm20"] = av3.CovenantTargetedOutput;
                    row["Parm21"] = av4.CovenantTargetedOutput;
                    row["Parm22"] = av5.CovenantTargetedOutput;
                    //row["Parm23"] = av6.CovenantTargetedOutput;
                    row["Parm24"] = am1.CovenantWeight;
                    row["Parm25"] = am2.CovenantWeight;
                    row["Parm26"] = am3.CovenantWeight;
                    row["Parm27"] = am4.CovenantWeight;
                    row["Parm28"] = am5.CovenantWeight;
                    row["Parm29"] = am6.CovenantWeight;
                    row["Parm30"] = am7.CovenantWeight;
                    row["Parm31"] = ad1.CovenantCompetenciecDLevel;
                    row["Parm32"] = ad2.CovenantCompetenciecDLevel;
                    row["Parm33"] = ad3.CovenantCompetenciecDLevel;
                    row["Parm34"] = ad4.CovenantCompetenciecDLevel;
                    row["Parm35"] = ad5.CovenantCompetenciecDLevel;
                    row["Parm36"] = ad6.CovenantCompetenciecDLevel;
                    row["Parm37"] = ad7.CovenantCompetenciecDLevel;
                    row["Parm38"] = ad8.CovenantCompetenciecDLevel;
                    row["Parm39"] = ad9.CovenantCompetenciecDLevel;
                    row["Parm40"] = ad10.CovenantCompetenciecDLevel;
                    row["Parm41"] = ad11.CovenantCompetenciecDLevel;
                    row["Parm42"] = ad12.CovenantCompetenciecDLevel;
                    row["Parm43"] = ad13.CovenantCompetenciecDLevel;
                    row["Parm44"] = ad14.CovenantCompetenciecDLevel;
                    row["Parm45"] = ad15.CovenantCompetenciecDLevel;
                    row["Parm46"] = ad16.CovenantCompetenciecDLevel;
                    row["Parm47"] = ad17.CovenantCompetenciecDLevel;
                    row["Parm48"] = ad18.CovenantCompetenciecDLevel;

                    //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
                    //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
                    //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
                    //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
                    //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
                    row["Parm55"] = av1.EvaluationTotal / 100;
                    row["Parm56"] = ad18.EvaluationTotal / 100;
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                {

                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    row["Parm1"] = av1.CovenantGoalsName;
                    row["Parm2"] = av2.CovenantGoalsName;
                    row["Parm3"] = av3.CovenantGoalsName;
                    row["Parm4"] = av4.CovenantGoalsName;
                    //row["Parm5"] = av5.CovenantGoalsName;
                    //row["Parm54"] = av6.CovenantGoalsName;
                    row["Parm6"] = av1.CovenantMeasurementCriteria;
                    row["Parm7"] = av2.CovenantMeasurementCriteria;
                    row["Parm8"] = av3.CovenantMeasurementCriteria;
                    row["Parm9"] = av4.CovenantMeasurementCriteria;
                    //row["Parm10"] = av5.CovenantMeasurementCriteria;
                    //row["Parm11"] = av6.CovenantMeasurementCriteria;
                    row["Parm12"] = av1.CovenantPercentageWeight;
                    row["Parm13"] = av2.CovenantPercentageWeight;
                    row["Parm14"] = av3.CovenantPercentageWeight;
                    row["Parm15"] = av4.CovenantPercentageWeight;
                    //row["Parm16"] = av5.CovenantPercentageWeight;
                    //row["Parm17"] = av6.CovenantPercentageWeight;
                    row["Parm18"] = av1.CovenantTargetedOutput;
                    row["Parm19"] = av2.CovenantTargetedOutput;
                    row["Parm20"] = av3.CovenantTargetedOutput;
                    row["Parm21"] = av4.CovenantTargetedOutput;
                    //row["Parm22"] = av5.CovenantTargetedOutput;
                    //row["Parm23"] = av6.CovenantTargetedOutput;
                    row["Parm24"] = am1.CovenantWeight;
                    row["Parm25"] = am2.CovenantWeight;
                    row["Parm26"] = am3.CovenantWeight;
                    row["Parm27"] = am4.CovenantWeight;
                    row["Parm28"] = am5.CovenantWeight;
                    row["Parm29"] = am6.CovenantWeight;
                    row["Parm30"] = am7.CovenantWeight;
                    row["Parm31"] = ad1.CovenantCompetenciecDLevel;
                    row["Parm32"] = ad2.CovenantCompetenciecDLevel;
                    row["Parm33"] = ad3.CovenantCompetenciecDLevel;
                    row["Parm34"] = ad4.CovenantCompetenciecDLevel;
                    row["Parm35"] = ad5.CovenantCompetenciecDLevel;
                    row["Parm36"] = ad6.CovenantCompetenciecDLevel;
                    row["Parm37"] = ad7.CovenantCompetenciecDLevel;
                    row["Parm38"] = ad8.CovenantCompetenciecDLevel;
                    row["Parm39"] = ad9.CovenantCompetenciecDLevel;
                    row["Parm40"] = ad10.CovenantCompetenciecDLevel;
                    row["Parm41"] = ad11.CovenantCompetenciecDLevel;
                    row["Parm42"] = ad12.CovenantCompetenciecDLevel;
                    row["Parm43"] = ad13.CovenantCompetenciecDLevel;
                    row["Parm44"] = ad14.CovenantCompetenciecDLevel;
                    row["Parm45"] = ad15.CovenantCompetenciecDLevel;
                    row["Parm46"] = ad16.CovenantCompetenciecDLevel;
                    row["Parm47"] = ad17.CovenantCompetenciecDLevel;
                    row["Parm48"] = ad18.CovenantCompetenciecDLevel;

                    row["Parm49"] = ad19.CovenantCompetenciecDLevel;
                    row["Parm50"] = ad20.CovenantCompetenciecDLevel;
                    row["Parm51"] = ad21.CovenantCompetenciecDLevel;
                    row["Parm52"] = ad22.CovenantCompetenciecDLevel;
                    row["Parm53"] = ad23.CovenantCompetenciecDLevel;
                    row["Parm55"] = av1.EvaluationTotal / 100;
                    row["Parm56"] = ad23.EvaluationTotal / 100;
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {

                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    row["Parm1"] = av1.CovenantGoalsName;
                    row["Parm2"] = av2.CovenantGoalsName;
                    row["Parm3"] = av3.CovenantGoalsName;
                    row["Parm4"] = av4.CovenantGoalsName;
                    //row["Parm5"] = av5.CovenantGoalsName;
                    //row["Parm54"] = av6.CovenantGoalsName;
                    row["Parm6"] = av1.CovenantMeasurementCriteria;
                    row["Parm7"] = av2.CovenantMeasurementCriteria;
                    row["Parm8"] = av3.CovenantMeasurementCriteria;
                    row["Parm9"] = av4.CovenantMeasurementCriteria;
                    //row["Parm10"] = av5.CovenantMeasurementCriteria;
                    //row["Parm11"] = av6.CovenantMeasurementCriteria;
                    row["Parm12"] = av1.CovenantPercentageWeight;
                    row["Parm13"] = av2.CovenantPercentageWeight;
                    row["Parm14"] = av3.CovenantPercentageWeight;
                    row["Parm15"] = av4.CovenantPercentageWeight;
                    //row["Parm16"] = av5.CovenantPercentageWeight;
                    //row["Parm17"] = av6.CovenantPercentageWeight;
                    row["Parm18"] = av1.CovenantTargetedOutput;
                    row["Parm19"] = av2.CovenantTargetedOutput;
                    row["Parm20"] = av3.CovenantTargetedOutput;
                    row["Parm21"] = av4.CovenantTargetedOutput;
                    //row["Parm22"] = av5.CovenantTargetedOutput;
                    //row["Parm23"] = av6.CovenantTargetedOutput;
                    row["Parm24"] = am1.CovenantWeight;
                    row["Parm25"] = am2.CovenantWeight;
                    row["Parm26"] = am3.CovenantWeight;
                    row["Parm27"] = am4.CovenantWeight;
                    row["Parm28"] = am5.CovenantWeight;
                    row["Parm29"] = am6.CovenantWeight;
                    row["Parm30"] = am7.CovenantWeight;
                    row["Parm31"] = ad1.CovenantCompetenciecDLevel;
                    row["Parm32"] = ad2.CovenantCompetenciecDLevel;
                    row["Parm33"] = ad3.CovenantCompetenciecDLevel;
                    row["Parm34"] = ad4.CovenantCompetenciecDLevel;
                    row["Parm35"] = ad5.CovenantCompetenciecDLevel;
                    row["Parm36"] = ad6.CovenantCompetenciecDLevel;
                    row["Parm37"] = ad7.CovenantCompetenciecDLevel;
                    row["Parm38"] = ad8.CovenantCompetenciecDLevel;
                    row["Parm39"] = ad9.CovenantCompetenciecDLevel;
                    row["Parm40"] = ad10.CovenantCompetenciecDLevel;
                    row["Parm41"] = ad11.CovenantCompetenciecDLevel;
                    row["Parm42"] = ad12.CovenantCompetenciecDLevel;
                    row["Parm43"] = ad13.CovenantCompetenciecDLevel;
                    row["Parm44"] = ad14.CovenantCompetenciecDLevel;
                    row["Parm45"] = ad15.CovenantCompetenciecDLevel;
                    row["Parm46"] = ad16.CovenantCompetenciecDLevel;
                    row["Parm47"] = ad17.CovenantCompetenciecDLevel;
                    row["Parm48"] = ad18.CovenantCompetenciecDLevel;

                    //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
                    //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
                    //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
                    //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
                    //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
                    row["Parm55"] = av1.EvaluationTotal / 100;
                    row["Parm56"] = ad18.EvaluationTotal / 100;

                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {

                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    row["Parm1"] = av1.CovenantGoalsName;
                    row["Parm2"] = av2.CovenantGoalsName;
                    row["Parm3"] = av3.CovenantGoalsName;
                    row["Parm4"] = av4.CovenantGoalsName;
                    row["Parm5"] = av5.CovenantGoalsName;
                    //row["Parm54"] = av6.CovenantGoalsName;
                    row["Parm6"] = av1.CovenantMeasurementCriteria;
                    row["Parm7"] = av2.CovenantMeasurementCriteria;
                    row["Parm8"] = av3.CovenantMeasurementCriteria;
                    row["Parm9"] = av4.CovenantMeasurementCriteria;
                    row["Parm10"] = av5.CovenantMeasurementCriteria;
                    //row["Parm11"] = av6.CovenantMeasurementCriteria;
                    row["Parm12"] = av1.CovenantPercentageWeight;
                    row["Parm13"] = av2.CovenantPercentageWeight;
                    row["Parm14"] = av3.CovenantPercentageWeight;
                    row["Parm15"] = av4.CovenantPercentageWeight;
                    row["Parm16"] = av5.CovenantPercentageWeight;
                    //row["Parm17"] = av6.CovenantPercentageWeight;
                    row["Parm18"] = av1.CovenantTargetedOutput;
                    row["Parm19"] = av2.CovenantTargetedOutput;
                    row["Parm20"] = av3.CovenantTargetedOutput;
                    row["Parm21"] = av4.CovenantTargetedOutput;
                    row["Parm22"] = av5.CovenantTargetedOutput;
                    //row["Parm23"] = av6.CovenantTargetedOutput;
                    row["Parm24"] = am1.CovenantWeight;
                    row["Parm25"] = am2.CovenantWeight;
                    row["Parm26"] = am3.CovenantWeight;
                    row["Parm27"] = am4.CovenantWeight;
                    row["Parm28"] = am5.CovenantWeight;
                    row["Parm29"] = am6.CovenantWeight;
                    //row["Parm30"] = am7.CovenantWeight;
                    row["Parm31"] = ad1.CovenantCompetenciecDLevel;
                    row["Parm32"] = ad2.CovenantCompetenciecDLevel;
                    row["Parm33"] = ad3.CovenantCompetenciecDLevel;
                    row["Parm34"] = ad4.CovenantCompetenciecDLevel;
                    row["Parm35"] = ad5.CovenantCompetenciecDLevel;
                    row["Parm36"] = ad6.CovenantCompetenciecDLevel;
                    row["Parm37"] = ad7.CovenantCompetenciecDLevel;
                    row["Parm38"] = ad8.CovenantCompetenciecDLevel;
                    row["Parm39"] = ad9.CovenantCompetenciecDLevel;
                    row["Parm40"] = ad10.CovenantCompetenciecDLevel;
                    row["Parm41"] = ad11.CovenantCompetenciecDLevel;
                    row["Parm42"] = ad12.CovenantCompetenciecDLevel;
                    row["Parm43"] = ad13.CovenantCompetenciecDLevel;
                    row["Parm44"] = ad14.CovenantCompetenciecDLevel;
                    row["Parm45"] = ad15.CovenantCompetenciecDLevel;
                    row["Parm46"] = ad16.CovenantCompetenciecDLevel;
                    row["Parm47"] = ad17.CovenantCompetenciecDLevel;
                    row["Parm48"] = ad18.CovenantCompetenciecDLevel;

                    //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
                    //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
                    //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
                    //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
                    //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
                    row["Parm55"] = av1.EvaluationTotal / 100;
                    row["Parm56"] = ad18.EvaluationTotal / 100;
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {

                    row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

                    row["Parm1"] = av1.CovenantGoalsName;
                    row["Parm2"] = av2.CovenantGoalsName;
                    row["Parm3"] = av3.CovenantGoalsName;
                    row["Parm4"] = av4.CovenantGoalsName;
                    row["Parm5"] = av5.CovenantGoalsName;
                    row["Parm54"] = av6.CovenantGoalsName;
                    row["Parm6"] = av1.CovenantMeasurementCriteria;
                    row["Parm7"] = av2.CovenantMeasurementCriteria;
                    row["Parm8"] = av3.CovenantMeasurementCriteria;
                    row["Parm9"] = av4.CovenantMeasurementCriteria;
                    row["Parm10"] = av5.CovenantMeasurementCriteria;
                    row["Parm11"] = av6.CovenantMeasurementCriteria;
                    row["Parm12"] = av1.CovenantPercentageWeight;
                    row["Parm13"] = av2.CovenantPercentageWeight;
                    row["Parm14"] = av3.CovenantPercentageWeight;
                    row["Parm15"] = av4.CovenantPercentageWeight;
                    row["Parm16"] = av5.CovenantPercentageWeight;
                    row["Parm17"] = av6.CovenantPercentageWeight;
                    row["Parm18"] = av1.CovenantTargetedOutput;
                    row["Parm19"] = av2.CovenantTargetedOutput;
                    row["Parm20"] = av3.CovenantTargetedOutput;
                    row["Parm21"] = av4.CovenantTargetedOutput;
                    row["Parm22"] = av5.CovenantTargetedOutput;
                    row["Parm23"] = av6.CovenantTargetedOutput;
                    row["Parm24"] = am1.CovenantWeight;
                    row["Parm25"] = am2.CovenantWeight;
                    row["Parm26"] = am3.CovenantWeight;
                    row["Parm27"] = am4.CovenantWeight;
                    row["Parm28"] = am5.CovenantWeight;
                    row["Parm29"] = am6.CovenantWeight;
                    //row["Parm30"] = am7.CovenantWeight;
                    row["Parm31"] = ad1.CovenantCompetenciecDLevel;
                    row["Parm32"] = ad2.CovenantCompetenciecDLevel;
                    row["Parm33"] = ad3.CovenantCompetenciecDLevel;
                    row["Parm34"] = ad4.CovenantCompetenciecDLevel;
                    row["Parm35"] = ad5.CovenantCompetenciecDLevel;
                    row["Parm36"] = ad6.CovenantCompetenciecDLevel;
                    row["Parm37"] = ad7.CovenantCompetenciecDLevel;
                    row["Parm38"] = ad8.CovenantCompetenciecDLevel;
                    row["Parm39"] = ad9.CovenantCompetenciecDLevel;
                    row["Parm40"] = ad10.CovenantCompetenciecDLevel;
                    row["Parm41"] = ad11.CovenantCompetenciecDLevel;
                    row["Parm42"] = ad12.CovenantCompetenciecDLevel;
                    row["Parm43"] = ad13.CovenantCompetenciecDLevel;
                    row["Parm44"] = ad14.CovenantCompetenciecDLevel;
                    row["Parm45"] = ad15.CovenantCompetenciecDLevel;
                    row["Parm46"] = ad16.CovenantCompetenciecDLevel;
                    row["Parm47"] = ad17.CovenantCompetenciecDLevel;
                    row["Parm48"] = ad18.CovenantCompetenciecDLevel;

                    //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
                    //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
                    //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
                    //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
                    //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
                    row["Parm55"] = av1.EvaluationTotal / 100;
                    row["Parm56"] = ad18.EvaluationTotal / 100;

                }


                dt.Rows.Add(row);

            }
            // test one 
            //for (int i = 1; i < 100; i++)
            //{
            //    row = dt.NewRow();
            //    row["EmpId"] = i;
            //    row["EmpName"] = i.ToString() + " Empl";
            //    row["Department"] = "XXYY";
            //    row["BirthDate"] = DateTime.Now.AddDays(-10000);
            //    dt.Rows.Add(row);
            //}

            return dt;
        }
        private DataTable GetEmployeeList4(string Id)
        {
            var dt = new DataTable();
            dt.Columns.Add("EmpId");
            dt.Columns.Add("EmpName");
            dt.Columns.Add("Department");
            dt.Columns.Add("BirthDate");
            dt.Columns.Add("hiring");
            dt.Columns.Add("class");
            dt.Columns.Add("grade");
            dt.Columns.Add("parent");
            dt.Columns.Add("phone");
            dt.Columns.Add("Year");
            dt.Columns.Add("Parm1");
            dt.Columns.Add("Parm2");
            dt.Columns.Add("Parm3");
            dt.Columns.Add("Parm4");
            dt.Columns.Add("Parm5");
            dt.Columns.Add("Parm6");
            dt.Columns.Add("Parm7");
            dt.Columns.Add("Parm8");
            dt.Columns.Add("Parm9");
            dt.Columns.Add("Parm10");
            dt.Columns.Add("Parm11");
            dt.Columns.Add("Parm12");
            dt.Columns.Add("Parm13");
            dt.Columns.Add("Parm14");
            dt.Columns.Add("Parm15");
            dt.Columns.Add("Parm16");
            dt.Columns.Add("Parm17");
            dt.Columns.Add("Parm18");
            dt.Columns.Add("Parm19");
            dt.Columns.Add("Parm20");
            dt.Columns.Add("Parm21");
            dt.Columns.Add("Parm22");
            dt.Columns.Add("Parm23");
            dt.Columns.Add("Parm24");
            dt.Columns.Add("Parm25");
            dt.Columns.Add("Parm26");
            dt.Columns.Add("Parm27");
            dt.Columns.Add("Parm28");
            dt.Columns.Add("Parm29");
            dt.Columns.Add("Parm30");
            dt.Columns.Add("Parm31");
            dt.Columns.Add("Parm32");
            dt.Columns.Add("Parm33");
            dt.Columns.Add("Parm34");
            dt.Columns.Add("Parm35");
            dt.Columns.Add("Parm36");
            dt.Columns.Add("Parm37");
            dt.Columns.Add("Parm38");
            dt.Columns.Add("Parm39");
            dt.Columns.Add("Parm40");
            dt.Columns.Add("Parm41");
            dt.Columns.Add("Parm42");
            dt.Columns.Add("Parm43");
            dt.Columns.Add("Parm44");
            dt.Columns.Add("Parm45");
            dt.Columns.Add("Parm46");
            dt.Columns.Add("Parm47");
            dt.Columns.Add("Parm48");
            dt.Columns.Add("Parm49");
            dt.Columns.Add("Parm50");
            dt.Columns.Add("Parm51");
            dt.Columns.Add("Parm52");
            dt.Columns.Add("Parm53");
            dt.Columns.Add("Parm54");
            dt.Columns.Add("Parm55");
            dt.Columns.Add("Parm56");
























            DataRow row;
            // for one employee
            //var Cemp = _context.Cemps.Where(xz => xz.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
            //row = dt.NewRow();
            //row["EmpId"] = Cemp.Cempid;
            //row["EmpName"] = Cemp.CEMPNAME;
            //row["Department"] = Cemp.DEP_NAME;
            //row["BirthDate"] =Convert.ToDateTime( Cemp.CEMPLASTUPGRADEHIJRA).ToString("yyyy-MM-dd");
            //dt.Rows.Add(row);

            OracleConnection Con = new OracleConnection(TNS11);
            Con.Open();
            DataTable tab = new DataTable();
            OracleDataAdapter da = new OracleDataAdapter("select * from MADCAP.EMP_SALARY_STATEMENTS where EMPNO=" + Id + " ", Con);
            OracleDataAdapter da2 = new OracleDataAdapter("select * from MADCAP.EMP_STRNTYP where EMPNO=" + Id + " ", Con);
            da.Fill(tab);
            da2.Fill(tab);
            string x = "";
            DataRow[] dr = tab.Select("EMPNO=" + Id + "");
            if (dr.Count() > 1)
            {
                x = dr[1]["PAYVAL"].ToString() ?? " ";
            }
                if (dr.Count() > 0)
            {
                // save data in sql 
                Payrollr payrollr = new Payrollr
                {
                    requestor = dr[0]["EMPNO"].ToString(),
                    EmpName = dr[0]["EMPNAM"].ToString(),
                    grade = dr[0]["GRADE"].ToString(),
                    classs = dr[0]["CLSSNO"].ToString(),
                    hiring = dr[0]["HIREDATE"].ToString(),
                    BirthDate = dr[0]["FAPPLDATE"].ToString(),
                    Department = dr[0]["DEP_NAME"].ToString(),
                    phone = dr[0]["NIDNO"].ToString(),
                    parent = dr[0]["PARENT_DEP_NAME"].ToString(),
                    Parm1 = dr[0]["JOBNO"].ToString(),
                    Parm2 = dr[0]["NATDESC"].ToString(),
                    Parm3 = dr[0]["BSALARY"].ToString(),
                    Parm4 = dr[0]["TRNALL"].ToString(),
                    Parm5 = dr[0]["TOTAL_DED"].ToString(),
                    Parm6 = dr[0]["SUM_SALARY"].ToString(),
                    Parm7 = dr[0]["JOBNAME"].ToString(),
                    Parm8 = x
                };
                _context.Payrollrs.Add(payrollr);
                _context.SaveChanges();
                // show data from oracle 
                row = dt.NewRow();
                row["EmpId"] = dr[0]["EMPNO"].ToString();
                row["EmpName"] = dr[0]["EMPNAM"].ToString();
                row["grade"] = dr[0]["GRADE"].ToString();
                row["class"] = dr[0]["CLSSNO"].ToString();
                row["hiring"] = dr[0]["HIREDATE"].ToString();
                row["BirthDate"] = dr[0]["FAPPLDATE"].ToString();
                row["Department"] = dr[0]["DEP_NAME"].ToString();
                row["phone"] = dr[0]["NIDNO"].ToString();
                row["parent"] = dr[0]["PARENT_DEP_NAME"].ToString();
                row["Parm1"] = dr[0]["JOBNO"].ToString();
                row["Parm2"] = dr[0]["NATDESC"].ToString();
                row["Parm3"] = dr[0]["BSALARY"].ToString();
                row["Parm4"] = dr[0]["TRNALL"].ToString();
                row["Parm5"] = dr[0]["TOTAL_DED"].ToString();
                row["Parm6"] = dr[0]["SUM_SALARY"].ToString();
                row["Parm7"] = dr[0]["JOBNAME"].ToString();
                row["Parm8"] = _context.Payrollrs.Max(u => u.Id);
<<<<<<< HEAD
                row["Parm9"] = x;
=======
                row["Parm9"] = x; ;
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b


                dt.Rows.Add(row);
            }
            Con.Close();
           


            //List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            //List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            //List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            //List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            //List<EvalDetail> EvalDetails2 = _context.EvalDetailss.ToList();
            //List<EvalRequestTypeId> EvalRequestTypeIds2 = _context.EvalRequestTypeIds.ToList();
            //List<Evalcomment2> evalcommentss = _context.EvalComments2.ToList();
            //List<Cemp> cemps = _context.Cemps.ToList();
            //var Records = from e in AEvaluationEmps
            //                  //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
            //                  //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
            //                  //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
            //                  //from j in table3.ToList()
            //              join f in EvalDetails2 on e.Idd equals f.CourcesIdoffered into table4
            //              from f in table4.ToList()
            //              where f.OfferedRequestTypeSatus == 1
            //              where f.OfferedRequestFrom == /*Id & e.year == Year*/ HttpContext.Session.GetString("username")
            //              join h in EvalRequestTypeIds2 on e.Idd equals h.CourcesIdoffered into table5
            //              from h in table5.ToList()
            //              where h.OfferedRequestType == 1
            //              //join mm in evalcommentss on f.OfferedDetailsSerial equals mm.Offerdetailsid into table6
            //              //from mm in table6.ToList()
            //              //where mm.Offerdetailsid == f.OfferedDetailsSerial
            //              join gg in cemps on e.Empno equals Convert.ToInt32(gg.Cempid) into table99
            //              from gg in table99.ToList()



            //              select new ViewModelEvalwithother
            //              {
            //                  AEvaluationEmp = e,
            //                  //AEvaluationGoal = d,
            //                  //AEvaluationCompetenciesM = i,
            //                  //AEvaluationCompetenciesD = j,
            //                  evalDetail = f,
            //                  evalRequestTypeId = h,
            //                  //evalcomment2 = mm,
            //                  cemp = gg,

            //              };

            //foreach (var cemp in Records)
            //{
            //    row = dt.NewRow();
            //    row["EmpId"] = cemp.cemp.Cempid;
            //    row["EmpName"] = cemp.cemp.CEMPNAME;
            //    row["Department"] = cemp.cemp.DEP_NAME;
            //    //row["BirthDate"] = Convert.ToDateTime(cemp.cemp.CEMPLASTUPGRADEHIJRA).ToString("yyyy-MM-dd");
            //    //row["hiring"] = Convert.ToDateTime(cemp.cemp.CEMPHIRINGDATEHIJRA).ToString("yyyy-MM-dd");
            //    row["class"] = cemp.cemp.CEMPPASSWRD;
            //    row["grade"] = cemp.cemp.CEMPJOBNAME;
            //    row["parent"] = cemp.cemp.PARENTNAME;
            //    row["phone"] = cemp.AEvaluationEmp.Idd;
            //    row["Year"] = cemp.AEvaluationEmp.year;

            //    //var approveddate = _context.EvalComments2.Where(x => x.Offerdetailsid == cemp.evalDetail2.OfferedDetailsSerial).FirstOrDefault();
            //    //if (approveddate != null)
            //    //{
            //    //    TempData["GRADE1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("yyyy");
            //    //    TempData["GRADEN1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
            //    //}
            //    List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
            //    av1 = vAEvaluationGoals[0];
            //    av2 = vAEvaluationGoals[1];
            //    av3 = vAEvaluationGoals[2];
            //    av4 = vAEvaluationGoals[3];
            //    if (vAEvaluationGoals.Count > 4)
            //    {
            //        av5 = vAEvaluationGoals[4];

            //    }
            //    if (vAEvaluationGoals.Count > 5)
            //    {
            //        av6 = vAEvaluationGoals[5];
            //    }
            //    List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            //    am1 = vAEvaluationCompetenciesMs[0];
            //    am2 = vAEvaluationCompetenciesMs[1];
            //    am3 = vAEvaluationCompetenciesMs[2];
            //    am4 = vAEvaluationCompetenciesMs[3];
            //    am5 = vAEvaluationCompetenciesMs[4];
            //    am6 = vAEvaluationCompetenciesMs[5];
            //    if (vAEvaluationCompetenciesMs.Count > 6)
            //    {

            //        am7 = vAEvaluationCompetenciesMs[6];
            //    }

            //    List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            //    ad1 = vAEvaluationCompetenciesDs[0];
            //    ad2 = vAEvaluationCompetenciesDs[1];
            //    ad3 = vAEvaluationCompetenciesDs[2];
            //    ad4 = vAEvaluationCompetenciesDs[3];
            //    ad5 = vAEvaluationCompetenciesDs[4];
            //    ad6 = vAEvaluationCompetenciesDs[5];
            //    ad7 = vAEvaluationCompetenciesDs[6];
            //    ad8 = vAEvaluationCompetenciesDs[7];
            //    ad9 = vAEvaluationCompetenciesDs[8];
            //    ad10 = vAEvaluationCompetenciesDs[9];
            //    ad11 = vAEvaluationCompetenciesDs[10];
            //    ad12 = vAEvaluationCompetenciesDs[11];
            //    ad13 = vAEvaluationCompetenciesDs[12];
            //    ad14 = vAEvaluationCompetenciesDs[13];
            //    ad15 = vAEvaluationCompetenciesDs[14];
            //    ad16 = vAEvaluationCompetenciesDs[15];
            //    ad17 = vAEvaluationCompetenciesDs[16];
            //    ad18 = vAEvaluationCompetenciesDs[17];
            //    if (vAEvaluationCompetenciesDs.Count > 18)
            //    {

            //        ad19 = vAEvaluationCompetenciesDs[18];
            //        ad20 = vAEvaluationCompetenciesDs[19];
            //        ad21 = vAEvaluationCompetenciesDs[20];
            //        ad22 = vAEvaluationCompetenciesDs[21];
            //        ad23 = vAEvaluationCompetenciesDs[22];
            //    }
            //    if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
            //    {

            //        row["BirthDate"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName,
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria,
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight,
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput,
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad23.EvaluationTotal / 100;

            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad23.EvaluationTotal / 100;

            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            //    {



            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;
            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        //row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        //row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        //row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        //row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        //row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;
            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;
            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        //row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        //row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        //row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        //row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad23.EvaluationTotal / 100;
            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        //row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        //row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        //row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        //row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;

            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        //row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;
            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        //row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;

            //    }


            //    dt.Rows.Add(row);

            //}
            // test one 
            //for (int i = 1; i < 100; i++)
            //{
            //    row = dt.NewRow();
            //    row["EmpId"] = i;
            //    row["EmpName"] = i.ToString() + " Empl";
            //    row["Department"] = "XXYY";
            //    row["BirthDate"] = DateTime.Now.AddDays(-10000);
            //    dt.Rows.Add(row);
            //}

            return dt;
        }
        private DataTable GetEmployeeList5(string Id)
        {
            var dt = new DataTable();
            dt.Columns.Add("EmpId");
            dt.Columns.Add("EmpName");
            dt.Columns.Add("Department");
            dt.Columns.Add("BirthDate");
            dt.Columns.Add("hiring");
            dt.Columns.Add("class");
            dt.Columns.Add("grade");
            dt.Columns.Add("parent");
            dt.Columns.Add("phone");
            dt.Columns.Add("Year");
            dt.Columns.Add("Parm1");
            dt.Columns.Add("Parm2");
            dt.Columns.Add("Parm3");
            dt.Columns.Add("Parm4");
            dt.Columns.Add("Parm5");
            dt.Columns.Add("Parm6");
            dt.Columns.Add("Parm7");
            dt.Columns.Add("Parm8");
            dt.Columns.Add("Parm9");
            dt.Columns.Add("Parm10");
            dt.Columns.Add("Parm11");
            dt.Columns.Add("Parm12");
            dt.Columns.Add("Parm13");
            dt.Columns.Add("Parm14");
            dt.Columns.Add("Parm15");
            dt.Columns.Add("Parm16");
            dt.Columns.Add("Parm17");
            dt.Columns.Add("Parm18");
            dt.Columns.Add("Parm19");
            dt.Columns.Add("Parm20");
            dt.Columns.Add("Parm21");
            dt.Columns.Add("Parm22");
            dt.Columns.Add("Parm23");
            dt.Columns.Add("Parm24");
            dt.Columns.Add("Parm25");
            dt.Columns.Add("Parm26");
            dt.Columns.Add("Parm27");
            dt.Columns.Add("Parm28");
            dt.Columns.Add("Parm29");
            dt.Columns.Add("Parm30");
            dt.Columns.Add("Parm31");
            dt.Columns.Add("Parm32");
            dt.Columns.Add("Parm33");
            dt.Columns.Add("Parm34");
            dt.Columns.Add("Parm35");
            dt.Columns.Add("Parm36");
            dt.Columns.Add("Parm37");
            dt.Columns.Add("Parm38");
            dt.Columns.Add("Parm39");
            dt.Columns.Add("Parm40");
            dt.Columns.Add("Parm41");
            dt.Columns.Add("Parm42");
            dt.Columns.Add("Parm43");
            dt.Columns.Add("Parm44");
            dt.Columns.Add("Parm45");
            dt.Columns.Add("Parm46");
            dt.Columns.Add("Parm47");
            dt.Columns.Add("Parm48");
            dt.Columns.Add("Parm49");
            dt.Columns.Add("Parm50");
            dt.Columns.Add("Parm51");
            dt.Columns.Add("Parm52");
            dt.Columns.Add("Parm53");
            dt.Columns.Add("Parm54");
            dt.Columns.Add("Parm55");
            dt.Columns.Add("Parm56");
























            DataRow row;
            // for one employee
            //var Cemp = _context.Cemps.Where(xz => xz.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
            //row = dt.NewRow();
            //row["EmpId"] = Cemp.Cempid;
            //row["EmpName"] = Cemp.CEMPNAME;
            //row["Department"] = Cemp.DEP_NAME;
            //row["BirthDate"] =Convert.ToDateTime( Cemp.CEMPLASTUPGRADEHIJRA).ToString("yyyy-MM-dd");
            //dt.Rows.Add(row);

            OracleConnection Con = new OracleConnection(TNS11);
            Con.Open();
            DataTable tab = new DataTable();
            OracleDataAdapter da = new OracleDataAdapter("select * from MADCAP.EMP_SALARY_STATEMENTS where EMPNO=" +Id + " ", Con);
            da.Fill(tab);
            DataRow[] dr = tab.Select("EMPNO=" + Id + "");
            if (dr.Count() > 0)
            {
                // save data in sql 
                Payrollr2 payrollr = new Payrollr2
                {
                    requestor = dr[0]["EMPNO"].ToString(),
                    EmpName = dr[0]["EMPNAM"].ToString(),
                    grade = dr[0]["GRADE"].ToString(),
                    classs = dr[0]["CLSSNO"].ToString(),
                    hiring = dr[0]["HIREDATE"].ToString(),
                    BirthDate = dr[0]["FAPPLDATE"].ToString(),
                    Department = dr[0]["DEP_NAME"].ToString(),
                    phone = dr[0]["NIDNO"].ToString(),
                    parent = dr[0]["PARENT_DEP_NAME"].ToString(),
                    Parm1 = dr[0]["JOBNO"].ToString(),
                    Parm2 = dr[0]["NATDESC"].ToString(),
                    Parm3 = dr[0]["BSALARY"].ToString(),
                    Parm4 = dr[0]["TRNALL"].ToString(),
                    Parm5 = dr[0]["TOTAL_DED"].ToString(),
                    Parm6 = dr[0]["SUM_SALARY"].ToString(),
                    Parm7 = dr[0]["JOBNAME"].ToString()
                };
                _context.Payrollrs2.Add(payrollr);
                _context.SaveChanges();
                // show data from oracle 
                row = dt.NewRow();
                row["EmpId"] = dr[0]["EMPNO"].ToString();
                row["EmpName"] = dr[0]["EMPNAM"].ToString();
                row["grade"] = dr[0]["GRADE"].ToString();
                row["class"] = dr[0]["CLSSNO"].ToString();
                row["hiring"] = dr[0]["HIREDATE"].ToString();
                row["BirthDate"] = dr[0]["FAPPLDATE"].ToString();
                row["Department"] = dr[0]["DEP_NAME"].ToString();
                row["phone"] = dr[0]["NIDNO"].ToString();
                row["parent"] = dr[0]["PARENT_DEP_NAME"].ToString();
                row["Parm1"] = dr[0]["JOBNO"].ToString();
                row["Parm2"] = dr[0]["NATDESC"].ToString();
                row["Parm3"] = dr[0]["BSALARY"].ToString();
                row["Parm4"] = dr[0]["TRNALL"].ToString();
                row["Parm5"] = dr[0]["TOTAL_DED"].ToString();
                row["Parm6"] = dr[0]["SUM_SALARY"].ToString();
                row["Parm7"] = dr[0]["JOBNAME"].ToString();
                row["Parm8"] = _context.Payrollrs2.Max(u => u.Id);


                dt.Rows.Add(row);
            }
            Con.Close();



            //List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            //List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            //List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            //List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            //List<EvalDetail> EvalDetails2 = _context.EvalDetailss.ToList();
            //List<EvalRequestTypeId> EvalRequestTypeIds2 = _context.EvalRequestTypeIds.ToList();
            //List<Evalcomment2> evalcommentss = _context.EvalComments2.ToList();
            //List<Cemp> cemps = _context.Cemps.ToList();
            //var Records = from e in AEvaluationEmps
            //                  //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
            //                  //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
            //                  //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
            //                  //from j in table3.ToList()
            //              join f in EvalDetails2 on e.Idd equals f.CourcesIdoffered into table4
            //              from f in table4.ToList()
            //              where f.OfferedRequestTypeSatus == 1
            //              where f.OfferedRequestFrom == /*Id & e.year == Year*/ HttpContext.Session.GetString("username")
            //              join h in EvalRequestTypeIds2 on e.Idd equals h.CourcesIdoffered into table5
            //              from h in table5.ToList()
            //              where h.OfferedRequestType == 1
            //              //join mm in evalcommentss on f.OfferedDetailsSerial equals mm.Offerdetailsid into table6
            //              //from mm in table6.ToList()
            //              //where mm.Offerdetailsid == f.OfferedDetailsSerial
            //              join gg in cemps on e.Empno equals Convert.ToInt32(gg.Cempid) into table99
            //              from gg in table99.ToList()



            //              select new ViewModelEvalwithother
            //              {
            //                  AEvaluationEmp = e,
            //                  //AEvaluationGoal = d,
            //                  //AEvaluationCompetenciesM = i,
            //                  //AEvaluationCompetenciesD = j,
            //                  evalDetail = f,
            //                  evalRequestTypeId = h,
            //                  //evalcomment2 = mm,
            //                  cemp = gg,

            //              };

            //foreach (var cemp in Records)
            //{
            //    row = dt.NewRow();
            //    row["EmpId"] = cemp.cemp.Cempid;
            //    row["EmpName"] = cemp.cemp.CEMPNAME;
            //    row["Department"] = cemp.cemp.DEP_NAME;
            //    //row["BirthDate"] = Convert.ToDateTime(cemp.cemp.CEMPLASTUPGRADEHIJRA).ToString("yyyy-MM-dd");
            //    //row["hiring"] = Convert.ToDateTime(cemp.cemp.CEMPHIRINGDATEHIJRA).ToString("yyyy-MM-dd");
            //    row["class"] = cemp.cemp.CEMPPASSWRD;
            //    row["grade"] = cemp.cemp.CEMPJOBNAME;
            //    row["parent"] = cemp.cemp.PARENTNAME;
            //    row["phone"] = cemp.AEvaluationEmp.Idd;
            //    row["Year"] = cemp.AEvaluationEmp.year;

            //    //var approveddate = _context.EvalComments2.Where(x => x.Offerdetailsid == cemp.evalDetail2.OfferedDetailsSerial).FirstOrDefault();
            //    //if (approveddate != null)
            //    //{
            //    //    TempData["GRADE1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("yyyy");
            //    //    TempData["GRADEN1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
            //    //}
            //    List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
            //    av1 = vAEvaluationGoals[0];
            //    av2 = vAEvaluationGoals[1];
            //    av3 = vAEvaluationGoals[2];
            //    av4 = vAEvaluationGoals[3];
            //    if (vAEvaluationGoals.Count > 4)
            //    {
            //        av5 = vAEvaluationGoals[4];

            //    }
            //    if (vAEvaluationGoals.Count > 5)
            //    {
            //        av6 = vAEvaluationGoals[5];
            //    }
            //    List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            //    am1 = vAEvaluationCompetenciesMs[0];
            //    am2 = vAEvaluationCompetenciesMs[1];
            //    am3 = vAEvaluationCompetenciesMs[2];
            //    am4 = vAEvaluationCompetenciesMs[3];
            //    am5 = vAEvaluationCompetenciesMs[4];
            //    am6 = vAEvaluationCompetenciesMs[5];
            //    if (vAEvaluationCompetenciesMs.Count > 6)
            //    {

            //        am7 = vAEvaluationCompetenciesMs[6];
            //    }

            //    List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            //    ad1 = vAEvaluationCompetenciesDs[0];
            //    ad2 = vAEvaluationCompetenciesDs[1];
            //    ad3 = vAEvaluationCompetenciesDs[2];
            //    ad4 = vAEvaluationCompetenciesDs[3];
            //    ad5 = vAEvaluationCompetenciesDs[4];
            //    ad6 = vAEvaluationCompetenciesDs[5];
            //    ad7 = vAEvaluationCompetenciesDs[6];
            //    ad8 = vAEvaluationCompetenciesDs[7];
            //    ad9 = vAEvaluationCompetenciesDs[8];
            //    ad10 = vAEvaluationCompetenciesDs[9];
            //    ad11 = vAEvaluationCompetenciesDs[10];
            //    ad12 = vAEvaluationCompetenciesDs[11];
            //    ad13 = vAEvaluationCompetenciesDs[12];
            //    ad14 = vAEvaluationCompetenciesDs[13];
            //    ad15 = vAEvaluationCompetenciesDs[14];
            //    ad16 = vAEvaluationCompetenciesDs[15];
            //    ad17 = vAEvaluationCompetenciesDs[16];
            //    ad18 = vAEvaluationCompetenciesDs[17];
            //    if (vAEvaluationCompetenciesDs.Count > 18)
            //    {

            //        ad19 = vAEvaluationCompetenciesDs[18];
            //        ad20 = vAEvaluationCompetenciesDs[19];
            //        ad21 = vAEvaluationCompetenciesDs[20];
            //        ad22 = vAEvaluationCompetenciesDs[21];
            //        ad23 = vAEvaluationCompetenciesDs[22];
            //    }
            //    if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
            //    {

            //        row["BirthDate"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName,
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria,
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight,
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput,
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad23.EvaluationTotal / 100;

            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad23.EvaluationTotal / 100;

            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            //    {



            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;
            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        //row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        //row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        //row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        //row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        //row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;
            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;
            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        //row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        //row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        //row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        //row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad23.EvaluationTotal / 100;
            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        //row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        //row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        //row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        //row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;

            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        //row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;
            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        //row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;

            //    }


            //    dt.Rows.Add(row);

            //}
            // test one 
            //for (int i = 1; i < 100; i++)
            //{
            //    row = dt.NewRow();
            //    row["EmpId"] = i;
            //    row["EmpName"] = i.ToString() + " Empl";
            //    row["Department"] = "XXYY";
            //    row["BirthDate"] = DateTime.Now.AddDays(-10000);
            //    dt.Rows.Add(row);
            //}

            return dt;
        }
        private DataTable GetEmployeeList44(string Id, string Year)
        {
            var dt = new DataTable();
            dt.Columns.Add("EmpId");
            dt.Columns.Add("EmpName");
            dt.Columns.Add("Department");
            dt.Columns.Add("BirthDate");
            dt.Columns.Add("hiring");
            dt.Columns.Add("class");
            dt.Columns.Add("grade");
            dt.Columns.Add("parent");
            dt.Columns.Add("phone");
            dt.Columns.Add("Year");
            dt.Columns.Add("Parm1");
            dt.Columns.Add("Parm2");
            dt.Columns.Add("Parm3");
            dt.Columns.Add("Parm4");
            dt.Columns.Add("Parm5");
            dt.Columns.Add("Parm6");
            dt.Columns.Add("Parm7");
            dt.Columns.Add("Parm8");
            dt.Columns.Add("Parm9");
            dt.Columns.Add("Parm10");
            dt.Columns.Add("Parm11");
            dt.Columns.Add("Parm12");
            dt.Columns.Add("Parm13");
            dt.Columns.Add("Parm14");
            dt.Columns.Add("Parm15");
            dt.Columns.Add("Parm16");
            dt.Columns.Add("Parm17");
            dt.Columns.Add("Parm18");
            dt.Columns.Add("Parm19");
            dt.Columns.Add("Parm20");
            dt.Columns.Add("Parm21");
            dt.Columns.Add("Parm22");
            dt.Columns.Add("Parm23");
            dt.Columns.Add("Parm24");
            dt.Columns.Add("Parm25");
            dt.Columns.Add("Parm26");
            dt.Columns.Add("Parm27");
            dt.Columns.Add("Parm28");
            dt.Columns.Add("Parm29");
            dt.Columns.Add("Parm30");
            dt.Columns.Add("Parm31");
            dt.Columns.Add("Parm32");
            dt.Columns.Add("Parm33");
            dt.Columns.Add("Parm34");
            dt.Columns.Add("Parm35");
            dt.Columns.Add("Parm36");
            dt.Columns.Add("Parm37");
            dt.Columns.Add("Parm38");
            dt.Columns.Add("Parm39");
            dt.Columns.Add("Parm40");
            dt.Columns.Add("Parm41");
            dt.Columns.Add("Parm42");
            dt.Columns.Add("Parm43");
            dt.Columns.Add("Parm44");
            dt.Columns.Add("Parm45");
            dt.Columns.Add("Parm46");
            dt.Columns.Add("Parm47");
            dt.Columns.Add("Parm48");
            dt.Columns.Add("Parm49");
            dt.Columns.Add("Parm50");
            dt.Columns.Add("Parm51");
            dt.Columns.Add("Parm52");
            dt.Columns.Add("Parm53");
            dt.Columns.Add("Parm54");
            dt.Columns.Add("Parm55");
            dt.Columns.Add("Parm56");
























            DataRow row;
            // for one employee
            //var Cemp = _context.Cemps.Where(xz => xz.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
            //row = dt.NewRow();
            //row["EmpId"] = Cemp.Cempid;
            //row["EmpName"] = Cemp.CEMPNAME;
            //row["Department"] = Cemp.DEP_NAME;
            //row["BirthDate"] =Convert.ToDateTime( Cemp.CEMPLASTUPGRADEHIJRA).ToString("yyyy-MM-dd");
            //dt.Rows.Add(row);
            var person = _context.Payrollrs.Where(c => c.phone == Id && c.Id == Convert.ToInt32(Year)).FirstOrDefault();

            //OracleConnection Con = new OracleConnection(TNS11);
            //Con.Open();
            //DataTable tab = new DataTable();
            //OracleDataAdapter da = new OracleDataAdapter("select * from MADCAP.EMP_SALARY_STATEMENTS where EMPNO=" + HttpContext.Session.GetString("username") + " ", Con);
            //da.Fill(tab);
            //DataRow[] dr = tab.Select("EMPNO=" + HttpContext.Session.GetString("username") + "");
            if (person != null)
            {
                // save data in sql 
                //Payrollr payrollr = new Payrollr
                //{
                //    requestor = dr[0]["EMPNO"].ToString(),
                //    EmpName = dr[0]["EMPNAM"].ToString(),
                //    grade = dr[0]["GRADE"].ToString(),
                //    classs = dr[0]["CLSSNO"].ToString(),
                //    hiring = dr[0]["HIREDATE"].ToString(),
                //    BirthDate = dr[0]["FAPPLDATE"].ToString(),
                //    Department = dr[0]["DEP_NAME"].ToString(),
                //    phone = dr[0]["NIDNO"].ToString(),
                //    parent = dr[0]["DEP_NAME"].ToString(),
                //    Parm1 = dr[0]["JOBNO"].ToString(),
                //    Parm2 = dr[0]["NATDESC"].ToString(),
                //    Parm3 = dr[0]["BSALARY"].ToString(),
                //    Parm4 = dr[0]["TRNALL"].ToString(),
                //    Parm5 = dr[0]["TOTAL_DED"].ToString(),
                //    Parm6 = dr[0]["SUM_SALARY"].ToString(),
                //    Parm7 = dr[0]["JOBNAME"].ToString()
                //};
                //_context.Payrollrs.Add(payrollr);
                //_context.SaveChanges();
                // show data from oracle 
                row = dt.NewRow();
                row["EmpId"] = person.requestor.ToString();
                row["EmpName"] = person.EmpName.ToString();
                row["grade"] = person.grade.ToString();
                row["class"] = person.classs.ToString();
                row["hiring"] = person.hiring.ToString();
                row["BirthDate"] = person.BirthDate.ToString();
                row["Department"] = person.Department.ToString();
                row["phone"] = person.phone.ToString();
                row["parent"] =person.parent.ToString();
                row["Parm1"] = person.Parm1.ToString();
                row["Parm2"] = person.Parm2.ToString();
                row["Parm3"] = person.Parm3.ToString();
                row["Parm4"] = person.Parm4.ToString();
                row["Parm5"] = person.Parm5.ToString();
                row["Parm6"] = person.Parm6.ToString();
                row["Parm7"] = person.Parm7.ToString();
                row["Parm8"] = person.Id.ToString();
                row["Parm9"] = person.Parm8.ToString();


                dt.Rows.Add(row);
            }
            //Con.Close();



            //List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            //List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            //List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            //List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            //List<EvalDetail> EvalDetails2 = _context.EvalDetailss.ToList();
            //List<EvalRequestTypeId> EvalRequestTypeIds2 = _context.EvalRequestTypeIds.ToList();
            //List<Evalcomment2> evalcommentss = _context.EvalComments2.ToList();
            //List<Cemp> cemps = _context.Cemps.ToList();
            //var Records = from e in AEvaluationEmps
            //                  //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
            //                  //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
            //                  //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
            //                  //from j in table3.ToList()
            //              join f in EvalDetails2 on e.Idd equals f.CourcesIdoffered into table4
            //              from f in table4.ToList()
            //              where f.OfferedRequestTypeSatus == 1
            //              where f.OfferedRequestFrom == /*Id & e.year == Year*/ HttpContext.Session.GetString("username")
            //              join h in EvalRequestTypeIds2 on e.Idd equals h.CourcesIdoffered into table5
            //              from h in table5.ToList()
            //              where h.OfferedRequestType == 1
            //              //join mm in evalcommentss on f.OfferedDetailsSerial equals mm.Offerdetailsid into table6
            //              //from mm in table6.ToList()
            //              //where mm.Offerdetailsid == f.OfferedDetailsSerial
            //              join gg in cemps on e.Empno equals Convert.ToInt32(gg.Cempid) into table99
            //              from gg in table99.ToList()



            //              select new ViewModelEvalwithother
            //              {
            //                  AEvaluationEmp = e,
            //                  //AEvaluationGoal = d,
            //                  //AEvaluationCompetenciesM = i,
            //                  //AEvaluationCompetenciesD = j,
            //                  evalDetail = f,
            //                  evalRequestTypeId = h,
            //                  //evalcomment2 = mm,
            //                  cemp = gg,

            //              };

            //foreach (var cemp in Records)
            //{
            //    row = dt.NewRow();
            //    row["EmpId"] = cemp.cemp.Cempid;
            //    row["EmpName"] = cemp.cemp.CEMPNAME;
            //    row["Department"] = cemp.cemp.DEP_NAME;
            //    //row["BirthDate"] = Convert.ToDateTime(cemp.cemp.CEMPLASTUPGRADEHIJRA).ToString("yyyy-MM-dd");
            //    //row["hiring"] = Convert.ToDateTime(cemp.cemp.CEMPHIRINGDATEHIJRA).ToString("yyyy-MM-dd");
            //    row["class"] = cemp.cemp.CEMPPASSWRD;
            //    row["grade"] = cemp.cemp.CEMPJOBNAME;
            //    row["parent"] = cemp.cemp.PARENTNAME;
            //    row["phone"] = cemp.AEvaluationEmp.Idd;
            //    row["Year"] = cemp.AEvaluationEmp.year;

            //    //var approveddate = _context.EvalComments2.Where(x => x.Offerdetailsid == cemp.evalDetail2.OfferedDetailsSerial).FirstOrDefault();
            //    //if (approveddate != null)
            //    //{
            //    //    TempData["GRADE1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("yyyy");
            //    //    TempData["GRADEN1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
            //    //}
            //    List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
            //    av1 = vAEvaluationGoals[0];
            //    av2 = vAEvaluationGoals[1];
            //    av3 = vAEvaluationGoals[2];
            //    av4 = vAEvaluationGoals[3];
            //    if (vAEvaluationGoals.Count > 4)
            //    {
            //        av5 = vAEvaluationGoals[4];

            //    }
            //    if (vAEvaluationGoals.Count > 5)
            //    {
            //        av6 = vAEvaluationGoals[5];
            //    }
            //    List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            //    am1 = vAEvaluationCompetenciesMs[0];
            //    am2 = vAEvaluationCompetenciesMs[1];
            //    am3 = vAEvaluationCompetenciesMs[2];
            //    am4 = vAEvaluationCompetenciesMs[3];
            //    am5 = vAEvaluationCompetenciesMs[4];
            //    am6 = vAEvaluationCompetenciesMs[5];
            //    if (vAEvaluationCompetenciesMs.Count > 6)
            //    {

            //        am7 = vAEvaluationCompetenciesMs[6];
            //    }

            //    List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            //    ad1 = vAEvaluationCompetenciesDs[0];
            //    ad2 = vAEvaluationCompetenciesDs[1];
            //    ad3 = vAEvaluationCompetenciesDs[2];
            //    ad4 = vAEvaluationCompetenciesDs[3];
            //    ad5 = vAEvaluationCompetenciesDs[4];
            //    ad6 = vAEvaluationCompetenciesDs[5];
            //    ad7 = vAEvaluationCompetenciesDs[6];
            //    ad8 = vAEvaluationCompetenciesDs[7];
            //    ad9 = vAEvaluationCompetenciesDs[8];
            //    ad10 = vAEvaluationCompetenciesDs[9];
            //    ad11 = vAEvaluationCompetenciesDs[10];
            //    ad12 = vAEvaluationCompetenciesDs[11];
            //    ad13 = vAEvaluationCompetenciesDs[12];
            //    ad14 = vAEvaluationCompetenciesDs[13];
            //    ad15 = vAEvaluationCompetenciesDs[14];
            //    ad16 = vAEvaluationCompetenciesDs[15];
            //    ad17 = vAEvaluationCompetenciesDs[16];
            //    ad18 = vAEvaluationCompetenciesDs[17];
            //    if (vAEvaluationCompetenciesDs.Count > 18)
            //    {

            //        ad19 = vAEvaluationCompetenciesDs[18];
            //        ad20 = vAEvaluationCompetenciesDs[19];
            //        ad21 = vAEvaluationCompetenciesDs[20];
            //        ad22 = vAEvaluationCompetenciesDs[21];
            //        ad23 = vAEvaluationCompetenciesDs[22];
            //    }
            //    if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
            //    {

            //        row["BirthDate"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName,
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria,
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight,
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput,
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad23.EvaluationTotal / 100;

            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad23.EvaluationTotal / 100;

            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            //    {



            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;
            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        //row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        //row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        //row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        //row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        //row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;
            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;
            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        //row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        //row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        //row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        //row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad23.EvaluationTotal / 100;
            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        //row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        //row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        //row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        //row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;

            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        //row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;
            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        //row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;

            //    }


            //    dt.Rows.Add(row);

            //}
            // test one 
            //for (int i = 1; i < 100; i++)
            //{
            //    row = dt.NewRow();
            //    row["EmpId"] = i;
            //    row["EmpName"] = i.ToString() + " Empl";
            //    row["Department"] = "XXYY";
            //    row["BirthDate"] = DateTime.Now.AddDays(-10000);
            //    dt.Rows.Add(row);
            //}

            return dt;
        }
        private DataTable GetEmployeeList55(string Id, string Year)
        {
            var dt = new DataTable();
            dt.Columns.Add("EmpId");
            dt.Columns.Add("EmpName");
            dt.Columns.Add("Department");
            dt.Columns.Add("BirthDate");
            dt.Columns.Add("hiring");
            dt.Columns.Add("class");
            dt.Columns.Add("grade");
            dt.Columns.Add("parent");
            dt.Columns.Add("phone");
            dt.Columns.Add("Year");
            dt.Columns.Add("Parm1");
            dt.Columns.Add("Parm2");
            dt.Columns.Add("Parm3");
            dt.Columns.Add("Parm4");
            dt.Columns.Add("Parm5");
            dt.Columns.Add("Parm6");
            dt.Columns.Add("Parm7");
            dt.Columns.Add("Parm8");
            dt.Columns.Add("Parm9");
            dt.Columns.Add("Parm10");
            dt.Columns.Add("Parm11");
            dt.Columns.Add("Parm12");
            dt.Columns.Add("Parm13");
            dt.Columns.Add("Parm14");
            dt.Columns.Add("Parm15");
            dt.Columns.Add("Parm16");
            dt.Columns.Add("Parm17");
            dt.Columns.Add("Parm18");
            dt.Columns.Add("Parm19");
            dt.Columns.Add("Parm20");
            dt.Columns.Add("Parm21");
            dt.Columns.Add("Parm22");
            dt.Columns.Add("Parm23");
            dt.Columns.Add("Parm24");
            dt.Columns.Add("Parm25");
            dt.Columns.Add("Parm26");
            dt.Columns.Add("Parm27");
            dt.Columns.Add("Parm28");
            dt.Columns.Add("Parm29");
            dt.Columns.Add("Parm30");
            dt.Columns.Add("Parm31");
            dt.Columns.Add("Parm32");
            dt.Columns.Add("Parm33");
            dt.Columns.Add("Parm34");
            dt.Columns.Add("Parm35");
            dt.Columns.Add("Parm36");
            dt.Columns.Add("Parm37");
            dt.Columns.Add("Parm38");
            dt.Columns.Add("Parm39");
            dt.Columns.Add("Parm40");
            dt.Columns.Add("Parm41");
            dt.Columns.Add("Parm42");
            dt.Columns.Add("Parm43");
            dt.Columns.Add("Parm44");
            dt.Columns.Add("Parm45");
            dt.Columns.Add("Parm46");
            dt.Columns.Add("Parm47");
            dt.Columns.Add("Parm48");
            dt.Columns.Add("Parm49");
            dt.Columns.Add("Parm50");
            dt.Columns.Add("Parm51");
            dt.Columns.Add("Parm52");
            dt.Columns.Add("Parm53");
            dt.Columns.Add("Parm54");
            dt.Columns.Add("Parm55");
            dt.Columns.Add("Parm56");
























            DataRow row;
            // for one employee
            //var Cemp = _context.Cemps.Where(xz => xz.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
            //row = dt.NewRow();
            //row["EmpId"] = Cemp.Cempid;
            //row["EmpName"] = Cemp.CEMPNAME;
            //row["Department"] = Cemp.DEP_NAME;
            //row["BirthDate"] =Convert.ToDateTime( Cemp.CEMPLASTUPGRADEHIJRA).ToString("yyyy-MM-dd");
            //dt.Rows.Add(row);
            var person = _context.Payrollrs2.Where(c => c.phone == Id && c.Id == Convert.ToInt32(Year)).FirstOrDefault();

            //OracleConnection Con = new OracleConnection(TNS11);
            //Con.Open();
            //DataTable tab = new DataTable();
            //OracleDataAdapter da = new OracleDataAdapter("select * from MADCAP.EMP_SALARY_STATEMENTS where EMPNO=" + HttpContext.Session.GetString("username") + " ", Con);
            //da.Fill(tab);
            //DataRow[] dr = tab.Select("EMPNO=" + HttpContext.Session.GetString("username") + "");
            if (person != null)
            {
                // save data in sql 
                //Payrollr payrollr = new Payrollr
                //{
                //    requestor = dr[0]["EMPNO"].ToString(),
                //    EmpName = dr[0]["EMPNAM"].ToString(),
                //    grade = dr[0]["GRADE"].ToString(),
                //    classs = dr[0]["CLSSNO"].ToString(),
                //    hiring = dr[0]["HIREDATE"].ToString(),
                //    BirthDate = dr[0]["FAPPLDATE"].ToString(),
                //    Department = dr[0]["DEP_NAME"].ToString(),
                //    phone = dr[0]["NIDNO"].ToString(),
                //    parent = dr[0]["DEP_NAME"].ToString(),
                //    Parm1 = dr[0]["JOBNO"].ToString(),
                //    Parm2 = dr[0]["NATDESC"].ToString(),
                //    Parm3 = dr[0]["BSALARY"].ToString(),
                //    Parm4 = dr[0]["TRNALL"].ToString(),
                //    Parm5 = dr[0]["TOTAL_DED"].ToString(),
                //    Parm6 = dr[0]["SUM_SALARY"].ToString(),
                //    Parm7 = dr[0]["JOBNAME"].ToString()
                //};
                //_context.Payrollrs.Add(payrollr);
                //_context.SaveChanges();
                // show data from oracle 
                row = dt.NewRow();
                row["EmpId"] = person.requestor.ToString();
                row["EmpName"] = person.EmpName.ToString();
                row["grade"] = person.grade.ToString();
                row["class"] = person.classs.ToString();
                row["hiring"] = person.hiring.ToString();
                row["BirthDate"] = person.BirthDate.ToString();
                row["Department"] = person.Department.ToString();
                row["phone"] = person.phone.ToString();
                row["parent"] = person.parent.ToString();
                row["Parm1"] = person.Parm1.ToString();
                row["Parm2"] = person.Parm2.ToString();
                row["Parm3"] = person.Parm3.ToString();
                row["Parm4"] = person.Parm4.ToString();
                row["Parm5"] = person.Parm5.ToString();
                row["Parm6"] = person.Parm6.ToString();
                row["Parm7"] = person.Parm7.ToString();
                row["Parm8"] = person.Id.ToString();


                dt.Rows.Add(row);
            }
            //Con.Close();



            //List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            //List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            //List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            //List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            //List<EvalDetail> EvalDetails2 = _context.EvalDetailss.ToList();
            //List<EvalRequestTypeId> EvalRequestTypeIds2 = _context.EvalRequestTypeIds.ToList();
            //List<Evalcomment2> evalcommentss = _context.EvalComments2.ToList();
            //List<Cemp> cemps = _context.Cemps.ToList();
            //var Records = from e in AEvaluationEmps
            //                  //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
            //                  //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
            //                  //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
            //                  //from j in table3.ToList()
            //              join f in EvalDetails2 on e.Idd equals f.CourcesIdoffered into table4
            //              from f in table4.ToList()
            //              where f.OfferedRequestTypeSatus == 1
            //              where f.OfferedRequestFrom == /*Id & e.year == Year*/ HttpContext.Session.GetString("username")
            //              join h in EvalRequestTypeIds2 on e.Idd equals h.CourcesIdoffered into table5
            //              from h in table5.ToList()
            //              where h.OfferedRequestType == 1
            //              //join mm in evalcommentss on f.OfferedDetailsSerial equals mm.Offerdetailsid into table6
            //              //from mm in table6.ToList()
            //              //where mm.Offerdetailsid == f.OfferedDetailsSerial
            //              join gg in cemps on e.Empno equals Convert.ToInt32(gg.Cempid) into table99
            //              from gg in table99.ToList()



            //              select new ViewModelEvalwithother
            //              {
            //                  AEvaluationEmp = e,
            //                  //AEvaluationGoal = d,
            //                  //AEvaluationCompetenciesM = i,
            //                  //AEvaluationCompetenciesD = j,
            //                  evalDetail = f,
            //                  evalRequestTypeId = h,
            //                  //evalcomment2 = mm,
            //                  cemp = gg,

            //              };

            //foreach (var cemp in Records)
            //{
            //    row = dt.NewRow();
            //    row["EmpId"] = cemp.cemp.Cempid;
            //    row["EmpName"] = cemp.cemp.CEMPNAME;
            //    row["Department"] = cemp.cemp.DEP_NAME;
            //    //row["BirthDate"] = Convert.ToDateTime(cemp.cemp.CEMPLASTUPGRADEHIJRA).ToString("yyyy-MM-dd");
            //    //row["hiring"] = Convert.ToDateTime(cemp.cemp.CEMPHIRINGDATEHIJRA).ToString("yyyy-MM-dd");
            //    row["class"] = cemp.cemp.CEMPPASSWRD;
            //    row["grade"] = cemp.cemp.CEMPJOBNAME;
            //    row["parent"] = cemp.cemp.PARENTNAME;
            //    row["phone"] = cemp.AEvaluationEmp.Idd;
            //    row["Year"] = cemp.AEvaluationEmp.year;

            //    //var approveddate = _context.EvalComments2.Where(x => x.Offerdetailsid == cemp.evalDetail2.OfferedDetailsSerial).FirstOrDefault();
            //    //if (approveddate != null)
            //    //{
            //    //    TempData["GRADE1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("yyyy");
            //    //    TempData["GRADEN1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
            //    //}
            //    List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
            //    av1 = vAEvaluationGoals[0];
            //    av2 = vAEvaluationGoals[1];
            //    av3 = vAEvaluationGoals[2];
            //    av4 = vAEvaluationGoals[3];
            //    if (vAEvaluationGoals.Count > 4)
            //    {
            //        av5 = vAEvaluationGoals[4];

            //    }
            //    if (vAEvaluationGoals.Count > 5)
            //    {
            //        av6 = vAEvaluationGoals[5];
            //    }
            //    List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            //    am1 = vAEvaluationCompetenciesMs[0];
            //    am2 = vAEvaluationCompetenciesMs[1];
            //    am3 = vAEvaluationCompetenciesMs[2];
            //    am4 = vAEvaluationCompetenciesMs[3];
            //    am5 = vAEvaluationCompetenciesMs[4];
            //    am6 = vAEvaluationCompetenciesMs[5];
            //    if (vAEvaluationCompetenciesMs.Count > 6)
            //    {

            //        am7 = vAEvaluationCompetenciesMs[6];
            //    }

            //    List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == cemp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            //    ad1 = vAEvaluationCompetenciesDs[0];
            //    ad2 = vAEvaluationCompetenciesDs[1];
            //    ad3 = vAEvaluationCompetenciesDs[2];
            //    ad4 = vAEvaluationCompetenciesDs[3];
            //    ad5 = vAEvaluationCompetenciesDs[4];
            //    ad6 = vAEvaluationCompetenciesDs[5];
            //    ad7 = vAEvaluationCompetenciesDs[6];
            //    ad8 = vAEvaluationCompetenciesDs[7];
            //    ad9 = vAEvaluationCompetenciesDs[8];
            //    ad10 = vAEvaluationCompetenciesDs[9];
            //    ad11 = vAEvaluationCompetenciesDs[10];
            //    ad12 = vAEvaluationCompetenciesDs[11];
            //    ad13 = vAEvaluationCompetenciesDs[12];
            //    ad14 = vAEvaluationCompetenciesDs[13];
            //    ad15 = vAEvaluationCompetenciesDs[14];
            //    ad16 = vAEvaluationCompetenciesDs[15];
            //    ad17 = vAEvaluationCompetenciesDs[16];
            //    ad18 = vAEvaluationCompetenciesDs[17];
            //    if (vAEvaluationCompetenciesDs.Count > 18)
            //    {

            //        ad19 = vAEvaluationCompetenciesDs[18];
            //        ad20 = vAEvaluationCompetenciesDs[19];
            //        ad21 = vAEvaluationCompetenciesDs[20];
            //        ad22 = vAEvaluationCompetenciesDs[21];
            //        ad23 = vAEvaluationCompetenciesDs[22];
            //    }
            //    if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
            //    {

            //        row["BirthDate"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName,
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria,
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight,
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput,
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad23.EvaluationTotal / 100;

            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad23.EvaluationTotal / 100;

            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            //    {



            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;
            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        //row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        //row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        //row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        //row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        //row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;
            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;
            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        //row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        //row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        //row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        //row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad23.EvaluationTotal / 100;
            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        //row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        //row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        //row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        //row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;

            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        //row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        //row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        //row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        //row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        //row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;
            //    }
            //    else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            //    {

            //        row["BirthDate"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
            //        row["hiring"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
            //        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

            //        row["Parm1"] = av1.CovenantGoalsName;
            //        row["Parm2"] = av2.CovenantGoalsName;
            //        row["Parm3"] = av3.CovenantGoalsName;
            //        row["Parm4"] = av4.CovenantGoalsName;
            //        row["Parm5"] = av5.CovenantGoalsName;
            //        row["Parm54"] = av6.CovenantGoalsName;
            //        row["Parm6"] = av1.CovenantMeasurementCriteria;
            //        row["Parm7"] = av2.CovenantMeasurementCriteria;
            //        row["Parm8"] = av3.CovenantMeasurementCriteria;
            //        row["Parm9"] = av4.CovenantMeasurementCriteria;
            //        row["Parm10"] = av5.CovenantMeasurementCriteria;
            //        row["Parm11"] = av6.CovenantMeasurementCriteria;
            //        row["Parm12"] = av1.CovenantPercentageWeight;
            //        row["Parm13"] = av2.CovenantPercentageWeight;
            //        row["Parm14"] = av3.CovenantPercentageWeight;
            //        row["Parm15"] = av4.CovenantPercentageWeight;
            //        row["Parm16"] = av5.CovenantPercentageWeight;
            //        row["Parm17"] = av6.CovenantPercentageWeight;
            //        row["Parm18"] = av1.CovenantTargetedOutput;
            //        row["Parm19"] = av2.CovenantTargetedOutput;
            //        row["Parm20"] = av3.CovenantTargetedOutput;
            //        row["Parm21"] = av4.CovenantTargetedOutput;
            //        row["Parm22"] = av5.CovenantTargetedOutput;
            //        row["Parm23"] = av6.CovenantTargetedOutput;
            //        row["Parm24"] = am1.CovenantWeight;
            //        row["Parm25"] = am2.CovenantWeight;
            //        row["Parm26"] = am3.CovenantWeight;
            //        row["Parm27"] = am4.CovenantWeight;
            //        row["Parm28"] = am5.CovenantWeight;
            //        row["Parm29"] = am6.CovenantWeight;
            //        //row["Parm30"] = am7.CovenantWeight;
            //        row["Parm31"] = ad1.CovenantCompetenciecDLevel;
            //        row["Parm32"] = ad2.CovenantCompetenciecDLevel;
            //        row["Parm33"] = ad3.CovenantCompetenciecDLevel;
            //        row["Parm34"] = ad4.CovenantCompetenciecDLevel;
            //        row["Parm35"] = ad5.CovenantCompetenciecDLevel;
            //        row["Parm36"] = ad6.CovenantCompetenciecDLevel;
            //        row["Parm37"] = ad7.CovenantCompetenciecDLevel;
            //        row["Parm38"] = ad8.CovenantCompetenciecDLevel;
            //        row["Parm39"] = ad9.CovenantCompetenciecDLevel;
            //        row["Parm40"] = ad10.CovenantCompetenciecDLevel;
            //        row["Parm41"] = ad11.CovenantCompetenciecDLevel;
            //        row["Parm42"] = ad12.CovenantCompetenciecDLevel;
            //        row["Parm43"] = ad13.CovenantCompetenciecDLevel;
            //        row["Parm44"] = ad14.CovenantCompetenciecDLevel;
            //        row["Parm45"] = ad15.CovenantCompetenciecDLevel;
            //        row["Parm46"] = ad16.CovenantCompetenciecDLevel;
            //        row["Parm47"] = ad17.CovenantCompetenciecDLevel;
            //        row["Parm48"] = ad18.CovenantCompetenciecDLevel;

            //        //row["Parm49"] = ad19.CovenantCompetenciecDLevel;
            //        //row["Parm50"] = ad20.CovenantCompetenciecDLevel;
            //        //row["Parm51"] = ad21.CovenantCompetenciecDLevel;
            //        //row["Parm52"] = ad22.CovenantCompetenciecDLevel;
            //        //row["Parm53"] = ad23.CovenantCompetenciecDLevel;
            //        row["Parm55"] = av1.EvaluationTotal / 100;
            //        row["Parm56"] = ad18.EvaluationTotal / 100;

            //    }


            //    dt.Rows.Add(row);

            //}
            // test one 
            //for (int i = 1; i < 100; i++)
            //{
            //    row = dt.NewRow();
            //    row["EmpId"] = i;
            //    row["EmpName"] = i.ToString() + " Empl";
            //    row["Department"] = "XXYY";
            //    row["BirthDate"] = DateTime.Now.AddDays(-10000);
            //    dt.Rows.Add(row);
            //}

            return dt;
        }

        [Authorize(Roles = "Admin,HR-Admin")]
        public IActionResult Upload()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            return View();
        }

        [HttpPost]
        public IActionResult Upload(IFormFile postedFile)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            string fileName = "";
            if (postedFile != null)
            {
                //Create a Folder.
                string path = Path.Combine(this.Environment.WebRootPath, "Uploads");
                if (!Directory.Exists(path))
                {
                    Directory.CreateDirectory(path);
                }

                //Save the uploaded Excel file.
                fileName = DateTime.Now.ToString("ddMMMyyhhmmsstt") + Path.GetFileName(postedFile.FileName);
                string filePath = Path.Combine(path, fileName);
                using (FileStream stream = new FileStream(filePath, FileMode.Create))
                {
                    postedFile.CopyTo(stream);
                }

                //Read the connection string for the Excel file.
                string conString = this.Configuration.GetConnectionString("ExcelConString");
                DataTable dt = new DataTable();
                conString = string.Format(conString, filePath);

                using (OleDbConnection connExcel = new OleDbConnection(conString))
                {
                    using (OleDbCommand cmdExcel = new OleDbCommand())
                    {
                        using (OleDbDataAdapter odaExcel = new OleDbDataAdapter())
                        {
                            cmdExcel.Connection = connExcel;

                            //Get the name of First Sheet.
                            connExcel.Open();
                            DataTable dtExcelSchema;
                            dtExcelSchema = connExcel.GetOleDbSchemaTable(OleDbSchemaGuid.Tables, null);
                            string sheetName = dtExcelSchema.Rows[0]["TABLE_NAME"].ToString();
                            connExcel.Close();

                            //Read Data from First Sheet.
                            connExcel.Open();
                            cmdExcel.CommandText = "SELECT * From [" + sheetName + "]";
                            odaExcel.SelectCommand = cmdExcel;
                            odaExcel.Fill(dt);
                            connExcel.Close();
                        }
                    }
                }

                //Insert the Data read from the Excel file to Database Table.
                conString = this.Configuration.GetConnectionString("hr");
                using (SqlConnection con = new SqlConnection(conString))
                {
                    using (SqlBulkCopy sqlBulkCopy = new SqlBulkCopy(con))
                    {
                        //Set the database table name.
                        sqlBulkCopy.DestinationTableName = "dbo.PersonalEmpGrade";

                        //[OPTIONAL]: Map the Excel columns with that of the database table.
                        sqlBulkCopy.ColumnMappings.Add("رقم الهوية", "empnational");
                        sqlBulkCopy.ColumnMappings.Add("اسم الموظف المرشح ", "empname");
                        sqlBulkCopy.ColumnMappings.Add("نقاط المقابلة ", "empgrade");
                        sqlBulkCopy.ColumnMappings.Add("التاريخ ", "empdate");
                        con.Open();
                        sqlBulkCopy.WriteToServer(dt);
                        con.Close();
                    }
                }

                // add logs 
                APersonalEmpLogsf aPersonalEmpLogs = new APersonalEmpLogsf();
                aPersonalEmpLogs.requestid = fileName;
                aPersonalEmpLogs.userr = HttpContext.Session.GetString("username");
                aPersonalEmpLogs.tt = DateTime.Now;
                _context.APersonalEmpLogsf.Add(aPersonalEmpLogs);
                _context.SaveChanges();
                ViewBag.Message2 = "تم الرفع والتحديث ";
            }
            else
            {
                ViewBag.Message2 = "يرجي اختيار المرفق ";
                return View();
            }
            return View();
        }
        [Authorize(Roles = "Admin,HR-Admin")]
        public IActionResult Uploadm()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");
      
            return View();
        }

        [HttpPost]
        public IActionResult Uploadm(Cemp cemp,string t1)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            if (cemp != null)
            {
                Cemp cemp1 = _context.Cemps.Where(v => v.Cempid == cemp.Cempid).FirstOrDefault();

                PersnolEmpGrade persnolEmpGrade = new PersnolEmpGrade();
                persnolEmpGrade.empname = cemp1.CEMPNAME;
                persnolEmpGrade.empnational = cemp1.CEMPPASSWRD;
                persnolEmpGrade.empgrade = cemp.DEP_NAME;
                persnolEmpGrade.empdate = Convert.ToDateTime(t1);
                _context.PersnolEmpGrade.Add(persnolEmpGrade);
                _context.SaveChanges();

                ViewBag.Message2 = "تمت الاضافة والتحديث";

                // add logs 
                APersonalEmpLogs aPersonalEmpLogs = new APersonalEmpLogs();
                aPersonalEmpLogs.requestid = persnolEmpGrade.seriad.ToString();
                aPersonalEmpLogs.userr = HttpContext.Session.GetString("username");
                aPersonalEmpLogs.tt = DateTime.Now;
                _context.APersonalEmpLogs.Add(aPersonalEmpLogs);
                _context.SaveChanges();

            }
            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");
            return View();
        }

        [Authorize(Roles = "Admin,HR-Admin")]
        public IActionResult Uploadmm()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            OracleConnection Con = new OracleConnection(TNS11);
            Con.Open();
            DataTable tab = new DataTable();
            OracleDataAdapter da = new OracleDataAdapter("select * from MADCAP.A_VGET_EMP_DATA  ", Con);
            da.Fill(tab);
            //Insert the Data read from the Excel file to Database Table.
           string  conString = this.Configuration.GetConnectionString("hr");
            using (SqlConnection con = new SqlConnection(conString))
            {
                con.Open();
                SqlCommand command = new SqlCommand("delete  FROM [hr].[dbo].[memberstmp]",con);
                command.ExecuteNonQuery();
                con.Close();
                using (SqlBulkCopy sqlBulkCopy = new SqlBulkCopy(con))
                {
                    //Set the database table name.
                    sqlBulkCopy.DestinationTableName = "dbo.memberstmp";

                    //[OPTIONAL]: Map the Excel columns with that of the database table.
                    sqlBulkCopy.ColumnMappings.Add("EMPNO", "userid");
                    sqlBulkCopy.ColumnMappings.Add("EMPNAME", "username");
                    sqlBulkCopy.ColumnMappings.Add("MANAGER", "commitedescession");
                    sqlBulkCopy.ColumnMappings.Add("NIDNO", "userentry");
                    con.Open();
                    sqlBulkCopy.WriteToServer(tab);
                    con.Close();
                }
            }
            ViewData["Cempid"] = new SelectList(_context.Memberst.Where(x=>x.commitedescession=="1"||x.userid== "4071009"), "userid", "username");
            ViewData["Cempid1"] = new SelectList(_context.Memberst.Where(x => x.userentry.StartsWith("1")), "userid", "username");
           
            return View();
        }

        [Authorize(Roles = "Admin,HR-Admin")]
        public IActionResult Uploadmmx()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            //OracleConnection Con = new OracleConnection(TNS11);
            //Con.Open();
            //DataTable tab = new DataTable();
            //OracleDataAdapter da = new OracleDataAdapter("select * from MADCAP.A_VGET_EMP_DATA  ", Con);
            //da.Fill(tab);
            ////Insert the Data read from the Excel file to Database Table.
            //string conString = this.Configuration.GetConnectionString("hr");
            //using (SqlConnection con = new SqlConnection(conString))
            //{
            //    con.Open();
            //    SqlCommand command = new SqlCommand("delete  FROM [hr].[dbo].[memberstmp]", con);
            //    command.ExecuteNonQuery();
            //    con.Close();
            //    using (SqlBulkCopy sqlBulkCopy = new SqlBulkCopy(con))
            //    {
            //        //Set the database table name.
            //        sqlBulkCopy.DestinationTableName = "dbo.memberstmp";

            //        //[OPTIONAL]: Map the Excel columns with that of the database table.
            //        sqlBulkCopy.ColumnMappings.Add("EMPNO", "userid");
            //        sqlBulkCopy.ColumnMappings.Add("EMPNAME", "username");
            //        sqlBulkCopy.ColumnMappings.Add("MANAGER", "commitedescession");
            //        sqlBulkCopy.ColumnMappings.Add("NIDNO", "userentry");
            //        con.Open();
            //        sqlBulkCopy.WriteToServer(tab);
            //        con.Close();
            //    }
            //}
            ViewData["Cempid"] = new SelectList(_context.Memberst.Where(x => x.commitedescession == "1" || x.userid == "4071009"), "userid", "username");
            ViewData["Cempid1"] = new SelectList(_context.Memberst.Where(x => x.userentry.StartsWith("1")), "userid", "username");

            return View();
        }
        [Authorize(Roles = "Admin,HR-Admin")]
        public IActionResult Uploadmm0()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            //OracleConnection Con = new OracleConnection(TNS11);
            //Con.Open();
            //DataTable tab = new DataTable();
            //OracleDataAdapter da = new OracleDataAdapter("select * from MADCAP.A_VGET_EMP_DATA  ", Con);
            //da.Fill(tab);
            ////Insert the Data read from the Excel file to Database Table.
            //string conString = this.Configuration.GetConnectionString("hr");
            //using (SqlConnection con = new SqlConnection(conString))
            //{
            //    con.Open();
            //    SqlCommand command = new SqlCommand("delete  FROM [hr].[dbo].[memberstmp]", con);
            //    command.ExecuteNonQuery();
            //    con.Close();
            //    using (SqlBulkCopy sqlBulkCopy = new SqlBulkCopy(con))
            //    {
            //        //Set the database table name.
            //        sqlBulkCopy.DestinationTableName = "dbo.memberstmp";

            //        //[OPTIONAL]: Map the Excel columns with that of the database table.
            //        sqlBulkCopy.ColumnMappings.Add("EMPNO", "userid");
            //        sqlBulkCopy.ColumnMappings.Add("EMPNAME", "username");
            //        sqlBulkCopy.ColumnMappings.Add("MANAGER", "commitedescession");
            //        sqlBulkCopy.ColumnMappings.Add("NIDNO", "userentry");
            //        con.Open();
            //        sqlBulkCopy.WriteToServer(tab);
            //        con.Close();
            //    }
            //}
            //var distinctList = _context.commite.GroupBy(s => s.userid).Select(s => s.commitedescession()).ToArray();
            //var duplicates = _context.commite
            //      .GroupBy(r => r.commitedescession)
            //       .Where(g => g.Count() > 1).ToDictionary(x => x.Key, x => x.Select(y => y.commitedescession)
            //                                     .OrderBy(v => v)
            //                                     .ToList()); ;
            //var  someList = duplicates.Except(duplicates).ToList();
            // List<_context.commite> l = new List<_context.commite>();
            List<commite> l = _context.commite.ToList();
            HashSet<commite> h = new HashSet<commite>(l);
            List<commite> l2 = h.ToList();
            List<commite> noDups = _context.commite.ToList().GroupBy(d => new {  d.commitedescession})
                                  .Where(d => d.Count() >= 1)
                                  .Select(d => d.First())
                                  .ToList();
            ViewData["Cempid"] = new SelectList(noDups.ToList(), "commitedescession", "commitedescession");
            ViewData["Cempid1"] = new SelectList(_context.Memberst.Where(x => x.userentry.StartsWith("1")), "userid", "username");

            return View();
        }
        [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public IActionResult Uploadmmm(string announce)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            viewModelEvalwithother.commite = _context.commite.Where(z => z.userid == HttpContext.Session.GetString("username") && z.status == 0).OrderBy(x=>x.id).LastOrDefault();
            viewModelEvalwithother.members = _context.Members.Where(X => X.status == 0&&X.userid!="" && X.username != "" && X.commitedescession== viewModelEvalwithother.commite.commitedescession).ToList();
            // add commite
            List<Cemp> list = new List<Cemp>();
            for (int i = 0; i < viewModelEvalwithother.members.ToList().Count; i++)
            {
                var tt = new Cemp
                {
                    Cempid = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().Cempid ?? "",
                    CEMPNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPNAME ?? "",
                    CEMPPASSWRD = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPPASSWRD ?? "",
                    CEMPNO = viewModelEvalwithother.members.ElementAt(i).commitedescession.ToString() ?? "",
                    CEMPPASSWRD1 = viewModelEvalwithother.members.ElementAt(i).announce.ToString() ?? "",
                    EncryptedId = _protector.Protect(viewModelEvalwithother.members.ElementAt(i).userid.ToString()),
                    CLSSNO = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CLSSNO ?? "",
                    grade=_context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().grade ?? "",
                    DEP_NAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().DEP_NAME ?? "",
                    PARENTNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().PARENTNAME ?? "",
                    CEMPHIRINGDATEHIJRA =Convert.ToDateTime( _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPHIRINGDATEHIJRA).Date ,
                    CEMPLASTUPGRADEHIJRA = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPLASTUPGRADEHIJRA,
                    //TaskM10 = HttpContext.Session.GetString("empid")
                };
                list.Add(tt);
            }
            viewModelEvalwithother.cemps = list;
            return View(viewModelEvalwithother);
        }
        [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public IActionResult Uploadmmmm(string announce)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            List<members> noDups = _context.Members.ToList().GroupBy(d => new { d.announce })
                                  .Where(d => d.Count() >= 1)
                                  .Select(d => d.First())
                                  .ToList();
            ViewData["Cempid1"] = new SelectList(noDups.ToList(), "announce", "announce");
           if(announce==null)
            {
                announce = "111111";
            }
                var announce0 = _context.Members.Where(x => x.announce == announce).FirstOrDefault().announce;
                var commit= _context.Members.Where(x => x.announce == announce).FirstOrDefault().commitedescession;
                List<membersz> membersz = _context.Membersz.Where(x => x.userid == HttpContext.Session.GetString("username") && x.announce == announce).ToList();
                List<memberszz> memberszz = _context.Memberszz.Where(x => x.userid == HttpContext.Session.GetString("username") && x.announce == announce).ToList();
                List<members> members = _context.Members.Where(X => X.status == 0 && X.userid != "" && X.username != "" && X.announce == announce0).ToList();
                List<commite> commites = _context.commite.Where(z => z.userid == HttpContext.Session.GetString("username") && z.status == 0 && z.commitedescession == commit).ToList();
                List<Cemp> cemps = _context.Cemps.ToList();

                var Records = from e in cemps
                                  //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                                  //from d in table1.ToList()
                                  //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                                  //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                                  //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                                  //from j in table3.ToList()
                              join f in members on e.CEMPPASSWRD equals f.userid into table4
                              from f in table4.Distinct().ToList()
                              where f.status == 0
                              //where (f.OfferedRequestTo == HttpContext.Session.GetString("empid") && f.OfferedRequestTo3 == "0") || (f.OfferedRequestTo2 == HttpContext.Session.GetString("empid") && f.OfferedRequestTo4 == "0") || (f.Offeredoption == HttpContext.Session.GetString("empid") && f.OfferedRequestTo5 == "0")
                              join yy in commites on f.commitedescession equals yy.commitedescession into table555
                              from yy in table555.Distinct().ToList()
                              where yy.status == 0 && yy.commitedescession == commit
                              //join h in membersz on e.Cempid equals h.userid into table5
                              //from h in table5.ToList()
                              //where h.status == 0
                              //join y in memberszz on f.announce equals y.announce into table55
                              //from y in table55.Distinct().ToList()
                              //where y.status == 0 && e.Cempid != y.announcetxt && f.commitedescession == y.commitedescession



                              select new ViewModelEvalwithother
                              {
                                  cemp = e,
                                  //AEvaluationGoal = d,
                                  //AEvaluationCompetenciesM = i,
                                  //AEvaluationCompetenciesD = j,
                                  member = f,
                                  //memberz = h,
                                  //memberzz = y,
                                  commite = yy,

                              };


            //ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            //viewModelEvalwithother.commite = _context.commite.Where(z => z.userid == HttpContext.Session.GetString("username") && z.status == 0).OrderBy(x => x.id).LastOrDefault();
            //viewModelEvalwithother.members = _context.Members.Where(X => X.status == 0 && X.userid != "" && X.username != "" && X.commitedescession == viewModelEvalwithother.commite.commitedescession).ToList();
            //// add commite
            //List<Cemp> list = new List<Cemp>();
            //for (int i = 0; i < viewModelEvalwithother.members.ToList().Count; i++)
            //{
            //    var tt = new Cemp
            //    {
            //        Cempid = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().Cempid ?? "",
            //        CEMPNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPNAME ?? "",
            //        CEMPPASSWRD = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPPASSWRD ?? "",
            //        CEMPNO = viewModelEvalwithother.members.ElementAt(i).commitedescession.ToString() ?? "",
            //        CEMPPASSWRD1 = viewModelEvalwithother.members.ElementAt(i).announce.ToString() ?? "",
            //        EncryptedId = _protector.Protect(viewModelEvalwithother.members.ElementAt(i).userid.ToString()),
            //        CLSSNO = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CLSSNO ?? "",
            //        grade = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().grade ?? "",
            //        DEP_NAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().DEP_NAME ?? "",
            //        PARENTNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().PARENTNAME ?? "",
            //        CEMPHIRINGDATEHIJRA = Convert.ToDateTime(_context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPHIRINGDATEHIJRA).Date,
            //        CEMPLASTUPGRADEHIJRA = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPLASTUPGRADEHIJRA,
            //        //TaskM10 = HttpContext.Session.GetString("empid")
            //    };
            //    list.Add(tt);
            //}
            //viewModelEvalwithother.cemps = list;

            foreach (var emp in Records.ToList())
            {
                var stringId = emp.cemp.Cempid.ToString();
                emp.cemp.EncryptedId = _protector.Protect(stringId);
            }

            return View(Records);
        }



        [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public IActionResult Uploadmmmm0(string announce)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            double sumgrade = 0.0;
            List<members> noDups = _context.Members.ToList().GroupBy(d => new { d.announce })
                                  .Where(d => d.Count() >= 1)
                                  .Select(d => d.First())
                                  .ToList();
            ViewData["Cempid1"] = new SelectList(noDups.ToList(), "announce", "announce");
            if (announce == null)
            {
                announce = "111111";
            }
            var announce0 = _context.Members.Where(x => x.announce == announce).FirstOrDefault().announce;
            var commit = _context.Members.Where(x => x.announce == announce).FirstOrDefault().commitedescession;
            //List<membersz> membersz = _context.Membersz.Where(x => x.userid == HttpContext.Session.GetString("username") && x.announce == announce).ToList();
            //List<memberszz> memberszz = _context.Memberszz.Where(x => x.userid == HttpContext.Session.GetString("username") && x.announce == announce).ToList();
            List<members> members = _context.Members.Where(X =>X.userid != "" && X.username != "" && X.announce == announce0).ToList();
            List<commite> commites = _context.commite.Where(z => z.userid == HttpContext.Session.GetString("username") && z.status == 0 && z.commitedescession == commit&&z.postion!= "سكرتير اللجنة ").ToList();
<<<<<<< HEAD
            //var ann = _context.Members.Where(x => x.announce == announce0).FirstOrDefault();
            //List<PersnolEmpGrade> persnolEmpGrades = _context.PersnolEmpGrade.Where(z => z.empdate == ann.dateexcute1).ToList();
=======
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
            List<Cemp> cemps = _context.Cemps.ToList();
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail2> EvalDetails2 = _context.EvalDetailss2.ToList();
            List<EvalRequestTypeId2> EvalRequestTypeIds2 = _context.EvalRequestTypeIds2.ToList();
            List<Evalcomment2> evalcommentss = _context.EvalComments2.ToList();
            //
            List<ACourcesType> ACourcesTypes = _context.ACourcesTypes.ToList();
            List<Cemp> Cemps = _context.Cemps.ToList();
            List<ACourcesEstimate> ACourcesEstimates = _context.ACourcesEstimates.ToList();
            List<ACourcesMaster> ACourcesMasters = _context.ACourcesMasters.ToList();
           // List<ACourcesMaster> ACourcesMasters = _context.ACourcesMasters.Where(e => e.CourcesEndDate.Date >= Convert.ToDateTime(emppro.CEMPLASTUPGRADEHIJRA).Date && e.Cempid == HttpContext.Session.GetString("empid")).ToList();
            List<ACourcesDeptin> ACourcesDeptins = _context.ACourcesDeptins.ToList();
            List<MasterRequestTypeId> MasterRequestTypeIds = _context.MasterRequestTypeIds.ToList();
            List<MasterDetails> MasterDetailss = _context.MasterDetailss.ToList();
            List<ACourcesDeptout> ACourcesDeptouts = _context.ACourcesDeptouts.ToList();
            List<ACourcesTrainingMethod> ACourcesTrainingMethods = _context.ACourcesTrainingMethods.ToList();
            List<ACourcesName> ACourcesNames = _context.ACourcesNames.ToList();
            //

            var Records = from e0 in AEvaluationEmps
                              //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                              //from d in table1.ToList()
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join ff in EvalDetails2 on e0.Idd equals ff.CourcesIdoffered into table4f
                          from ff in table4f.ToList()
<<<<<<< HEAD
                          where ff.OfferedRequestTypeSatus == 1 && e0.CovenantYear==2022
=======
                          where ff.OfferedRequestTypeSatus == 1
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                          //where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                          join hf in EvalRequestTypeIds2 on e0.Idd equals hf.CourcesIdoffered into table5f
                          from hf in table5f.ToList()
                          where hf.OfferedRequestType == 1
                          //join mm in evalcommentss on f.OfferedDetailsSerial equals mm.Offerdetailsid into table6
                          //from mm in table6.ToList()
                          //where mm.Offerdetailsid == f.OfferedDetailsSerial
                          join gg in cemps on e0.Empno equals Convert.ToInt32(gg.Cempid) into table99
                          from gg in table99.ToList()
                          where gg.CEMPPASSWRD.Length == 10
                          join f in members on gg.CEMPPASSWRD equals f.userid into table4
                          from f in table4.Distinct().ToList()
                          //where f.status == 0
                          //where (f.OfferedRequestTo == HttpContext.Session.GetString("empid") && f.OfferedRequestTo3 == "0") || (f.OfferedRequestTo2 == HttpContext.Session.GetString("empid") && f.OfferedRequestTo4 == "0") || (f.Offeredoption == HttpContext.Session.GetString("empid") && f.OfferedRequestTo5 == "0")
                          join yy in commites on f.commitedescession equals yy.commitedescession into table555
                          from yy in table555.Distinct().ToList()
                          where yy.status == 0 && yy.commitedescession == commit &&(f.status==0&&yy.postion== "رئيس اللجنة")||(f.status2==0&&yy.postion== "نائب رئيس اللجنة ")||(f.status3==0&&yy.postion== "عضو اللجنة1") || (f.status4 == 0 && yy.postion == "عضو اللجنة2") || (f.status5 == 0 && yy.postion == "عضو اللجنة3")
<<<<<<< HEAD
                          //join yyx in persnolEmpGrades on 0 equals 0 into table500
                          //from yyx in table500.Distinct().ToList()
                          //where yyx.empnational != gg.CEMPPASSWRD
                          // from e in ACourcesMasters
=======

                         // from e in ACourcesMasters
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                          //join i in ACourcesMasters on gg.Cempid equals i.Cempid into table2
                          //from i in table2.ToList()
                          //    // where i.Cempid == HttpContext.Session.GetString("empid")
                          //where i.CourcesEndDate.Date >= Convert.ToDateTime(gg.CEMPLASTUPGRADEHIJRA).Date && e0.Empno ==Convert.ToInt32( gg.Cempid)

                          //join d in ACourcesTypes on i.CourcesIdType equals d.CourcesIdType into table1
                          //from d in table1.ToList()
                          //join j in ACourcesEstimates on i.CourcesIdEstimate equals j.CourcesIdEstimate into table3
                          //from j in table3.ToList()
                          //join f1 in ACourcesDeptins on i.CourcesIdDeptin equals f1.CourcesIdDeptin into table41
                          //from f1 in table41.ToList()
                          //join h in ACourcesDeptouts on i.CourcesIdDeptout equals h.CourcesIdDeptout into table5
                          //from h in table5.ToList()
                          //join n in ACourcesTrainingMethods on i.CourcesIdTraining equals n.CourcesIdTraining into table6
                          //from n in table6.ToList()
                          //join x in MasterRequestTypeIds on i.CourcesIdmaster equals x.COURCES_IDMASTER into table7
                          //from x in table7.ToList()
                          //where x.MasterRequestType == 1
                          //join y in MasterDetailss on i.CourcesIdmaster equals y.COURCES_IDMASTER into table8
                          //from y in table8.Distinct().ToList()
                          //where y.MasterRequestTypeSatus == 1
                          //where y.MasterRequestTo == HttpContext.Session.GetString("empid") || y.MasterRequestTo2 == HttpContext.Session.GetString("empid")
                          //join z in ACourcesNames on i.CourcesId equals z.CourcesId into table9
                          //from z in table9.ToList()

<<<<<<< HEAD
                          //join h in membersz on e.Cempid equals h.userid into table5
                          //from h in table5.ToList()
                          //where h.status == 0
                          //join y in memberszz on f.announce equals y.announce into table55
                          //from y in table55.Distinct().ToList()
                          //where y.status == 0 && e.Cempid != y.announcetxt && f.commitedescession == y.commitedescession
=======
                              //join h in membersz on e.Cempid equals h.userid into table5
                              //from h in table5.ToList()
                              //where h.status == 0
                              //join y in memberszz on f.announce equals y.announce into table55
                              //from y in table55.Distinct().ToList()
                              //where y.status == 0 && e.Cempid != y.announcetxt && f.commitedescession == y.commitedescession
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b



                          select new ViewModelEvalwithother
                          {
                              cemp = gg,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              member = f,
                              //memberz = h,
                              //memberzz = y,
                              commite = yy,
                              evalDetail2 = ff,
                              evalRequestTypeId2 = hf,
                              AEvaluationEmp = e0,
                             // ACourcesMasters = i,
                             // ACourcesTypes = d,
                              //Cemps = i,
                              //ACourcesEstimates = j,
                              //ACourcesDeptins = f1,
                            //  ACourcesDeptouts = h,
                             // ACourcesTrainingMethods = n,
                             // MasterRequestTypeIds = x,
                            //  MasterDetails = y,
                             // ACourcesNames = z

                          };


            //ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            //viewModelEvalwithother.commite = _context.commite.Where(z => z.userid == HttpContext.Session.GetString("username") && z.status == 0).OrderBy(x => x.id).LastOrDefault();
            //viewModelEvalwithother.members = _context.Members.Where(X => X.status == 0 && X.userid != "" && X.username != "" && X.commitedescession == viewModelEvalwithother.commite.commitedescession).ToList();
            //// add commite
            //List<Cemp> list = new List<Cemp>();
            //for (int i = 0; i < viewModelEvalwithother.members.ToList().Count; i++)
            //{
            //    var tt = new Cemp
            //    {
            //        Cempid = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().Cempid ?? "",
            //        CEMPNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPNAME ?? "",
            //        CEMPPASSWRD = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPPASSWRD ?? "",
            //        CEMPNO = viewModelEvalwithother.members.ElementAt(i).commitedescession.ToString() ?? "",
            //        CEMPPASSWRD1 = viewModelEvalwithother.members.ElementAt(i).announce.ToString() ?? "",
            //        EncryptedId = _protector.Protect(viewModelEvalwithother.members.ElementAt(i).userid.ToString()),
            //        CLSSNO = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CLSSNO ?? "",
            //        grade = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().grade ?? "",
            //        DEP_NAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().DEP_NAME ?? "",
            //        PARENTNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().PARENTNAME ?? "",
            //        CEMPHIRINGDATEHIJRA = Convert.ToDateTime(_context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPHIRINGDATEHIJRA).Date,
            //        CEMPLASTUPGRADEHIJRA = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPLASTUPGRADEHIJRA,
            //        //TaskM10 = HttpContext.Session.GetString("empid")
            //    };
            //    list.Add(tt);
            //}
            //viewModelEvalwithother.cemps = list;

            foreach (var emp in Records.ToList())
            {
                var stringId = emp.cemp.Cempid.ToString();
                emp.cemp.EncryptedId = _protector.Protect(stringId);
                sumgrade = 0.0;
                ACourcesMasters = _context.ACourcesMasters.Where(e => e.CourcesEndDate.Date >= Convert.ToDateTime(emp.cemp.CEMPLASTUPGRADEHIJRA).Date && e.CourcesEndDate.Date <= (_context.Members.Where(x => x.announce == announce).FirstOrDefault().dateexcute1.Value.Date) && e.Cempid == emp.cemp.Cempid).ToList();
                foreach (var emp0 in ACourcesMasters.ToList())
                {
                    if (_context.MasterRequestTypeIds.Where(z => z.COURCES_IDMASTER == emp0.CourcesIdmaster && z.MasterRequestType == 1).FirstOrDefault() != null)
                    {
                        if (emp0.CourcesIdType == 1)
                        {
                            if (emp0.CourcesIdType == 1 && emp0.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                            {
                                emp0.gradetocourse = 40.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 1 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                            {

                                emp0.gradetocourse = 30.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }
                        else if (emp0.CourcesIdType == 2)
                        {
                            if (emp0.CourcesIdType == 2 && emp0.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                            {
                                emp0.gradetocourse = 80.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 2 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                            {
                                emp0.gradetocourse = 60.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 2 && emp0.COURCES_EXCUTION.Equals("جهة تدريب بالقطاع الخاص"))
                            {
                                emp0.gradetocourse = 40.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }
                        else if (emp0.CourcesIdType == 3)
                        {
                            if (emp0.CourcesIdType == 3 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                            {
                                emp0.gradetocourse = 1.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }
                        else if (emp0.CourcesIdType == 4 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {

                            if (emp0.CourcesIdType == 4 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && emp0.CourcesIdEstimate == 1)
                            {
                                emp0.gradetocourse = 50.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 4 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && emp0.CourcesIdEstimate == 2)
                            {
                                emp0.gradetocourse = 25.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }
                        
                    }

                    //emp.gradetocourse0 = sumgrade;


                }
                if (sumgrade >= 100.00)
                {
                    //TempData["sumgrade"] = "100.00";
                    emp.cemp.cbrowser = "100";

                }
                else
                {
                    // TempData["sumgrade"] = sumgrade;
                    emp.cemp.cbrowser = sumgrade.ToString();
                }
<<<<<<< HEAD
                // emp.gradetocourse0 = sumgrade;
                // emp.cemp.cbrowser = sumgrade.ToString();
                //emp.ACourcesMasters.gradetocourse0 = sumgrade;
                var emp01 = _context.AEvaluationEmps.Where(x => x.Empno == emp.AEvaluationEmp.Empno) /*&&(x.year=="2021")*/.OrderBy(x => x.Idd).LastOrDefault();
                if (emp01 != null)
                {
                    // check eval approved  for last year 2022 or go to previous year 
                    var approval = _context.EvalDetailss2.Where(x => x.CourcesIdoffered == emp01.Idd && x.OfferedRequestTypeSatus == 1).FirstOrDefault();
                    if (approval != null)
                    {
                        List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp01.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                        av1 = vAEvaluationGoals[0];
                        av2 = vAEvaluationGoals[1];
                        av3 = vAEvaluationGoals[2];
                        av4 = vAEvaluationGoals[3];
                        if (vAEvaluationGoals.Count > 4)
                        {
                            av5 = vAEvaluationGoals[4];

                        }
                        if (vAEvaluationGoals.Count > 5)
                        {
                            av6 = vAEvaluationGoals[5];
                        }
                        List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp01.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                        am1 = vAEvaluationCompetenciesMs[0];
                        am2 = vAEvaluationCompetenciesMs[1];
                        am3 = vAEvaluationCompetenciesMs[2];
                        am4 = vAEvaluationCompetenciesMs[3];
                        am5 = vAEvaluationCompetenciesMs[4];
                        am6 = vAEvaluationCompetenciesMs[5];
                        if (vAEvaluationCompetenciesMs.Count > 6)
                        {

                            am7 = vAEvaluationCompetenciesMs[6];
                        }

                        List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp01.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                        ad1 = vAEvaluationCompetenciesDs[0];
                        ad2 = vAEvaluationCompetenciesDs[1];
                        ad3 = vAEvaluationCompetenciesDs[2];
                        ad4 = vAEvaluationCompetenciesDs[3];
                        ad5 = vAEvaluationCompetenciesDs[4];
                        ad6 = vAEvaluationCompetenciesDs[5];
                        ad7 = vAEvaluationCompetenciesDs[6];
                        ad8 = vAEvaluationCompetenciesDs[7];
                        ad9 = vAEvaluationCompetenciesDs[8];
                        ad10 = vAEvaluationCompetenciesDs[9];
                        ad11 = vAEvaluationCompetenciesDs[10];
                        ad12 = vAEvaluationCompetenciesDs[11];
                        ad13 = vAEvaluationCompetenciesDs[12];
                        ad14 = vAEvaluationCompetenciesDs[13];
                        ad15 = vAEvaluationCompetenciesDs[14];
                        ad16 = vAEvaluationCompetenciesDs[15];
                        ad17 = vAEvaluationCompetenciesDs[16];
                        ad18 = vAEvaluationCompetenciesDs[17];
                        if (vAEvaluationCompetenciesDs.Count > 18)
                        {

                            ad19 = vAEvaluationCompetenciesDs[18];
                            ad20 = vAEvaluationCompetenciesDs[19];
                            ad21 = vAEvaluationCompetenciesDs[20];
                            ad22 = vAEvaluationCompetenciesDs[21];
                            ad23 = vAEvaluationCompetenciesDs[22];
                        }
                        if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString(((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('"+emp.cemp.CEMPPASSWRD+"', '"+emp.cemp.CEMPNO+"','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '"+ emp.AEvaluationEmp.tot1 + "', "+Convert.ToInt32(emp.AEvaluationEmp.tot4)+") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();

                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "3 " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                             ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                             ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                             ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();

                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                     ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                     ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                     ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                      ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                      ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                      ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                              ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                              ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                              ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);


                        }
                    }
                    else
                    {
                        // aeval 2021 calc 
                        var emp021 = _context.AEvaluationEmps.Where(x => x.Empno == emp.AEvaluationEmp.Empno && x.year == "2021").FirstOrDefault();
                        if (emp021 != null)
                        {
                            var approval021 = _context.EvalDetailss2.Where(x => x.CourcesIdoffered == emp021.Idd && x.OfferedRequestTypeSatus == 1).FirstOrDefault();
                            if (approval021 != null)
                            {
                                var approvalseial = _context.EvalDetailss2.Where(x => x.CourcesIdoffered == emp021.Idd).FirstOrDefault();
                                var approveddate = _context.EvalComments2.Where(x => x.Offerdetailsid == approvalseial.OfferedDetailsSerial).FirstOrDefault();
                                List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp021.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                                av1 = vAEvaluationGoals[0];
                                av2 = vAEvaluationGoals[1];
                                av3 = vAEvaluationGoals[2];
                                av4 = vAEvaluationGoals[3];
                                if (vAEvaluationGoals.Count > 4)
                                {
                                    av5 = vAEvaluationGoals[4];

                                }
                                if (vAEvaluationGoals.Count > 5)
                                {
                                    av6 = vAEvaluationGoals[5];
                                }
                                List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp021.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                                am1 = vAEvaluationCompetenciesMs[0];
                                am2 = vAEvaluationCompetenciesMs[1];
                                am3 = vAEvaluationCompetenciesMs[2];
                                am4 = vAEvaluationCompetenciesMs[3];
                                am5 = vAEvaluationCompetenciesMs[4];
                                am6 = vAEvaluationCompetenciesMs[5];
                                if (vAEvaluationCompetenciesMs.Count > 6)
                                {

                                    am7 = vAEvaluationCompetenciesMs[6];
                                }

                                List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp021.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                                ad1 = vAEvaluationCompetenciesDs[0];
                                ad2 = vAEvaluationCompetenciesDs[1];
                                ad3 = vAEvaluationCompetenciesDs[2];
                                ad4 = vAEvaluationCompetenciesDs[3];
                                ad5 = vAEvaluationCompetenciesDs[4];
                                ad6 = vAEvaluationCompetenciesDs[5];
                                ad7 = vAEvaluationCompetenciesDs[6];
                                ad8 = vAEvaluationCompetenciesDs[7];
                                ad9 = vAEvaluationCompetenciesDs[8];
                                ad10 = vAEvaluationCompetenciesDs[9];
                                ad11 = vAEvaluationCompetenciesDs[10];
                                ad12 = vAEvaluationCompetenciesDs[11];
                                ad13 = vAEvaluationCompetenciesDs[12];
                                ad14 = vAEvaluationCompetenciesDs[13];
                                ad15 = vAEvaluationCompetenciesDs[14];
                                ad16 = vAEvaluationCompetenciesDs[15];
                                ad17 = vAEvaluationCompetenciesDs[16];
                                ad18 = vAEvaluationCompetenciesDs[17];
                                if (vAEvaluationCompetenciesDs.Count > 18)
                                {

                                    ad19 = vAEvaluationCompetenciesDs[18];
                                    ad20 = vAEvaluationCompetenciesDs[19];
                                    ad21 = vAEvaluationCompetenciesDs[20];
                                    ad22 = vAEvaluationCompetenciesDs[21];
                                    ad23 = vAEvaluationCompetenciesDs[22];
                                }
                                if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString(((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('"+emp.cemp.CEMPPASSWRD+"', '"+emp.cemp.CEMPNO+"','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '"+ emp.AEvaluationEmp.tot1 + "', "+Convert.ToInt32(emp.AEvaluationEmp.tot4)+") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();

                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "3 " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();

                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);


                                }

                            }
                            else
                            {
                                ViewBag.mesg = "ليس لديك طلب تقييم معتمد للعام الحالي او  العام 2021  .";
                            }

                        }
                        else
                        {
                            ViewBag.mesg = "ليس لديك طلب تقييم معتمد للعام  2021  .";
                        }
                    }
                }
                else
                {
                    ViewBag.mesg = "لايوجد طلبات تقييم للاداء مرفوعة علي النظام    .";
                }

            }
            
                return View(Records);
        }
        [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public ActionResult test0(int Id)
        {

            return View("test0");
        }
=======
               // emp.gradetocourse0 = sumgrade;
               // emp.cemp.cbrowser = sumgrade.ToString();
                //emp.ACourcesMasters.gradetocourse0 = sumgrade;
                List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                    av1 = vAEvaluationGoals[0];
                    av2 = vAEvaluationGoals[1];
                    av3 = vAEvaluationGoals[2];
                    av4 = vAEvaluationGoals[3];
                    if (vAEvaluationGoals.Count > 4)
                    {
                        av5 = vAEvaluationGoals[4];

                    }
                    if (vAEvaluationGoals.Count > 5)
                    {
                        av6 = vAEvaluationGoals[5];
                    }
                    List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                    am1 = vAEvaluationCompetenciesMs[0];
                    am2 = vAEvaluationCompetenciesMs[1];
                    am3 = vAEvaluationCompetenciesMs[2];
                    am4 = vAEvaluationCompetenciesMs[3];
                    am5 = vAEvaluationCompetenciesMs[4];
                    am6 = vAEvaluationCompetenciesMs[5];
                    if (vAEvaluationCompetenciesMs.Count > 6)
                    {

                        am7 = vAEvaluationCompetenciesMs[6];
                    }

                    List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                    ad1 = vAEvaluationCompetenciesDs[0];
                    ad2 = vAEvaluationCompetenciesDs[1];
                    ad3 = vAEvaluationCompetenciesDs[2];
                    ad4 = vAEvaluationCompetenciesDs[3];
                    ad5 = vAEvaluationCompetenciesDs[4];
                    ad6 = vAEvaluationCompetenciesDs[5];
                    ad7 = vAEvaluationCompetenciesDs[6];
                    ad8 = vAEvaluationCompetenciesDs[7];
                    ad9 = vAEvaluationCompetenciesDs[8];
                    ad10 = vAEvaluationCompetenciesDs[9];
                    ad11 = vAEvaluationCompetenciesDs[10];
                    ad12 = vAEvaluationCompetenciesDs[11];
                    ad13 = vAEvaluationCompetenciesDs[12];
                    ad14 = vAEvaluationCompetenciesDs[13];
                    ad15 = vAEvaluationCompetenciesDs[14];
                    ad16 = vAEvaluationCompetenciesDs[15];
                    ad17 = vAEvaluationCompetenciesDs[16];
                    ad18 = vAEvaluationCompetenciesDs[17];
                    if (vAEvaluationCompetenciesDs.Count > 18)
                    {

                        ad19 = vAEvaluationCompetenciesDs[18];
                        ad20 = vAEvaluationCompetenciesDs[19];
                        ad21 = vAEvaluationCompetenciesDs[20];
                        ad22 = vAEvaluationCompetenciesDs[21];
                        ad23 = vAEvaluationCompetenciesDs[22];
                    }
                    if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                    {
                        // calculation 

                        emp.AEvaluationEmp.tot1 = Convert.ToString(((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                        emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                        emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                       ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                       ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                       ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                        emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                       ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                       ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                       ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                        //OracleConnection Con5 = new OracleConnection(TNS1);
                        //Con5.Open();
                        //OracleCommand cmd = new OracleCommand();
                        //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('"+emp.cemp.CEMPPASSWRD+"', '"+emp.cemp.CEMPNO+"','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '"+ emp.AEvaluationEmp.tot1 + "', "+Convert.ToInt32(emp.AEvaluationEmp.tot4)+") ";
                        ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                        //cmd.Connection = Con5;
                        //cmd.ExecuteNonQuery();
                        //Con5.Close();

                        //return View(Records);
                    }
                    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                    {
                        // calculation 

                        emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                        emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                        emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";

                        emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "3 " :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                        //OracleConnection Con5 = new OracleConnection(TNS1);
                        //Con5.Open();
                        //OracleCommand cmd = new OracleCommand();
                        //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                        ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                        //cmd.Connection = Con5;
                        //cmd.ExecuteNonQuery();
                        //Con5.Close();
                        //return View(Records);
                    }
                    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                    {
                        // calculation 

                        emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                        emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                        emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                       ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                       ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                       ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                        emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                         ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                         ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                         ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                        //OracleConnection Con5 = new OracleConnection(TNS1);
                        //Con5.Open();
                        //OracleCommand cmd = new OracleCommand();
                        //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                        ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                        //cmd.Connection = Con5;
                        //cmd.ExecuteNonQuery();
                        //Con5.Close();
                        //return View(Records);
                    }
                    else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                    {
                        // calculation 

                        emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                        emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                        emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                        emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                        //OracleConnection Con5 = new OracleConnection(TNS1);
                        //Con5.Open();
                        //OracleCommand cmd = new OracleCommand();
                        //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                        ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                        //cmd.Connection = Con5;
                        //cmd.ExecuteNonQuery();
                        //Con5.Close();
                        //return View(Records);
                    }
                    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                    {
                        // calculation 

                        emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                        emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                        emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                       ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                       ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                       ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                        emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                        //OracleConnection Con5 = new OracleConnection(TNS1);
                        //Con5.Open();
                        //OracleCommand cmd = new OracleCommand();
                        //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                        ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                        //cmd.Connection = Con5;
                        //cmd.ExecuteNonQuery();
                        //Con5.Close();

                    }
                    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                    {
                        // calculation 

                        emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                        emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                        emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                 ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                 ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                 ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 0";

                        emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                  ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                  ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                  ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 9";


                        //OracleConnection Con5 = new OracleConnection(TNS1);
                        //Con5.Open();
                        //OracleCommand cmd = new OracleCommand();
                        //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                        ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                        //cmd.Connection = Con5;
                        //cmd.ExecuteNonQuery();
                        //Con5.Close();
                        //return View(Records);
                    }
                    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                    {
                        // calculation 

                        emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                        emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                        emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                       ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                       ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                       ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                        emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                       ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                       ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                       ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                        //OracleConnection Con5 = new OracleConnection(TNS1);
                        //Con5.Open();
                        //OracleCommand cmd = new OracleCommand();
                        //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                        ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                        //cmd.Connection = Con5;
                        //cmd.ExecuteNonQuery();
                        //Con5.Close();
                        //return View(Records);
                    }
                    else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                    {
                        // calculation 

                        emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                        emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                        emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                       ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                       ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                       ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                        emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                        //OracleConnection Con5 = new OracleConnection(TNS1);
                        //Con5.Open();
                        //OracleCommand cmd = new OracleCommand();
                        //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                        ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                        //cmd.Connection = Con5;
                        //cmd.ExecuteNonQuery();
                        //Con5.Close();
                        //return View(Records);
                    }
                    else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                    {
                        // calculation 

                        emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                        emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                        emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                        emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                       ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                       ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                       ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                        //OracleConnection Con5 = new OracleConnection(TNS1);
                        //Con5.Open();
                        //OracleCommand cmd = new OracleCommand();
                        //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                        ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                        //cmd.Connection = Con5;
                        //cmd.ExecuteNonQuery();
                        //Con5.Close();
                        //return View(Records);


                    }
                }
            
                return View(Records);
        }

>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
        [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public IActionResult Uploadmmmm000(string announce)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            double sumgrade = 0.0;
            List<members> noDups = _context.Members.ToList().GroupBy(d => new { d.announce })
                                  .Where(d => d.Count() >= 1)
                                  .Select(d => d.First())
                                  .ToList();
            ViewData["Cempid1"] = new SelectList(noDups.ToList(), "announce", "announce");
            if (announce == null)
            {
                announce = "111111";
            }
            var announce0 = _context.Members.Where(x => x.announce == announce).FirstOrDefault().announce;
            var commit = _context.Members.Where(x => x.announce == announce).FirstOrDefault().commitedescession;
            //List<membersz> membersz = _context.Membersz.Where(x => x.userid == HttpContext.Session.GetString("username") && x.announce == announce).ToList();
            //List<memberszz> memberszz = _context.Memberszz.Where(x => x.userid == HttpContext.Session.GetString("username") && x.announce == announce).ToList();
            List<members> members = _context.Members.Where(X => X.userid != "" && X.username != "" && X.announce == announce0).ToList();
<<<<<<< HEAD
            List<commite> commites = _context.commite.Where(z => z.userid == HttpContext.Session.GetString("username") && z.status == 0 && z.commitedescession == commit /*&& z.postion != "سكرتير اللجنة "*/).ToList();
            //var ann = _context.Members.Where(x => x.announce == announce0).FirstOrDefault();
            //List<PersnolEmpGrade> persnolEmpGrades = _context.PersnolEmpGrade.Where(z => z.empdate == ann.dateexcute1).ToList();
=======
            List<commite> commites = _context.commite.Where(z => z.userid == HttpContext.Session.GetString("username") && z.status == 0 && z.commitedescession == commit && z.postion != "سكرتير اللجنة ").ToList();
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
            List<Cemp> cemps = _context.Cemps.ToList();
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail2> EvalDetails2 = _context.EvalDetailss2.ToList();
            List<EvalRequestTypeId2> EvalRequestTypeIds2 = _context.EvalRequestTypeIds2.ToList();
            List<Evalcomment2> evalcommentss = _context.EvalComments2.ToList();
            //
            List<ACourcesType> ACourcesTypes = _context.ACourcesTypes.ToList();
            List<Cemp> Cemps = _context.Cemps.ToList();
            List<ACourcesEstimate> ACourcesEstimates = _context.ACourcesEstimates.ToList();
            List<ACourcesMaster> ACourcesMasters = _context.ACourcesMasters.ToList();
            // List<ACourcesMaster> ACourcesMasters = _context.ACourcesMasters.Where(e => e.CourcesEndDate.Date >= Convert.ToDateTime(emppro.CEMPLASTUPGRADEHIJRA).Date && e.Cempid == HttpContext.Session.GetString("empid")).ToList();
            List<ACourcesDeptin> ACourcesDeptins = _context.ACourcesDeptins.ToList();
            List<MasterRequestTypeId> MasterRequestTypeIds = _context.MasterRequestTypeIds.ToList();
            List<MasterDetails> MasterDetailss = _context.MasterDetailss.ToList();
            List<ACourcesDeptout> ACourcesDeptouts = _context.ACourcesDeptouts.ToList();
            List<ACourcesTrainingMethod> ACourcesTrainingMethods = _context.ACourcesTrainingMethods.ToList();
            List<ACourcesName> ACourcesNames = _context.ACourcesNames.ToList();
            //

            var Records = from e0 in AEvaluationEmps
                              //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                              //from d in table1.ToList()
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()

                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join ff in EvalDetails2 on e0.Idd equals ff.CourcesIdoffered into table4f
                          from ff in table4f.ToList()
<<<<<<< HEAD
                          where ff.OfferedRequestTypeSatus == 1 && e0.CovenantYear == 2022
=======
                          where ff.OfferedRequestTypeSatus == 1
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                          //where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                          join hf in EvalRequestTypeIds2 on e0.Idd equals hf.CourcesIdoffered into table5f
                          from hf in table5f.ToList()
                          where hf.OfferedRequestType == 1
                          //join mm in evalcommentss on f.OfferedDetailsSerial equals mm.Offerdetailsid into table6
                          //from mm in table6.ToList()
                          //where mm.Offerdetailsid == f.OfferedDetailsSerial
                          join gg in cemps on e0.Empno equals Convert.ToInt32(gg.Cempid) into table99
                          from gg in table99.ToList()
                          where gg.CEMPPASSWRD.Length == 10
                          join f in members on gg.CEMPPASSWRD equals f.userid into table4
                          from f in table4.Distinct().ToList()
                              //where f.status == 0
                              //where (f.OfferedRequestTo == HttpContext.Session.GetString("empid") && f.OfferedRequestTo3 == "0") || (f.OfferedRequestTo2 == HttpContext.Session.GetString("empid") && f.OfferedRequestTo4 == "0") || (f.Offeredoption == HttpContext.Session.GetString("empid") && f.OfferedRequestTo5 == "0")
                          join yy in commites on f.commitedescession equals yy.commitedescession into table555
                          from yy in table555.Distinct().ToList()
<<<<<<< HEAD
                          where yy.status == 0 && yy.commitedescession == commit && /*(f.status == 0 && yy.postion == "رئيس اللجنة") || (f.status2 == 0 && yy.postion == "نائب رئيس اللجنة ") || (f.status3 == 0 && yy.postion == "عضو اللجنة1") || (f.status4 == 0 && yy.postion == "عضو اللجنة2") || (f.status5 == 0 && yy.postion == "عضو اللجنة3") ||*/ ( yy.postion == "سكرتير اللجنة ")
                          //join yyx in persnolEmpGrades on 0 equals 0 into table500
                          //from yyx in table500.Distinct().ToList()
                          //where yyx.empnational!=gg.CEMPPASSWRD
=======
                          where yy.status == 0 && yy.commitedescession == commit && (f.status == 0 && yy.postion == "رئيس اللجنة") || (f.status2 == 0 && yy.postion == "نائب رئيس اللجنة ") || (f.status3 == 0 && yy.postion == "عضو اللجنة1") || (f.status4 == 0 && yy.postion == "عضو اللجنة2") || (f.status5 == 0 && yy.postion == "عضو اللجنة3")

>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                          // from e in ACourcesMasters
                          //join i in ACourcesMasters on gg.Cempid equals i.Cempid into table2
                          //from i in table2.ToList()
                          //    // where i.Cempid == HttpContext.Session.GetString("empid")
                          //where i.CourcesEndDate.Date >= Convert.ToDateTime(gg.CEMPLASTUPGRADEHIJRA).Date && e0.Empno ==Convert.ToInt32( gg.Cempid)

                          //join d in ACourcesTypes on i.CourcesIdType equals d.CourcesIdType into table1
                          //from d in table1.ToList()
                          //join j in ACourcesEstimates on i.CourcesIdEstimate equals j.CourcesIdEstimate into table3
                          //from j in table3.ToList()
                          //join f1 in ACourcesDeptins on i.CourcesIdDeptin equals f1.CourcesIdDeptin into table41
                          //from f1 in table41.ToList()
                          //join h in ACourcesDeptouts on i.CourcesIdDeptout equals h.CourcesIdDeptout into table5
                          //from h in table5.ToList()
                          //join n in ACourcesTrainingMethods on i.CourcesIdTraining equals n.CourcesIdTraining into table6
                          //from n in table6.ToList()
                          //join x in MasterRequestTypeIds on i.CourcesIdmaster equals x.COURCES_IDMASTER into table7
                          //from x in table7.ToList()
                          //where x.MasterRequestType == 1
                          //join y in MasterDetailss on i.CourcesIdmaster equals y.COURCES_IDMASTER into table8
                          //from y in table8.Distinct().ToList()
                          //where y.MasterRequestTypeSatus == 1
                          //where y.MasterRequestTo == HttpContext.Session.GetString("empid") || y.MasterRequestTo2 == HttpContext.Session.GetString("empid")
                          //join z in ACourcesNames on i.CourcesId equals z.CourcesId into table9
                          //from z in table9.ToList()

                          //join h in membersz on e.Cempid equals h.userid into table5
                          //from h in table5.ToList()
                          //where h.status == 0
                          //join y in memberszz on f.announce equals y.announce into table55
                          //from y in table55.Distinct().ToList()
                          //where y.status == 0 && e.Cempid != y.announcetxt && f.commitedescession == y.commitedescession



                          select new ViewModelEvalwithother
                          {
                              cemp = gg,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              member = f,
                              //memberz = h,
                              //memberzz = y,
                              commite = yy,
                              evalDetail2 = ff,
                              evalRequestTypeId2 = hf,
                              AEvaluationEmp = e0,
                              // ACourcesMasters = i,
                              // ACourcesTypes = d,
                              //Cemps = i,
                              //ACourcesEstimates = j,
                              //ACourcesDeptins = f1,
                              //  ACourcesDeptouts = h,
                              // ACourcesTrainingMethods = n,
                              // MasterRequestTypeIds = x,
                              //  MasterDetails = y,
                              // ACourcesNames = z

                          };


            //ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            //viewModelEvalwithother.commite = _context.commite.Where(z => z.userid == HttpContext.Session.GetString("username") && z.status == 0).OrderBy(x => x.id).LastOrDefault();
            //viewModelEvalwithother.members = _context.Members.Where(X => X.status == 0 && X.userid != "" && X.username != "" && X.commitedescession == viewModelEvalwithother.commite.commitedescession).ToList();
            //// add commite
            //List<Cemp> list = new List<Cemp>();
            //for (int i = 0; i < viewModelEvalwithother.members.ToList().Count; i++)
            //{
            //    var tt = new Cemp
            //    {
            //        Cempid = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().Cempid ?? "",
            //        CEMPNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPNAME ?? "",
            //        CEMPPASSWRD = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPPASSWRD ?? "",
            //        CEMPNO = viewModelEvalwithother.members.ElementAt(i).commitedescession.ToString() ?? "",
            //        CEMPPASSWRD1 = viewModelEvalwithother.members.ElementAt(i).announce.ToString() ?? "",
            //        EncryptedId = _protector.Protect(viewModelEvalwithother.members.ElementAt(i).userid.ToString()),
            //        CLSSNO = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CLSSNO ?? "",
            //        grade = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().grade ?? "",
            //        DEP_NAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().DEP_NAME ?? "",
            //        PARENTNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().PARENTNAME ?? "",
            //        CEMPHIRINGDATEHIJRA = Convert.ToDateTime(_context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPHIRINGDATEHIJRA).Date,
            //        CEMPLASTUPGRADEHIJRA = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPLASTUPGRADEHIJRA,
            //        //TaskM10 = HttpContext.Session.GetString("empid")
            //    };
            //    list.Add(tt);
            //}
            //viewModelEvalwithother.cemps = list;

            foreach (var emp in Records.ToList())
            {
                var stringId = emp.cemp.Cempid.ToString();
                emp.cemp.EncryptedId = _protector.Protect(stringId);
<<<<<<< HEAD
                if(_context.PersnolEmpGrade.Where(zx => zx.empnational == emp.cemp.CEMPPASSWRD).OrderBy(z => z.seriad).LastOrDefault() != null)
                {
                    emp.cemp.tot6 = Convert.ToDecimal(_context.PersnolEmpGrade.Where(zx => zx.empnational == emp.cemp.CEMPPASSWRD).OrderBy(z=>z.seriad).LastOrDefault().empgrade);
                    emp.cemp.tot5 = _context.Members.Where(x => x.dateexcute1 == (_context.PersnolEmpGrade.Where(zx => zx.empnational == emp.cemp.CEMPPASSWRD).OrderBy(z => z.seriad).LastOrDefault().empdate)).FirstOrDefault().announce;
                }
                sumgrade = 0.0;
                ACourcesMasters = _context.ACourcesMasters.Where(e => e.CourcesEndDate.Date >= Convert.ToDateTime(emp.cemp.CEMPLASTUPGRADEHIJRA).Date && e.CourcesEndDate.Date <= (_context.Members.Where(x => x.announce == announce).FirstOrDefault().dateexcute1.Value.Date) && e.Cempid == emp.cemp.Cempid).ToList();
=======
                sumgrade = 0.0;
                ACourcesMasters = _context.ACourcesMasters.Where(e => e.CourcesEndDate.Date >= Convert.ToDateTime(emp.cemp.CEMPLASTUPGRADEHIJRA).Date && e.Cempid == emp.cemp.Cempid).ToList();
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                foreach (var emp0 in ACourcesMasters.ToList())
                {
                    if (_context.MasterRequestTypeIds.Where(z => z.COURCES_IDMASTER == emp0.CourcesIdmaster && z.MasterRequestType == 1).FirstOrDefault() != null)
                    {
                        if (emp0.CourcesIdType == 1)
                        {
                            if (emp0.CourcesIdType == 1 && emp0.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                            {
                                emp0.gradetocourse = 40.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 1 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                            {

                                emp0.gradetocourse = 30.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }
                        else if (emp0.CourcesIdType == 2)
                        {
                            if (emp0.CourcesIdType == 2 && emp0.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                            {
                                emp0.gradetocourse = 80.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 2 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                            {
                                emp0.gradetocourse = 60.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 2 && emp0.COURCES_EXCUTION.Equals("جهة تدريب بالقطاع الخاص"))
                            {
                                emp0.gradetocourse = 40.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }
                        else if (emp0.CourcesIdType == 3)
                        {
                            if (emp0.CourcesIdType == 3 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                            {
                                emp0.gradetocourse = 1.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }
                        else if (emp0.CourcesIdType == 4 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {

                            if (emp0.CourcesIdType == 4 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && emp0.CourcesIdEstimate == 1)
                            {
                                emp0.gradetocourse = 50.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 4 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && emp0.CourcesIdEstimate == 2)
                            {
                                emp0.gradetocourse = 25.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }

                    }

                    //emp.gradetocourse0 = sumgrade;


                }
                if (sumgrade >= 100.00)
                {
                    //TempData["sumgrade"] = "100.00";
<<<<<<< HEAD
                    emp.cemp.cbrowser = "100";
=======
                    emp.cemp.cbrowser = "100.00";
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b

                }
                else
                {
                    // TempData["sumgrade"] = sumgrade;
                    emp.cemp.cbrowser = sumgrade.ToString();
                }
                // emp.gradetocourse0 = sumgrade;
                // emp.cemp.cbrowser = sumgrade.ToString();
                //emp.ACourcesMasters.gradetocourse0 = sumgrade;
<<<<<<< HEAD
                var emp01 = _context.AEvaluationEmps.Where(x => x.Empno == emp.AEvaluationEmp.Empno) /*&&(x.year=="2021")*/.OrderBy(x => x.Idd).LastOrDefault();
                if (emp01 != null)
                {
                    // check eval approved  for last year 2022 or go to previous year 
                    var approval = _context.EvalDetailss2.Where(x => x.CourcesIdoffered == emp01.Idd && x.OfferedRequestTypeSatus == 1).FirstOrDefault();
                    if (approval != null)
                    {
                        List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp01.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                        av1 = vAEvaluationGoals[0];
                        av2 = vAEvaluationGoals[1];
                        av3 = vAEvaluationGoals[2];
                        av4 = vAEvaluationGoals[3];
                        if (vAEvaluationGoals.Count > 4)
                        {
                            av5 = vAEvaluationGoals[4];

                        }
                        if (vAEvaluationGoals.Count > 5)
                        {
                            av6 = vAEvaluationGoals[5];
                        }
                        List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp01.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                        am1 = vAEvaluationCompetenciesMs[0];
                        am2 = vAEvaluationCompetenciesMs[1];
                        am3 = vAEvaluationCompetenciesMs[2];
                        am4 = vAEvaluationCompetenciesMs[3];
                        am5 = vAEvaluationCompetenciesMs[4];
                        am6 = vAEvaluationCompetenciesMs[5];
                        if (vAEvaluationCompetenciesMs.Count > 6)
                        {

                            am7 = vAEvaluationCompetenciesMs[6];
                        }

                        List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp01.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                        ad1 = vAEvaluationCompetenciesDs[0];
                        ad2 = vAEvaluationCompetenciesDs[1];
                        ad3 = vAEvaluationCompetenciesDs[2];
                        ad4 = vAEvaluationCompetenciesDs[3];
                        ad5 = vAEvaluationCompetenciesDs[4];
                        ad6 = vAEvaluationCompetenciesDs[5];
                        ad7 = vAEvaluationCompetenciesDs[6];
                        ad8 = vAEvaluationCompetenciesDs[7];
                        ad9 = vAEvaluationCompetenciesDs[8];
                        ad10 = vAEvaluationCompetenciesDs[9];
                        ad11 = vAEvaluationCompetenciesDs[10];
                        ad12 = vAEvaluationCompetenciesDs[11];
                        ad13 = vAEvaluationCompetenciesDs[12];
                        ad14 = vAEvaluationCompetenciesDs[13];
                        ad15 = vAEvaluationCompetenciesDs[14];
                        ad16 = vAEvaluationCompetenciesDs[15];
                        ad17 = vAEvaluationCompetenciesDs[16];
                        ad18 = vAEvaluationCompetenciesDs[17];
                        if (vAEvaluationCompetenciesDs.Count > 18)
                        {

                            ad19 = vAEvaluationCompetenciesDs[18];
                            ad20 = vAEvaluationCompetenciesDs[19];
                            ad21 = vAEvaluationCompetenciesDs[20];
                            ad22 = vAEvaluationCompetenciesDs[21];
                            ad23 = vAEvaluationCompetenciesDs[22];
                        }
                        if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString(((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('"+emp.cemp.CEMPPASSWRD+"', '"+emp.cemp.CEMPNO+"','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '"+ emp.AEvaluationEmp.tot1 + "', "+Convert.ToInt32(emp.AEvaluationEmp.tot4)+") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();

                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "3 " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                             ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                             ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                             ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();

                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                     ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                     ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                     ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                      ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                      ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                      ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                              ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                              ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                              ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);


                        }
                    }
                    else
                    {
                        // aeval 2021 calc 
                        var emp021 = _context.AEvaluationEmps.Where(x => x.Empno == emp.AEvaluationEmp.Empno && x.year == "2021").FirstOrDefault();
                        if (emp021 != null)
                        {
                            var approval021 = _context.EvalDetailss2.Where(x => x.CourcesIdoffered == emp021.Idd && x.OfferedRequestTypeSatus == 1).FirstOrDefault();
                            if (approval021 != null)
                            {
                                var approvalseial = _context.EvalDetailss2.Where(x => x.CourcesIdoffered == emp021.Idd).FirstOrDefault();
                                var approveddate = _context.EvalComments2.Where(x => x.Offerdetailsid == approvalseial.OfferedDetailsSerial).FirstOrDefault();
                                List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp021.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                                av1 = vAEvaluationGoals[0];
                                av2 = vAEvaluationGoals[1];
                                av3 = vAEvaluationGoals[2];
                                av4 = vAEvaluationGoals[3];
                                if (vAEvaluationGoals.Count > 4)
                                {
                                    av5 = vAEvaluationGoals[4];

                                }
                                if (vAEvaluationGoals.Count > 5)
                                {
                                    av6 = vAEvaluationGoals[5];
                                }
                                List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp021.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                                am1 = vAEvaluationCompetenciesMs[0];
                                am2 = vAEvaluationCompetenciesMs[1];
                                am3 = vAEvaluationCompetenciesMs[2];
                                am4 = vAEvaluationCompetenciesMs[3];
                                am5 = vAEvaluationCompetenciesMs[4];
                                am6 = vAEvaluationCompetenciesMs[5];
                                if (vAEvaluationCompetenciesMs.Count > 6)
                                {

                                    am7 = vAEvaluationCompetenciesMs[6];
                                }

                                List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp021.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                                ad1 = vAEvaluationCompetenciesDs[0];
                                ad2 = vAEvaluationCompetenciesDs[1];
                                ad3 = vAEvaluationCompetenciesDs[2];
                                ad4 = vAEvaluationCompetenciesDs[3];
                                ad5 = vAEvaluationCompetenciesDs[4];
                                ad6 = vAEvaluationCompetenciesDs[5];
                                ad7 = vAEvaluationCompetenciesDs[6];
                                ad8 = vAEvaluationCompetenciesDs[7];
                                ad9 = vAEvaluationCompetenciesDs[8];
                                ad10 = vAEvaluationCompetenciesDs[9];
                                ad11 = vAEvaluationCompetenciesDs[10];
                                ad12 = vAEvaluationCompetenciesDs[11];
                                ad13 = vAEvaluationCompetenciesDs[12];
                                ad14 = vAEvaluationCompetenciesDs[13];
                                ad15 = vAEvaluationCompetenciesDs[14];
                                ad16 = vAEvaluationCompetenciesDs[15];
                                ad17 = vAEvaluationCompetenciesDs[16];
                                ad18 = vAEvaluationCompetenciesDs[17];
                                if (vAEvaluationCompetenciesDs.Count > 18)
                                {

                                    ad19 = vAEvaluationCompetenciesDs[18];
                                    ad20 = vAEvaluationCompetenciesDs[19];
                                    ad21 = vAEvaluationCompetenciesDs[20];
                                    ad22 = vAEvaluationCompetenciesDs[21];
                                    ad23 = vAEvaluationCompetenciesDs[22];
                                }
                                if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString(((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('"+emp.cemp.CEMPPASSWRD+"', '"+emp.cemp.CEMPNO+"','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '"+ emp.AEvaluationEmp.tot1 + "', "+Convert.ToInt32(emp.AEvaluationEmp.tot4)+") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();

                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "3 " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();

                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);


                                }

                            }
                            else
                            {
                                ViewBag.mesg = "ليس لديك طلب تقييم معتمد للعام الحالي او  العام 2021  .";
                            }

                        }
                        else
                        {
                            ViewBag.mesg = "ليس لديك طلب تقييم معتمد للعام  2021  .";
                        }
                    }
                }
                else
                {
                    ViewBag.mesg = "لايوجد طلبات تقييم للاداء مرفوعة علي النظام    .";
                }

=======
                List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                av1 = vAEvaluationGoals[0];
                av2 = vAEvaluationGoals[1];
                av3 = vAEvaluationGoals[2];
                av4 = vAEvaluationGoals[3];
                if (vAEvaluationGoals.Count > 4)
                {
                    av5 = vAEvaluationGoals[4];

                }
                if (vAEvaluationGoals.Count > 5)
                {
                    av6 = vAEvaluationGoals[5];
                }
                List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                am1 = vAEvaluationCompetenciesMs[0];
                am2 = vAEvaluationCompetenciesMs[1];
                am3 = vAEvaluationCompetenciesMs[2];
                am4 = vAEvaluationCompetenciesMs[3];
                am5 = vAEvaluationCompetenciesMs[4];
                am6 = vAEvaluationCompetenciesMs[5];
                if (vAEvaluationCompetenciesMs.Count > 6)
                {

                    am7 = vAEvaluationCompetenciesMs[6];
                }

                List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                ad1 = vAEvaluationCompetenciesDs[0];
                ad2 = vAEvaluationCompetenciesDs[1];
                ad3 = vAEvaluationCompetenciesDs[2];
                ad4 = vAEvaluationCompetenciesDs[3];
                ad5 = vAEvaluationCompetenciesDs[4];
                ad6 = vAEvaluationCompetenciesDs[5];
                ad7 = vAEvaluationCompetenciesDs[6];
                ad8 = vAEvaluationCompetenciesDs[7];
                ad9 = vAEvaluationCompetenciesDs[8];
                ad10 = vAEvaluationCompetenciesDs[9];
                ad11 = vAEvaluationCompetenciesDs[10];
                ad12 = vAEvaluationCompetenciesDs[11];
                ad13 = vAEvaluationCompetenciesDs[12];
                ad14 = vAEvaluationCompetenciesDs[13];
                ad15 = vAEvaluationCompetenciesDs[14];
                ad16 = vAEvaluationCompetenciesDs[15];
                ad17 = vAEvaluationCompetenciesDs[16];
                ad18 = vAEvaluationCompetenciesDs[17];
                if (vAEvaluationCompetenciesDs.Count > 18)
                {

                    ad19 = vAEvaluationCompetenciesDs[18];
                    ad20 = vAEvaluationCompetenciesDs[19];
                    ad21 = vAEvaluationCompetenciesDs[20];
                    ad22 = vAEvaluationCompetenciesDs[21];
                    ad23 = vAEvaluationCompetenciesDs[22];
                }
                if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString(((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('"+emp.cemp.CEMPPASSWRD+"', '"+emp.cemp.CEMPNO+"','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '"+ emp.AEvaluationEmp.tot1 + "', "+Convert.ToInt32(emp.AEvaluationEmp.tot4)+") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();

                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "3 " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();

                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);


                }
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
            }

            return View(Records);
        }

        [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public IActionResult Uploadmmmm01(string announce)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            double sumgrade = 0.0;
            List<members> noDups = _context.Members.ToList().GroupBy(d => new { d.announce })
                                  .Where(d => d.Count() >= 1)
                                  .Select(d => d.First())
                                  .ToList();
            ViewData["Cempid1"] = new SelectList(noDups.ToList(), "announce", "announce");
            if (announce == null)
            {
                announce = "2255588";
            }
            TempData["TDFriend100"] = "5";
            TempData["TDFriend1000"] = "5";
            var announce0 = _context.Members.Where(x => x.announce == announce).FirstOrDefault().announce;
            var commit = _context.Members.Where(x => x.announce == announce).FirstOrDefault().commitedescession;
            //List<membersz> membersz = _context.Membersz.Where(x => x.userid == HttpContext.Session.GetString("username") && x.announce == announce).ToList();
            //List<memberszz> memberszz = _context.Memberszz.Where(x => x.userid == HttpContext.Session.GetString("username") && x.announce == announce).ToList();
            List<members> members = _context.Members.Where(X => X.userid != "" && X.username != "" && X.announce == announce0).ToList();
            List<commite> commites = _context.commite.Where(z => z.userid == HttpContext.Session.GetString("username") && z.status == 0 && z.commitedescession == commit && (z.postion == "سكرتير اللجنة "|| z.postion == "رئيس اللجنة")).ToList();
            List<Cemp> cemps = _context.Cemps.ToList();
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail2> EvalDetails2 = _context.EvalDetailss2.ToList();
            List<EvalRequestTypeId2> EvalRequestTypeIds2 = _context.EvalRequestTypeIds2.ToList();
            List<Evalcomment2> evalcommentss = _context.EvalComments2.ToList();
            //
            List<ACourcesType> ACourcesTypes = _context.ACourcesTypes.ToList();
            List<Cemp> Cemps = _context.Cemps.ToList();
            List<ACourcesEstimate> ACourcesEstimates = _context.ACourcesEstimates.ToList();
            List<ACourcesMaster> ACourcesMasters = _context.ACourcesMasters.ToList();
            List<commitez> commitezs = _context.commitez.Where(x=>x.commitedescession==commit&&x.CourcesIdImagecert==announce).ToList();

            // List<ACourcesMaster> ACourcesMasters = _context.ACourcesMasters.Where(e => e.CourcesEndDate.Date >= Convert.ToDateTime(emppro.CEMPLASTUPGRADEHIJRA).Date && e.Cempid == HttpContext.Session.GetString("empid")).ToList();
            List<ACourcesDeptin> ACourcesDeptins = _context.ACourcesDeptins.ToList();
            List<MasterRequestTypeId> MasterRequestTypeIds = _context.MasterRequestTypeIds.ToList();
            List<MasterDetails> MasterDetailss = _context.MasterDetailss.ToList();
            List<ACourcesDeptout> ACourcesDeptouts = _context.ACourcesDeptouts.ToList();
            List<ACourcesTrainingMethod> ACourcesTrainingMethods = _context.ACourcesTrainingMethods.ToList();
            List<ACourcesName> ACourcesNames = _context.ACourcesNames.ToList();
            StringBuilder sb = new StringBuilder();
            StringBuilder sb2 = new StringBuilder();
            StringBuilder sb3 = new StringBuilder();
            StringBuilder sb4 = new StringBuilder();
            StringBuilder sb5 = new StringBuilder();
            sb.Clear();
            sb2.Clear();
            sb3.Clear();
            sb4.Clear();
            sb5.Clear();
            HttpContext.Session.Remove("TDFriend10");
            HttpContext.Session.Remove("TDFriend20");
            HttpContext.Session.Remove("TDFriend30");
            HttpContext.Session.Remove("TDFriend40");
            HttpContext.Session.Remove("TDFriend50");
            HttpContext.Session.Remove("TDFriend6");
            HttpContext.Session.Remove("TDFriend100");
            HttpContext.Session.Remove("TDFriend1000");

            int count1 = 0,count2=0,count3=0,count4=0,count5=0;
            //

            var Records = from e0 in AEvaluationEmps
                              //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                              //from d in table1.ToList()
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()

                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join ff in EvalDetails2 on e0.Idd equals ff.CourcesIdoffered into table4f
                          from ff in table4f.ToList()
<<<<<<< HEAD
                          where ff.OfferedRequestTypeSatus == 1 && e0.CovenantYear==2022
=======
                          where ff.OfferedRequestTypeSatus == 1
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                          //where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                          join hf in EvalRequestTypeIds2 on e0.Idd equals hf.CourcesIdoffered into table5f
                          from hf in table5f.ToList()
                          where hf.OfferedRequestType == 1
                          //join mm in evalcommentss on f.OfferedDetailsSerial equals mm.Offerdetailsid into table6
                          //from mm in table6.ToList()
                          //where mm.Offerdetailsid == f.OfferedDetailsSerial
                          join gg in cemps on e0.Empno equals Convert.ToInt32(gg.Cempid) into table99
                          from gg in table99.ToList()
                          where gg.CEMPPASSWRD.Length == 10
                          join f in members on gg.CEMPPASSWRD equals f.userid into table4
                          from f in table4.Distinct().ToList()
                          where f.status == 1
                          //where (f.OfferedRequestTo == HttpContext.Session.GetString("empid") && f.OfferedRequestTo3 == "0") || (f.OfferedRequestTo2 == HttpContext.Session.GetString("empid") && f.OfferedRequestTo4 == "0") || (f.Offeredoption == HttpContext.Session.GetString("empid") && f.OfferedRequestTo5 == "0")
                          join yy in commites on f.commitedescession equals yy.commitedescession into table555
                          from yy in table555.Distinct().ToList()
                          where yy.status == 0 && yy.commitedescession == commit

                          // from e in ACourcesMasters
                          //join i in ACourcesMasters on gg.Cempid equals i.Cempid into table2
                          //from i in table2.ToList()
                          //    // where i.Cempid == HttpContext.Session.GetString("empid")
                          //where i.CourcesEndDate.Date >= Convert.ToDateTime(gg.CEMPLASTUPGRADEHIJRA).Date && e0.Empno ==Convert.ToInt32( gg.Cempid)

                          //join d in ACourcesTypes on i.CourcesIdType equals d.CourcesIdType into table1
                          //from d in table1.ToList()
                          //join j in ACourcesEstimates on i.CourcesIdEstimate equals j.CourcesIdEstimate into table3
                          //from j in table3.ToList()
                          //join f1 in ACourcesDeptins on i.CourcesIdDeptin equals f1.CourcesIdDeptin into table41
                          //from f1 in table41.ToList()
                          //join h in ACourcesDeptouts on i.CourcesIdDeptout equals h.CourcesIdDeptout into table5
                          //from h in table5.ToList()
                          //join n in ACourcesTrainingMethods on i.CourcesIdTraining equals n.CourcesIdTraining into table6
                          //from n in table6.ToList()
                          //join x in MasterRequestTypeIds on i.CourcesIdmaster equals x.COURCES_IDMASTER into table7
                          //from x in table7.ToList()
                          //where x.MasterRequestType == 1
                          //join y in MasterDetailss on i.CourcesIdmaster equals y.COURCES_IDMASTER into table8
                          //from y in table8.Distinct().ToList()
                          //where y.MasterRequestTypeSatus == 1
                          //where y.MasterRequestTo == HttpContext.Session.GetString("empid") || y.MasterRequestTo2 == HttpContext.Session.GetString("empid")
                          //join z in ACourcesNames on i.CourcesId equals z.CourcesId into table9
                          //from z in table9.ToList()

                          //join h in membersz on e.Cempid equals h.userid into table5
                          //from h in table5.ToList()
                          //where h.status == 0
                          //join y in memberszz on f.announce equals y.announce into table55
                          //from y in table55.Distinct().ToList()
                          //where y.status == 0 && e.Cempid != y.announcetxt && f.commitedescession == y.commitedescession



                          select new ViewModelEvalwithother
                          {
                              cemp = gg,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              member = f,
                              //memberz = h,
                              //memberzz = y,
                              commite = yy,
                              evalDetail2 = ff,
                              evalRequestTypeId2 = hf,
                              AEvaluationEmp = e0,
                              // ACourcesMasters = i,
                              // ACourcesTypes = d,
                              //Cemps = i,
                              //ACourcesEstimates = j,
                              //ACourcesDeptins = f1,
                              //  ACourcesDeptouts = h,
                              // ACourcesTrainingMethods = n,
                              // MasterRequestTypeIds = x,
                              //  MasterDetails = y,
                              // ACourcesNames = z

                          };


            //ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            //viewModelEvalwithother.commite = _context.commite.Where(z => z.userid == HttpContext.Session.GetString("username") && z.status == 0).OrderBy(x => x.id).LastOrDefault();
            //viewModelEvalwithother.members = _context.Members.Where(X => X.status == 0 && X.userid != "" && X.username != "" && X.commitedescession == viewModelEvalwithother.commite.commitedescession).ToList();
            //// add commite
            //List<Cemp> list = new List<Cemp>();
            //for (int i = 0; i < viewModelEvalwithother.members.ToList().Count; i++)
            //{
            //    var tt = new Cemp
            //    {
            //        Cempid = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().Cempid ?? "",
            //        CEMPNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPNAME ?? "",
            //        CEMPPASSWRD = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPPASSWRD ?? "",
            //        CEMPNO = viewModelEvalwithother.members.ElementAt(i).commitedescession.ToString() ?? "",
            //        CEMPPASSWRD1 = viewModelEvalwithother.members.ElementAt(i).announce.ToString() ?? "",
            //        EncryptedId = _protector.Protect(viewModelEvalwithother.members.ElementAt(i).userid.ToString()),
            //        CLSSNO = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CLSSNO ?? "",
            //        grade = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().grade ?? "",
            //        DEP_NAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().DEP_NAME ?? "",
            //        PARENTNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().PARENTNAME ?? "",
            //        CEMPHIRINGDATEHIJRA = Convert.ToDateTime(_context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPHIRINGDATEHIJRA).Date,
            //        CEMPLASTUPGRADEHIJRA = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPLASTUPGRADEHIJRA,
            //        //TaskM10 = HttpContext.Session.GetString("empid")
            //    };
            //    list.Add(tt);
            //}
            //viewModelEvalwithother.cemps = list;

            foreach (var emp in Records.ToList())
            {
                var stringId = emp.cemp.Cempid.ToString();
                emp.cemp.EncryptedId = _protector.Protect(stringId);


                string ann = _context.commitez.Where(x => x.userid == emp.cemp.Cempid&&x.commitedescession== commit&&x.CourcesIdImagecert == announce).FirstOrDefault().CourcesIdImagecert;
                var res = from l in _context.commitez.Where(x => x.userid == emp.cemp.Cempid && x.commitedescession == commit && x.CourcesIdImagecert == announce).ToList() group l by new { l.userentry } into g select new { g.Key.userentry, value = g.Distinct().Count() };
                int n2 = 0;
                foreach (var item in res)
                {
                    Console.WriteLine(item.userentry + " " + item.value);
                    n2++;
                }
                if (_context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "رئيس اللجنة").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault()!=null)
                {
                    emp.cemp.tot1 = _context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "رئيس اللجنة").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault().status;

                }
                 if (_context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "نائب رئيس اللجنة").FirstOrDefault().userid&& z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault() != null)
                {
                    emp.cemp.tot2 = _context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "نائب رئيس اللجنة").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault().status;
                }
                 if (_context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة1").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault() != null)
                {
                    emp.cemp.tot3 = _context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة1").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault().status;
                }
                 if (_context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة2").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault() != null)
                {
                    emp.cemp.tot4 = _context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة2").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault().status;
                }
                 if (_context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة3").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault() != null)
                {
                    emp.cemp.tot5 = _context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة3").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault().status;
                }
                emp.cemp.tot6 =(Convert.ToDecimal(emp.cemp.tot5) + Convert.ToDecimal( emp.cemp.tot4) + Convert.ToDecimal( emp.cemp.tot3) + Convert.ToDecimal( emp.cemp.tot2) + Convert.ToDecimal(emp.cemp.tot1)) / n2;
                if (emp.cemp.tot6 >= 100)
                {
                    //TempData["sumgrade"] = "100.00";
                    emp.cemp.tot6 = 100;

                }
                else
                {
                    // TempData["sumgrade"] = sumgrade;
                    emp.cemp.tot6 = emp.cemp.tot6;
                }
                if (emp.cemp.tot1 == null)
                {
                    sb.Append(emp.cemp.CEMPNAME.ToString()+',');
                    //TempData["TDFriend1"] = sb.ToString() ;
                    count1++;
                }
                TempData["TDFriend10"] = count1;
                TempData["TDFriend100"] = count1;
                if (emp.cemp.tot2 == null)
                {
                    sb2.Append(emp.cemp.CEMPNAME.ToString() + ',');
                    //TempData["TDFriend2"] = sb2.ToString();
                    count2++;
                }
                TempData["TDFriend20"] = count2;
                TempData["TDFriend1000"] = count2;
                if (emp.cemp.tot3 == null)
                {
                    sb3.Append(emp.cemp.CEMPNAME.ToString() + ',');
                    //TempData["TDFriend3"] = sb3.ToString();
                    count3++;
                }
                TempData["TDFriend30"] = count3;
                if (emp.cemp.tot4 == null)
                {
                    sb4.Append(emp.cemp.CEMPNAME.ToString() + ',');
                    //TempData["TDFriend4"] = sb4.ToString();
                    count4++;
                }
                TempData["TDFriend40"] = count4;
                if (emp.cemp.tot5 == null)
                {
                    sb5.Append(emp.cemp.CEMPNAME.ToString() + ',');
                    //TempData["TDFriend5"] = sb5.ToString();
                    count5++;
                }
                TempData["TDFriend50"] = count5;
                TempData["TDFriend6"] = ann;
                sumgrade = 0.0;
                ACourcesMasters = _context.ACourcesMasters.Where(e => e.CourcesEndDate.Date >= Convert.ToDateTime(emp.cemp.CEMPLASTUPGRADEHIJRA).Date&&e.CourcesEndDate.Date<=(_context.Members.Where(x => x.announce == announce).FirstOrDefault().dateexcute1.Value.Date) && e.Cempid == emp.cemp.Cempid).ToList();
                foreach (var emp0 in ACourcesMasters.ToList())
                {
                    if (_context.MasterRequestTypeIds.Where(z => z.COURCES_IDMASTER == emp0.CourcesIdmaster && z.MasterRequestType == 1).FirstOrDefault() != null)
                    {
                        if (emp0.CourcesIdType == 1)
                        {
                            if (emp0.CourcesIdType == 1 && emp0.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                            {
                                emp0.gradetocourse = 40.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 1 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                            {

                                emp0.gradetocourse = 30.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }
                        else if (emp0.CourcesIdType == 2)
                        {
                            if (emp0.CourcesIdType == 2 && emp0.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                            {
                                emp0.gradetocourse = 80.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 2 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                            {
                                emp0.gradetocourse = 60.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 2 && emp0.COURCES_EXCUTION.Equals("جهة تدريب بالقطاع الخاص"))
                            {
                                emp0.gradetocourse = 40.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }
                        else if (emp0.CourcesIdType == 3)
                        {
                            if (emp0.CourcesIdType == 3 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                            {
                                emp0.gradetocourse = 1.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }
                        else if (emp0.CourcesIdType == 4 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {

                            if (emp0.CourcesIdType == 4 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && emp0.CourcesIdEstimate == 1)
                            {
                                emp0.gradetocourse = 50.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 4 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && emp0.CourcesIdEstimate == 2)
                            {
                                emp0.gradetocourse = 25.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }

                    }

                    //emp.gradetocourse0 = sumgrade;


                }
                if (sumgrade >= 100.00)
                {
                    //TempData["sumgrade"] = "100.00";
                    emp.cemp.cbrowser = "100";

                }
                else
                {
                    // TempData["sumgrade"] = sumgrade;
                    emp.cemp.cbrowser = sumgrade.ToString();
                }
<<<<<<< HEAD
                var emp01 = _context.AEvaluationEmps.Where(x => x.Empno == emp.AEvaluationEmp.Empno) /*&&(x.year=="2021")*/.OrderBy(x => x.Idd).LastOrDefault();
                if (emp01 != null)
                {
                    // check eval approved  for last year 2022 or go to previous year 
                    var approval = _context.EvalDetailss2.Where(x => x.CourcesIdoffered == emp01.Idd && x.OfferedRequestTypeSatus == 1).FirstOrDefault();
                    if (approval != null)
                    {
                        List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp01.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                        av1 = vAEvaluationGoals[0];
                        av2 = vAEvaluationGoals[1];
                        av3 = vAEvaluationGoals[2];
                        av4 = vAEvaluationGoals[3];
                        if (vAEvaluationGoals.Count > 4)
                        {
                            av5 = vAEvaluationGoals[4];

                        }
                        if (vAEvaluationGoals.Count > 5)
                        {
                            av6 = vAEvaluationGoals[5];
                        }
                        List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp01.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                        am1 = vAEvaluationCompetenciesMs[0];
                        am2 = vAEvaluationCompetenciesMs[1];
                        am3 = vAEvaluationCompetenciesMs[2];
                        am4 = vAEvaluationCompetenciesMs[3];
                        am5 = vAEvaluationCompetenciesMs[4];
                        am6 = vAEvaluationCompetenciesMs[5];
                        if (vAEvaluationCompetenciesMs.Count > 6)
                        {

                            am7 = vAEvaluationCompetenciesMs[6];
                        }

                        List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp01.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                        ad1 = vAEvaluationCompetenciesDs[0];
                        ad2 = vAEvaluationCompetenciesDs[1];
                        ad3 = vAEvaluationCompetenciesDs[2];
                        ad4 = vAEvaluationCompetenciesDs[3];
                        ad5 = vAEvaluationCompetenciesDs[4];
                        ad6 = vAEvaluationCompetenciesDs[5];
                        ad7 = vAEvaluationCompetenciesDs[6];
                        ad8 = vAEvaluationCompetenciesDs[7];
                        ad9 = vAEvaluationCompetenciesDs[8];
                        ad10 = vAEvaluationCompetenciesDs[9];
                        ad11 = vAEvaluationCompetenciesDs[10];
                        ad12 = vAEvaluationCompetenciesDs[11];
                        ad13 = vAEvaluationCompetenciesDs[12];
                        ad14 = vAEvaluationCompetenciesDs[13];
                        ad15 = vAEvaluationCompetenciesDs[14];
                        ad16 = vAEvaluationCompetenciesDs[15];
                        ad17 = vAEvaluationCompetenciesDs[16];
                        ad18 = vAEvaluationCompetenciesDs[17];
                        if (vAEvaluationCompetenciesDs.Count > 18)
                        {

                            ad19 = vAEvaluationCompetenciesDs[18];
                            ad20 = vAEvaluationCompetenciesDs[19];
                            ad21 = vAEvaluationCompetenciesDs[20];
                            ad22 = vAEvaluationCompetenciesDs[21];
                            ad23 = vAEvaluationCompetenciesDs[22];
                        }
                        if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString(((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('"+emp.cemp.CEMPPASSWRD+"', '"+emp.cemp.CEMPNO+"','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '"+ emp.AEvaluationEmp.tot1 + "', "+Convert.ToInt32(emp.AEvaluationEmp.tot4)+") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();

                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "3 " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                             ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                             ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                             ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();

                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                     ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                     ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                     ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                      ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                      ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                      ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                              ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                              ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                              ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";

                            emp.cemp.tot7 = Convert.ToDecimal(emp.AEvaluationEmp.tot3) * 30 / 100 + Convert.ToDecimal(emp.cemp.cbrowser) * 30 / 100 + Convert.ToDecimal(emp.cemp.tot6) * 40 / 100;

                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);


                        }
                        emp.cemp.tot7 = Convert.ToDecimal(emp.AEvaluationEmp.tot3) * 30 / 100 + Convert.ToDecimal(emp.cemp.cbrowser) * 30 / 100 + Convert.ToDecimal(emp.cemp.tot6) * 40 / 100;

                    }
                    else
                    {
                        // aeval 2021 calc 
                        var emp021 = _context.AEvaluationEmps.Where(x => x.Empno == emp.AEvaluationEmp.Empno && x.year == "2021").FirstOrDefault();
                        if (emp021 != null)
                        {
                            var approval021 = _context.EvalDetailss2.Where(x => x.CourcesIdoffered == emp021.Idd && x.OfferedRequestTypeSatus == 1).FirstOrDefault();
                            if (approval021 != null)
                            {
                                var approvalseial = _context.EvalDetailss2.Where(x => x.CourcesIdoffered == emp021.Idd).FirstOrDefault();
                                var approveddate = _context.EvalComments2.Where(x => x.Offerdetailsid == approvalseial.OfferedDetailsSerial).FirstOrDefault();
                                List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp021.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                                av1 = vAEvaluationGoals[0];
                                av2 = vAEvaluationGoals[1];
                                av3 = vAEvaluationGoals[2];
                                av4 = vAEvaluationGoals[3];
                                if (vAEvaluationGoals.Count > 4)
                                {
                                    av5 = vAEvaluationGoals[4];

                                }
                                if (vAEvaluationGoals.Count > 5)
                                {
                                    av6 = vAEvaluationGoals[5];
                                }
                                List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp021.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                                am1 = vAEvaluationCompetenciesMs[0];
                                am2 = vAEvaluationCompetenciesMs[1];
                                am3 = vAEvaluationCompetenciesMs[2];
                                am4 = vAEvaluationCompetenciesMs[3];
                                am5 = vAEvaluationCompetenciesMs[4];
                                am6 = vAEvaluationCompetenciesMs[5];
                                if (vAEvaluationCompetenciesMs.Count > 6)
                                {

                                    am7 = vAEvaluationCompetenciesMs[6];
                                }

                                List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp021.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                                ad1 = vAEvaluationCompetenciesDs[0];
                                ad2 = vAEvaluationCompetenciesDs[1];
                                ad3 = vAEvaluationCompetenciesDs[2];
                                ad4 = vAEvaluationCompetenciesDs[3];
                                ad5 = vAEvaluationCompetenciesDs[4];
                                ad6 = vAEvaluationCompetenciesDs[5];
                                ad7 = vAEvaluationCompetenciesDs[6];
                                ad8 = vAEvaluationCompetenciesDs[7];
                                ad9 = vAEvaluationCompetenciesDs[8];
                                ad10 = vAEvaluationCompetenciesDs[9];
                                ad11 = vAEvaluationCompetenciesDs[10];
                                ad12 = vAEvaluationCompetenciesDs[11];
                                ad13 = vAEvaluationCompetenciesDs[12];
                                ad14 = vAEvaluationCompetenciesDs[13];
                                ad15 = vAEvaluationCompetenciesDs[14];
                                ad16 = vAEvaluationCompetenciesDs[15];
                                ad17 = vAEvaluationCompetenciesDs[16];
                                ad18 = vAEvaluationCompetenciesDs[17];
                                if (vAEvaluationCompetenciesDs.Count > 18)
                                {

                                    ad19 = vAEvaluationCompetenciesDs[18];
                                    ad20 = vAEvaluationCompetenciesDs[19];
                                    ad21 = vAEvaluationCompetenciesDs[20];
                                    ad22 = vAEvaluationCompetenciesDs[21];
                                    ad23 = vAEvaluationCompetenciesDs[22];
                                }
                                if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString(((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('"+emp.cemp.CEMPPASSWRD+"', '"+emp.cemp.CEMPNO+"','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '"+ emp.AEvaluationEmp.tot1 + "', "+Convert.ToInt32(emp.AEvaluationEmp.tot4)+") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();

                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "3 " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();

                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);


                                }
                                emp.cemp.tot7 = Convert.ToDecimal(emp.AEvaluationEmp.tot3) * 30 / 100 + Convert.ToDecimal(emp.cemp.cbrowser) * 30 / 100 + Convert.ToDecimal(emp.cemp.tot6) * 40 / 100;

                            }
                            else
                            {
                                ViewBag.mesg = "ليس لديك طلب تقييم معتمد للعام الحالي او  العام 2021  .";
                            }

                        }
                        else
                        {
                            ViewBag.mesg = "ليس لديك طلب تقييم معتمد للعام  2021  .";
                        }
                    }
                }
                else
                {
                    ViewBag.mesg = "لايوجد طلبات تقييم للاداء مرفوعة علي النظام    .";
                }

=======
                // emp.gradetocourse0 = sumgrade;
                // emp.cemp.cbrowser = sumgrade.ToString();
                //emp.ACourcesMasters.gradetocourse0 = sumgrade;
                List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                av1 = vAEvaluationGoals[0];
                av2 = vAEvaluationGoals[1];
                av3 = vAEvaluationGoals[2];
                av4 = vAEvaluationGoals[3];
                if (vAEvaluationGoals.Count > 4)
                {
                    av5 = vAEvaluationGoals[4];

                }
                if (vAEvaluationGoals.Count > 5)
                {
                    av6 = vAEvaluationGoals[5];
                }
                List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                am1 = vAEvaluationCompetenciesMs[0];
                am2 = vAEvaluationCompetenciesMs[1];
                am3 = vAEvaluationCompetenciesMs[2];
                am4 = vAEvaluationCompetenciesMs[3];
                am5 = vAEvaluationCompetenciesMs[4];
                am6 = vAEvaluationCompetenciesMs[5];
                if (vAEvaluationCompetenciesMs.Count > 6)
                {

                    am7 = vAEvaluationCompetenciesMs[6];
                }

                List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                ad1 = vAEvaluationCompetenciesDs[0];
                ad2 = vAEvaluationCompetenciesDs[1];
                ad3 = vAEvaluationCompetenciesDs[2];
                ad4 = vAEvaluationCompetenciesDs[3];
                ad5 = vAEvaluationCompetenciesDs[4];
                ad6 = vAEvaluationCompetenciesDs[5];
                ad7 = vAEvaluationCompetenciesDs[6];
                ad8 = vAEvaluationCompetenciesDs[7];
                ad9 = vAEvaluationCompetenciesDs[8];
                ad10 = vAEvaluationCompetenciesDs[9];
                ad11 = vAEvaluationCompetenciesDs[10];
                ad12 = vAEvaluationCompetenciesDs[11];
                ad13 = vAEvaluationCompetenciesDs[12];
                ad14 = vAEvaluationCompetenciesDs[13];
                ad15 = vAEvaluationCompetenciesDs[14];
                ad16 = vAEvaluationCompetenciesDs[15];
                ad17 = vAEvaluationCompetenciesDs[16];
                ad18 = vAEvaluationCompetenciesDs[17];
                if (vAEvaluationCompetenciesDs.Count > 18)
                {

                    ad19 = vAEvaluationCompetenciesDs[18];
                    ad20 = vAEvaluationCompetenciesDs[19];
                    ad21 = vAEvaluationCompetenciesDs[20];
                    ad22 = vAEvaluationCompetenciesDs[21];
                    ad23 = vAEvaluationCompetenciesDs[22];
                }
                if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString(((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('"+emp.cemp.CEMPPASSWRD+"', '"+emp.cemp.CEMPNO+"','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '"+ emp.AEvaluationEmp.tot1 + "', "+Convert.ToInt32(emp.AEvaluationEmp.tot4)+") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();

                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "3 " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();

                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);


                }

                emp.cemp.tot7 = Convert.ToDecimal(emp.AEvaluationEmp.tot3) * 30 / 100 + Convert.ToDecimal(emp.cemp.cbrowser) * 30 / 100 + Convert.ToDecimal(emp.cemp.tot6) * 40 / 100;
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
            }

            return View(Records);
        }
        [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public IActionResult Uploadmmmm010(string announce)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            double sumgrade = 0.0;
            List<members> noDups = _context.Members.ToList().GroupBy(d => new { d.announce })
                                  .Where(d => d.Count() >= 1)
                                  .Select(d => d.First())
                                  .ToList();
            ViewData["Cempid1"] = new SelectList(noDups.ToList(), "announce", "announce");
            if (announce == null)
            {
                announce = "2255588";
            }
            var announce0 = _context.Members.Where(x => x.announce == announce).FirstOrDefault().announce;
            var commit = _context.Members.Where(x => x.announce == announce).FirstOrDefault().commitedescession;
            //List<membersz> membersz = _context.Membersz.Where(x => x.userid == HttpContext.Session.GetString("username") && x.announce == announce).ToList();
            //List<memberszz> memberszz = _context.Memberszz.Where(x => x.userid == HttpContext.Session.GetString("username") && x.announce == announce).ToList();
            List<members> members = _context.Members.Where(X => X.userid != "" && X.username != "" && X.announce == announce0).ToList();
            List<commite> commites = _context.commite.Where(z => z.userid == HttpContext.Session.GetString("username") && z.status == 0 && z.commitedescession == commit && (z.postion == "سكرتير اللجنة ")).ToList();
            List<Cemp> cemps = _context.Cemps.ToList();
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail2> EvalDetails2 = _context.EvalDetailss2.ToList();
            List<EvalRequestTypeId2> EvalRequestTypeIds2 = _context.EvalRequestTypeIds2.ToList();
            List<Evalcomment2> evalcommentss = _context.EvalComments2.ToList();
            //
            List<ACourcesType> ACourcesTypes = _context.ACourcesTypes.ToList();
            List<Cemp> Cemps = _context.Cemps.ToList();
            List<ACourcesEstimate> ACourcesEstimates = _context.ACourcesEstimates.ToList();
            List<ACourcesMaster> ACourcesMasters = _context.ACourcesMasters.ToList();
            List<commitez> commitezs = _context.commitez.Where(x => x.commitedescession == commit && x.CourcesIdImagecert == announce).ToList();

            // List<ACourcesMaster> ACourcesMasters = _context.ACourcesMasters.Where(e => e.CourcesEndDate.Date >= Convert.ToDateTime(emppro.CEMPLASTUPGRADEHIJRA).Date && e.Cempid == HttpContext.Session.GetString("empid")).ToList();
            List<ACourcesDeptin> ACourcesDeptins = _context.ACourcesDeptins.ToList();
            List<MasterRequestTypeId> MasterRequestTypeIds = _context.MasterRequestTypeIds.ToList();
            List<MasterDetails> MasterDetailss = _context.MasterDetailss.ToList();
            List<ACourcesDeptout> ACourcesDeptouts = _context.ACourcesDeptouts.ToList();
            List<ACourcesTrainingMethod> ACourcesTrainingMethods = _context.ACourcesTrainingMethods.ToList();
            List<ACourcesName> ACourcesNames = _context.ACourcesNames.ToList();
            StringBuilder sb = new StringBuilder();
            StringBuilder sb2 = new StringBuilder();
            StringBuilder sb3 = new StringBuilder();
            StringBuilder sb4 = new StringBuilder();
            StringBuilder sb5 = new StringBuilder();
            sb.Clear();
            sb2.Clear();
            sb3.Clear();
            sb4.Clear();
            sb5.Clear();
            int count1 = 0, count2 = 0, count3 = 0, count4 = 0, count5 = 0;
            //

            var Records = from e0 in AEvaluationEmps
                              //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                              //from d in table1.ToList()
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()

                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join ff in EvalDetails2 on e0.Idd equals ff.CourcesIdoffered into table4f
                          from ff in table4f.ToList()
<<<<<<< HEAD
                          where ff.OfferedRequestTypeSatus == 1 && e0.CovenantYear==2022
=======
                          where ff.OfferedRequestTypeSatus == 1
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                          //where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                          join hf in EvalRequestTypeIds2 on e0.Idd equals hf.CourcesIdoffered into table5f
                          from hf in table5f.ToList()
                          where hf.OfferedRequestType == 1
                          //join mm in evalcommentss on f.OfferedDetailsSerial equals mm.Offerdetailsid into table6
                          //from mm in table6.ToList()
                          //where mm.Offerdetailsid == f.OfferedDetailsSerial
                          join gg in cemps on e0.Empno equals Convert.ToInt32(gg.Cempid) into table99
                          from gg in table99.ToList()
                          where gg.CEMPPASSWRD.Length == 10
                          join f in members on gg.CEMPPASSWRD equals f.userid into table4
                          from f in table4.Distinct().ToList()
                          where f.status == 1
                          //where (f.OfferedRequestTo == HttpContext.Session.GetString("empid") && f.OfferedRequestTo3 == "0") || (f.OfferedRequestTo2 == HttpContext.Session.GetString("empid") && f.OfferedRequestTo4 == "0") || (f.Offeredoption == HttpContext.Session.GetString("empid") && f.OfferedRequestTo5 == "0")
                          join yy in commites on f.commitedescession equals yy.commitedescession into table555
                          from yy in table555.Distinct().ToList()
                          where yy.status == 0 && yy.commitedescession == commit

                          // from e in ACourcesMasters
                          //join i in ACourcesMasters on gg.Cempid equals i.Cempid into table2
                          //from i in table2.ToList()
                          //    // where i.Cempid == HttpContext.Session.GetString("empid")
                          //where i.CourcesEndDate.Date >= Convert.ToDateTime(gg.CEMPLASTUPGRADEHIJRA).Date && e0.Empno ==Convert.ToInt32( gg.Cempid)

                          //join d in ACourcesTypes on i.CourcesIdType equals d.CourcesIdType into table1
                          //from d in table1.ToList()
                          //join j in ACourcesEstimates on i.CourcesIdEstimate equals j.CourcesIdEstimate into table3
                          //from j in table3.ToList()
                          //join f1 in ACourcesDeptins on i.CourcesIdDeptin equals f1.CourcesIdDeptin into table41
                          //from f1 in table41.ToList()
                          //join h in ACourcesDeptouts on i.CourcesIdDeptout equals h.CourcesIdDeptout into table5
                          //from h in table5.ToList()
                          //join n in ACourcesTrainingMethods on i.CourcesIdTraining equals n.CourcesIdTraining into table6
                          //from n in table6.ToList()
                          //join x in MasterRequestTypeIds on i.CourcesIdmaster equals x.COURCES_IDMASTER into table7
                          //from x in table7.ToList()
                          //where x.MasterRequestType == 1
                          //join y in MasterDetailss on i.CourcesIdmaster equals y.COURCES_IDMASTER into table8
                          //from y in table8.Distinct().ToList()
                          //where y.MasterRequestTypeSatus == 1
                          //where y.MasterRequestTo == HttpContext.Session.GetString("empid") || y.MasterRequestTo2 == HttpContext.Session.GetString("empid")
                          //join z in ACourcesNames on i.CourcesId equals z.CourcesId into table9
                          //from z in table9.ToList()

                          //join h in membersz on e.Cempid equals h.userid into table5
                          //from h in table5.ToList()
                          //where h.status == 0
                          //join y in memberszz on f.announce equals y.announce into table55
                          //from y in table55.Distinct().ToList()
                          //where y.status == 0 && e.Cempid != y.announcetxt && f.commitedescession == y.commitedescession



                          select new ViewModelEvalwithother
                          {
                              cemp = gg,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              member = f,
                              //memberz = h,
                              //memberzz = y,
                              commite = yy,
                              evalDetail2 = ff,
                              evalRequestTypeId2 = hf,
                              AEvaluationEmp = e0,
                              // ACourcesMasters = i,
                              // ACourcesTypes = d,
                              //Cemps = i,
                              //ACourcesEstimates = j,
                              //ACourcesDeptins = f1,
                              //  ACourcesDeptouts = h,
                              // ACourcesTrainingMethods = n,
                              // MasterRequestTypeIds = x,
                              //  MasterDetails = y,
                              // ACourcesNames = z

                          };


            //ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            //viewModelEvalwithother.commite = _context.commite.Where(z => z.userid == HttpContext.Session.GetString("username") && z.status == 0).OrderBy(x => x.id).LastOrDefault();
            //viewModelEvalwithother.members = _context.Members.Where(X => X.status == 0 && X.userid != "" && X.username != "" && X.commitedescession == viewModelEvalwithother.commite.commitedescession).ToList();
            //// add commite
            //List<Cemp> list = new List<Cemp>();
            //for (int i = 0; i < viewModelEvalwithother.members.ToList().Count; i++)
            //{
            //    var tt = new Cemp
            //    {
            //        Cempid = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().Cempid ?? "",
            //        CEMPNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPNAME ?? "",
            //        CEMPPASSWRD = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPPASSWRD ?? "",
            //        CEMPNO = viewModelEvalwithother.members.ElementAt(i).commitedescession.ToString() ?? "",
            //        CEMPPASSWRD1 = viewModelEvalwithother.members.ElementAt(i).announce.ToString() ?? "",
            //        EncryptedId = _protector.Protect(viewModelEvalwithother.members.ElementAt(i).userid.ToString()),
            //        CLSSNO = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CLSSNO ?? "",
            //        grade = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().grade ?? "",
            //        DEP_NAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().DEP_NAME ?? "",
            //        PARENTNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().PARENTNAME ?? "",
            //        CEMPHIRINGDATEHIJRA = Convert.ToDateTime(_context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPHIRINGDATEHIJRA).Date,
            //        CEMPLASTUPGRADEHIJRA = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPLASTUPGRADEHIJRA,
            //        //TaskM10 = HttpContext.Session.GetString("empid")
            //    };
            //    list.Add(tt);
            //}
            //viewModelEvalwithother.cemps = list;

            foreach (var emp in Records.ToList())
            {
                var stringId = emp.cemp.Cempid.ToString();
                emp.cemp.EncryptedId = _protector.Protect(stringId);


                int n = _context.commitez.Where(x => x.userid == emp.cemp.Cempid && x.commitedescession == commit && x.CourcesIdImagecert == announce).ToList().Count;
                int n0 = _context.commitez.ToList().GroupBy(d => d.userentry, dd => dd.userid == emp.cemp.Cempid && dd.CourcesIdImagecert == announce)
                                  .Where(d => d.Count() >= 1)
                                  .Select(d => d.First())
                                  .ToList().Count;
                var res = from l in _context.commitez.Where(x => x.userid == emp.cemp.Cempid && x.commitedescession == commit && x.CourcesIdImagecert == announce).ToList() group l by new { l.userentry } into g select new { g.Key.userentry, value = g.Distinct().Count() };
                int n2 = 0;
                foreach (var item in res)
                {
                    Console.WriteLine(item.userentry + " " + item.value);
                    n2++;
                }
                if (_context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "رئيس اللجنة").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault() != null)
                {
                    emp.cemp.tot1 = _context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "رئيس اللجنة").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault().status;

                }
                if (_context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "نائب رئيس اللجنة").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault() != null)
                {
                    emp.cemp.tot2 = _context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "نائب رئيس اللجنة").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault().status;
                }
                if (_context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة1").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault() != null)
                {
                    emp.cemp.tot3 = _context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة1").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault().status;
                }
                if (_context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة2").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault() != null)
                {
                    emp.cemp.tot4 = _context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة2").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault().status;
                }
                if (_context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة3").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault() != null)
                {
                    emp.cemp.tot5 = _context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة3").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault().status;
                }
                emp.cemp.tot6 = (Convert.ToDecimal(emp.cemp.tot5) + Convert.ToDecimal(emp.cemp.tot4) + Convert.ToDecimal(emp.cemp.tot3) + Convert.ToDecimal(emp.cemp.tot2) + Convert.ToDecimal(emp.cemp.tot1)) / n2;
                if (emp.cemp.tot6 >= 100)
                {
                    //TempData["sumgrade"] = "100.00";
                    emp.cemp.tot6 = 100;

                }
                else
                {
                    // TempData["sumgrade"] = sumgrade;
                    emp.cemp.tot6 = emp.cemp.tot6;
                }
                if (emp.cemp.tot1 == null)
                {
                    sb.Append(emp.cemp.CEMPNAME.ToString() + ',');
                    //TempData["TDFriend1"] = sb.ToString();
                    count1++;
                }
                //TempData["TDFriend10"] = count1;
                if (emp.cemp.tot2 == null)
                {
                    sb2.Append(emp.cemp.CEMPNAME.ToString() + ',');
                    //TempData["TDFriend2"] = sb2.ToString();
                    count2++;
                }
                //TempData["TDFriend20"] = count2;
                if (emp.cemp.tot3 == null)
                {
                    sb3.Append(emp.cemp.CEMPNAME.ToString() + ',');
                    //TempData["TDFriend3"] = sb3.ToString();
                    count3++;
                }
                //TempData["TDFriend30"] = count3;
                if (emp.cemp.tot4 == null)
                {
                    sb4.Append(emp.cemp.CEMPNAME.ToString() + ',');
                    //TempData["TDFriend4"] = sb4.ToString();
                    count4++;
                }
                //TempData["TDFriend40"] = count4;
                if (emp.cemp.tot5 == null)
                {
                    sb5.Append(emp.cemp.CEMPNAME.ToString() + ',');
                    //TempData["TDFriend5"] = sb5.ToString();
                    count5++;
                }
                //TempData["TDFriend50"] = count5;
                sumgrade = 0.0;
                ACourcesMasters = _context.ACourcesMasters.Where(e => e.CourcesEndDate.Date >= Convert.ToDateTime(emp.cemp.CEMPLASTUPGRADEHIJRA).Date && e.CourcesEndDate.Date <= (_context.Members.Where(x => x.announce == announce).FirstOrDefault().dateexcute1.Value.Date) && e.Cempid == emp.cemp.Cempid).ToList();
                foreach (var emp0 in ACourcesMasters.ToList())
                {
                    if (_context.MasterRequestTypeIds.Where(z => z.COURCES_IDMASTER == emp0.CourcesIdmaster && z.MasterRequestType == 1).FirstOrDefault() != null)
                    {
                        if (emp0.CourcesIdType == 1)
                        {
                            if (emp0.CourcesIdType == 1 && emp0.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                            {
                                emp0.gradetocourse = 40.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 1 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                            {

                                emp0.gradetocourse = 30.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }
                        else if (emp0.CourcesIdType == 2)
                        {
                            if (emp0.CourcesIdType == 2 && emp0.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                            {
                                emp0.gradetocourse = 80.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 2 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                            {
                                emp0.gradetocourse = 60.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 2 && emp0.COURCES_EXCUTION.Equals("جهة تدريب بالقطاع الخاص"))
                            {
                                emp0.gradetocourse = 40.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }
                        else if (emp0.CourcesIdType == 3)
                        {
                            if (emp0.CourcesIdType == 3 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                            {
                                emp0.gradetocourse = 1.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }
                        else if (emp0.CourcesIdType == 4 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {

                            if (emp0.CourcesIdType == 4 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && emp0.CourcesIdEstimate == 1)
                            {
                                emp0.gradetocourse = 50.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 4 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && emp0.CourcesIdEstimate == 2)
                            {
                                emp0.gradetocourse = 25.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }

                    }

                    //emp.gradetocourse0 = sumgrade;


                }
                if (sumgrade >= 100.00)
                {
                    //TempData["sumgrade"] = "100.00";
                    emp.cemp.cbrowser = "100";

                }
                else
                {
                    // TempData["sumgrade"] = sumgrade;
                    emp.cemp.cbrowser = sumgrade.ToString();
                }
                // emp.gradetocourse0 = sumgrade;
                // emp.cemp.cbrowser = sumgrade.ToString();
                //emp.ACourcesMasters.gradetocourse0 = sumgrade;
<<<<<<< HEAD
                var emp01 = _context.AEvaluationEmps.Where(x => x.Empno == emp.AEvaluationEmp.Empno) /*&&(x.year=="2021")*/.OrderBy(x => x.Idd).LastOrDefault();
                if (emp01 != null)
                {
                    // check eval approved  for last year 2022 or go to previous year 
                    var approval = _context.EvalDetailss2.Where(x => x.CourcesIdoffered == emp01.Idd && x.OfferedRequestTypeSatus == 1).FirstOrDefault();
                    if (approval != null)
                    {
                        List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp01.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                        av1 = vAEvaluationGoals[0];
                        av2 = vAEvaluationGoals[1];
                        av3 = vAEvaluationGoals[2];
                        av4 = vAEvaluationGoals[3];
                        if (vAEvaluationGoals.Count > 4)
                        {
                            av5 = vAEvaluationGoals[4];

                        }
                        if (vAEvaluationGoals.Count > 5)
                        {
                            av6 = vAEvaluationGoals[5];
                        }
                        List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp01.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                        am1 = vAEvaluationCompetenciesMs[0];
                        am2 = vAEvaluationCompetenciesMs[1];
                        am3 = vAEvaluationCompetenciesMs[2];
                        am4 = vAEvaluationCompetenciesMs[3];
                        am5 = vAEvaluationCompetenciesMs[4];
                        am6 = vAEvaluationCompetenciesMs[5];
                        if (vAEvaluationCompetenciesMs.Count > 6)
                        {

                            am7 = vAEvaluationCompetenciesMs[6];
                        }

                        List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp01.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                        ad1 = vAEvaluationCompetenciesDs[0];
                        ad2 = vAEvaluationCompetenciesDs[1];
                        ad3 = vAEvaluationCompetenciesDs[2];
                        ad4 = vAEvaluationCompetenciesDs[3];
                        ad5 = vAEvaluationCompetenciesDs[4];
                        ad6 = vAEvaluationCompetenciesDs[5];
                        ad7 = vAEvaluationCompetenciesDs[6];
                        ad8 = vAEvaluationCompetenciesDs[7];
                        ad9 = vAEvaluationCompetenciesDs[8];
                        ad10 = vAEvaluationCompetenciesDs[9];
                        ad11 = vAEvaluationCompetenciesDs[10];
                        ad12 = vAEvaluationCompetenciesDs[11];
                        ad13 = vAEvaluationCompetenciesDs[12];
                        ad14 = vAEvaluationCompetenciesDs[13];
                        ad15 = vAEvaluationCompetenciesDs[14];
                        ad16 = vAEvaluationCompetenciesDs[15];
                        ad17 = vAEvaluationCompetenciesDs[16];
                        ad18 = vAEvaluationCompetenciesDs[17];
                        if (vAEvaluationCompetenciesDs.Count > 18)
                        {

                            ad19 = vAEvaluationCompetenciesDs[18];
                            ad20 = vAEvaluationCompetenciesDs[19];
                            ad21 = vAEvaluationCompetenciesDs[20];
                            ad22 = vAEvaluationCompetenciesDs[21];
                            ad23 = vAEvaluationCompetenciesDs[22];
                        }
                        if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString(((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('"+emp.cemp.CEMPPASSWRD+"', '"+emp.cemp.CEMPNO+"','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '"+ emp.AEvaluationEmp.tot1 + "', "+Convert.ToInt32(emp.AEvaluationEmp.tot4)+") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();

                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "3 " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                             ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                             ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                             ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();

                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                     ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                     ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                     ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                      ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                      ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                      ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                              ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                              ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                              ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);


                        }
                        emp.cemp.tot7 = Convert.ToDecimal(emp.AEvaluationEmp.tot3) * 30 / 100 + Convert.ToDecimal(emp.cemp.cbrowser) * 30 / 100 + Convert.ToDecimal(emp.cemp.tot6) * 40 / 100;

                    }
                    else
                    {
                        // aeval 2021 calc 
                        var emp021 = _context.AEvaluationEmps.Where(x => x.Empno == emp.AEvaluationEmp.Empno && x.year == "2021").FirstOrDefault();
                        if (emp021 != null)
                        {
                            var approval021 = _context.EvalDetailss2.Where(x => x.CourcesIdoffered == emp021.Idd && x.OfferedRequestTypeSatus == 1).FirstOrDefault();
                            if (approval021 != null)
                            {
                                var approvalseial = _context.EvalDetailss2.Where(x => x.CourcesIdoffered == emp021.Idd).FirstOrDefault();
                                var approveddate = _context.EvalComments2.Where(x => x.Offerdetailsid == approvalseial.OfferedDetailsSerial).FirstOrDefault();
                                List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp021.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                                av1 = vAEvaluationGoals[0];
                                av2 = vAEvaluationGoals[1];
                                av3 = vAEvaluationGoals[2];
                                av4 = vAEvaluationGoals[3];
                                if (vAEvaluationGoals.Count > 4)
                                {
                                    av5 = vAEvaluationGoals[4];

                                }
                                if (vAEvaluationGoals.Count > 5)
                                {
                                    av6 = vAEvaluationGoals[5];
                                }
                                List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp021.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                                am1 = vAEvaluationCompetenciesMs[0];
                                am2 = vAEvaluationCompetenciesMs[1];
                                am3 = vAEvaluationCompetenciesMs[2];
                                am4 = vAEvaluationCompetenciesMs[3];
                                am5 = vAEvaluationCompetenciesMs[4];
                                am6 = vAEvaluationCompetenciesMs[5];
                                if (vAEvaluationCompetenciesMs.Count > 6)
                                {

                                    am7 = vAEvaluationCompetenciesMs[6];
                                }

                                List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp021.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                                ad1 = vAEvaluationCompetenciesDs[0];
                                ad2 = vAEvaluationCompetenciesDs[1];
                                ad3 = vAEvaluationCompetenciesDs[2];
                                ad4 = vAEvaluationCompetenciesDs[3];
                                ad5 = vAEvaluationCompetenciesDs[4];
                                ad6 = vAEvaluationCompetenciesDs[5];
                                ad7 = vAEvaluationCompetenciesDs[6];
                                ad8 = vAEvaluationCompetenciesDs[7];
                                ad9 = vAEvaluationCompetenciesDs[8];
                                ad10 = vAEvaluationCompetenciesDs[9];
                                ad11 = vAEvaluationCompetenciesDs[10];
                                ad12 = vAEvaluationCompetenciesDs[11];
                                ad13 = vAEvaluationCompetenciesDs[12];
                                ad14 = vAEvaluationCompetenciesDs[13];
                                ad15 = vAEvaluationCompetenciesDs[14];
                                ad16 = vAEvaluationCompetenciesDs[15];
                                ad17 = vAEvaluationCompetenciesDs[16];
                                ad18 = vAEvaluationCompetenciesDs[17];
                                if (vAEvaluationCompetenciesDs.Count > 18)
                                {

                                    ad19 = vAEvaluationCompetenciesDs[18];
                                    ad20 = vAEvaluationCompetenciesDs[19];
                                    ad21 = vAEvaluationCompetenciesDs[20];
                                    ad22 = vAEvaluationCompetenciesDs[21];
                                    ad23 = vAEvaluationCompetenciesDs[22];
                                }
                                if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString(((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('"+emp.cemp.CEMPPASSWRD+"', '"+emp.cemp.CEMPNO+"','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '"+ emp.AEvaluationEmp.tot1 + "', "+Convert.ToInt32(emp.AEvaluationEmp.tot4)+") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();

                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "3 " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();

                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);


                                }
                                emp.cemp.tot7 = Convert.ToDecimal(emp.AEvaluationEmp.tot3) * 30 / 100 + Convert.ToDecimal(emp.cemp.cbrowser) * 30 / 100 + Convert.ToDecimal(emp.cemp.tot6) * 40 / 100;


                            }
                            else
                            {
                                ViewBag.mesg = "ليس لديك طلب تقييم معتمد للعام الحالي او  العام 2021  .";
                            }

                        }
                        else
                        {
                            ViewBag.mesg = "ليس لديك طلب تقييم معتمد للعام  2021  .";
                        }
                    }
                }
                else
                {
                    ViewBag.mesg = "لايوجد طلبات تقييم للاداء مرفوعة علي النظام    .";
                }

=======
                List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                av1 = vAEvaluationGoals[0];
                av2 = vAEvaluationGoals[1];
                av3 = vAEvaluationGoals[2];
                av4 = vAEvaluationGoals[3];
                if (vAEvaluationGoals.Count > 4)
                {
                    av5 = vAEvaluationGoals[4];

                }
                if (vAEvaluationGoals.Count > 5)
                {
                    av6 = vAEvaluationGoals[5];
                }
                List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                am1 = vAEvaluationCompetenciesMs[0];
                am2 = vAEvaluationCompetenciesMs[1];
                am3 = vAEvaluationCompetenciesMs[2];
                am4 = vAEvaluationCompetenciesMs[3];
                am5 = vAEvaluationCompetenciesMs[4];
                am6 = vAEvaluationCompetenciesMs[5];
                if (vAEvaluationCompetenciesMs.Count > 6)
                {

                    am7 = vAEvaluationCompetenciesMs[6];
                }

                List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                ad1 = vAEvaluationCompetenciesDs[0];
                ad2 = vAEvaluationCompetenciesDs[1];
                ad3 = vAEvaluationCompetenciesDs[2];
                ad4 = vAEvaluationCompetenciesDs[3];
                ad5 = vAEvaluationCompetenciesDs[4];
                ad6 = vAEvaluationCompetenciesDs[5];
                ad7 = vAEvaluationCompetenciesDs[6];
                ad8 = vAEvaluationCompetenciesDs[7];
                ad9 = vAEvaluationCompetenciesDs[8];
                ad10 = vAEvaluationCompetenciesDs[9];
                ad11 = vAEvaluationCompetenciesDs[10];
                ad12 = vAEvaluationCompetenciesDs[11];
                ad13 = vAEvaluationCompetenciesDs[12];
                ad14 = vAEvaluationCompetenciesDs[13];
                ad15 = vAEvaluationCompetenciesDs[14];
                ad16 = vAEvaluationCompetenciesDs[15];
                ad17 = vAEvaluationCompetenciesDs[16];
                ad18 = vAEvaluationCompetenciesDs[17];
                if (vAEvaluationCompetenciesDs.Count > 18)
                {

                    ad19 = vAEvaluationCompetenciesDs[18];
                    ad20 = vAEvaluationCompetenciesDs[19];
                    ad21 = vAEvaluationCompetenciesDs[20];
                    ad22 = vAEvaluationCompetenciesDs[21];
                    ad23 = vAEvaluationCompetenciesDs[22];
                }
                if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString(((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('"+emp.cemp.CEMPPASSWRD+"', '"+emp.cemp.CEMPNO+"','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '"+ emp.AEvaluationEmp.tot1 + "', "+Convert.ToInt32(emp.AEvaluationEmp.tot4)+") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();

                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "3 " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();

                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);


                }

                emp.cemp.tot7 = Convert.ToDecimal(emp.AEvaluationEmp.tot3) * 30 / 100 + Convert.ToDecimal(emp.cemp.cbrowser) * 30 / 100 + Convert.ToDecimal(emp.cemp.tot6) * 40 / 100;
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
            }

            return View(Records);
        }
        [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public IActionResult Uploadmmmm0100(string announce)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            double sumgrade = 0.0;
            List<members> noDups = _context.Members.ToList().GroupBy(d => new { d.announce })
                                  .Where(d => d.Count() >= 1)
                                  .Select(d => d.First())
                                  .ToList();
            ViewData["Cempid1"] = new SelectList(noDups.ToList(), "announce", "announce");
            if (announce == null)
            {
                announce = "2255588";
            }
            var announce0 = _context.Members.Where(x => x.announce == announce).FirstOrDefault().announce;
            var commit = _context.Members.Where(x => x.announce == announce).FirstOrDefault().commitedescession;
            //List<membersz> membersz = _context.Membersz.Where(x => x.userid == HttpContext.Session.GetString("username") && x.announce == announce).ToList();
            //List<memberszz> memberszz = _context.Memberszz.Where(x => x.userid == HttpContext.Session.GetString("username") && x.announce == announce).ToList();
            List<members> members = _context.Members.Where(X => X.userid != "" && X.username != "" && X.announce == announce0).ToList();
            List<commite> commites = _context.commite.Where(z => z.userid == HttpContext.Session.GetString("username") && z.status == 0 && z.commitedescession == commit && (z.postion == "سكرتير اللجنة ")).ToList();
            TempData["TDFriend10000"] = _context.commite.Where(z => z.userid == HttpContext.Session.GetString("username") && z.status == 0 && z.commitedescession == commit && (z.postion == "سكرتير اللجنة ")).ToList().Count;
            List<Cemp> cemps = _context.Cemps.ToList();
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail2> EvalDetails2 = _context.EvalDetailss2.ToList();
            List<EvalRequestTypeId2> EvalRequestTypeIds2 = _context.EvalRequestTypeIds2.ToList();
            List<Evalcomment2> evalcommentss = _context.EvalComments2.ToList();
            //
            List<ACourcesType> ACourcesTypes = _context.ACourcesTypes.ToList();
            List<Cemp> Cemps = _context.Cemps.ToList();
            List<ACourcesEstimate> ACourcesEstimates = _context.ACourcesEstimates.ToList();
            List<ACourcesMaster> ACourcesMasters = _context.ACourcesMasters.ToList();
            List<commitez> commitezs = _context.commitez.Where(x => x.commitedescession == commit && x.CourcesIdImagecert == announce).ToList();

            // List<ACourcesMaster> ACourcesMasters = _context.ACourcesMasters.Where(e => e.CourcesEndDate.Date >= Convert.ToDateTime(emppro.CEMPLASTUPGRADEHIJRA).Date && e.Cempid == HttpContext.Session.GetString("empid")).ToList();
            List<ACourcesDeptin> ACourcesDeptins = _context.ACourcesDeptins.ToList();
            List<MasterRequestTypeId> MasterRequestTypeIds = _context.MasterRequestTypeIds.ToList();
            List<MasterDetails> MasterDetailss = _context.MasterDetailss.ToList();
            List<ACourcesDeptout> ACourcesDeptouts = _context.ACourcesDeptouts.ToList();
            List<ACourcesTrainingMethod> ACourcesTrainingMethods = _context.ACourcesTrainingMethods.ToList();
            List<ACourcesName> ACourcesNames = _context.ACourcesNames.ToList();
            StringBuilder sb = new StringBuilder();
            StringBuilder sb2 = new StringBuilder();
            StringBuilder sb3 = new StringBuilder();
            StringBuilder sb4 = new StringBuilder();
            StringBuilder sb5 = new StringBuilder();
            sb.Clear();
            sb2.Clear();
            sb3.Clear();
            sb4.Clear();
            sb5.Clear();
            HttpContext.Session.Remove("TDFriend6");
            int count1 = 0, count2 = 0, count3 = 0, count4 = 0, count5 = 0;
            //

            var Records = from e0 in AEvaluationEmps
                              //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                              //from d in table1.ToList()
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()

                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join ff in EvalDetails2 on e0.Idd equals ff.CourcesIdoffered into table4f
                          from ff in table4f.ToList()
<<<<<<< HEAD
                          where ff.OfferedRequestTypeSatus == 1 && e0.CovenantYear==2022
=======
                          where ff.OfferedRequestTypeSatus == 1
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                          //where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                          join hf in EvalRequestTypeIds2 on e0.Idd equals hf.CourcesIdoffered into table5f
                          from hf in table5f.ToList()
                          where hf.OfferedRequestType == 1
                          //join mm in evalcommentss on f.OfferedDetailsSerial equals mm.Offerdetailsid into table6
                          //from mm in table6.ToList()
                          //where mm.Offerdetailsid == f.OfferedDetailsSerial
                          join gg in cemps on e0.Empno equals Convert.ToInt32(gg.Cempid) into table99
                          from gg in table99.ToList()
                          where gg.CEMPPASSWRD.Length == 10
                          join f in members on gg.CEMPPASSWRD equals f.userid into table4
                          from f in table4.Distinct().ToList()
                          where f.status == 1
                          //where (f.OfferedRequestTo == HttpContext.Session.GetString("empid") && f.OfferedRequestTo3 == "0") || (f.OfferedRequestTo2 == HttpContext.Session.GetString("empid") && f.OfferedRequestTo4 == "0") || (f.Offeredoption == HttpContext.Session.GetString("empid") && f.OfferedRequestTo5 == "0")
                          join yy in commites on f.commitedescession equals yy.commitedescession into table555
                          from yy in table555.Distinct().ToList()
                          where yy.status == 0 && yy.commitedescession == commit

                          // from e in ACourcesMasters
                          //join i in ACourcesMasters on gg.Cempid equals i.Cempid into table2
                          //from i in table2.ToList()
                          //    // where i.Cempid == HttpContext.Session.GetString("empid")
                          //where i.CourcesEndDate.Date >= Convert.ToDateTime(gg.CEMPLASTUPGRADEHIJRA).Date && e0.Empno ==Convert.ToInt32( gg.Cempid)

                          //join d in ACourcesTypes on i.CourcesIdType equals d.CourcesIdType into table1
                          //from d in table1.ToList()
                          //join j in ACourcesEstimates on i.CourcesIdEstimate equals j.CourcesIdEstimate into table3
                          //from j in table3.ToList()
                          //join f1 in ACourcesDeptins on i.CourcesIdDeptin equals f1.CourcesIdDeptin into table41
                          //from f1 in table41.ToList()
                          //join h in ACourcesDeptouts on i.CourcesIdDeptout equals h.CourcesIdDeptout into table5
                          //from h in table5.ToList()
                          //join n in ACourcesTrainingMethods on i.CourcesIdTraining equals n.CourcesIdTraining into table6
                          //from n in table6.ToList()
                          //join x in MasterRequestTypeIds on i.CourcesIdmaster equals x.COURCES_IDMASTER into table7
                          //from x in table7.ToList()
                          //where x.MasterRequestType == 1
                          //join y in MasterDetailss on i.CourcesIdmaster equals y.COURCES_IDMASTER into table8
                          //from y in table8.Distinct().ToList()
                          //where y.MasterRequestTypeSatus == 1
                          //where y.MasterRequestTo == HttpContext.Session.GetString("empid") || y.MasterRequestTo2 == HttpContext.Session.GetString("empid")
                          //join z in ACourcesNames on i.CourcesId equals z.CourcesId into table9
                          //from z in table9.ToList()

                          //join h in membersz on e.Cempid equals h.userid into table5
                          //from h in table5.ToList()
                          //where h.status == 0
                          //join y in memberszz on f.announce equals y.announce into table55
                          //from y in table55.Distinct().ToList()
                          //where y.status == 0 && e.Cempid != y.announcetxt && f.commitedescession == y.commitedescession



                          select new ViewModelEvalwithother
                          {
                              cemp = gg,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              member = f,
                              //memberz = h,
                              //memberzz = y,
                              commite = yy,
                              evalDetail2 = ff,
                              evalRequestTypeId2 = hf,
                              AEvaluationEmp = e0,
                              // ACourcesMasters = i,
                              // ACourcesTypes = d,
                              //Cemps = i,
                              //ACourcesEstimates = j,
                              //ACourcesDeptins = f1,
                              //  ACourcesDeptouts = h,
                              // ACourcesTrainingMethods = n,
                              // MasterRequestTypeIds = x,
                              //  MasterDetails = y,
                              // ACourcesNames = z

                          };


            //ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            //viewModelEvalwithother.commite = _context.commite.Where(z => z.userid == HttpContext.Session.GetString("username") && z.status == 0).OrderBy(x => x.id).LastOrDefault();
            //viewModelEvalwithother.members = _context.Members.Where(X => X.status == 0 && X.userid != "" && X.username != "" && X.commitedescession == viewModelEvalwithother.commite.commitedescession).ToList();
            //// add commite
            //List<Cemp> list = new List<Cemp>();
            //for (int i = 0; i < viewModelEvalwithother.members.ToList().Count; i++)
            //{
            //    var tt = new Cemp
            //    {
            //        Cempid = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().Cempid ?? "",
            //        CEMPNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPNAME ?? "",
            //        CEMPPASSWRD = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPPASSWRD ?? "",
            //        CEMPNO = viewModelEvalwithother.members.ElementAt(i).commitedescession.ToString() ?? "",
            //        CEMPPASSWRD1 = viewModelEvalwithother.members.ElementAt(i).announce.ToString() ?? "",
            //        EncryptedId = _protector.Protect(viewModelEvalwithother.members.ElementAt(i).userid.ToString()),
            //        CLSSNO = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CLSSNO ?? "",
            //        grade = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().grade ?? "",
            //        DEP_NAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().DEP_NAME ?? "",
            //        PARENTNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().PARENTNAME ?? "",
            //        CEMPHIRINGDATEHIJRA = Convert.ToDateTime(_context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPHIRINGDATEHIJRA).Date,
            //        CEMPLASTUPGRADEHIJRA = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPLASTUPGRADEHIJRA,
            //        //TaskM10 = HttpContext.Session.GetString("empid")
            //    };
            //    list.Add(tt);
            //}
            //viewModelEvalwithother.cemps = list;

            foreach (var emp in Records.ToList())
            {
                var stringId = emp.cemp.Cempid.ToString();
                emp.cemp.EncryptedId = _protector.Protect(stringId);

                string ann = _context.commitez.Where(x => x.userid == emp.cemp.Cempid && x.commitedescession == commit && x.CourcesIdImagecert == announce).FirstOrDefault().CourcesIdImagecert;
                int n = _context.commitez.Where(x => x.userid == emp.cemp.Cempid && x.commitedescession == commit && x.CourcesIdImagecert == announce).ToList().Count;
                int n0 = _context.commitez.ToList().GroupBy(d => d.userentry, dd => dd.userid == emp.cemp.Cempid && dd.CourcesIdImagecert == announce)
                                  .Where(d => d.Count() >= 1)
                                  .Select(d => d.First())
                                  .ToList().Count;
                var res = from l in _context.commitez.Where(x => x.userid == emp.cemp.Cempid && x.commitedescession == commit && x.CourcesIdImagecert == announce).ToList() group l by new { l.userentry } into g select new { g.Key.userentry, value = g.Distinct().Count() };
                int n2 = 0;
                foreach (var item in res)
                {
                    Console.WriteLine(item.userentry + " " + item.value);
                    n2++;
                }
                if (_context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "رئيس اللجنة").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault() != null)
                {
                    emp.cemp.tot1 = _context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "رئيس اللجنة").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault().status;

                }
                if (_context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "نائب رئيس اللجنة").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault() != null)
                {
                    emp.cemp.tot2 = _context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "نائب رئيس اللجنة").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault().status;
                }
                if (_context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة1").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault() != null)
                {
                    emp.cemp.tot3 = _context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة1").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault().status;
                }
                if (_context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة2").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault() != null)
                {
                    emp.cemp.tot4 = _context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة2").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault().status;
                }
                if (_context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة3").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault() != null)
                {
                    emp.cemp.tot5 = _context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة3").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault().status;
                }
                emp.cemp.tot6 = (Convert.ToDecimal(emp.cemp.tot5) + Convert.ToDecimal(emp.cemp.tot4) + Convert.ToDecimal(emp.cemp.tot3) + Convert.ToDecimal(emp.cemp.tot2) + Convert.ToDecimal(emp.cemp.tot1)) / n2;
                if (emp.cemp.tot6 >= 100)
                {
                    //TempData["sumgrade"] = "100.00";
                    emp.cemp.tot6 = 100;

                }
                else
                {
                    // TempData["sumgrade"] = sumgrade;
                    emp.cemp.tot6 = emp.cemp.tot6;
                }
                if (emp.cemp.tot1 == null)
                {
                    sb.Append(emp.cemp.CEMPNAME.ToString() + ',');
                    //TempData["TDFriend1"] = sb.ToString();
                    count1++;
                }
                //TempData["TDFriend10"] = count1;
                if (emp.cemp.tot2 == null)
                {
                    sb2.Append(emp.cemp.CEMPNAME.ToString() + ',');
                    //TempData["TDFriend2"] = sb2.ToString();
                    count2++;
                }
                //TempData["TDFriend20"] = count2;
                if (emp.cemp.tot3 == null)
                {
                    sb3.Append(emp.cemp.CEMPNAME.ToString() + ',');
                    //TempData["TDFriend3"] = sb3.ToString();
                    count3++;
                }
                //TempData["TDFriend30"] = count3;
                if (emp.cemp.tot4 == null)
                {
                    sb4.Append(emp.cemp.CEMPNAME.ToString() + ',');
                    //TempData["TDFriend4"] = sb4.ToString();
                    count4++;
                }
                //TempData["TDFriend40"] = count4;
                if (emp.cemp.tot5 == null)
                {
                    sb5.Append(emp.cemp.CEMPNAME.ToString() + ',');
                    //TempData["TDFriend5"] = sb5.ToString();
                    count5++;
                }
                //TempData["TDFriend50"] = count5;
                TempData["TDFriend6"] = ann;
                sumgrade = 0.0;
                ACourcesMasters = _context.ACourcesMasters.Where(e => e.CourcesEndDate.Date >= Convert.ToDateTime(emp.cemp.CEMPLASTUPGRADEHIJRA).Date && e.CourcesEndDate.Date <= (_context.Members.Where(x => x.announce == announce).FirstOrDefault().dateexcute1.Value.Date) && e.Cempid == emp.cemp.Cempid).ToList();
                foreach (var emp0 in ACourcesMasters.ToList())
                {
                    if (_context.MasterRequestTypeIds.Where(z => z.COURCES_IDMASTER == emp0.CourcesIdmaster && z.MasterRequestType == 1).FirstOrDefault() != null)
                    {
                        if (emp0.CourcesIdType == 1)
                        {
                            if (emp0.CourcesIdType == 1 && emp0.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                            {
                                emp0.gradetocourse = 40.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 1 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                            {

                                emp0.gradetocourse = 30.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }
                        else if (emp0.CourcesIdType == 2)
                        {
                            if (emp0.CourcesIdType == 2 && emp0.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                            {
                                emp0.gradetocourse = 80.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 2 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                            {
                                emp0.gradetocourse = 60.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 2 && emp0.COURCES_EXCUTION.Equals("جهة تدريب بالقطاع الخاص"))
                            {
                                emp0.gradetocourse = 40.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }
                        else if (emp0.CourcesIdType == 3)
                        {
                            if (emp0.CourcesIdType == 3 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                            {
                                emp0.gradetocourse = 1.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }
                        else if (emp0.CourcesIdType == 4 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {

                            if (emp0.CourcesIdType == 4 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && emp0.CourcesIdEstimate == 1)
                            {
                                emp0.gradetocourse = 50.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 4 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && emp0.CourcesIdEstimate == 2)
                            {
                                emp0.gradetocourse = 25.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }

                    }

                    //emp.gradetocourse0 = sumgrade;


                }
                if (sumgrade >= 100.00)
                {
                    //TempData["sumgrade"] = "100.00";
                    emp.cemp.cbrowser = "100";

                }
                else
                {
                    // TempData["sumgrade"] = sumgrade;
                    emp.cemp.cbrowser = sumgrade.ToString();
                }
                // emp.gradetocourse0 = sumgrade;
                // emp.cemp.cbrowser = sumgrade.ToString();
                //emp.ACourcesMasters.gradetocourse0 = sumgrade;
<<<<<<< HEAD
                var emp01 = _context.AEvaluationEmps.Where(x => x.Empno == emp.AEvaluationEmp.Empno) /*&&(x.year=="2021")*/.OrderBy(x => x.Idd).LastOrDefault();
                if (emp01 != null)
                {
                    // check eval approved  for last year 2022 or go to previous year 
                    var approval = _context.EvalDetailss2.Where(x => x.CourcesIdoffered == emp01.Idd && x.OfferedRequestTypeSatus == 1).FirstOrDefault();
                    if (approval != null)
                    {
                        List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp01.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                        av1 = vAEvaluationGoals[0];
                        av2 = vAEvaluationGoals[1];
                        av3 = vAEvaluationGoals[2];
                        av4 = vAEvaluationGoals[3];
                        if (vAEvaluationGoals.Count > 4)
                        {
                            av5 = vAEvaluationGoals[4];

                        }
                        if (vAEvaluationGoals.Count > 5)
                        {
                            av6 = vAEvaluationGoals[5];
                        }
                        List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp01.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                        am1 = vAEvaluationCompetenciesMs[0];
                        am2 = vAEvaluationCompetenciesMs[1];
                        am3 = vAEvaluationCompetenciesMs[2];
                        am4 = vAEvaluationCompetenciesMs[3];
                        am5 = vAEvaluationCompetenciesMs[4];
                        am6 = vAEvaluationCompetenciesMs[5];
                        if (vAEvaluationCompetenciesMs.Count > 6)
                        {

                            am7 = vAEvaluationCompetenciesMs[6];
                        }

                        List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp01.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                        ad1 = vAEvaluationCompetenciesDs[0];
                        ad2 = vAEvaluationCompetenciesDs[1];
                        ad3 = vAEvaluationCompetenciesDs[2];
                        ad4 = vAEvaluationCompetenciesDs[3];
                        ad5 = vAEvaluationCompetenciesDs[4];
                        ad6 = vAEvaluationCompetenciesDs[5];
                        ad7 = vAEvaluationCompetenciesDs[6];
                        ad8 = vAEvaluationCompetenciesDs[7];
                        ad9 = vAEvaluationCompetenciesDs[8];
                        ad10 = vAEvaluationCompetenciesDs[9];
                        ad11 = vAEvaluationCompetenciesDs[10];
                        ad12 = vAEvaluationCompetenciesDs[11];
                        ad13 = vAEvaluationCompetenciesDs[12];
                        ad14 = vAEvaluationCompetenciesDs[13];
                        ad15 = vAEvaluationCompetenciesDs[14];
                        ad16 = vAEvaluationCompetenciesDs[15];
                        ad17 = vAEvaluationCompetenciesDs[16];
                        ad18 = vAEvaluationCompetenciesDs[17];
                        if (vAEvaluationCompetenciesDs.Count > 18)
                        {

                            ad19 = vAEvaluationCompetenciesDs[18];
                            ad20 = vAEvaluationCompetenciesDs[19];
                            ad21 = vAEvaluationCompetenciesDs[20];
                            ad22 = vAEvaluationCompetenciesDs[21];
                            ad23 = vAEvaluationCompetenciesDs[22];
                        }
                        if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString(((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('"+emp.cemp.CEMPPASSWRD+"', '"+emp.cemp.CEMPNO+"','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '"+ emp.AEvaluationEmp.tot1 + "', "+Convert.ToInt32(emp.AEvaluationEmp.tot4)+") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();

                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "3 " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                             ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                             ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                             ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                          ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();

                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                     ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                     ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                     ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                      ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                      ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                      ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                              ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                              ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                              ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);
                        }
                        else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                        {
                            // calculation 

                            emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                            emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                            emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                            emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                            //OracleConnection Con5 = new OracleConnection(TNS1);
                            //Con5.Open();
                            //OracleCommand cmd = new OracleCommand();
                            //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                            ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                            //cmd.Connection = Con5;
                            //cmd.ExecuteNonQuery();
                            //Con5.Close();
                            //return View(Records);


                        }
                        emp.cemp.tot7 = Convert.ToDecimal(emp.AEvaluationEmp.tot3) * 30 / 100 + Convert.ToDecimal(emp.cemp.cbrowser) * 30 / 100 + Convert.ToDecimal(emp.cemp.tot6) * 40 / 100;

                    }
                    else
                    {
                        // aeval 2021 calc 
                        var emp021 = _context.AEvaluationEmps.Where(x => x.Empno == emp.AEvaluationEmp.Empno && x.year == "2021").FirstOrDefault();
                        if (emp021 != null)
                        {
                            var approval021 = _context.EvalDetailss2.Where(x => x.CourcesIdoffered == emp021.Idd && x.OfferedRequestTypeSatus == 1).FirstOrDefault();
                            if (approval021 != null)
                            {
                                var approvalseial = _context.EvalDetailss2.Where(x => x.CourcesIdoffered == emp021.Idd).FirstOrDefault();
                                var approveddate = _context.EvalComments2.Where(x => x.Offerdetailsid == approvalseial.OfferedDetailsSerial).FirstOrDefault();
                                List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp021.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                                av1 = vAEvaluationGoals[0];
                                av2 = vAEvaluationGoals[1];
                                av3 = vAEvaluationGoals[2];
                                av4 = vAEvaluationGoals[3];
                                if (vAEvaluationGoals.Count > 4)
                                {
                                    av5 = vAEvaluationGoals[4];

                                }
                                if (vAEvaluationGoals.Count > 5)
                                {
                                    av6 = vAEvaluationGoals[5];
                                }
                                List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp021.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                                am1 = vAEvaluationCompetenciesMs[0];
                                am2 = vAEvaluationCompetenciesMs[1];
                                am3 = vAEvaluationCompetenciesMs[2];
                                am4 = vAEvaluationCompetenciesMs[3];
                                am5 = vAEvaluationCompetenciesMs[4];
                                am6 = vAEvaluationCompetenciesMs[5];
                                if (vAEvaluationCompetenciesMs.Count > 6)
                                {

                                    am7 = vAEvaluationCompetenciesMs[6];
                                }

                                List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp021.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                                ad1 = vAEvaluationCompetenciesDs[0];
                                ad2 = vAEvaluationCompetenciesDs[1];
                                ad3 = vAEvaluationCompetenciesDs[2];
                                ad4 = vAEvaluationCompetenciesDs[3];
                                ad5 = vAEvaluationCompetenciesDs[4];
                                ad6 = vAEvaluationCompetenciesDs[5];
                                ad7 = vAEvaluationCompetenciesDs[6];
                                ad8 = vAEvaluationCompetenciesDs[7];
                                ad9 = vAEvaluationCompetenciesDs[8];
                                ad10 = vAEvaluationCompetenciesDs[9];
                                ad11 = vAEvaluationCompetenciesDs[10];
                                ad12 = vAEvaluationCompetenciesDs[11];
                                ad13 = vAEvaluationCompetenciesDs[12];
                                ad14 = vAEvaluationCompetenciesDs[13];
                                ad15 = vAEvaluationCompetenciesDs[14];
                                ad16 = vAEvaluationCompetenciesDs[15];
                                ad17 = vAEvaluationCompetenciesDs[16];
                                ad18 = vAEvaluationCompetenciesDs[17];
                                if (vAEvaluationCompetenciesDs.Count > 18)
                                {

                                    ad19 = vAEvaluationCompetenciesDs[18];
                                    ad20 = vAEvaluationCompetenciesDs[19];
                                    ad21 = vAEvaluationCompetenciesDs[20];
                                    ad22 = vAEvaluationCompetenciesDs[21];
                                    ad23 = vAEvaluationCompetenciesDs[22];
                                }
                                if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString(((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('"+emp.cemp.CEMPPASSWRD+"', '"+emp.cemp.CEMPNO+"','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '"+ emp.AEvaluationEmp.tot1 + "', "+Convert.ToInt32(emp.AEvaluationEmp.tot4)+") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();

                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "3 " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();

                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);
                                }
                                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                                {
                                    // calculation 

                                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                                    //OracleConnection Con5 = new OracleConnection(TNS1);
                                    //Con5.Open();
                                    //OracleCommand cmd = new OracleCommand();
                                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                                    //cmd.Connection = Con5;
                                    //cmd.ExecuteNonQuery();
                                    //Con5.Close();
                                    //return View(Records);


                                }
                                emp.cemp.tot7 = Convert.ToDecimal(emp.AEvaluationEmp.tot3) * 30 / 100 + Convert.ToDecimal(emp.cemp.cbrowser) * 30 / 100 + Convert.ToDecimal(emp.cemp.tot6) * 40 / 100;


                            }
                            else
                            {
                                ViewBag.mesg = "ليس لديك طلب تقييم معتمد للعام الحالي او  العام 2021  .";
                            }

                        }
                        else
                        {
                            ViewBag.mesg = "ليس لديك طلب تقييم معتمد للعام  2021  .";
                        }
                    }
                }
                else
                {
                    ViewBag.mesg = "لايوجد طلبات تقييم للاداء مرفوعة علي النظام    .";
                }

=======
                List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                av1 = vAEvaluationGoals[0];
                av2 = vAEvaluationGoals[1];
                av3 = vAEvaluationGoals[2];
                av4 = vAEvaluationGoals[3];
                if (vAEvaluationGoals.Count > 4)
                {
                    av5 = vAEvaluationGoals[4];

                }
                if (vAEvaluationGoals.Count > 5)
                {
                    av6 = vAEvaluationGoals[5];
                }
                List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                am1 = vAEvaluationCompetenciesMs[0];
                am2 = vAEvaluationCompetenciesMs[1];
                am3 = vAEvaluationCompetenciesMs[2];
                am4 = vAEvaluationCompetenciesMs[3];
                am5 = vAEvaluationCompetenciesMs[4];
                am6 = vAEvaluationCompetenciesMs[5];
                if (vAEvaluationCompetenciesMs.Count > 6)
                {

                    am7 = vAEvaluationCompetenciesMs[6];
                }

                List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                ad1 = vAEvaluationCompetenciesDs[0];
                ad2 = vAEvaluationCompetenciesDs[1];
                ad3 = vAEvaluationCompetenciesDs[2];
                ad4 = vAEvaluationCompetenciesDs[3];
                ad5 = vAEvaluationCompetenciesDs[4];
                ad6 = vAEvaluationCompetenciesDs[5];
                ad7 = vAEvaluationCompetenciesDs[6];
                ad8 = vAEvaluationCompetenciesDs[7];
                ad9 = vAEvaluationCompetenciesDs[8];
                ad10 = vAEvaluationCompetenciesDs[9];
                ad11 = vAEvaluationCompetenciesDs[10];
                ad12 = vAEvaluationCompetenciesDs[11];
                ad13 = vAEvaluationCompetenciesDs[12];
                ad14 = vAEvaluationCompetenciesDs[13];
                ad15 = vAEvaluationCompetenciesDs[14];
                ad16 = vAEvaluationCompetenciesDs[15];
                ad17 = vAEvaluationCompetenciesDs[16];
                ad18 = vAEvaluationCompetenciesDs[17];
                if (vAEvaluationCompetenciesDs.Count > 18)
                {

                    ad19 = vAEvaluationCompetenciesDs[18];
                    ad20 = vAEvaluationCompetenciesDs[19];
                    ad21 = vAEvaluationCompetenciesDs[20];
                    ad22 = vAEvaluationCompetenciesDs[21];
                    ad23 = vAEvaluationCompetenciesDs[22];
                }
                if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString(((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('"+emp.cemp.CEMPPASSWRD+"', '"+emp.cemp.CEMPNO+"','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '"+ emp.AEvaluationEmp.tot1 + "', "+Convert.ToInt32(emp.AEvaluationEmp.tot4)+") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();

                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "3 " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();

                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);


                }

                emp.cemp.tot7 = Convert.ToDecimal(emp.AEvaluationEmp.tot3) * 30 / 100 + Convert.ToDecimal(emp.cemp.cbrowser) * 30 / 100 + Convert.ToDecimal(emp.cemp.tot6) * 40 / 100;
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
            }

            return View(Records);
        }
        [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public IActionResult Uploadmmmmm(string announce)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            List<members> noDups = _context.Members.ToList().GroupBy(d => new { d.announce })
                                  .Where(d => d.Count() >= 1)
                                  .Select(d => d.First())
                                  .ToList();
            ViewData["Cempid1"] = new SelectList(noDups.ToList(), "announce", "announce");
            if (announce == null)
            {
                announce = "111111";
            }
            //var announce0 = _context.Members.Where(x => x.announce == announce).FirstOrDefault().announce;
            //var commit = _context.Members.Where(x => x.announce == announce).FirstOrDefault().commitedescession;
            //List<membersz> membersz = _context.Membersz.Where(x => x.userid == HttpContext.Session.GetString("username") && x.announce == announce).ToList();
            //List<memberszz> memberszz = _context.Memberszz.Where(x => x.userid == HttpContext.Session.GetString("username") && x.announce == announce).ToList();
            //List<members> members = _context.Members.Where(X => X.status == 0 && X.userid != "" && X.username != "" && X.announce == announce0).ToList();
            //List<commite> commites = _context.commite.Where(z => z.userid == HttpContext.Session.GetString("username") && z.status == 0 && z.commitedescession == commit).ToList();
            List<commitez> commitezs = _context.commitez.Where(c=>c.CourcesIdImagecert==announce).ToList();
            List<Cemp> cemps = _context.Cemps.ToList();

            var Records = from e in cemps
                              //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                              //from d in table1.ToList()
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          //join f in members on e.CEMPPASSWRD equals f.userid into table4
                          //from f in table4.Distinct().ToList()
                          //where f.status == 0
                          //where (f.OfferedRequestTo == HttpContext.Session.GetString("empid") && f.OfferedRequestTo3 == "0") || (f.OfferedRequestTo2 == HttpContext.Session.GetString("empid") && f.OfferedRequestTo4 == "0") || (f.Offeredoption == HttpContext.Session.GetString("empid") && f.OfferedRequestTo5 == "0")
                          join yy in commitezs on e.CEMPNO equals yy.userid into table555
                          from yy in table555.Distinct().ToList()
                          //where  
                          //join h in membersz on e.Cempid equals h.userid into table5
                          //from h in table5.ToList()
                          //where h.status == 0
                          //join y in memberszz on f.announce equals y.announce into table55
                          //from y in table55.Distinct().ToList()
                          //where y.status == 0 && e.Cempid != y.announcetxt && f.commitedescession == y.commitedescession



                          select new ViewModelEvalwithother
                          {
                              cemp = e,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              //member = f,
                              //memberz = h,
                              //memberzz = y,
                              commitez = yy,

                          };


            //ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            //viewModelEvalwithother.commite = _context.commite.Where(z => z.userid == HttpContext.Session.GetString("username") && z.status == 0).OrderBy(x => x.id).LastOrDefault();
            //viewModelEvalwithother.members = _context.Members.Where(X => X.status == 0 && X.userid != "" && X.username != "" && X.commitedescession == viewModelEvalwithother.commite.commitedescession).ToList();
            //// add commite
            //List<Cemp> list = new List<Cemp>();
            //for (int i = 0; i < viewModelEvalwithother.members.ToList().Count; i++)
            //{
            //    var tt = new Cemp
            //    {
            //        Cempid = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().Cempid ?? "",
            //        CEMPNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPNAME ?? "",
            //        CEMPPASSWRD = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPPASSWRD ?? "",
            //        CEMPNO = viewModelEvalwithother.members.ElementAt(i).commitedescession.ToString() ?? "",
            //        CEMPPASSWRD1 = viewModelEvalwithother.members.ElementAt(i).announce.ToString() ?? "",
            //        EncryptedId = _protector.Protect(viewModelEvalwithother.members.ElementAt(i).userid.ToString()),
            //        CLSSNO = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CLSSNO ?? "",
            //        grade = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().grade ?? "",
            //        DEP_NAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().DEP_NAME ?? "",
            //        PARENTNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().PARENTNAME ?? "",
            //        CEMPHIRINGDATEHIJRA = Convert.ToDateTime(_context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPHIRINGDATEHIJRA).Date,
            //        CEMPLASTUPGRADEHIJRA = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPLASTUPGRADEHIJRA,
            //        //TaskM10 = HttpContext.Session.GetString("empid")
            //    };
            //    list.Add(tt);
            //}
            //viewModelEvalwithother.cemps = list;

            foreach (var emp in Records.ToList())
            {
                var stringId = emp.cemp.Cempid.ToString();
                emp.cemp.EncryptedId = _protector.Protect(stringId);
            }

            return View(Records);
        }
        [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public IActionResult OnGetPartial()
        {
            Thread.Sleep(2000);
            @ViewData["Message"] = "hi !";
            return new PartialViewResult
            {
                ViewName = "_HelloWorldPartial",
                ViewData = this.ViewData

            };

        }
        [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
<<<<<<< HEAD
        public IActionResult OnGetPartial9(string a1,string a2,string a3,string a4,string a5)
        {
            Thread.Sleep(5000);
            @ViewData["Message2"] = "hi !";



            return new PartialViewResult
            {
                ViewName = "_HelloWorldPartial9",
                ViewData = this.ViewData

            };

        }
        [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
=======
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
        public IActionResult OnGetPartial0(string announce)
        {
            Thread.Sleep(5000);

            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            double sumgrade = 0.0;
            List<members> noDups = _context.Members.ToList().GroupBy(d => new { d.announce })
                                  .Where(d => d.Count() >= 1)
                                  .Select(d => d.First())
                                  .ToList();
            ViewData["Cempid1"] = new SelectList(noDups.ToList(), "announce", "announce");
            if (announce == null)
            {
                announce = "2255588";
            }
            var announce0 = _context.Members.Where(x => x.announce == announce).FirstOrDefault().announce;
            var commit = _context.Members.Where(x => x.announce == announce).FirstOrDefault().commitedescession;
            //List<membersz> membersz = _context.Membersz.Where(x => x.userid == HttpContext.Session.GetString("username") && x.announce == announce).ToList();
            //List<memberszz> memberszz = _context.Memberszz.Where(x => x.userid == HttpContext.Session.GetString("username") && x.announce == announce).ToList();
            List<members> members = _context.Members.Where(X => X.userid != "" && X.username != "" && X.announce == announce0).ToList();
            List<commite> commites = _context.commite.Where(z => z.userid == HttpContext.Session.GetString("username") && z.status == 0 && z.commitedescession == commit && (z.postion == "سكرتير اللجنة ")).ToList();
            List<Cemp> cemps = _context.Cemps.ToList();
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail2> EvalDetails2 = _context.EvalDetailss2.ToList();
            List<EvalRequestTypeId2> EvalRequestTypeIds2 = _context.EvalRequestTypeIds2.ToList();
            List<Evalcomment2> evalcommentss = _context.EvalComments2.ToList();
            //
            List<ACourcesType> ACourcesTypes = _context.ACourcesTypes.ToList();
            List<Cemp> Cemps = _context.Cemps.ToList();
            List<ACourcesEstimate> ACourcesEstimates = _context.ACourcesEstimates.ToList();
            List<ACourcesMaster> ACourcesMasters = _context.ACourcesMasters.ToList();
            List<commitez> commitezs = _context.commitez.Where(x => x.commitedescession == commit && x.CourcesIdImagecert == announce).ToList();

            // List<ACourcesMaster> ACourcesMasters = _context.ACourcesMasters.Where(e => e.CourcesEndDate.Date >= Convert.ToDateTime(emppro.CEMPLASTUPGRADEHIJRA).Date && e.Cempid == HttpContext.Session.GetString("empid")).ToList();
            List<ACourcesDeptin> ACourcesDeptins = _context.ACourcesDeptins.ToList();
            List<MasterRequestTypeId> MasterRequestTypeIds = _context.MasterRequestTypeIds.ToList();
            List<MasterDetails> MasterDetailss = _context.MasterDetailss.ToList();
            List<ACourcesDeptout> ACourcesDeptouts = _context.ACourcesDeptouts.ToList();
            List<ACourcesTrainingMethod> ACourcesTrainingMethods = _context.ACourcesTrainingMethods.ToList();
            List<ACourcesName> ACourcesNames = _context.ACourcesNames.ToList();
            StringBuilder sb = new StringBuilder();
            StringBuilder sb2 = new StringBuilder();
            StringBuilder sb3 = new StringBuilder();
            StringBuilder sb4 = new StringBuilder();
            StringBuilder sb5 = new StringBuilder();
            sb.Clear();
            sb2.Clear();
            sb3.Clear();
            sb4.Clear();
            sb5.Clear();
            int count1 = 0, count2 = 0, count3 = 0, count4 = 0, count5 = 0;
            //

            var Records = from e0 in AEvaluationEmps
                              //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                              //from d in table1.ToList()
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()

                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join ff in EvalDetails2 on e0.Idd equals ff.CourcesIdoffered into table4f
                          from ff in table4f.ToList()
                          where ff.OfferedRequestTypeSatus == 1
                          //where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                          join hf in EvalRequestTypeIds2 on e0.Idd equals hf.CourcesIdoffered into table5f
                          from hf in table5f.ToList()
                          where hf.OfferedRequestType == 1
                          //join mm in evalcommentss on f.OfferedDetailsSerial equals mm.Offerdetailsid into table6
                          //from mm in table6.ToList()
                          //where mm.Offerdetailsid == f.OfferedDetailsSerial
                          join gg in cemps on e0.Empno equals Convert.ToInt32(gg.Cempid) into table99
                          from gg in table99.ToList()
                          where gg.CEMPPASSWRD.Length == 10
                          join f in members on gg.CEMPPASSWRD equals f.userid into table4
                          from f in table4.Distinct().ToList()
                          where f.status == 1
                          //where (f.OfferedRequestTo == HttpContext.Session.GetString("empid") && f.OfferedRequestTo3 == "0") || (f.OfferedRequestTo2 == HttpContext.Session.GetString("empid") && f.OfferedRequestTo4 == "0") || (f.Offeredoption == HttpContext.Session.GetString("empid") && f.OfferedRequestTo5 == "0")
                          join yy in commites on f.commitedescession equals yy.commitedescession into table555
                          from yy in table555.Distinct().ToList()
                          where yy.status == 0 && yy.commitedescession == commit

                          // from e in ACourcesMasters
                          //join i in ACourcesMasters on gg.Cempid equals i.Cempid into table2
                          //from i in table2.ToList()
                          //    // where i.Cempid == HttpContext.Session.GetString("empid")
                          //where i.CourcesEndDate.Date >= Convert.ToDateTime(gg.CEMPLASTUPGRADEHIJRA).Date && e0.Empno ==Convert.ToInt32( gg.Cempid)

                          //join d in ACourcesTypes on i.CourcesIdType equals d.CourcesIdType into table1
                          //from d in table1.ToList()
                          //join j in ACourcesEstimates on i.CourcesIdEstimate equals j.CourcesIdEstimate into table3
                          //from j in table3.ToList()
                          //join f1 in ACourcesDeptins on i.CourcesIdDeptin equals f1.CourcesIdDeptin into table41
                          //from f1 in table41.ToList()
                          //join h in ACourcesDeptouts on i.CourcesIdDeptout equals h.CourcesIdDeptout into table5
                          //from h in table5.ToList()
                          //join n in ACourcesTrainingMethods on i.CourcesIdTraining equals n.CourcesIdTraining into table6
                          //from n in table6.ToList()
                          //join x in MasterRequestTypeIds on i.CourcesIdmaster equals x.COURCES_IDMASTER into table7
                          //from x in table7.ToList()
                          //where x.MasterRequestType == 1
                          //join y in MasterDetailss on i.CourcesIdmaster equals y.COURCES_IDMASTER into table8
                          //from y in table8.Distinct().ToList()
                          //where y.MasterRequestTypeSatus == 1
                          //where y.MasterRequestTo == HttpContext.Session.GetString("empid") || y.MasterRequestTo2 == HttpContext.Session.GetString("empid")
                          //join z in ACourcesNames on i.CourcesId equals z.CourcesId into table9
                          //from z in table9.ToList()

                          //join h in membersz on e.Cempid equals h.userid into table5
                          //from h in table5.ToList()
                          //where h.status == 0
                          //join y in memberszz on f.announce equals y.announce into table55
                          //from y in table55.Distinct().ToList()
                          //where y.status == 0 && e.Cempid != y.announcetxt && f.commitedescession == y.commitedescession



                          select new ViewModelEvalwithother
                          {
                              cemp = gg,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              member = f,
                              //memberz = h,
                              //memberzz = y,
                              commite = yy,
                              evalDetail2 = ff,
                              evalRequestTypeId2 = hf,
                              AEvaluationEmp = e0,
                              // ACourcesMasters = i,
                              // ACourcesTypes = d,
                              //Cemps = i,
                              //ACourcesEstimates = j,
                              //ACourcesDeptins = f1,
                              //  ACourcesDeptouts = h,
                              // ACourcesTrainingMethods = n,
                              // MasterRequestTypeIds = x,
                              //  MasterDetails = y,
                              // ACourcesNames = z

                          };


            //ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            //viewModelEvalwithother.commite = _context.commite.Where(z => z.userid == HttpContext.Session.GetString("username") && z.status == 0).OrderBy(x => x.id).LastOrDefault();
            //viewModelEvalwithother.members = _context.Members.Where(X => X.status == 0 && X.userid != "" && X.username != "" && X.commitedescession == viewModelEvalwithother.commite.commitedescession).ToList();
            //// add commite
            //List<Cemp> list = new List<Cemp>();
            //for (int i = 0; i < viewModelEvalwithother.members.ToList().Count; i++)
            //{
            //    var tt = new Cemp
            //    {
            //        Cempid = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().Cempid ?? "",
            //        CEMPNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPNAME ?? "",
            //        CEMPPASSWRD = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPPASSWRD ?? "",
            //        CEMPNO = viewModelEvalwithother.members.ElementAt(i).commitedescession.ToString() ?? "",
            //        CEMPPASSWRD1 = viewModelEvalwithother.members.ElementAt(i).announce.ToString() ?? "",
            //        EncryptedId = _protector.Protect(viewModelEvalwithother.members.ElementAt(i).userid.ToString()),
            //        CLSSNO = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CLSSNO ?? "",
            //        grade = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().grade ?? "",
            //        DEP_NAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().DEP_NAME ?? "",
            //        PARENTNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().PARENTNAME ?? "",
            //        CEMPHIRINGDATEHIJRA = Convert.ToDateTime(_context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPHIRINGDATEHIJRA).Date,
            //        CEMPLASTUPGRADEHIJRA = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPLASTUPGRADEHIJRA,
            //        //TaskM10 = HttpContext.Session.GetString("empid")
            //    };
            //    list.Add(tt);
            //}
            //viewModelEvalwithother.cemps = list;

            foreach (var emp in Records.ToList())
            {
                var stringId = emp.cemp.Cempid.ToString();
                emp.cemp.EncryptedId = _protector.Protect(stringId);


                int n = _context.commitez.Where(x => x.userid == emp.cemp.Cempid && x.commitedescession == commit && x.CourcesIdImagecert == announce).ToList().Count;
                int n0 = _context.commitez.ToList().GroupBy(d => d.userentry, dd => dd.userid == emp.cemp.Cempid && dd.CourcesIdImagecert == announce)
                                  .Where(d => d.Count() >= 1)
                                  .Select(d => d.First())
                                  .ToList().Count;
                var res = from l in _context.commitez.Where(x => x.userid == emp.cemp.Cempid && x.commitedescession == commit && x.CourcesIdImagecert == announce).ToList() group l by new { l.userentry } into g select new { g.Key.userentry, value = g.Distinct().Count() };
                int n2 = 0;
                foreach (var item in res)
                {
                    Console.WriteLine(item.userentry + " " + item.value);
                    n2++;
                }
                if (_context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "رئيس اللجنة").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault() != null)
                {
                    emp.cemp.tot1 = _context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "رئيس اللجنة").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault().status;

                }
                if (_context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "نائب رئيس اللجنة").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault() != null)
                {
                    emp.cemp.tot2 = _context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "نائب رئيس اللجنة").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault().status;
                }
                if (_context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة1").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault() != null)
                {
                    emp.cemp.tot3 = _context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة1").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault().status;
                }
                if (_context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة2").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault() != null)
                {
                    emp.cemp.tot4 = _context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة2").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault().status;
                }
                if (_context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة3").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault() != null)
                {
                    emp.cemp.tot5 = _context.commitez.Where(z => z.userentry == _context.commite.Where(c => c.commitedescession == commit && c.postion == "عضو اللجنة3").FirstOrDefault().userid && z.CourcesIdImagecert == announce && z.userid == emp.cemp.Cempid).FirstOrDefault().status;
                }
                emp.cemp.tot6 = (Convert.ToDecimal(emp.cemp.tot5) + Convert.ToDecimal(emp.cemp.tot4) + Convert.ToDecimal(emp.cemp.tot3) + Convert.ToDecimal(emp.cemp.tot2) + Convert.ToDecimal(emp.cemp.tot1)) / n2;
                if (emp.cemp.tot6 >= 100)
                {
                    //TempData["sumgrade"] = "100.00";
                    emp.cemp.tot6 = 100;

                }
                else
                {
                    // TempData["sumgrade"] = sumgrade;
                    emp.cemp.tot6 = emp.cemp.tot6;
                }

                Cemp cemp1 = _context.Cemps.Where(v => v.Cempid == emp.cemp.Cempid).FirstOrDefault();

                PersnolEmpGrade persnolEmpGrade = new PersnolEmpGrade();
                persnolEmpGrade.empname = cemp1.CEMPNAME;
                persnolEmpGrade.empnational = cemp1.CEMPPASSWRD;
                persnolEmpGrade.empgrade =Convert.ToString(emp.cemp.tot6);
                persnolEmpGrade.empdate = Convert.ToDateTime(_context.Members.Where(x => x.announce == announce).FirstOrDefault().dateexcute1);
                _context.PersnolEmpGrade.Add(persnolEmpGrade);
                _context.SaveChanges();

                //ViewBag.Message2 = "تمت الاضافة والتحديث";

                // add logs 
                APersonalEmpLogs aPersonalEmpLogs = new APersonalEmpLogs();
                aPersonalEmpLogs.requestid = persnolEmpGrade.seriad.ToString();
                aPersonalEmpLogs.userr = HttpContext.Session.GetString("username");
                aPersonalEmpLogs.tt = DateTime.Now;
                _context.APersonalEmpLogs.Add(aPersonalEmpLogs);
                _context.SaveChanges();
                if (emp.cemp.tot1 == null)
                {
                    sb.Append(emp.cemp.CEMPNAME.ToString() + ',');
                    //TempData["TDFriend1"] = sb.ToString();
                    count1++;
                }
                //TempData["TDFriend10"] = count1;
                if (emp.cemp.tot2 == null)
                {
                    sb2.Append(emp.cemp.CEMPNAME.ToString() + ',');
                    //TempData["TDFriend2"] = sb2.ToString();
                    count2++;
                }
                //TempData["TDFriend20"] = count2;
                if (emp.cemp.tot3 == null)
                {
                    sb3.Append(emp.cemp.CEMPNAME.ToString() + ',');
                    //TempData["TDFriend3"] = sb3.ToString();
                    count3++;
                }
                //TempData["TDFriend30"] = count3;
                if (emp.cemp.tot4 == null)
                {
                    sb4.Append(emp.cemp.CEMPNAME.ToString() + ',');
                    //TempData["TDFriend4"] = sb4.ToString();
                    count4++;
                }
                //TempData["TDFriend40"] = count4;
                if (emp.cemp.tot5 == null)
                {
                    sb5.Append(emp.cemp.CEMPNAME.ToString() + ',');
                    //TempData["TDFriend5"] = sb5.ToString();
                    count5++;
                }
                //TempData["TDFriend50"] = count5;
                sumgrade = 0.0;
                ACourcesMasters = _context.ACourcesMasters.Where(e => e.CourcesEndDate.Date >= Convert.ToDateTime(emp.cemp.CEMPLASTUPGRADEHIJRA).Date && e.CourcesEndDate.Date <= (_context.Members.Where(x => x.announce == announce).FirstOrDefault().dateexcute1.Value.Date) && e.Cempid == emp.cemp.Cempid).ToList();
                foreach (var emp0 in ACourcesMasters.ToList())
                {
                    if (_context.MasterRequestTypeIds.Where(z => z.COURCES_IDMASTER == emp0.CourcesIdmaster && z.MasterRequestType == 1).FirstOrDefault() != null)
                    {
                        if (emp0.CourcesIdType == 1)
                        {
                            if (emp0.CourcesIdType == 1 && emp0.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                            {
                                emp0.gradetocourse = 40.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 1 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                            {

                                emp0.gradetocourse = 30.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }
                        else if (emp0.CourcesIdType == 2)
                        {
                            if (emp0.CourcesIdType == 2 && emp0.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                            {
                                emp0.gradetocourse = 80.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 2 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                            {
                                emp0.gradetocourse = 60.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 2 && emp0.COURCES_EXCUTION.Equals("جهة تدريب بالقطاع الخاص"))
                            {
                                emp0.gradetocourse = 40.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }
                        else if (emp0.CourcesIdType == 3)
                        {
                            if (emp0.CourcesIdType == 3 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                            {
                                emp0.gradetocourse = 1.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }
                        else if (emp0.CourcesIdType == 4 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {

                            if (emp0.CourcesIdType == 4 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && emp0.CourcesIdEstimate == 1)
                            {
                                emp0.gradetocourse = 50.0;
                                sumgrade += emp0.gradetocourse;
                            }
                            else if (emp0.CourcesIdType == 4 && emp0.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && emp0.CourcesIdEstimate == 2)
                            {
                                emp0.gradetocourse = 25.0;
                                sumgrade += emp0.gradetocourse;
                            }
                        }

                    }

                    //emp.gradetocourse0 = sumgrade;


                }
                if (sumgrade >= 100.00)
                {
                    //TempData["sumgrade"] = "100.00";
                    emp.cemp.cbrowser = "100";

                }
                else
                {
                    // TempData["sumgrade"] = sumgrade;
                    emp.cemp.cbrowser = sumgrade.ToString();
                }
                // emp.gradetocourse0 = sumgrade;
                // emp.cemp.cbrowser = sumgrade.ToString();
                //emp.ACourcesMasters.gradetocourse0 = sumgrade;
                List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                av1 = vAEvaluationGoals[0];
                av2 = vAEvaluationGoals[1];
                av3 = vAEvaluationGoals[2];
                av4 = vAEvaluationGoals[3];
                if (vAEvaluationGoals.Count > 4)
                {
                    av5 = vAEvaluationGoals[4];

                }
                if (vAEvaluationGoals.Count > 5)
                {
                    av6 = vAEvaluationGoals[5];
                }
                List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                am1 = vAEvaluationCompetenciesMs[0];
                am2 = vAEvaluationCompetenciesMs[1];
                am3 = vAEvaluationCompetenciesMs[2];
                am4 = vAEvaluationCompetenciesMs[3];
                am5 = vAEvaluationCompetenciesMs[4];
                am6 = vAEvaluationCompetenciesMs[5];
                if (vAEvaluationCompetenciesMs.Count > 6)
                {

                    am7 = vAEvaluationCompetenciesMs[6];
                }

                List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                ad1 = vAEvaluationCompetenciesDs[0];
                ad2 = vAEvaluationCompetenciesDs[1];
                ad3 = vAEvaluationCompetenciesDs[2];
                ad4 = vAEvaluationCompetenciesDs[3];
                ad5 = vAEvaluationCompetenciesDs[4];
                ad6 = vAEvaluationCompetenciesDs[5];
                ad7 = vAEvaluationCompetenciesDs[6];
                ad8 = vAEvaluationCompetenciesDs[7];
                ad9 = vAEvaluationCompetenciesDs[8];
                ad10 = vAEvaluationCompetenciesDs[9];
                ad11 = vAEvaluationCompetenciesDs[10];
                ad12 = vAEvaluationCompetenciesDs[11];
                ad13 = vAEvaluationCompetenciesDs[12];
                ad14 = vAEvaluationCompetenciesDs[13];
                ad15 = vAEvaluationCompetenciesDs[14];
                ad16 = vAEvaluationCompetenciesDs[15];
                ad17 = vAEvaluationCompetenciesDs[16];
                ad18 = vAEvaluationCompetenciesDs[17];
                if (vAEvaluationCompetenciesDs.Count > 18)
                {

                    ad19 = vAEvaluationCompetenciesDs[18];
                    ad20 = vAEvaluationCompetenciesDs[19];
                    ad21 = vAEvaluationCompetenciesDs[20];
                    ad22 = vAEvaluationCompetenciesDs[21];
                    ad23 = vAEvaluationCompetenciesDs[22];
                }
                if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString(((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('"+emp.cemp.CEMPPASSWRD+"', '"+emp.cemp.CEMPNO+"','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '"+ emp.AEvaluationEmp.tot1 + "', "+Convert.ToInt32(emp.AEvaluationEmp.tot4)+") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();

                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "3 " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();

                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);


                }

                emp.cemp.tot7 = Convert.ToDecimal(emp.AEvaluationEmp.tot3) * 30 / 100 + Convert.ToDecimal(emp.cemp.cbrowser) * 30 / 100 + Convert.ToDecimal(emp.cemp.tot6) * 40 / 100;
            }

            @ViewData["Message2"] = " تم النشر والتحديث وتظهر الان الدرجات في خدمة الترقيات للموظفين بالمحضر .. !";
            return new PartialViewResult
            {
                ViewName = "_HelloWorldPartial0",
                ViewData = this.ViewData

            };

        }
        [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
<<<<<<< HEAD
        public IActionResult OnGetPartial00(string announce)
        {
            Thread.Sleep(5000);

            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            var count2022 = _context.EvalRequestTypeIds2.Where(z => z.OfferedRequestType == 2022).ToList().Count;
            string conString = this.Configuration.GetConnectionString("hr");
            using (SqlConnection con = new SqlConnection(conString))
            {

                using (SqlCommand cmd = new SqlCommand())
                {
                    cmd.CommandType = CommandType.Text;
                    cmd.Connection = con;
                    cmd.Parameters.Clear();
                    cmd.CommandText = "UPDATE [dbo].[EvalDetails2] SET [OfferedRequestTypeSatus]=@UserId WHERE [OfferedRequestTypeSatus]=@UserName;update [hr].[dbo].[EvalRequestTypeId2] set OfferedRequestType=@UserId where OfferedRequestType=@UserName ";
                    cmd.Parameters.AddWithValue("@UserId",0);
                    cmd.Parameters.AddWithValue("@UserName",2022);
                    //cmd.Parameters.AddWithValue("@DateExcute", ViewModelEvalwithother.c12);
                    //cmd.Parameters.AddWithValue("@CommiteDe", c10);
                    //cmd.Parameters.AddWithValue("@UserEntry", HttpContext.Session.GetString("username"));
                    //cmd.Parameters.AddWithValue("@TimeEntry", DateTime.Now);
                    //cmd.Parameters.AddWithValue("@Announce", c11);
                    //cmd.Parameters.AddWithValue("@Status", txtCountry0);
                    //cmd.Parameters.AddWithValue("@Status0", 0);
                    con.Open();
                    cmd.ExecuteNonQuery();
                    con.Close();
                }
            }
            @ViewData["Message2"] = $" تم فتح عدد {count2022} ميثاق لدورة التقييم لهذا العام {DateTime.Now.Year}  .. !";
            return new PartialViewResult
            {
                ViewName = "_HelloWorldPartial00",
                ViewData = this.ViewData

            };

        }
        [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public IActionResult OnGetPartial000(string announce)
        {
            Thread.Sleep(5000);

            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            var count2022 = _context.AEvaluationEmps.Where(z => z.CovenantYear == DateTime.Now.Year).ToList().Count;
            if (DateTime.Now.Month ==6 || DateTime.Now.Month == 7)
            {
                var looplist = _context.AEvaluationEmps.Where(x => x.CovenantYear == DateTime.Now.Year).ToList();
                foreach(var emp in looplist.ToList())
                {
                string conString = this.Configuration.GetConnectionString("hr");
                using (SqlConnection con = new SqlConnection(conString))
                {

                    using (SqlCommand cmd = new SqlCommand())
                    {
                        cmd.CommandType = CommandType.Text;
                        cmd.Connection = con;
                        cmd.Parameters.Clear();
                        cmd.CommandText = "UPDATE [dbo].[EvalDetails] SET [OfferedRequestTypeSatus]=@UserId,[OfferedRequestTo3]=@UserId2 WHERE [COURCES_IDOffered]=@UserName;update [hr].[dbo].[EvalRequestTypeId] set OfferedRequestType=@UserId where COURCES_IDOffered=@UserName ";
                        cmd.Parameters.AddWithValue("@UserId", 0);
                        cmd.Parameters.AddWithValue("@UserId2", 0);
                        cmd.Parameters.AddWithValue("@UserName", emp.Idd);
                        //cmd.Parameters.AddWithValue("@DateExcute", ViewModelEvalwithother.c12);
                        //cmd.Parameters.AddWithValue("@CommiteDe", c10);
                        //cmd.Parameters.AddWithValue("@UserEntry", HttpContext.Session.GetString("username"));
                        //cmd.Parameters.AddWithValue("@TimeEntry", DateTime.Now);
                        //cmd.Parameters.AddWithValue("@Announce", c11);
                        //cmd.Parameters.AddWithValue("@Status", txtCountry0);
                        //cmd.Parameters.AddWithValue("@Status0", 0);
                        con.Open();
                        cmd.ExecuteNonQuery();
                        con.Close();
                    }
                }
                }

                @ViewData["Message2"] = $" تم فتح عدد {count2022} ميثاق  للتعديل لهذا العام {DateTime.Now.Year}  .. !";
            }
            else
            {
                @ViewData["Message2"] = $" فقط يتم فتح الميثاق للتعديل في شهر 6 و7 من كل عام   {DateTime.Now.Year}  .. !";
            }
            return new PartialViewResult
            {
                ViewName = "_HelloWorldPartial00",
                ViewData = this.ViewData

            };

        }

        [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
=======
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
        public IActionResult Uploadmmm0()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            viewModelEvalwithother.commites = _context.commite.ToList();
           // viewModelEvalwithother.members = _context.Members.Where(x => x.userid != "" && x.username != "").ToList();
            // add commite
            List<Cemp> list = new List<Cemp>();
            for (int i = 0; i < viewModelEvalwithother.commites.ToList().Count; i++)
            {
                var tt = new Cemp
                {
                    Cempid = _context.Cemps.Where(f => f.Cempid == viewModelEvalwithother.commites.ElementAt(i).userid.ToString()).FirstOrDefault().Cempid ?? "",
                    CEMPNAME = _context.Cemps.Where(f => f.Cempid == viewModelEvalwithother.commites.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPNAME ?? "",
                    CEMPPASSWRD = _context.Cemps.Where(f => f.Cempid == viewModelEvalwithother.commites.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPPASSWRD ?? "",
                    CEMPNO = viewModelEvalwithother.commites.ElementAt(i).commitedescession.ToString() ?? "",
                   // CEMPPASSWRD1 = viewModelEvalwithother.commites.ElementAt(i).announce.ToString() ?? "",
                    EncryptedId = _protector.Protect(viewModelEvalwithother.commites.ElementAt(i).userid.ToString()),
                    CLSSNO = _context.Cemps.Where(f => f.Cempid == viewModelEvalwithother.commites.ElementAt(i).userid.ToString()).FirstOrDefault().CLSSNO ?? "",
                    grade = _context.Cemps.Where(f => f.Cempid == viewModelEvalwithother.commites.ElementAt(i).userid.ToString()).FirstOrDefault().grade ?? "",
                    DEP_NAME = _context.Cemps.Where(f => f.Cempid == viewModelEvalwithother.commites.ElementAt(i).userid.ToString()).FirstOrDefault().DEP_NAME ?? "",
                    PARENTNAME = _context.Cemps.Where(f => f.Cempid == viewModelEvalwithother.commites.ElementAt(i).userid.ToString()).FirstOrDefault().PARENTNAME ?? "",
                    CEMPHIRINGDATEHIJRA = Convert.ToDateTime(_context.Cemps.Where(f => f.Cempid == viewModelEvalwithother.commites.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPHIRINGDATEHIJRA).Date,
                    CEMPLASTUPGRADEHIJRA = _context.Cemps.Where(f => f.Cempid == viewModelEvalwithother.commites.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPLASTUPGRADEHIJRA,
                    cbrowser = viewModelEvalwithother.commites.ElementAt(i).indexp.ToString() ?? "",
                    cip = viewModelEvalwithother.commites.ElementAt(i).postion.ToString() ?? "",
                    //TaskM10 = HttpContext.Session.GetString("empid")
                };
                list.Add(tt);
            }
            viewModelEvalwithother.cemps = list;
            //List<memberst> Memberst0 = _context.Memberst.Where(s => s.userentry[0] == '1').OrderBy(s=>s.id).Select(x=>x.id).ToList();
            ViewData["Cempid"] = new SelectList(_context.Memberst, "userid", "username");
            List<members> noDups = _context.Members.ToList().GroupBy(d => new { d.announce })
                                  .Where(d => d.Count() >= 1)
                                  .Select(d => d.First())
                                  .ToList();
            ViewData["Cempid2"] = new SelectList(noDups.ToList(), "announce", "announce");
            return View(viewModelEvalwithother);
        }
        [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public IActionResult Uploadmmm1(string announce)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            List<members> noDups0 = _context.Members.ToList().GroupBy(d => new { d.announce })
                                 .Where(d => d.Count() >= 1)
                                 .Select(d => d.First())
                                 .ToList();
            ViewData["Cempid1"] = new SelectList(noDups0.ToList(), "announce", "announce");
            if (announce == null)
            {
                announce = "111111";
            }
            ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            //viewModelEvalwithother.commite = _context.commite.Where(z => z.userid == HttpContext.Session.GetString("username") && z.status == 0).FirstOrDefault();
            viewModelEvalwithother.members = _context.Members.Where(x=>x.userid!=""&&x.username!=""&&x.announce==announce).ToList();
            // add commite
            List<Cemp> list = new List<Cemp>();
            for (int i = 0; i < viewModelEvalwithother.members.ToList().Count; i++)
            {
                var tt = new Cemp
                {
                    Cempid = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().Cempid ?? "",
                    CEMPNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPNAME ?? "",
                    CEMPPASSWRD = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPPASSWRD ?? "",
                    mobileno = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().mobileno ?? "",
                    CEMPJOBNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPJOBNAME ?? "",
                    CEMPNO = viewModelEvalwithother.members.ElementAt(i).commitedescession.ToString() ?? "",
                    CEMPPASSWRD1= viewModelEvalwithother.members.ElementAt(i).announce.ToString() ?? "",
                    EncryptedId = _protector.Protect(viewModelEvalwithother.members.ElementAt(i).userid.ToString()),
                    CLSSNO = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CLSSNO ?? "",
                    grade = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().grade ?? "",
                    DEP_NAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().DEP_NAME ?? "",
                    PARENTNAME = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().PARENTNAME ?? "",
                    CEMPHIRINGDATEHIJRA = Convert.ToDateTime(_context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPHIRINGDATEHIJRA).Date,
                    CEMPLASTUPGRADEHIJRA = _context.Cemps.Where(f => f.CEMPPASSWRD == viewModelEvalwithother.members.ElementAt(i).userid.ToString()).FirstOrDefault().CEMPLASTUPGRADEHIJRA,
                    //TaskM10 = HttpContext.Session.GetString("empid")
                };
                list.Add(tt);
            }
            viewModelEvalwithother.cemps = list;
            //List<commite> noDups = _context.commite.ToList().GroupBy(d => new { d.commitedescession })
            //                    .Where(d => d.Count() >= 1)
            //                    .Select(d => d.First())
            //                    .ToList();
            //List<commite> NN = _context.commite.Distinct().ToList();
            //ViewData["Cempid2"] = new SelectList(NN, "userid", "username");
            return View(viewModelEvalwithother);
        }

        [HttpPost]
        public IActionResult Uploadmm(Cemp cemp, string t1)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            if (cemp != null)
            {
                Cemp cemp1 = _context.Cemps.Where(v => v.Cempid == cemp.Cempid).FirstOrDefault();

                PersnolEmpGrade persnolEmpGrade = new PersnolEmpGrade();
                persnolEmpGrade.empname = cemp1.CEMPNAME;
                persnolEmpGrade.empnational = cemp1.CEMPPASSWRD;
                persnolEmpGrade.empgrade = cemp.DEP_NAME;
                persnolEmpGrade.empdate = Convert.ToDateTime(t1);
                _context.PersnolEmpGrade.Add(persnolEmpGrade);
                _context.SaveChanges();

                ViewBag.Message2 = "تمت الاضافة والتحديث";

                // add logs 
                APersonalEmpLogs aPersonalEmpLogs = new APersonalEmpLogs();
                aPersonalEmpLogs.requestid = persnolEmpGrade.seriad.ToString();
                aPersonalEmpLogs.userr = HttpContext.Session.GetString("username");
                aPersonalEmpLogs.tt = DateTime.Now;
                _context.APersonalEmpLogs.Add(aPersonalEmpLogs);
                _context.SaveChanges();

            }
            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");
            return View();
        }

        [Authorize(Roles = "Admin")]

        public async Task<IActionResult> Index()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail> EvalDetails = _context.EvalDetailss.ToList();
            List<EvalRequestTypeId> EvalRequestTypeIds = _context.EvalRequestTypeIds.ToList();
            //List<Evalcomment> evalcommentss = _context.EvalComments.ToList();


            var Records = from e in AEvaluationEmps
                          //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                          //from d in table1.ToList()
                          //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                          //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                          //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                          //from j in table3.ToList()
                          join f in EvalDetails on e.Idd equals f.CourcesIdoffered into table4
                          from f in table4.ToList()
                          where f.OfferedRequestTypeSatus == 0
                          join h in EvalRequestTypeIds on e.Idd equals h.CourcesIdoffered into table5
                          from h in table5.ToList()
                          where h.OfferedRequestType == 0
                          


                          select new ViewModelEvalwithother
                          {
                              AEvaluationEmp = e,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              evalDetail = f,
                              evalRequestTypeId = h,
                          
                          };
            return View(Records);

            //return View(await _context.ViewModelEvalwithother.ToListAsync());
        }

       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public async Task<IActionResult> Search1()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail> EvalDetails = _context.EvalDetailss.ToList();
            List<EvalRequestTypeId> EvalRequestTypeIds = _context.EvalRequestTypeIds.ToList();
            //List<Evalcomment> evalcommentss = _context.EvalComments.ToList();
            List<Cemp> Cemps = _context.Cemps.ToList();


            var Records = from e in AEvaluationEmps
                          join d in Cemps on e.Empno equals Convert.ToInt32(d.Cempid) into table1
                          from d in table1.ToList()
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join f in EvalDetails on e.Idd equals f.CourcesIdoffered into table4
                          from f in table4.ToList()
                          where f.OfferedRequestTypeSatus== 0
                          where f.OfferedRequestFrom== HttpContext.Session.GetString("username") /*&& e.year == "2022"*/
                          join h in EvalRequestTypeIds on e.Idd equals h.CourcesIdoffered into table5
                          from h in table5.ToList()
                          where h.OfferedRequestType == 0



                          select new ViewModelEvalwithother
                          {
                              AEvaluationEmp = e,
                              cemp = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              evalDetail = f,
                              evalRequestTypeId = h,

                          };

            foreach (var emp in Records.ToList())
            {
                var stringId = emp.AEvaluationEmp.Idd.ToString();
                emp.AEvaluationEmp.EncryptedIdd = _protector.Protect(stringId);
                //emp.AEvaluationGoal.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesM.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesD.EncryptedCovenantId= _protector.Protect(stringId);

                ////Previous code removed for the example clarity
                //var timeLimitedProtector = _protector.ToTimeLimitedDataProtector();
                //var timeLimitedData = timeLimitedProtector.Protect("Test timed protector", lifetime: TimeSpan.FromSeconds(2));
                ////just to test that this action works as long as life-time hasn't expired
                //var timedUnprotectedData = timeLimitedProtector.Unprotect(timeLimitedData);
                //Thread.Sleep(3000);
                //var anotherTimedUnprotectTry = timeLimitedProtector.Unprotect(timeLimitedData);
            }

            return View(Records);

            //return View(await _context.ViewModelEvalwithother.ToListAsync());
        }
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public async Task<IActionResult> Search()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail2> EvalDetails2 = _context.EvalDetailss2.ToList();
            List<EvalRequestTypeId2> EvalRequestTypeIds2 = _context.EvalRequestTypeIds2.ToList();
            //List<Evalcomment> evalcommentss = _context.EvalComments.ToList();
            List<Cemp> Cemps = _context.Cemps.ToList();


            var Records = from e in AEvaluationEmps
                          join d in Cemps on e.Empno equals Convert.ToInt32(d.Cempid) into table1
                          from d in table1.ToList()
                              //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                              //from d in table1.ToList()
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join f in EvalDetails2 on e.Idd equals f.CourcesIdoffered into table4
                          from f in table4.ToList()
                          where f.OfferedRequestTypeSatus == 0 &&f.OfferedRequestTo3!="1"
                          where f.OfferedRequestFrom == HttpContext.Session.GetString("username") && e.year == "2022"
                          join h in EvalRequestTypeIds2 on e.Idd equals h.CourcesIdoffered into table5
                          from h in table5.ToList()
                          where h.OfferedRequestType == 0



                          select new ViewModelEvalwithother
                          {
                              AEvaluationEmp = e,
                              cemp = d,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              evalDetail2 = f,
                              evalRequestTypeId2 = h,

                          };
            foreach (var emp in Records.ToList())
            {
                var stringId = emp.AEvaluationEmp.Idd.ToString();
                emp.AEvaluationEmp.EncryptedIdd = _protector.Protect(stringId);
                //emp.AEvaluationGoal.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesM.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesD.EncryptedCovenantId= _protector.Protect(stringId);

                ////Previous code removed for the example clarity
                //var timeLimitedProtector = _protector.ToTimeLimitedDataProtector();
                //var timeLimitedData = timeLimitedProtector.Protect("Test timed protector", lifetime: TimeSpan.FromSeconds(2));
                ////just to test that this action works as long as life-time hasn't expired
                //var timedUnprotectedData = timeLimitedProtector.Unprotect(timeLimitedData);
                //Thread.Sleep(3000);
                //var anotherTimedUnprotectTry = timeLimitedProtector.Unprotect(timeLimitedData);
            }
            return View(Records);

            //return View(await _context.ViewModelEvalwithother.ToListAsync());
        }

       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public async Task<IActionResult> approveduser()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail> EvalDetails = _context.EvalDetailss.ToList();
            List<EvalRequestTypeId> EvalRequestTypeIds = _context.EvalRequestTypeIds.ToList();
            //List<Evalcomment> evalcommentss = _context.EvalComments.ToList();


            var Records = from e in AEvaluationEmps
                              //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                              //from d in table1.ToList()
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join f in EvalDetails on e.Idd equals f.CourcesIdoffered into table4
                          from f in table4.ToList()
                          where f.OfferedRequestTypeSatus == 1 
                          where f.OfferedRequestFrom == HttpContext.Session.GetString("username") /*&& e.year == "2021"*/
                          join h in EvalRequestTypeIds on e.Idd equals h.CourcesIdoffered into table5
                          from h in table5.ToList()
                          where h.OfferedRequestType == 1



                          select new ViewModelEvalwithother
                          {
                              AEvaluationEmp = e,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              evalDetail = f,
                              evalRequestTypeId = h,

                          };
            foreach (var emp in Records.ToList())
            {
                var stringId = emp.AEvaluationEmp.Idd.ToString();
                emp.AEvaluationEmp.EncryptedIdd = _protector.Protect(stringId);
                //emp.AEvaluationGoal.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesM.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesD.EncryptedCovenantId= _protector.Protect(stringId);

                ////Previous code removed for the example clarity
                //var timeLimitedProtector = _protector.ToTimeLimitedDataProtector();
                //var timeLimitedData = timeLimitedProtector.Protect("Test timed protector", lifetime: TimeSpan.FromSeconds(2));
                ////just to test that this action works as long as life-time hasn't expired
                //var timedUnprotectedData = timeLimitedProtector.Unprotect(timeLimitedData);
                //Thread.Sleep(3000);
                //var anotherTimedUnprotectTry = timeLimitedProtector.Unprotect(timeLimitedData);
            }
            return View(Records);

            //return View(await _context.ViewModelEvalwithother.ToListAsync());
        }
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public async Task<IActionResult> pendinguser1111()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
<<<<<<< HEAD
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.Where(x => x.CovenantYear >= 2022).ToList();
=======
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail> EvalDetails = _context.EvalDetailss.ToList();
            List<EvalRequestTypeId> EvalRequestTypeIds = _context.EvalRequestTypeIds.ToList();
            List<Evalcomment2> evalcommentss = _context.EvalComments2.ToList();
            List<Cemp> cemps = _context.Cemps.ToList();
            var Records = from e in AEvaluationEmps
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join f in EvalDetails on e.Idd equals f.CourcesIdoffered into table4
                          from f in table4.ToList()
<<<<<<< HEAD
                          where f.OfferedRequestTypeSatus == 0 /*&& e.year == "2022"*/
=======
                          where f.OfferedRequestTypeSatus == 0 && e.year == "2022"
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                          //where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                          join h in EvalRequestTypeIds on e.Idd equals h.CourcesIdoffered into table5
                          from h in table5.ToList()
                          where h.OfferedRequestType == 0
                          //join mm in evalcommentss on f.OfferedDetailsSerial equals mm.Offerdetailsid into table6
                          //from mm in table6.ToList()
                          //where mm.Offerdetailsid == f.OfferedDetailsSerial
                          join gg in cemps on e.Empno equals Convert.ToInt32(gg.Cempid) into table99
                          from gg in table99.ToList()
                          where gg.CEMPPASSWRD.Length == 10



                          select new ViewModelEvalwithother
                          {
                              AEvaluationEmp = e,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              evalDetail = f,
                              evalRequestTypeId = h,
                              //evalcomment2 = mm,
                              cemp = gg,

                          };
            foreach (var emp in Records.ToList())
            {
                var stringId = emp.AEvaluationEmp.Idd.ToString();
                emp.AEvaluationEmp.EncryptedIdd = _protector.Protect(stringId);
                TempData["GRADE1"] = "2022";
                //var approveddate = _context.EvalComments2.Where(x => x.Offerdetailsid == emp.evalDetail2.OfferedDetailsSerial).FirstOrDefault();
                //if (approveddate != null)
                //{
                //    TempData["GRADE1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("yyyy");
                //    TempData["GRADEN1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                //}
                List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                av1 = vAEvaluationGoals[0];
                av2 = vAEvaluationGoals[1];
                av3 = vAEvaluationGoals[2];
                av4 = vAEvaluationGoals[3];
                if (vAEvaluationGoals.Count > 4)
                {
                    av5 = vAEvaluationGoals[4];

                }
                if (vAEvaluationGoals.Count > 5)
                {
                    av6 = vAEvaluationGoals[5];
                }
                List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                am1 = vAEvaluationCompetenciesMs[0];
                am2 = vAEvaluationCompetenciesMs[1];
                am3 = vAEvaluationCompetenciesMs[2];
                am4 = vAEvaluationCompetenciesMs[3];
                am5 = vAEvaluationCompetenciesMs[4];
                am6 = vAEvaluationCompetenciesMs[5];
                if (vAEvaluationCompetenciesMs.Count > 6)
                {

                    am7 = vAEvaluationCompetenciesMs[6];
                }

                List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                ad1 = vAEvaluationCompetenciesDs[0];
                ad2 = vAEvaluationCompetenciesDs[1];
                ad3 = vAEvaluationCompetenciesDs[2];
                ad4 = vAEvaluationCompetenciesDs[3];
                ad5 = vAEvaluationCompetenciesDs[4];
                ad6 = vAEvaluationCompetenciesDs[5];
                ad7 = vAEvaluationCompetenciesDs[6];
                ad8 = vAEvaluationCompetenciesDs[7];
                ad9 = vAEvaluationCompetenciesDs[8];
                ad10 = vAEvaluationCompetenciesDs[9];
                ad11 = vAEvaluationCompetenciesDs[10];
                ad12 = vAEvaluationCompetenciesDs[11];
                ad13 = vAEvaluationCompetenciesDs[12];
                ad14 = vAEvaluationCompetenciesDs[13];
                ad15 = vAEvaluationCompetenciesDs[14];
                ad16 = vAEvaluationCompetenciesDs[15];
                ad17 = vAEvaluationCompetenciesDs[16];
                ad18 = vAEvaluationCompetenciesDs[17];
                if (vAEvaluationCompetenciesDs.Count > 18)
                {

                    ad19 = vAEvaluationCompetenciesDs[18];
                    ad20 = vAEvaluationCompetenciesDs[19];
                    ad21 = vAEvaluationCompetenciesDs[20];
                    ad22 = vAEvaluationCompetenciesDs[21];
                    ad23 = vAEvaluationCompetenciesDs[22];
                }
                if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString(((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";
                    //return View(Records);
                }

            }
            return View(Records);

            //return View(await _context.ViewModelEvalwithother.ToListAsync());
        }

       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public async Task<IActionResult> pendinguser111()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail2> EvalDetails2 = _context.EvalDetailss2.ToList();
            List<EvalRequestTypeId2> EvalRequestTypeIds2 = _context.EvalRequestTypeIds2.ToList();
            List<Evalcomment2> evalcommentss = _context.EvalComments2.ToList();
            List<Cemp> cemps = _context.Cemps.ToList();
            var Records = from e in AEvaluationEmps
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join f in EvalDetails2 on e.Idd equals f.CourcesIdoffered into table4
                          from f in table4.ToList()
<<<<<<< HEAD
                          where f.OfferedRequestTypeSatus == 0 /*&& e.year=="2021"*/
=======
                          where f.OfferedRequestTypeSatus == 0 && e.year=="2021"
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                          //where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                          join h in EvalRequestTypeIds2 on e.Idd equals h.CourcesIdoffered into table5
                          from h in table5.ToList()
                          where h.OfferedRequestType == 0
                          //join mm in evalcommentss on f.OfferedDetailsSerial equals mm.Offerdetailsid into table6
                          //from mm in table6.ToList()
                          //where mm.Offerdetailsid == f.OfferedDetailsSerial
                          join gg in cemps on e.Empno equals Convert.ToInt32(gg.Cempid) into table99
                          from gg in table99.ToList()
<<<<<<< HEAD
                          where gg.CEMPPASSWRD.Length==10 &&gg.status!="1"
=======
                          where gg.CEMPPASSWRD.Length==10
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b



                          select new ViewModelEvalwithother
                          {
                              AEvaluationEmp = e,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              evalDetail2 = f,
                              evalRequestTypeId2 = h,
                              //evalcomment2 = mm,
                              cemp = gg,

                          };
            foreach (var emp in Records.ToList())
            {
                var stringId = emp.AEvaluationEmp.Idd.ToString();
                emp.AEvaluationEmp.EncryptedIdd = _protector.Protect(stringId);
                TempData["GRADE1"] = "2021";
                //var approveddate = _context.EvalComments2.Where(x => x.Offerdetailsid == emp.evalDetail2.OfferedDetailsSerial).FirstOrDefault();
                //if (approveddate != null)
                //{
                //    TempData["GRADE1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("yyyy");
                //    TempData["GRADEN1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                //}
                List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                av1 = vAEvaluationGoals[0];
                av2 = vAEvaluationGoals[1];
                av3 = vAEvaluationGoals[2];
                av4 = vAEvaluationGoals[3];
                if (vAEvaluationGoals.Count > 4)
                {
                    av5 = vAEvaluationGoals[4];

                }
                if (vAEvaluationGoals.Count > 5)
                {
                    av6 = vAEvaluationGoals[5];
                }
                List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                am1 = vAEvaluationCompetenciesMs[0];
                am2 = vAEvaluationCompetenciesMs[1];
                am3 = vAEvaluationCompetenciesMs[2];
                am4 = vAEvaluationCompetenciesMs[3];
                am5 = vAEvaluationCompetenciesMs[4];
                am6 = vAEvaluationCompetenciesMs[5];
                if (vAEvaluationCompetenciesMs.Count > 6)
                {

                    am7 = vAEvaluationCompetenciesMs[6];
                }

                List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                ad1 = vAEvaluationCompetenciesDs[0];
                ad2 = vAEvaluationCompetenciesDs[1];
                ad3 = vAEvaluationCompetenciesDs[2];
                ad4 = vAEvaluationCompetenciesDs[3];
                ad5 = vAEvaluationCompetenciesDs[4];
                ad6 = vAEvaluationCompetenciesDs[5];
                ad7 = vAEvaluationCompetenciesDs[6];
                ad8 = vAEvaluationCompetenciesDs[7];
                ad9 = vAEvaluationCompetenciesDs[8];
                ad10 = vAEvaluationCompetenciesDs[9];
                ad11 = vAEvaluationCompetenciesDs[10];
                ad12 = vAEvaluationCompetenciesDs[11];
                ad13 = vAEvaluationCompetenciesDs[12];
                ad14 = vAEvaluationCompetenciesDs[13];
                ad15 = vAEvaluationCompetenciesDs[14];
                ad16 = vAEvaluationCompetenciesDs[15];
                ad17 = vAEvaluationCompetenciesDs[16];
                ad18 = vAEvaluationCompetenciesDs[17];
                if (vAEvaluationCompetenciesDs.Count > 18)
                {

                    ad19 = vAEvaluationCompetenciesDs[18];
                    ad20 = vAEvaluationCompetenciesDs[19];
                    ad21 = vAEvaluationCompetenciesDs[20];
                    ad22 = vAEvaluationCompetenciesDs[21];
                    ad23 = vAEvaluationCompetenciesDs[22];
                }
                if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString(((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";
                    //return View(Records);
                }

            }
<<<<<<< HEAD
            ViewData["Cempid"] = new SelectList(_context.Cemps.Where(z=>z.status!="1"), "Cempid", "CEMPNAME");
            //ViewData["Cempid"] = new SelectList(_context.Memberst, "userid", "username");
=======
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
            return View(Records);

            //return View(await _context.ViewModelEvalwithother.ToListAsync());
        }

       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public async Task<IActionResult> approveduser111()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail2> EvalDetails2 = _context.EvalDetailss2.ToList();
            List<EvalRequestTypeId2> EvalRequestTypeIds2 = _context.EvalRequestTypeIds2.ToList();
            List<Evalcomment2> evalcommentss = _context.EvalComments2.ToList();
            List<Cemp> cemps = _context.Cemps.ToList();
            var Records = from e in AEvaluationEmps
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join f in EvalDetails2 on e.Idd equals f.CourcesIdoffered into table4
                          from f in table4.ToList()
                          where f.OfferedRequestTypeSatus == 1
                          //where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                          join h in EvalRequestTypeIds2 on e.Idd equals h.CourcesIdoffered into table5
                          from h in table5.ToList()
                          where h.OfferedRequestType == 1
                          //join mm in evalcommentss on f.OfferedDetailsSerial equals mm.Offerdetailsid into table6
                          //from mm in table6.ToList()
                          //where mm.Offerdetailsid == f.OfferedDetailsSerial
                          join gg in cemps on e.Empno equals Convert.ToInt32(gg.Cempid) into table99
                          from gg in table99.ToList()
                          where gg.CEMPPASSWRD.Length==10



                          select new ViewModelEvalwithother
                          {
                              AEvaluationEmp = e,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              evalDetail2 = f,
                              evalRequestTypeId2 = h,
                              //evalcomment2 = mm,
                              cemp = gg,

                          };
            foreach (var emp in Records.ToList())
            {
                var stringId = emp.AEvaluationEmp.Idd.ToString();
                emp.AEvaluationEmp.EncryptedIdd = _protector.Protect(stringId);
                TempData["GRADE1"] = "2021";
                //var approveddate = _context.EvalComments2.Where(x => x.Offerdetailsid == emp.evalDetail2.OfferedDetailsSerial).FirstOrDefault();
                //if (approveddate != null)
                //{
                //    TempData["GRADE1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("yyyy");
                //    TempData["GRADEN1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                //}
                List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                av1 = vAEvaluationGoals[0];
                av2 = vAEvaluationGoals[1];
                av3 = vAEvaluationGoals[2];
                av4 = vAEvaluationGoals[3];
                if (vAEvaluationGoals.Count > 4)
                {
                    av5 = vAEvaluationGoals[4];

                }
                if (vAEvaluationGoals.Count > 5)
                {
                    av6 = vAEvaluationGoals[5];
                }
                List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                am1 = vAEvaluationCompetenciesMs[0];
                am2 = vAEvaluationCompetenciesMs[1];
                am3 = vAEvaluationCompetenciesMs[2];
                am4 = vAEvaluationCompetenciesMs[3];
                am5 = vAEvaluationCompetenciesMs[4];
                am6 = vAEvaluationCompetenciesMs[5];
                if (vAEvaluationCompetenciesMs.Count > 6)
                {

                    am7 = vAEvaluationCompetenciesMs[6];
                }

                List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                ad1 = vAEvaluationCompetenciesDs[0];
                ad2 = vAEvaluationCompetenciesDs[1];
                ad3 = vAEvaluationCompetenciesDs[2];
                ad4 = vAEvaluationCompetenciesDs[3];
                ad5 = vAEvaluationCompetenciesDs[4];
                ad6 = vAEvaluationCompetenciesDs[5];
                ad7 = vAEvaluationCompetenciesDs[6];
                ad8 = vAEvaluationCompetenciesDs[7];
                ad9 = vAEvaluationCompetenciesDs[8];
                ad10 = vAEvaluationCompetenciesDs[9];
                ad11 = vAEvaluationCompetenciesDs[10];
                ad12 = vAEvaluationCompetenciesDs[11];
                ad13 = vAEvaluationCompetenciesDs[12];
                ad14 = vAEvaluationCompetenciesDs[13];
                ad15 = vAEvaluationCompetenciesDs[14];
                ad16 = vAEvaluationCompetenciesDs[15];
                ad17 = vAEvaluationCompetenciesDs[16];
                ad18 = vAEvaluationCompetenciesDs[17];
                if (vAEvaluationCompetenciesDs.Count > 18)
                {

                    ad19 = vAEvaluationCompetenciesDs[18];
                    ad20 = vAEvaluationCompetenciesDs[19];
                    ad21 = vAEvaluationCompetenciesDs[20];
                    ad22 = vAEvaluationCompetenciesDs[21];
                    ad23 = vAEvaluationCompetenciesDs[22];
                }
                if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 =Convert.ToString( ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('"+emp.cemp.CEMPPASSWRD+"', '"+emp.cemp.CEMPNO+"','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '"+ emp.AEvaluationEmp.tot1 + "', "+Convert.ToInt32(emp.AEvaluationEmp.tot4)+") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();

                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 =Convert.ToString( (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "3 " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                     ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 =Convert.ToString( (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();

                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "4" :
              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 3 " :
              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "2" :
              ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                      ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                    emp.AEvaluationEmp.tot4 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "4" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 3 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "2" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 9";


                    //OracleConnection Con5 = new OracleConnection(TNS1);
                    //Con5.Open();
                    //OracleCommand cmd = new OracleCommand();
                    //cmd.CommandText = "INSERT INTO MCS_ELTEZAM.EMPLOYEEAPPRAISALINFO (NATIONALID,EMPLOYEEID,APPRAISALID,STARTDATE,ENDDATE,APPRAISALTYPECODE,TRANSACTIONTYPE,RESULT,RATINGCODE) VALUES  ('" + emp.cemp.CEMPPASSWRD + "', '" + emp.cemp.CEMPNO + "','30' ,'17-05-1442','27-05-1443', 'AnnualPerformanceEvaluation', 'Add', '" + emp.AEvaluationEmp.tot1 + "', " + Convert.ToInt32(emp.AEvaluationEmp.tot4) + ") ";
                    ////cmd.CommandText = "Insert into Student(Id, Name, Email)Values(" + student.Id + ",'" + student.Name + "','" + student.Email + "'')";
                    //cmd.Connection = Con5;
                    //cmd.ExecuteNonQuery();
                    //Con5.Close();
                    //return View(Records);
                }

            }
            return View(Records);

            //return View(await _context.ViewModelEvalwithother.ToListAsync());
        }

       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public async Task<IActionResult> approveduser1111()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
<<<<<<< HEAD
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.Where(x => x.CovenantYear >= 2022).ToList();
=======
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.Where(x=>x.year=="2022").ToList();
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail> EvalDetails = _context.EvalDetailss.ToList();
            List<EvalRequestTypeId> EvalRequestTypeIds = _context.EvalRequestTypeIds.ToList();
            List<Evalcomment> evalcommentss = _context.EvalComments.ToList();
            List<Cemp> cemps = _context.Cemps.ToList();
            var Records = from e in AEvaluationEmps
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join f in EvalDetails on e.Idd equals f.CourcesIdoffered into table4
                          from f in table4.ToList()
                          where f.OfferedRequestTypeSatus == 1
                          //where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                          join h in EvalRequestTypeIds on e.Idd equals h.CourcesIdoffered into table5
                          from h in table5.ToList()
                          where h.OfferedRequestType == 1
                          //join mm in evalcommentss on f.OfferedDetailsSerial equals mm.Offerdetailsid into table6
                          //from mm in table6.ToList()
                          //where mm.Offerdetailsid == f.OfferedDetailsSerial
                          join gg in cemps on e.Empno equals Convert.ToInt32(gg.Cempid) into table99
                          from gg in table99.ToList()



                          select new ViewModelEvalwithother
                          {
                              AEvaluationEmp = e,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              evalDetail = f,
                              evalRequestTypeId = h,
                              //evalcomment2 = mm,
                              cemp = gg,

                          };
            foreach (var emp in Records.ToList())
            {
                var stringId = emp.AEvaluationEmp.Idd.ToString();
                emp.AEvaluationEmp.EncryptedIdd = _protector.Protect(stringId);
                TempData["GRADE1"] = "2022";
                //var approveddate = _context.EvalComments2.Where(x => x.Offerdetailsid == emp.evalDetail2.OfferedDetailsSerial).FirstOrDefault();
                //if (approveddate != null)
                //{
                //    TempData["GRADE1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("yyyy");
                //    TempData["GRADEN1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                //}
                List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                av1 = vAEvaluationGoals[0];
                av2 = vAEvaluationGoals[1];
                av3 = vAEvaluationGoals[2];
                av4 = vAEvaluationGoals[3];
                if (vAEvaluationGoals.Count > 4)
                {
                    av5 = vAEvaluationGoals[4];

                }
                if (vAEvaluationGoals.Count > 5)
                {
                    av6 = vAEvaluationGoals[5];
                }
                List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                am1 = vAEvaluationCompetenciesMs[0];
                am2 = vAEvaluationCompetenciesMs[1];
                am3 = vAEvaluationCompetenciesMs[2];
                am4 = vAEvaluationCompetenciesMs[3];
                am5 = vAEvaluationCompetenciesMs[4];
                am6 = vAEvaluationCompetenciesMs[5];
                if (vAEvaluationCompetenciesMs.Count > 6)
                {

                    am7 = vAEvaluationCompetenciesMs[6];
                }

                List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                ad1 = vAEvaluationCompetenciesDs[0];
                ad2 = vAEvaluationCompetenciesDs[1];
                ad3 = vAEvaluationCompetenciesDs[2];
                ad4 = vAEvaluationCompetenciesDs[3];
                ad5 = vAEvaluationCompetenciesDs[4];
                ad6 = vAEvaluationCompetenciesDs[5];
                ad7 = vAEvaluationCompetenciesDs[6];
                ad8 = vAEvaluationCompetenciesDs[7];
                ad9 = vAEvaluationCompetenciesDs[8];
                ad10 = vAEvaluationCompetenciesDs[9];
                ad11 = vAEvaluationCompetenciesDs[10];
                ad12 = vAEvaluationCompetenciesDs[11];
                ad13 = vAEvaluationCompetenciesDs[12];
                ad14 = vAEvaluationCompetenciesDs[13];
                ad15 = vAEvaluationCompetenciesDs[14];
                ad16 = vAEvaluationCompetenciesDs[15];
                ad17 = vAEvaluationCompetenciesDs[16];
                ad18 = vAEvaluationCompetenciesDs[17];
                if (vAEvaluationCompetenciesDs.Count > 18)
                {

                    ad19 = vAEvaluationCompetenciesDs[18];
                    ad20 = vAEvaluationCompetenciesDs[19];
                    ad21 = vAEvaluationCompetenciesDs[20];
                    ad22 = vAEvaluationCompetenciesDs[21];
                    ad23 = vAEvaluationCompetenciesDs[22];
                }
                if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString(((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                  ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";

                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? " 75 " :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
             ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : " 0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    emp.AEvaluationEmp.tot3 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? " 75 " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : " 0";
                    //return View(Records);
                }

            }
            return View(Records);

            //return View(await _context.ViewModelEvalwithother.ToListAsync());
        }

       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public async Task<IActionResult> approveduser11()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            TempData["GRADE"] = "";
            TempData["GRADEN"] = "";
            TempData["GRADE1"] = "";
            TempData["GRADEN1"] = "";
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail2> EvalDetails2 = _context.EvalDetailss2.ToList();
            List<EvalRequestTypeId2> EvalRequestTypeIds2 = _context.EvalRequestTypeIds2.ToList();
            List<Evalcomment2> evalcommentss = _context.EvalComments2.ToList();
            List<Cemp> cemps = _context.Cemps.ToList();
            var Records = from e in AEvaluationEmps
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join f in EvalDetails2 on e.Idd equals f.CourcesIdoffered into table4
                          from f in table4.ToList()
                          where f.OfferedRequestTypeSatus == 1
                          where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                          join h in EvalRequestTypeIds2 on e.Idd equals h.CourcesIdoffered into table5
                          from h in table5.ToList()
                          where h.OfferedRequestType == 1
                          //join mm in evalcommentss on f.OfferedDetailsSerial equals mm.Offerdetailsid into table6
                          //from mm in table6.ToList()
                          //where mm.Offerdetailsid == f.OfferedDetailsSerial
                          join gg in cemps on e.Empno equals Convert.ToInt32(gg.Cempid) into table99
                          from gg in table99.ToList()



                          select new ViewModelEvalwithother
                          {
                              AEvaluationEmp = e,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              evalDetail2 = f,
                              evalRequestTypeId2 = h,
                              //evalcomment2 = mm,
                              cemp = gg,

                          };
            foreach (var emp in Records.ToList())
            {
                var stringId = emp.AEvaluationEmp.Idd.ToString();
                emp.AEvaluationEmp.EncryptedIdd = _protector.Protect(stringId);
                var approveddate = _context.EvalComments2.Where(x => x.Offerdetailsid == emp.evalDetail2.OfferedDetailsSerial).FirstOrDefault();
                if (approveddate != null)
                {
                    TempData["GRADE1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("yyyy");
                    TempData["GRADEN1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                }
                List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                av1 = vAEvaluationGoals[0];
                av2 = vAEvaluationGoals[1];
                av3 = vAEvaluationGoals[2];
                av4 = vAEvaluationGoals[3];
                if (vAEvaluationGoals.Count > 4)
                {
                    av5 = vAEvaluationGoals[4];

                }
                if (vAEvaluationGoals.Count > 5)
                {
                    av6 = vAEvaluationGoals[5];
                }
                List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                am1 = vAEvaluationCompetenciesMs[0];
                am2 = vAEvaluationCompetenciesMs[1];
                am3 = vAEvaluationCompetenciesMs[2];
                am4 = vAEvaluationCompetenciesMs[3];
                am5 = vAEvaluationCompetenciesMs[4];
                am6 = vAEvaluationCompetenciesMs[5];
                if (vAEvaluationCompetenciesMs.Count > 6)
                {

                    am7 = vAEvaluationCompetenciesMs[6];
                }

                List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp.AEvaluationEmp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                ad1 = vAEvaluationCompetenciesDs[0];
                ad2 = vAEvaluationCompetenciesDs[1];
                ad3 = vAEvaluationCompetenciesDs[2];
                ad4 = vAEvaluationCompetenciesDs[3];
                ad5 = vAEvaluationCompetenciesDs[4];
                ad6 = vAEvaluationCompetenciesDs[5];
                ad7 = vAEvaluationCompetenciesDs[6];
                ad8 = vAEvaluationCompetenciesDs[7];
                ad9 = vAEvaluationCompetenciesDs[8];
                ad10 = vAEvaluationCompetenciesDs[9];
                ad11 = vAEvaluationCompetenciesDs[10];
                ad12 = vAEvaluationCompetenciesDs[11];
                ad13 = vAEvaluationCompetenciesDs[12];
                ad14 = vAEvaluationCompetenciesDs[13];
                ad15 = vAEvaluationCompetenciesDs[14];
                ad16 = vAEvaluationCompetenciesDs[15];
                ad17 = vAEvaluationCompetenciesDs[16];
                ad18 = vAEvaluationCompetenciesDs[17];
                if (vAEvaluationCompetenciesDs.Count > 18)
                {

                    ad19 = vAEvaluationCompetenciesDs[18];
                    ad20 = vAEvaluationCompetenciesDs[19];
                    ad21 = vAEvaluationCompetenciesDs[20];
                    ad22 = vAEvaluationCompetenciesDs[21];
                    ad23 = vAEvaluationCompetenciesDs[22];
                }
                if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

<<<<<<< HEAD
                    emp.AEvaluationEmp.tot1 = Convert.ToString(((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
=======
                    TempData["GRADE"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30);
                    TempData["GRADEN"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

<<<<<<< HEAD
                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";

=======
                    TempData["GRADE"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2);
                    TempData["GRADEN"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

<<<<<<< HEAD
                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
=======
                    TempData["GRADE"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    TempData["GRADEN"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

<<<<<<< HEAD
                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
=======
                    TempData["GRADE"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    TempData["GRADEN"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

<<<<<<< HEAD
                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
=======
                    TempData["GRADE"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    TempData["GRADEN"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";

                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

<<<<<<< HEAD
                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
=======
                    TempData["GRADE"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2);
                    TempData["GRADEN"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                {
                    // calculation 

<<<<<<< HEAD
                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
=======
                    TempData["GRADE"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    TempData["GRADEN"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                {
                    // calculation 

<<<<<<< HEAD
                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
=======
                    TempData["GRADE"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    TempData["GRADEN"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    //return View(Records);
                }
                else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                {
                    // calculation 

<<<<<<< HEAD
                    emp.AEvaluationEmp.tot1 = Convert.ToString((double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2));
                    emp.AEvaluationEmp.tot2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
=======
                    TempData["GRADE"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                    TempData["GRADEN"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                    //return View(Records);
                }

            }
            return View(Records);

            //return View(await _context.ViewModelEvalwithother.ToListAsync());
        }
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public async Task<IActionResult> promotions() {


            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            TempData["GRADEp"] = "";
            TempData["GRADEp1"] = "";
            TempData["GRADENp"] = "";
            TempData["GRADENp1"] = "0";
            double sumgrade = 0.0;
            TempData["sumgrade"] = "0.0";
            TempData["sumgrade1"] = " =";
            TempData["mygrade"] = "0";
            TempData["mygradedate"] = "";
            TempData["mygrade1"] = "0";
           // emp personal grade
            //var persempgrade = _context.PersnolEmpGrade.Where(x => x.empname == HttpContext.Session.GetString("empname")).OrderBy(x=>x.seriad).LastOrDefault();
            var persempgrade0 = _context.PersnolEmpGrade.Where(x => x.empnational == HttpContext.Session.GetString("empidpass")).OrderBy(x => x.seriad).LastOrDefault();
            if (persempgrade0 != null)
            {
                TempData["mygrade"] = persempgrade0.empgrade;
                TempData["mygradedate"] =Convert.ToDateTime( persempgrade0.empdate).ToString("dd/MM/yyyy");
            }
<<<<<<< HEAD
            // aeval last calc 
            var emp = _context.AEvaluationEmps.Where(x => x.Empno == Convert.ToInt32(HttpContext.Session.GetString("empid")) /*&&(x.year=="2021")*/).OrderBy(x=>x.Idd).LastOrDefault();
=======
            // aeval 2021 calc 
            var emp = _context.AEvaluationEmps.Where(x => x.Empno == Convert.ToInt32(HttpContext.Session.GetString("empid")) &&(x.year=="2021")).FirstOrDefault();
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
            if (emp != null)
            {
                var approval = _context.EvalDetailss2.Where(x => x.CourcesIdoffered == emp.Idd && x.OfferedRequestTypeSatus == 1).FirstOrDefault();
                if (approval != null)
                {

                    var approvalseial = _context.EvalDetailss2.Where(x => x.CourcesIdoffered == emp.Idd).FirstOrDefault();
                    var approveddate = _context.EvalComments2.Where(x => x.Offerdetailsid == approvalseial.OfferedDetailsSerial).FirstOrDefault();

                    List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                    av1 = vAEvaluationGoals[0];
                    av2 = vAEvaluationGoals[1];
                    av3 = vAEvaluationGoals[2];
                    av4 = vAEvaluationGoals[3];
                    if (vAEvaluationGoals.Count > 4)
                    {
                        av5 = vAEvaluationGoals[4];

                    }
                    if (vAEvaluationGoals.Count > 5)
                    {
                        av6 = vAEvaluationGoals[5];
                    }
                    List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                    am1 = vAEvaluationCompetenciesMs[0];
                    am2 = vAEvaluationCompetenciesMs[1];
                    am3 = vAEvaluationCompetenciesMs[2];
                    am4 = vAEvaluationCompetenciesMs[3];
                    am5 = vAEvaluationCompetenciesMs[4];
                    am6 = vAEvaluationCompetenciesMs[5];
                    if (vAEvaluationCompetenciesMs.Count > 6)
                    {

                        am7 = vAEvaluationCompetenciesMs[6];
                    }

                    List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                    ad1 = vAEvaluationCompetenciesDs[0];
                    ad2 = vAEvaluationCompetenciesDs[1];
                    ad3 = vAEvaluationCompetenciesDs[2];
                    ad4 = vAEvaluationCompetenciesDs[3];
                    ad5 = vAEvaluationCompetenciesDs[4];
                    ad6 = vAEvaluationCompetenciesDs[5];
                    ad7 = vAEvaluationCompetenciesDs[6];
                    ad8 = vAEvaluationCompetenciesDs[7];
                    ad9 = vAEvaluationCompetenciesDs[8];
                    ad10 = vAEvaluationCompetenciesDs[9];
                    ad11 = vAEvaluationCompetenciesDs[10];
                    ad12 = vAEvaluationCompetenciesDs[11];
                    ad13 = vAEvaluationCompetenciesDs[12];
                    ad14 = vAEvaluationCompetenciesDs[13];
                    ad15 = vAEvaluationCompetenciesDs[14];
                    ad16 = vAEvaluationCompetenciesDs[15];
                    ad17 = vAEvaluationCompetenciesDs[16];
                    ad18 = vAEvaluationCompetenciesDs[17];
                    if (vAEvaluationCompetenciesDs.Count > 18)
                    {

                        ad19 = vAEvaluationCompetenciesDs[18];
                        ad20 = vAEvaluationCompetenciesDs[19];
                        ad21 = vAEvaluationCompetenciesDs[20];
                        ad22 = vAEvaluationCompetenciesDs[21];
                        ad23 = vAEvaluationCompetenciesDs[22];
                    }
                    if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                    {
                        // calculation 
                        if (approveddate != null)
                        {
                            TempData["GRADEp1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                        }
                        TempData["GRADEp"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30);
                        TempData["GRADENp"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                        TempData["GRADENp1"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                        //return View(Records);
                    }
                    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                    {
                        // calculation 
                        if (approveddate != null)
                        {
                            TempData["GRADEp1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                        }
                        TempData["GRADEp"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2);
                        TempData["GRADENp"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                        TempData["GRADENp1"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                         ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75" :
                         ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                         ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                        //return View(Records);
                    }
                    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                    {
                        // calculation 
                        if (approveddate != null)
                        {
                            TempData["GRADEp1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                        }
                        TempData["GRADEp"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                        TempData["GRADENp"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                        TempData["GRADENp1"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "75" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : "0";
                        //return View(Records);
                    }
                    else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                    {
                        // calculation 
                        if (approveddate != null)
                        {
                            TempData["GRADEp1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                        }
                        TempData["GRADEp"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                        TempData["GRADENp"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                        TempData["GRADENp1"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "75" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : "0";
                        //return View(Records);
                    }
                    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                    {
                        // calculation 
                        if (approveddate != null)
                        {
                            TempData["GRADEp1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                        }
                        TempData["GRADEp"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                        TempData["GRADENp"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                        TempData["GRADENp1"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "75" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : "0";
                    }
                    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                    {
                        // calculation 
                        if (approveddate != null)
                        {
                            TempData["GRADEp1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                        }
                        TempData["GRADEp"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2);
                        TempData["GRADENp"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                        ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                        TempData["GRADENp1"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                            ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                        //return View(Records);
                    }
                    else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                    {
                        // calculation 
                        if (approveddate != null)
                        {
                            TempData["GRADEp1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                        }
                        TempData["GRADEp"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                        TempData["GRADENp"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                        TempData["GRADENp1"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "75" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1" : "0";
                        //return View(Records);
                    }
                    else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                    {
                        // calculation 
                        if (approveddate != null)
                        {
                            TempData["GRADEp1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                        }
                        TempData["GRADEp"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                        TempData["GRADENp"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                        TempData["GRADENp1"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "75" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                            ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : "0";
                        //return View(Records);
                    }
                    else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                    {
                        // calculation 
                        if (approveddate != null)
                        {
                            TempData["GRADEp1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                        }
                        TempData["GRADEp"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                        TempData["GRADENp"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                        ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                        TempData["GRADENp1"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "75 " :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                           ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : "0";
                        //return View(Records);
                    }
                }
                else
                {
<<<<<<< HEAD
                    // aeval 2021 calc 
                    var emp0 = _context.AEvaluationEmps.Where(x => x.Empno == Convert.ToInt32(HttpContext.Session.GetString("empid")) && (x.year == "2021")).FirstOrDefault();
                    if (emp0 != null)
                    {
                        var approval0 = _context.EvalDetailss2.Where(x => x.CourcesIdoffered == emp0.Idd && x.OfferedRequestTypeSatus == 1).FirstOrDefault();
                        if (approval0 != null)
                        {

                            var approvalseial = _context.EvalDetailss2.Where(x => x.CourcesIdoffered == emp0.Idd).FirstOrDefault();
                            var approveddate = _context.EvalComments2.Where(x => x.Offerdetailsid == approvalseial.OfferedDetailsSerial).FirstOrDefault();

                            List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == emp0.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
                            av1 = vAEvaluationGoals[0];
                            av2 = vAEvaluationGoals[1];
                            av3 = vAEvaluationGoals[2];
                            av4 = vAEvaluationGoals[3];
                            if (vAEvaluationGoals.Count > 4)
                            {
                                av5 = vAEvaluationGoals[4];

                            }
                            if (vAEvaluationGoals.Count > 5)
                            {
                                av6 = vAEvaluationGoals[5];
                            }
                            List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == emp0.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
                            am1 = vAEvaluationCompetenciesMs[0];
                            am2 = vAEvaluationCompetenciesMs[1];
                            am3 = vAEvaluationCompetenciesMs[2];
                            am4 = vAEvaluationCompetenciesMs[3];
                            am5 = vAEvaluationCompetenciesMs[4];
                            am6 = vAEvaluationCompetenciesMs[5];
                            if (vAEvaluationCompetenciesMs.Count > 6)
                            {

                                am7 = vAEvaluationCompetenciesMs[6];
                            }

                            List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == emp0.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
                            ad1 = vAEvaluationCompetenciesDs[0];
                            ad2 = vAEvaluationCompetenciesDs[1];
                            ad3 = vAEvaluationCompetenciesDs[2];
                            ad4 = vAEvaluationCompetenciesDs[3];
                            ad5 = vAEvaluationCompetenciesDs[4];
                            ad6 = vAEvaluationCompetenciesDs[5];
                            ad7 = vAEvaluationCompetenciesDs[6];
                            ad8 = vAEvaluationCompetenciesDs[7];
                            ad9 = vAEvaluationCompetenciesDs[8];
                            ad10 = vAEvaluationCompetenciesDs[9];
                            ad11 = vAEvaluationCompetenciesDs[10];
                            ad12 = vAEvaluationCompetenciesDs[11];
                            ad13 = vAEvaluationCompetenciesDs[12];
                            ad14 = vAEvaluationCompetenciesDs[13];
                            ad15 = vAEvaluationCompetenciesDs[14];
                            ad16 = vAEvaluationCompetenciesDs[15];
                            ad17 = vAEvaluationCompetenciesDs[16];
                            ad18 = vAEvaluationCompetenciesDs[17];
                            if (vAEvaluationCompetenciesDs.Count > 18)
                            {

                                ad19 = vAEvaluationCompetenciesDs[18];
                                ad20 = vAEvaluationCompetenciesDs[19];
                                ad21 = vAEvaluationCompetenciesDs[20];
                                ad22 = vAEvaluationCompetenciesDs[21];
                                ad23 = vAEvaluationCompetenciesDs[22];
                            }
                            if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
                            {
                                // calculation 
                                if (approveddate != null)
                                {
                                    TempData["GRADEp1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                                }
                                TempData["GRADEp"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30);
                                TempData["GRADENp"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                                TempData["GRADENp1"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75 " :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                                //return View(Records);
                            }
                            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
                            {
                                // calculation 
                                if (approveddate != null)
                                {
                                    TempData["GRADEp1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                                }
                                TempData["GRADEp"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2);
                                TempData["GRADENp"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                                ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                                ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                                ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                                TempData["GRADENp1"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                                 ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75" :
                                 ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                                 ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                                //return View(Records);
                            }
                            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                            {
                                // calculation 
                                if (approveddate != null)
                                {
                                    TempData["GRADEp1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                                }
                                TempData["GRADEp"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                                TempData["GRADENp"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                TempData["GRADENp1"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "75" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : "0";
                                //return View(Records);
                            }
                            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                            {
                                // calculation 
                                if (approveddate != null)
                                {
                                    TempData["GRADEp1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                                }
                                TempData["GRADEp"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                                TempData["GRADENp"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                TempData["GRADENp1"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "75" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : "0";
                                //return View(Records);
                            }
                            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                            {
                                // calculation 
                                if (approveddate != null)
                                {
                                    TempData["GRADEp1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                                }
                                TempData["GRADEp"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                                TempData["GRADENp"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                TempData["GRADENp1"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "75" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : "0";
                            }
                            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
                            {
                                // calculation 
                                if (approveddate != null)
                                {
                                    TempData["GRADEp1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                                }
                                TempData["GRADEp"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2);
                                TempData["GRADENp"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                                ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                                ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                                ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي";
                                TempData["GRADENp1"] = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "100" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "75" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "60" :
                                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "1 " : "0";
                                //return View(Records);
                            }
                            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
                            {
                                // calculation 
                                if (approveddate != null)
                                {
                                    TempData["GRADEp1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                                }
                                TempData["GRADEp"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                                TempData["GRADENp"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                TempData["GRADENp1"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "75" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1" : "0";
                                //return View(Records);
                            }
                            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
                            {
                                // calculation 
                                if (approveddate != null)
                                {
                                    TempData["GRADEp1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                                }
                                TempData["GRADEp"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                                TempData["GRADENp"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                TempData["GRADENp1"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "75" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : "0";
                                //return View(Records);
                            }
                            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
                            {
                                // calculation 
                                if (approveddate != null)
                                {
                                    TempData["GRADEp1"] = Convert.ToDateTime(approveddate.dtapproved.ToString()).ToString("dd/MM/yyyy");
                                }
                                TempData["GRADEp"] = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2);
                                TempData["GRADENp"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                                ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                                ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                                ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي";
                                TempData["GRADENp1"] = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "100" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "75 " :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "60" :
                                   ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "1 " : "0";
                                //return View(Records);
                            }
                        }
                        else
                        {

                            ViewBag.mesg = "ليس لديك طلب تقييم معتمد للعام الحالي او  العام 2021  .";
                        }
                    }
                    else
                    {

                        ViewBag.mesg = "ليس لديك طلب تقييم معتمد للعام  2021  .";
                    }
=======
                    ViewBag.mesg = "لايوجد طلبات تقييم للاداء معتمدة للعام المالي 2021.";
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                }
            }
            else
            {
<<<<<<< HEAD
                ViewBag.mesg = "لايوجد طلبات تقييم للاداء مرفوعة علي النظام    .";
=======
                ViewBag.mesg = "لايوجد طلبات تقييم للاداء مرفوعة علي النظام للعام المالي 2021.";
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
            }
            // grade cources calculation 

            var emppro = _context.Cemps.Where(x => x.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
            List<ACourcesType> ACourcesTypes = _context.ACourcesTypes.ToList();
            List<Cemp> Cemps = _context.Cemps.ToList();
            List<ACourcesEstimate> ACourcesEstimates = _context.ACourcesEstimates.ToList();
            //List<ACourcesMaster> ACourcesMasters = _context.ACourcesMasters.ToList();
            List<ACourcesMaster> ACourcesMasters = _context.ACourcesMasters.Where(e=> e.CourcesEndDate.Date >= Convert.ToDateTime(emppro.CEMPLASTUPGRADEHIJRA).Date && e.Cempid == HttpContext.Session.GetString("empid")).ToList();
            List<ACourcesDeptin> ACourcesDeptins = _context.ACourcesDeptins.ToList();
            List<MasterRequestTypeId> MasterRequestTypeIds = _context.MasterRequestTypeIds.ToList();
            List<MasterDetails> MasterDetailss = _context.MasterDetailss.ToList();
            List<ACourcesDeptout> ACourcesDeptouts = _context.ACourcesDeptouts.ToList();
            List<ACourcesTrainingMethod> ACourcesTrainingMethods = _context.ACourcesTrainingMethods.ToList();
            List<ACourcesName> ACourcesNames = _context.ACourcesNames.ToList();
            var Records = from e in ACourcesMasters
                          join d in ACourcesTypes on e.CourcesIdType equals d.CourcesIdType into table1
                          from d in table1.ToList()
                          join i in Cemps on e.Cempid equals i.Cempid into table2
                          from i in table2.ToList()
                          where i.Cempid == HttpContext.Session.GetString("empid")
                          join j in ACourcesEstimates on e.CourcesIdEstimate equals j.CourcesIdEstimate into table3
                          from j in table3.ToList()
                          join f in ACourcesDeptins on e.CourcesIdDeptin equals f.CourcesIdDeptin into table4
                          from f in table4.ToList()
                          join h in ACourcesDeptouts on e.CourcesIdDeptout equals h.CourcesIdDeptout into table5
                          from h in table5.ToList()
                          join n in ACourcesTrainingMethods on e.CourcesIdTraining equals n.CourcesIdTraining into table6
                          from n in table6.ToList()
                          join x in MasterRequestTypeIds on e.CourcesIdmaster equals x.COURCES_IDMASTER into table7
                          from x in table7.ToList()
                          where x.MasterRequestType == 1
                          join y in MasterDetailss on e.CourcesIdmaster equals y.COURCES_IDMASTER into table8
                          from y in table8.Distinct().ToList()
                          where y.MasterRequestTypeSatus == 1
                          //where y.MasterRequestTo == HttpContext.Session.GetString("empid") || y.MasterRequestTo2 == HttpContext.Session.GetString("empid")
                          join z in ACourcesNames on e.CourcesId equals z.CourcesId into table9
                          from z in table9.ToList()


                          select new ViewModelMasterwithother
                          {
                              ACourcesMasters = e,
                              ACourcesTypes = d,
                              Cemps = i,
                              ACourcesEstimates = j,
                              ACourcesDeptins = f,
                              ACourcesDeptouts = h,
                              ACourcesTrainingMethods = n,
                              MasterRequestTypeIds = x,
                              MasterDetails = y,
                              ACourcesNames = z
                          };
           foreach(var course in Records.ToList())
            {
                if (course.ACourcesMasters.CourcesIdType == 1)
                {
                    if (course.ACourcesMasters.CourcesIdType == 1&&course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                    {
                        course.ACourcesMasters.gradetocourse = 40.0;
                        sumgrade += course.ACourcesMasters.gradetocourse;
                    }
                    else if (course.ACourcesMasters.CourcesIdType == 1 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                    {
                        course.ACourcesMasters.gradetocourse = 30.0;
                        sumgrade += course.ACourcesMasters.gradetocourse;
                    }
                }
                else if (course.ACourcesMasters.CourcesIdType == 2)
                {
                    if (course.ACourcesMasters.CourcesIdType == 2 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                    {
                        course.ACourcesMasters.gradetocourse = 80.0;
                        sumgrade += course.ACourcesMasters.gradetocourse;
                    }
                    else if (course.ACourcesMasters.CourcesIdType == 2 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                    {
                        course.ACourcesMasters.gradetocourse = 60.0;
                        sumgrade += course.ACourcesMasters.gradetocourse;
                    }
                    else if (course.ACourcesMasters.CourcesIdType == 2 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب بالقطاع الخاص"))
                    {
                        course.ACourcesMasters.gradetocourse = 40.0;
                        sumgrade += course.ACourcesMasters.gradetocourse;
                    }
                }
                else if (course.ACourcesMasters.CourcesIdType == 3)
                {
                    if (course.ACourcesMasters.CourcesIdType == 3 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                    {
                        course.ACourcesMasters.gradetocourse = 1.0;
                        sumgrade += course.ACourcesMasters.gradetocourse;
                    }
                }
                else if (course.ACourcesMasters.CourcesIdType == 4&& course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                {

                    if (course.ACourcesMasters.CourcesIdType == 4 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية")&&course.ACourcesMasters.CourcesIdEstimate==1)
                    {
                        course.ACourcesMasters.gradetocourse = 50.0;
                        sumgrade += course.ACourcesMasters.gradetocourse;
                    }
                    else if (course.ACourcesMasters.CourcesIdType == 4 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && course.ACourcesMasters.CourcesIdEstimate == 2)
                    {
                        course.ACourcesMasters.gradetocourse = 25.0;
                        sumgrade += course.ACourcesMasters.gradetocourse;
                    }
                }
            }
            if (sumgrade >= 100.00)
            {
                TempData["sumgrade"] = "100.00";
            }
            else
            {
                TempData["sumgrade"] = sumgrade;
            }
            TempData["mygrade1"] =Convert.ToDouble(TempData["GRADENp1"])*30/100 + Convert.ToDouble(TempData["sumgrade"]) * 30 / 100 + Convert.ToDouble(TempData["mygrade"]) * 40 / 100;
            return View(Records);


        }
        public void editxt2(string ii, string qi)
        {
            double sumgrade = 0.0;
            
         
            List<ACourcesMaster> ACourcesMasters = _context.ACourcesMasters.Where(e=>e.CourcesStartDate.Date>= Convert.ToDateTime(ii).Date && e.CourcesEndDate.Date <= Convert.ToDateTime(qi).Date && e.Cempid == HttpContext.Session.GetString("empid")).ToList();
            
            List<Cemp> Cemps2 = _context.Cemps.ToList();
            List<Cemp> Cemps3 = _context.Cemps.ToList();


            foreach (var cc in ACourcesMasters.ToList())
            {
                var dd = _context.MasterRequestTypeIds.Where(x => x.COURCES_IDMASTER == cc.CourcesIdmaster).FirstOrDefault();
                if (dd.COURCES_IDMASTER !=0)
                {

                    if (cc.CourcesIdType == 1)
                    {
                        if (cc.CourcesIdType == 1 && cc.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                        {
                            cc.gradetocourse = 40.0;
                            sumgrade += cc.gradetocourse;
                        }
                        else if (cc.CourcesIdType == 1 && cc.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {
                            cc.gradetocourse = 30.0;
                            sumgrade += cc.gradetocourse;
                        }
                    }
                    else if (cc.CourcesIdType == 2)
                    {
                        if (cc.CourcesIdType == 2 && cc.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                        {
                            cc.gradetocourse = 80.0;
                            sumgrade += cc.gradetocourse;
                        }
                        else if (cc.CourcesIdType == 2 && cc.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {
                            cc.gradetocourse = 60.0;
                            sumgrade += cc.gradetocourse;
                        }
                        else if (cc.CourcesIdType == 2 && cc.COURCES_EXCUTION.Equals("جهة تدريب بالقطاع الخاص"))
                        {
                            cc.gradetocourse = 40.0;
                            sumgrade += cc.gradetocourse;
                        }
                    }
                    else if (cc.CourcesIdType == 3)
                    {
                        if (cc.CourcesIdType == 3 && cc.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {
                            cc.gradetocourse = 1.0;
                            sumgrade +=cc.gradetocourse;
                        }
                    }
                    else if (cc.CourcesIdType == 4 && cc.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                    {

                        if (cc.CourcesIdType == 4 && cc.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && cc.CourcesIdEstimate == 1)
                        {
                            cc.gradetocourse = 50.0;
                            sumgrade += cc.gradetocourse;
                        }
                        else if (cc.CourcesIdType == 4 && cc.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && cc.CourcesIdEstimate == 2)
                        {
                            cc.gradetocourse = 25.0;
                            sumgrade += cc.gradetocourse;
                        }
                    }
                    //sumgrade += cc.gradetocourse;
                }
                else
                {
                    TempData["sumgrade1"] = "لايوجد دورات معتمدة في تلك الفترة المحددة ";
                }
            }

            
               
           
                TempData["sumgrade1"] = sumgrade;
           
            //return View(Records);




            //return RedirectToAction("IndexOffered4", "ViewModelEvalwithother1", new { area = "" });    //_context.Update(empnoted);


            //return RedirectToAction("MyInfo", "Cemps", new { area = "" });
        }
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public async Task<IActionResult> canceluser()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail> EvalDetails = _context.EvalDetailss.ToList();
            List<EvalRequestTypeId> EvalRequestTypeIds = _context.EvalRequestTypeIds.ToList();
            //List<Evalcomment> evalcommentss = _context.EvalComments.ToList();


            var Records = from e in AEvaluationEmps
                              //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                              //from d in table1.ToList()
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join f in EvalDetails on e.Idd equals f.CourcesIdoffered into table4
                          from f in table4.ToList()
                          where f.OfferedRequestTypeSatus == 2
                          where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                          join h in EvalRequestTypeIds on e.Idd equals h.CourcesIdoffered into table5
                          from h in table5.ToList()
                          where h.OfferedRequestType == 2



                          select new ViewModelEvalwithother
                          {
                              AEvaluationEmp = e,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              evalDetail = f,
                              evalRequestTypeId = h,

                          };
            foreach (var emp in Records.ToList())
            {
                var stringId = emp.AEvaluationEmp.Idd.ToString();
                emp.AEvaluationEmp.EncryptedIdd = _protector.Protect(stringId);
                //emp.AEvaluationGoal.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesM.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesD.EncryptedCovenantId= _protector.Protect(stringId);

                ////Previous code removed for the example clarity
                //var timeLimitedProtector = _protector.ToTimeLimitedDataProtector();
                //var timeLimitedData = timeLimitedProtector.Protect("Test timed protector", lifetime: TimeSpan.FromSeconds(2));
                ////just to test that this action works as long as life-time hasn't expired
                //var timedUnprotectedData = timeLimitedProtector.Unprotect(timeLimitedData);
                //Thread.Sleep(3000);
                //var anotherTimedUnprotectTry = timeLimitedProtector.Unprotect(timeLimitedData);
            }
            return View(Records);

            //return View(await _context.ViewModelEvalwithother.ToListAsync());
        }
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public async Task<IActionResult> canceluser11()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail2> EvalDetails2 = _context.EvalDetailss2.ToList();
            List<EvalRequestTypeId2> EvalRequestTypeIds2 = _context.EvalRequestTypeIds2.ToList();
            //List<Evalcomment> evalcommentss = _context.EvalComments.ToList();


            var Records = from e in AEvaluationEmps
                              //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                              //from d in table1.ToList()
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join f in EvalDetails2 on e.Idd equals f.CourcesIdoffered into table4
                          from f in table4.ToList()
                          where f.OfferedRequestTypeSatus == 2
                          where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                          join h in EvalRequestTypeIds2 on e.Idd equals h.CourcesIdoffered into table5
                          from h in table5.ToList()
                          where h.OfferedRequestType == 2



                          select new ViewModelEvalwithother
                          {
                              AEvaluationEmp = e,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              evalDetail2 = f,
                              evalRequestTypeId2 = h,

                          };
            foreach (var emp in Records.ToList())
            {
                var stringId = emp.AEvaluationEmp.Idd.ToString();
                emp.AEvaluationEmp.EncryptedIdd = _protector.Protect(stringId);
                //emp.AEvaluationGoal.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesM.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesD.EncryptedCovenantId= _protector.Protect(stringId);

                ////Previous code removed for the example clarity
                //var timeLimitedProtector = _protector.ToTimeLimitedDataProtector();
                //var timeLimitedData = timeLimitedProtector.Protect("Test timed protector", lifetime: TimeSpan.FromSeconds(2));
                ////just to test that this action works as long as life-time hasn't expired
                //var timedUnprotectedData = timeLimitedProtector.Unprotect(timeLimitedData);
                //Thread.Sleep(3000);
                //var anotherTimedUnprotectTry = timeLimitedProtector.Unprotect(timeLimitedData);
            }
            return View(Records);

            //return View(await _context.ViewModelEvalwithother.ToListAsync());
        }

       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public async Task<IActionResult> approveduser1()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail> EvalDetails = _context.EvalDetailss.ToList();
            List<EvalRequestTypeId> EvalRequestTypeIds = _context.EvalRequestTypeIds.ToList();
            //List<Evalcomment> evalcommentss = _context.EvalComments.ToList();


            var Records = from e in AEvaluationEmps
                              //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                              //from d in table1.ToList()
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join f in EvalDetails on e.Idd equals f.CourcesIdoffered into table4
                          from f in table4.ToList()
                          where f.OfferedRequestTo == HttpContext.Session.GetString("empid") || f.OfferedRequestTo2 == HttpContext.Session.GetString("empid")
                          //where (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo3 == "1") && (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo4 == "1") && (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo5 == "1")
                          where f.OfferedRequestTypeSatus == 1
                          //where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                          join h in EvalRequestTypeIds on e.Idd equals h.CourcesIdoffered into table5
                          from h in table5.ToList()
                          where h.OfferedRequestType == 1



                          select new ViewModelEvalwithother
                          {
                              AEvaluationEmp = e,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              evalDetail = f,
                              evalRequestTypeId = h,

                          };
            foreach (var emp in Records.ToList())
            {
                var stringId = emp.AEvaluationEmp.Idd.ToString();
                emp.AEvaluationEmp.EncryptedIdd = _protector.Protect(stringId);
                //emp.AEvaluationGoal.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesM.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesD.EncryptedCovenantId= _protector.Protect(stringId);

                ////Previous code removed for the example clarity
                //var timeLimitedProtector = _protector.ToTimeLimitedDataProtector();
                //var timeLimitedData = timeLimitedProtector.Protect("Test timed protector", lifetime: TimeSpan.FromSeconds(2));
                ////just to test that this action works as long as life-time hasn't expired
                //var timedUnprotectedData = timeLimitedProtector.Unprotect(timeLimitedData);
                //Thread.Sleep(3000);
                //var anotherTimedUnprotectTry = timeLimitedProtector.Unprotect(timeLimitedData);
            }
            return View(Records);

            //return View(await _context.ViewModelEvalwithother.ToListAsync());
        }

        public async Task<IActionResult> canceluser1()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail> EvalDetails = _context.EvalDetailss.ToList();
            List<EvalRequestTypeId> EvalRequestTypeIds = _context.EvalRequestTypeIds.ToList();
            //List<Evalcomment> evalcommentss = _context.EvalComments.ToList();


            var Records = from e in AEvaluationEmps
                              //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                              //from d in table1.ToList()
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join f in EvalDetails on e.Idd equals f.CourcesIdoffered into table4
                          from f in table4.ToList()
                          where f.OfferedRequestTypeSatus == 2
                          //where (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo3 == "2") && (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo4 == "2") && (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo5 == "2")
                          where f.OfferedRequestTo == HttpContext.Session.GetString("empid") || f.OfferedRequestTo2 == HttpContext.Session.GetString("empid")
                          //where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                          join h in EvalRequestTypeIds on e.Idd equals h.CourcesIdoffered into table5
                          from h in table5.ToList()
                          where h.OfferedRequestType == 2



                          select new ViewModelEvalwithother
                          {
                              AEvaluationEmp = e,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              evalDetail = f,
                              evalRequestTypeId = h,

                          };
            foreach (var emp in Records.ToList())
            {
                var stringId = emp.AEvaluationEmp.Idd.ToString();
                emp.AEvaluationEmp.EncryptedIdd = _protector.Protect(stringId);
                //emp.AEvaluationGoal.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesM.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesD.EncryptedCovenantId= _protector.Protect(stringId);

                ////Previous code removed for the example clarity
                //var timeLimitedProtector = _protector.ToTimeLimitedDataProtector();
                //var timeLimitedData = timeLimitedProtector.Protect("Test timed protector", lifetime: TimeSpan.FromSeconds(2));
                ////just to test that this action works as long as life-time hasn't expired
                //var timedUnprotectedData = timeLimitedProtector.Unprotect(timeLimitedData);
                //Thread.Sleep(3000);
                //var anotherTimedUnprotectTry = timeLimitedProtector.Unprotect(timeLimitedData);
            }
            return View(Records);

            //return View(await _context.ViewModelEvalwithother.ToListAsync());
        }
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public async Task<IActionResult> approveduser1E()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail2> EvalDetails = _context.EvalDetailss2.ToList();
            List<EvalRequestTypeId2> EvalRequestTypeIds = _context.EvalRequestTypeIds2.ToList();
            //List<Evalcomment> evalcommentss = _context.EvalComments.ToList();


            var Records = from e in AEvaluationEmps
                              //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                              //from d in table1.ToList()
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join f in EvalDetails on e.Idd equals f.CourcesIdoffered into table4
                          from f in table4.ToList()
                          where f.OfferedRequestTo == HttpContext.Session.GetString("empid") || f.OfferedRequestTo2 == HttpContext.Session.GetString("empid")
                          //where (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo3 == "1") && (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo4 == "1") && (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo5 == "1")
                          where f.OfferedRequestTypeSatus == 1
                          //where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                          join h in EvalRequestTypeIds on e.Idd equals h.CourcesIdoffered into table5
                          from h in table5.ToList()
                          where h.OfferedRequestType == 1



                          select new ViewModelEvalwithother
                          {
                              AEvaluationEmp = e,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              evalDetail2 = f,
                              evalRequestTypeId2 = h,

                          };
            foreach (var emp in Records.ToList())
            {
                var stringId = emp.AEvaluationEmp.Idd.ToString();
                emp.AEvaluationEmp.EncryptedIdd = _protector.Protect(stringId);
                //emp.AEvaluationGoal.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesM.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesD.EncryptedCovenantId= _protector.Protect(stringId);

                ////Previous code removed for the example clarity
                //var timeLimitedProtector = _protector.ToTimeLimitedDataProtector();
                //var timeLimitedData = timeLimitedProtector.Protect("Test timed protector", lifetime: TimeSpan.FromSeconds(2));
                ////just to test that this action works as long as life-time hasn't expired
                //var timedUnprotectedData = timeLimitedProtector.Unprotect(timeLimitedData);
                //Thread.Sleep(3000);
                //var anotherTimedUnprotectTry = timeLimitedProtector.Unprotect(timeLimitedData);
            }
            return View(Records);

            //return View(await _context.ViewModelEvalwithother.ToListAsync());
        }
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public async Task<IActionResult> canceluser1E()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail2> EvalDetails = _context.EvalDetailss2.ToList();
            List<EvalRequestTypeId2> EvalRequestTypeIds = _context.EvalRequestTypeIds2.ToList();
            //List<Evalcomment> evalcommentss = _context.EvalComments.ToList();


            var Records = from e in AEvaluationEmps
                              //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                              //from d in table1.ToList()
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join f in EvalDetails on e.Idd equals f.CourcesIdoffered into table4
                          from f in table4.ToList()
                          where f.OfferedRequestTypeSatus == 2
                          //where (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo3 == "2") && (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo4 == "2") && (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo5 == "2")
                          where f.OfferedRequestTo == HttpContext.Session.GetString("empid") || f.OfferedRequestTo2 == HttpContext.Session.GetString("empid")
                          //where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                          join h in EvalRequestTypeIds on e.Idd equals h.CourcesIdoffered into table5
                          from h in table5.ToList()
                          where h.OfferedRequestType == 2



                          select new ViewModelEvalwithother
                          {
                              AEvaluationEmp = e,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              evalDetail2 = f,
                              evalRequestTypeId2 = h,

                          };
            foreach (var emp in Records.ToList())
            {
                var stringId = emp.AEvaluationEmp.Idd.ToString();
                emp.AEvaluationEmp.EncryptedIdd = _protector.Protect(stringId);
                //emp.AEvaluationGoal.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesM.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesD.EncryptedCovenantId= _protector.Protect(stringId);

                ////Previous code removed for the example clarity
                //var timeLimitedProtector = _protector.ToTimeLimitedDataProtector();
                //var timeLimitedData = timeLimitedProtector.Protect("Test timed protector", lifetime: TimeSpan.FromSeconds(2));
                ////just to test that this action works as long as life-time hasn't expired
                //var timedUnprotectedData = timeLimitedProtector.Unprotect(timeLimitedData);
                //Thread.Sleep(3000);
                //var anotherTimedUnprotectTry = timeLimitedProtector.Unprotect(timeLimitedData);
            }
            return View(Records);

            //return View(await _context.ViewModelEvalwithother.ToListAsync());
        }

       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public IActionResult CreateB( string selectedtTime)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Jobname"] = new SelectList(_context.AJobsNames, "CourcesName", "CourcesName");
            if (selectedtTime == null)
            {
                List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
                List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.Where(zx => zx.CovenantGoalsName != null).ToList();
                List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
                List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
                List<EvalDetail2> EvalDetails = _context.EvalDetailss2.ToList();
                List<EvalRequestTypeId2> EvalRequestTypeIds = _context.EvalRequestTypeIds2.ToList();
                List<Cemp> cemps = _context.Cemps.Where(ZX=>ZX.Cempid== HttpContext.Session.GetString("username")).ToList();


                var Records = from e in cemps
                                  //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                                  //from d in table1.ToList()
                                  //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                                  //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                                  //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                                  //from j in table3.ToList()
                              join f in AEvaluationGoals on e.Cempid equals Convert.ToString(f.EmpId) into table4
                              from f in table4.ToList()
                              
                              //where (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo3 == "1") && (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo4 == "1") && (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo5 == "1")
                              //where f.OfferedRequestTypeSatus == 1
                              ////where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                              //join h in EvalRequestTypeIds on e.Idd equals h.CourcesIdoffered into table5
                              //from h in table5.ToList()
                              //where h.OfferedRequestType == 1



                              select new ViewModelEvalwithother
                              {
                                  cemp = e,
                                  //AEvaluationGoal = d,
                                  //AEvaluationCompetenciesM = i,
                                  //AEvaluationCompetenciesD = j,
                                  AEvaluationGoal = f
                                  //evalRequestTypeId2 = h,

                              };

                return View(Records.ToList());
            }
            else
            {
                //List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
                List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.Where(zx => zx.CovenantGoalsName != null).ToList();
                ////List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
                ////List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
                ////List<EvalDetail2> EvalDetails = _context.EvalDetailss2.ToList();
                ////List<EvalRequestTypeId2> EvalRequestTypeIds = _context.EvalRequestTypeIds2.ToList();
                List<Cemp> cemps = _context.Cemps.ToList();


                var Records = from e in cemps
                                  //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                                  //from d in table1.ToList()
                                  //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                                  //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                                  //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                                  //from j in table3.ToList()
                              join f in AEvaluationGoals on e.Cempid equals Convert.ToString(f.EmpId) into table4
                              from f in table4.ToList()
                              where e.CEMPJOBNAME == selectedtTime
                              //where (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo3 == "1") && (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo4 == "1") && (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo5 == "1")
                              //where f.OfferedRequestTypeSatus == 1
                              ////where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                              //join h in EvalRequestTypeIds on e.Idd equals h.CourcesIdoffered into table5
                              //from h in table5.ToList()
                              //where h.OfferedRequestType == 1



                              select new ViewModelEvalwithother
                              {
                                  cemp = e,
                                  //AEvaluationGoal = d,
                                  //AEvaluationCompetenciesM = i,
                                  //AEvaluationCompetenciesD = j,
                                  AEvaluationGoal = f
                                  //evalRequestTypeId2 = h,

                              };

                return Json(new { data = Records.ToList() });

            }

            
            

        }

       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public IActionResult CreateB1(string selectedtTime)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["name"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");//Cempid
            double sumgrade = 0.0;
            TempData["sumgrade"] = "";
            if (selectedtTime == null)
            {
                List<ACourcesType> ACourcesTypes = _context.ACourcesTypes.ToList();
                List<Cemp> Cemps = _context.Cemps.ToList();
                List<ACourcesEstimate> ACourcesEstimates = _context.ACourcesEstimates.ToList();
                List<ACourcesMaster> ACourcesMasters = _context.ACourcesMasters.ToList();
                List<ACourcesDeptin> ACourcesDeptins = _context.ACourcesDeptins.ToList();
                List<MasterRequestTypeId> MasterRequestTypeIds = _context.MasterRequestTypeIds.ToList();
                List<MasterDetails> MasterDetailss = _context.MasterDetailss.ToList();
                List<ACourcesDeptout> ACourcesDeptouts = _context.ACourcesDeptouts.ToList();
                List<ACourcesTrainingMethod> ACourcesTrainingMethods = _context.ACourcesTrainingMethods.ToList();
                List<ACourcesName> ACourcesNames = _context.ACourcesNames.ToList();
                var Records = from e in ACourcesMasters
                              join d in ACourcesTypes on e.CourcesIdType equals d.CourcesIdType into table1
                              from d in table1.ToList()
                              join i in Cemps on e.Cempid equals i.Cempid into table2
                              from i in table2.ToList()
                              where i.Cempid == e.Cempid && e.CourcesEndDate >= i.CEMPLASTUPGRADEHIJRA && i.Cempid == HttpContext.Session.GetString("username")
                              join j in ACourcesEstimates on e.CourcesIdEstimate equals j.CourcesIdEstimate into table3
                              from j in table3.ToList()
                              join f in ACourcesDeptins on e.CourcesIdDeptin equals f.CourcesIdDeptin into table4
                              from f in table4.ToList()
                              join h in ACourcesDeptouts on e.CourcesIdDeptout equals h.CourcesIdDeptout into table5
                              from h in table5.ToList()
                              join n in ACourcesTrainingMethods on e.CourcesIdTraining equals n.CourcesIdTraining into table6
                              from n in table6.ToList()
                              join x in MasterRequestTypeIds on e.CourcesIdmaster equals x.COURCES_IDMASTER into table7
                              from x in table7.ToList()
                              where x.MasterRequestType == 1
                              join y in MasterDetailss on e.CourcesIdmaster equals y.COURCES_IDMASTER into table8
                              from y in table8.ToList()
                              where y.MasterRequestTypeSatus == 1
                              join z in ACourcesNames on e.CourcesId equals z.CourcesId into table9
                              from z in table9.ToList()


                              select new ViewModelMasterwithother
                              {
                                  ACourcesMasters = e,
                                  ACourcesTypes = d,
                                  Cemps = i,
                                  ACourcesEstimates = j,
                                  ACourcesDeptins = f,
                                  ACourcesDeptouts = h,
                                  ACourcesTrainingMethods = n,
                                  MasterRequestTypeIds = x,
                                  MasterDetails = y,
                                  ACourcesNames = z
                              };
                foreach (var course in Records.ToList())
                {
                    var stringId = course.ACourcesMasters.CourcesIdmaster.ToString();
                    course.ACourcesMasters.EncryptedIdd = _protector.Protect(stringId);
                    //var emppro = _context.Cemps.Where(x => x.Cempid == course.ACourcesMasters.Cempid).FirstOrDefault();
                    //emp.AEvaluationGoal.EncryptedCovenantId= _protector.Protect(stringId);
                    //emp.AEvaluationCompetenciesM.EncryptedCovenantId= _protector.Protect(stringId);
                    //emp.AEvaluationCompetenciesD.EncryptedCovenantId= _protector.Protect(stringId);

                    ////Previous code removed for the example clarity
                    //var timeLimitedProtector = _protector.ToTimeLimitedDataProtector();
                    //var timeLimitedData = timeLimitedProtector.Protect("Test timed protector", lifetime: TimeSpan.FromSeconds(2));
                    ////just to test that this action works as long as life-time hasn't expired
                    //var timedUnprotectedData = timeLimitedProtector.Unprotect(timeLimitedData);
                    //Thread.Sleep(3000);
                    //var anotherTimedUnprotectTry = timeLimitedProtector.Unprotect(timeLimitedData);
                    if (course.ACourcesMasters.CourcesIdType == 1)
                    {
                        if (course.ACourcesMasters.CourcesIdType == 1 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                        {
                            course.ACourcesMasters.gradetocourse = 40.0;
                            sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                        else if (course.ACourcesMasters.CourcesIdType == 1 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {
                            course.ACourcesMasters.gradetocourse = 30.0;
                            sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                    }
                    else if (course.ACourcesMasters.CourcesIdType == 2)
                    {
                        if (course.ACourcesMasters.CourcesIdType == 2 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                        {
                            course.ACourcesMasters.gradetocourse = 80.0;
                            sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                        else if (course.ACourcesMasters.CourcesIdType == 2 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {
                            course.ACourcesMasters.gradetocourse = 60.0;
                            sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                        else if (course.ACourcesMasters.CourcesIdType == 2 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب بالقطاع الخاص"))
                        {
                            course.ACourcesMasters.gradetocourse = 40.0;
                            sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                    }
                    else if (course.ACourcesMasters.CourcesIdType == 3)
                    {
                        if (course.ACourcesMasters.CourcesIdType == 3 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {
                            course.ACourcesMasters.gradetocourse = 1.0;
                            sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                    }
                    else if (course.ACourcesMasters.CourcesIdType == 4 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                    {

                        if (course.ACourcesMasters.CourcesIdType == 4 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && course.ACourcesMasters.CourcesIdEstimate == 1)
                        {
                            course.ACourcesMasters.gradetocourse = 50.0;
                            sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                        else if (course.ACourcesMasters.CourcesIdType == 4 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && course.ACourcesMasters.CourcesIdEstimate == 2)
                        {
                            course.ACourcesMasters.gradetocourse = 25.0;
                            sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                    }

                    //course.ACourcesMasters.gradetocourset = sumgrade;
                }

                if (sumgrade >= 100.00)
                {
                    TempData["sumgrade"] = "100.00";
                    // course.ACourcesMasters.gradetocourset = 100.0;
                }
                else
                {
                    TempData["sumgrade"] = sumgrade;
                }
                return View(Records.ToList());

            }
            else
            {
                List<ACourcesType> ACourcesTypes = _context.ACourcesTypes.ToList();
                List<Cemp> Cemps = _context.Cemps.ToList();
                List<ACourcesEstimate> ACourcesEstimates = _context.ACourcesEstimates.ToList();
                List<ACourcesMaster> ACourcesMasters = _context.ACourcesMasters.ToList();
                List<ACourcesDeptin> ACourcesDeptins = _context.ACourcesDeptins.ToList();
                List<MasterRequestTypeId> MasterRequestTypeIds = _context.MasterRequestTypeIds.ToList();
                List<MasterDetails> MasterDetailss = _context.MasterDetailss.ToList();
                List<ACourcesDeptout> ACourcesDeptouts = _context.ACourcesDeptouts.ToList();
                List<ACourcesTrainingMethod> ACourcesTrainingMethods = _context.ACourcesTrainingMethods.ToList();
                List<ACourcesName> ACourcesNames = _context.ACourcesNames.ToList();
                var Records = from e in ACourcesMasters
                              join d in ACourcesTypes on e.CourcesIdType equals d.CourcesIdType into table1
                              from d in table1.ToList()
                              join i in Cemps on e.Cempid equals i.Cempid into table2
                              from i in table2.ToList()
                              where i.Cempid == e.Cempid && e.CourcesEndDate >= i.CEMPLASTUPGRADEHIJRA && i.Cempid == selectedtTime
                              join j in ACourcesEstimates on e.CourcesIdEstimate equals j.CourcesIdEstimate into table3
                              from j in table3.ToList()
                              join f in ACourcesDeptins on e.CourcesIdDeptin equals f.CourcesIdDeptin into table4
                              from f in table4.ToList()
                              join h in ACourcesDeptouts on e.CourcesIdDeptout equals h.CourcesIdDeptout into table5
                              from h in table5.ToList()
                              join n in ACourcesTrainingMethods on e.CourcesIdTraining equals n.CourcesIdTraining into table6
                              from n in table6.ToList()
                              join x in MasterRequestTypeIds on e.CourcesIdmaster equals x.COURCES_IDMASTER into table7
                              from x in table7.ToList()
                              where x.MasterRequestType == 1
                              join y in MasterDetailss on e.CourcesIdmaster equals y.COURCES_IDMASTER into table8
                              from y in table8.ToList()
                              where y.MasterRequestTypeSatus == 1
                              join z in ACourcesNames on e.CourcesId equals z.CourcesId into table9
                              from z in table9.ToList()


                              select new ViewModelMasterwithother
                              {
                                  ACourcesMasters = e,
                                  ACourcesTypes = d,
                                  Cemps = i,
                                  ACourcesEstimates = j,
                                  ACourcesDeptins = f,
                                  ACourcesDeptouts = h,
                                  ACourcesTrainingMethods = n,
                                  MasterRequestTypeIds = x,
                                  MasterDetails = y,
                                  ACourcesNames = z
                              };
                foreach (var course in Records.ToList())
                {
                    var stringId = course.ACourcesMasters.CourcesIdmaster.ToString();
                    course.ACourcesMasters.EncryptedIdd = _protector.Protect(stringId);
                    //var emppro = _context.Cemps.Where(x => x.Cempid == course.ACourcesMasters.Cempid).FirstOrDefault();
                    //emp.AEvaluationGoal.EncryptedCovenantId= _protector.Protect(stringId);
                    //emp.AEvaluationCompetenciesM.EncryptedCovenantId= _protector.Protect(stringId);
                    //emp.AEvaluationCompetenciesD.EncryptedCovenantId= _protector.Protect(stringId);

                    ////Previous code removed for the example clarity
                    //var timeLimitedProtector = _protector.ToTimeLimitedDataProtector();
                    //var timeLimitedData = timeLimitedProtector.Protect("Test timed protector", lifetime: TimeSpan.FromSeconds(2));
                    ////just to test that this action works as long as life-time hasn't expired
                    //var timedUnprotectedData = timeLimitedProtector.Unprotect(timeLimitedData);
                    //Thread.Sleep(3000);
                    //var anotherTimedUnprotectTry = timeLimitedProtector.Unprotect(timeLimitedData);
                    if (course.ACourcesMasters.CourcesIdType == 1)
                    {
                        if (course.ACourcesMasters.CourcesIdType == 1 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                        {
                            course.ACourcesMasters.gradetocourse = 40.0;
                            sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                        else if (course.ACourcesMasters.CourcesIdType == 1 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {
                            course.ACourcesMasters.gradetocourse = 30.0;
                            sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                    }
                    else if (course.ACourcesMasters.CourcesIdType == 2)
                    {
                        if (course.ACourcesMasters.CourcesIdType == 2 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                        {
                            course.ACourcesMasters.gradetocourse = 80.0;
                            sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                        else if (course.ACourcesMasters.CourcesIdType == 2 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {
                            course.ACourcesMasters.gradetocourse = 60.0;
                            sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                        else if (course.ACourcesMasters.CourcesIdType == 2 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب بالقطاع الخاص"))
                        {
                            course.ACourcesMasters.gradetocourse = 40.0;
                            sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                    }
                    else if (course.ACourcesMasters.CourcesIdType == 3)
                    {
                        if (course.ACourcesMasters.CourcesIdType == 3 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {
                            course.ACourcesMasters.gradetocourse = 1.0;
                            sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                    }
                    else if (course.ACourcesMasters.CourcesIdType == 4 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                    {

                        if (course.ACourcesMasters.CourcesIdType == 4 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && course.ACourcesMasters.CourcesIdEstimate == 1)
                        {
                            course.ACourcesMasters.gradetocourse = 50.0;
                            sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                        else if (course.ACourcesMasters.CourcesIdType == 4 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && course.ACourcesMasters.CourcesIdEstimate == 2)
                        {
                            course.ACourcesMasters.gradetocourse = 25.0;
                            sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                    }

                    //course.ACourcesMasters.gradetocourset = sumgrade;
                }

                if (sumgrade >= 100.00)
                {
                   TempData["sumgrade"] = "100.00";
                    // course.ACourcesMasters.gradetocourset = 100.0;
                }
                else
                {
                    TempData["sumgrade"] = sumgrade;
                }

                return Json(new { data = Records.ToList() });
                //return View(Records.ToList());

            }




        }
         [HttpGet]
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
<<<<<<< HEAD
        public IActionResult CreateB2(string SearchString,string b2)
=======
        public IActionResult CreateB2(string SearchString)
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["name"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");//Cempid
            double sumgrade = 0.0;
            TempData["sumgrade"] = "";
            if (SearchString == null)
            {
                List<ACourcesType> ACourcesTypes = _context.ACourcesTypes.ToList();
                List<Cemp> Cemps = _context.Cemps.ToList();
                List<ACourcesEstimate> ACourcesEstimates = _context.ACourcesEstimates.ToList();
                List<ACourcesMaster> ACourcesMasters = _context.ACourcesMasters.ToList();
                List<ACourcesDeptin> ACourcesDeptins = _context.ACourcesDeptins.ToList();
                List<MasterRequestTypeId> MasterRequestTypeIds = _context.MasterRequestTypeIds.ToList();
                List<MasterDetails> MasterDetailss = _context.MasterDetailss.ToList();
                List<ACourcesDeptout> ACourcesDeptouts = _context.ACourcesDeptouts.ToList();
                List<ACourcesTrainingMethod> ACourcesTrainingMethods = _context.ACourcesTrainingMethods.ToList();
                List<ACourcesName> ACourcesNames = _context.ACourcesNames.ToList();
                var Records = from e in ACourcesMasters
                              join d in ACourcesTypes on e.CourcesIdType equals d.CourcesIdType into table1
                              from d in table1.ToList()
                              join i in Cemps on e.Cempid equals i.Cempid into table2
                              from i in table2.ToList()
                              where i.Cempid == e.Cempid && e.CourcesEndDate >= i.CEMPLASTUPGRADEHIJRA && i.Cempid == HttpContext.Session.GetString("username")
                              join j in ACourcesEstimates on e.CourcesIdEstimate equals j.CourcesIdEstimate into table3
                              from j in table3.ToList()
                              join f in ACourcesDeptins on e.CourcesIdDeptin equals f.CourcesIdDeptin into table4
                              from f in table4.ToList()
                              join h in ACourcesDeptouts on e.CourcesIdDeptout equals h.CourcesIdDeptout into table5
                              from h in table5.ToList()
                              join n in ACourcesTrainingMethods on e.CourcesIdTraining equals n.CourcesIdTraining into table6
                              from n in table6.ToList()
                              join x in MasterRequestTypeIds on e.CourcesIdmaster equals x.COURCES_IDMASTER into table7
                              from x in table7.ToList()
                              where x.MasterRequestType == 1
                              join y in MasterDetailss on e.CourcesIdmaster equals y.COURCES_IDMASTER into table8
                              from y in table8.ToList()
                              where y.MasterRequestTypeSatus == 1
                              join z in ACourcesNames on e.CourcesId equals z.CourcesId into table9
                              from z in table9.ToList()


                              select new ViewModelMasterwithother
                              {
                                  ACourcesMasters = e,
                                  ACourcesTypes = d,
                                  Cemps = i,
                                  ACourcesEstimates = j,
                                  ACourcesDeptins = f,
                                  ACourcesDeptouts = h,
                                  ACourcesTrainingMethods = n,
                                  MasterRequestTypeIds = x,
                                  MasterDetails = y,
                                  ACourcesNames = z
                              };
                foreach (var course in Records.ToList())
                {
                    var stringId = course.ACourcesMasters.CourcesIdmaster.ToString();
                    course.ACourcesMasters.EncryptedIdd = _protector.Protect(stringId);
                    //var emppro = _context.Cemps.Where(x => x.Cempid == course.ACourcesMasters.Cempid).FirstOrDefault();
                    //emp.AEvaluationGoal.EncryptedCovenantId= _protector.Protect(stringId);
                    //emp.AEvaluationCompetenciesM.EncryptedCovenantId= _protector.Protect(stringId);
                    //emp.AEvaluationCompetenciesD.EncryptedCovenantId= _protector.Protect(stringId);

                    ////Previous code removed for the example clarity
                    //var timeLimitedProtector = _protector.ToTimeLimitedDataProtector();
                    //var timeLimitedData = timeLimitedProtector.Protect("Test timed protector", lifetime: TimeSpan.FromSeconds(2));
                    ////just to test that this action works as long as life-time hasn't expired
                    //var timedUnprotectedData = timeLimitedProtector.Unprotect(timeLimitedData);
                    //Thread.Sleep(3000);
                    //var anotherTimedUnprotectTry = timeLimitedProtector.Unprotect(timeLimitedData);
                    if (course.ACourcesMasters.CourcesIdType == 1)
                    {
                        if (course.ACourcesMasters.CourcesIdType == 1 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                        {
                            course.ACourcesMasters.gradetocourse = 40.0;
                            //sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                        else if (course.ACourcesMasters.CourcesIdType == 1 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {
                            course.ACourcesMasters.gradetocourse = 30.0;
                            //sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                    }
                    else if (course.ACourcesMasters.CourcesIdType == 2)
                    {
                        if (course.ACourcesMasters.CourcesIdType == 2 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                        {
                            course.ACourcesMasters.gradetocourse = 80.0;
                            //sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                        else if (course.ACourcesMasters.CourcesIdType == 2 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {
                            course.ACourcesMasters.gradetocourse = 60.0;
                            //sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                        else if (course.ACourcesMasters.CourcesIdType == 2 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب بالقطاع الخاص"))
                        {
                            course.ACourcesMasters.gradetocourse = 40.0;
                            //sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                    }
                    else if (course.ACourcesMasters.CourcesIdType == 3)
                    {
                        if (course.ACourcesMasters.CourcesIdType == 3 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {
                            course.ACourcesMasters.gradetocourse = 1.0;
                            //sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                    }
                    else if (course.ACourcesMasters.CourcesIdType == 4 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                    {

                        if (course.ACourcesMasters.CourcesIdType == 4 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && course.ACourcesMasters.CourcesIdEstimate == 1)
                        {
                            course.ACourcesMasters.gradetocourse = 50.0;
                            //sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                        else if (course.ACourcesMasters.CourcesIdType == 4 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && course.ACourcesMasters.CourcesIdEstimate == 2)
                        {
                            course.ACourcesMasters.gradetocourse = 25.0;
                            //sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                    }

                    //course.ACourcesMasters.gradetocourset = sumgrade;
                }

                if (sumgrade >= 100.00)
                {
                    //TempData["sumgrade"] = "100.00";
                    // course.ACourcesMasters.gradetocourset = 100.0;
                }
                else
                {
                    //TempData["sumgrade"] = sumgrade;
                }
                return View(Records.ToList());

            }
            else
            {
                List<ACourcesType> ACourcesTypes = _context.ACourcesTypes.ToList();
                List<Cemp> Cemps = _context.Cemps.ToList();
                List<ACourcesEstimate> ACourcesEstimates = _context.ACourcesEstimates.ToList();
                List<ACourcesMaster> ACourcesMasters = _context.ACourcesMasters.ToList();
                List<ACourcesDeptin> ACourcesDeptins = _context.ACourcesDeptins.ToList();
                List<MasterRequestTypeId> MasterRequestTypeIds = _context.MasterRequestTypeIds.ToList();
                List<MasterDetails> MasterDetailss = _context.MasterDetailss.ToList();
                List<ACourcesDeptout> ACourcesDeptouts = _context.ACourcesDeptouts.ToList();
                List<ACourcesTrainingMethod> ACourcesTrainingMethods = _context.ACourcesTrainingMethods.ToList();
                List<ACourcesName> ACourcesNames = _context.ACourcesNames.ToList();
                var Records = from e in ACourcesMasters
                              join d in ACourcesTypes on e.CourcesIdType equals d.CourcesIdType into table1
                              from d in table1.ToList()
                              join i in Cemps on e.Cempid equals i.Cempid into table2
                              from i in table2.ToList()
<<<<<<< HEAD
                              where i.Cempid == e.Cempid && e.CourcesEndDate >= i.CEMPLASTUPGRADEHIJRA &&(e.CourcesEndDate <=Convert.ToDateTime(b2)) && (i.Cempid == SearchString||i.CEMPPASSWRD==SearchString)
=======
                              where i.Cempid == e.Cempid && e.CourcesEndDate >= i.CEMPLASTUPGRADEHIJRA && (i.Cempid == SearchString||i.CEMPPASSWRD==SearchString)
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                              join j in ACourcesEstimates on e.CourcesIdEstimate equals j.CourcesIdEstimate into table3
                              from j in table3.ToList()
                              join f in ACourcesDeptins on e.CourcesIdDeptin equals f.CourcesIdDeptin into table4
                              from f in table4.ToList()
                              join h in ACourcesDeptouts on e.CourcesIdDeptout equals h.CourcesIdDeptout into table5
                              from h in table5.ToList()
                              join n in ACourcesTrainingMethods on e.CourcesIdTraining equals n.CourcesIdTraining into table6
                              from n in table6.ToList()
                              join x in MasterRequestTypeIds on e.CourcesIdmaster equals x.COURCES_IDMASTER into table7
                              from x in table7.ToList()
                              where x.MasterRequestType == 1
                              join y in MasterDetailss on e.CourcesIdmaster equals y.COURCES_IDMASTER into table8
                              from y in table8.ToList()
                              where y.MasterRequestTypeSatus == 1
                              join z in ACourcesNames on e.CourcesId equals z.CourcesId into table9
                              from z in table9.ToList()


                              select new ViewModelMasterwithother
                              {
                                  ACourcesMasters = e,
                                  ACourcesTypes = d,
                                  Cemps = i,
                                  ACourcesEstimates = j,
                                  ACourcesDeptins = f,
                                  ACourcesDeptouts = h,
                                  ACourcesTrainingMethods = n,
                                  MasterRequestTypeIds = x,
                                  MasterDetails = y,
                                  ACourcesNames = z
                              };
                foreach (var course in Records.ToList())
                {
                    var stringId = course.ACourcesMasters.CourcesIdmaster.ToString();
                    course.ACourcesMasters.EncryptedIdd = _protector.Protect(stringId);
                    //var emppro = _context.Cemps.Where(x => x.Cempid == course.ACourcesMasters.Cempid).FirstOrDefault();
                    //emp.AEvaluationGoal.EncryptedCovenantId= _protector.Protect(stringId);
                    //emp.AEvaluationCompetenciesM.EncryptedCovenantId= _protector.Protect(stringId);
                    //emp.AEvaluationCompetenciesD.EncryptedCovenantId= _protector.Protect(stringId);

                    ////Previous code removed for the example clarity
                    //var timeLimitedProtector = _protector.ToTimeLimitedDataProtector();
                    //var timeLimitedData = timeLimitedProtector.Protect("Test timed protector", lifetime: TimeSpan.FromSeconds(2));
                    ////just to test that this action works as long as life-time hasn't expired
                    //var timedUnprotectedData = timeLimitedProtector.Unprotect(timeLimitedData);
                    //Thread.Sleep(3000);
                    //var anotherTimedUnprotectTry = timeLimitedProtector.Unprotect(timeLimitedData);
                    if (course.ACourcesMasters.CourcesIdType == 1)
                    {
                        if (course.ACourcesMasters.CourcesIdType == 1 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                        {
                            course.ACourcesMasters.gradetocourse = 40.0;
                            //sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                        else if (course.ACourcesMasters.CourcesIdType == 1 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {
                            course.ACourcesMasters.gradetocourse = 30.0;
                            //sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                    }
                    else if (course.ACourcesMasters.CourcesIdType == 2)
                    {
                        if (course.ACourcesMasters.CourcesIdType == 2 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب دولية"))
                        {
                            course.ACourcesMasters.gradetocourse = 80.0;
                            //sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                        else if (course.ACourcesMasters.CourcesIdType == 2 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {
                            course.ACourcesMasters.gradetocourse = 60.0;
                            //sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                        else if (course.ACourcesMasters.CourcesIdType == 2 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب بالقطاع الخاص"))
                        {
                            course.ACourcesMasters.gradetocourse = 40.0;
                            //sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                    }
                    else if (course.ACourcesMasters.CourcesIdType == 3)
                    {
                        if (course.ACourcesMasters.CourcesIdType == 3 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                        {
                            course.ACourcesMasters.gradetocourse = 1.0;
                            //sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                    }
                    else if (course.ACourcesMasters.CourcesIdType == 4 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية"))
                    {

                        if (course.ACourcesMasters.CourcesIdType == 4 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && course.ACourcesMasters.CourcesIdEstimate == 1)
                        {
                            course.ACourcesMasters.gradetocourse = 50.0;
                            //sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                        else if (course.ACourcesMasters.CourcesIdType == 4 && course.ACourcesMasters.COURCES_EXCUTION.Equals("جهة تدريب حكومية") && course.ACourcesMasters.CourcesIdEstimate == 2)
                        {
                            course.ACourcesMasters.gradetocourse = 25.0;
                            //sumgrade += course.ACourcesMasters.gradetocourse;
                        }
                    }

                    //course.ACourcesMasters.gradetocourset = sumgrade;
                }

                if (sumgrade >= 100.00)
                {
                    //TempData["sumgrade"] = "100.00";
                    // course.ACourcesMasters.gradetocourset = 100.0;
                }
                else
                {
                    //TempData["sumgrade"] = sumgrade;
                }

                //return Json(new { data = Records.ToList() });
                return View(Records.ToList());

            }




        }

       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public IActionResult CreateB4(string SearchString)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Jobname"] = new SelectList(_context.AJobsNames, "CourcesName", "CourcesName");
            ViewBag.Role = HttpContext.Session.GetInt32("emprole");
            if (SearchString == null)
            {
                List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
                List<AEvaluationGoal1> AEvaluationGoals = _context.AEvaluationGoals1.Where(zx => zx.CovenantGoalsName != null).ToList();
                List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
                List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
                List<EvalDetail2> EvalDetails = _context.EvalDetailss2.ToList();
                List<EvalRequestTypeId2> EvalRequestTypeIds = _context.EvalRequestTypeIds2.ToList();
                List<Cemp> cemps = _context.Cemps.Where(ZX => ZX.Cempid == HttpContext.Session.GetString("username")).ToList();


                var Records = from e in cemps
                                  //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                                  //from d in table1.ToList()
                                  //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                                  //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                                  //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                                  //from j in table3.ToList()
                              join f in AEvaluationGoals on e.Cempid equals Convert.ToString(f.EmpId) into table4
                              from f in table4.ToList()
                              where e.Cempid == HttpContext.Session.GetString("username")

                              //where (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo3 == "1") && (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo4 == "1") && (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo5 == "1")
                              //where f.OfferedRequestTypeSatus == 1
                              ////where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                              //join h in EvalRequestTypeIds on e.Idd equals h.CourcesIdoffered into table5
                              //from h in table5.ToList()
                              //where h.OfferedRequestType == 1



                              select new ViewModelEvalwithother
                              {
                                  cemp = e,
                                  //AEvaluationGoal = d,
                                  //AEvaluationCompetenciesM = i,
                                  //AEvaluationCompetenciesD = j,
                                  AEvaluationGoal1 = f
                                  //evalRequestTypeId2 = h,

                              };
                foreach (var emp in Records.ToList())
                {
                    var stringId = emp.AEvaluationGoal1.Idd4.ToString();
                    emp.AEvaluationGoal1.EncryptedIdd4Id = _protector.Protect(stringId);
                    //emp.AEvaluationGoal.EncryptedCovenantId= _protector.Protect(stringId);
                    //emp.AEvaluationCompetenciesM.EncryptedCovenantId= _protector.Protect(stringId);
                    //emp.AEvaluationCompetenciesD.EncryptedCovenantId= _protector.Protect(stringId);

                    ////Previous code removed for the example clarity
                    //var timeLimitedProtector = _protector.ToTimeLimitedDataProtector();
                    //var timeLimitedData = timeLimitedProtector.Protect("Test timed protector", lifetime: TimeSpan.FromSeconds(2));
                    ////just to test that this action works as long as life-time hasn't expired
                    //var timedUnprotectedData = timeLimitedProtector.Unprotect(timeLimitedData);
                    //Thread.Sleep(3000);
                    //var anotherTimedUnprotectTry = timeLimitedProtector.Unprotect(timeLimitedData);
                }

                return View(Records.ToList());
            }
            else
            {
                //List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
                List<AEvaluationGoal1> AEvaluationGoals = _context.AEvaluationGoals1.Where(zx => zx.CovenantGoalsName != null).ToList();
                ////List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
                ////List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
                ////List<EvalDetail2> EvalDetails = _context.EvalDetailss2.ToList();
                ////List<EvalRequestTypeId2> EvalRequestTypeIds = _context.EvalRequestTypeIds2.ToList();
                List<Cemp> cemps = _context.Cemps.ToList();


                var Records = from e in cemps
                                  //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                                  //from d in table1.ToList()
                                  //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                                  //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                                  //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                                  //from j in table3.ToList()
                              join f in AEvaluationGoals on e.Cempid equals Convert.ToString(f.EmpId) into table4
                              from f in table4.ToList()
                              where e.CEMPJOBNAME == SearchString
                              //where (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo3 == "1") && (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo4 == "1") && (f.OfferedRequestFrom == HttpContext.Session.GetString("empid") && f.OfferedRequestTo5 == "1")
                              //where f.OfferedRequestTypeSatus == 1
                              ////where f.OfferedRequestFrom == HttpContext.Session.GetString("username")
                              //join h in EvalRequestTypeIds on e.Idd equals h.CourcesIdoffered into table5
                              //from h in table5.ToList()
                              //where h.OfferedRequestType == 1



                              select new ViewModelEvalwithother
                              {
                                  cemp = e,
                                  //AEvaluationGoal = d,
                                  //AEvaluationCompetenciesM = i,
                                  //AEvaluationCompetenciesD = j,
                                  AEvaluationGoal1 = f
                                  //evalRequestTypeId2 = h,

                              };
                foreach (var emp in Records.ToList())
                {
                    var stringId = emp.AEvaluationGoal1.Idd4.ToString();
                    emp.AEvaluationGoal1.EncryptedIdd4Id = _protector.Protect(stringId);
                    //emp.AEvaluationGoal.EncryptedCovenantId= _protector.Protect(stringId);
                    //emp.AEvaluationCompetenciesM.EncryptedCovenantId= _protector.Protect(stringId);
                    //emp.AEvaluationCompetenciesD.EncryptedCovenantId= _protector.Protect(stringId);

                    ////Previous code removed for the example clarity
                    //var timeLimitedProtector = _protector.ToTimeLimitedDataProtector();
                    //var timeLimitedData = timeLimitedProtector.Protect("Test timed protector", lifetime: TimeSpan.FromSeconds(2));
                    ////just to test that this action works as long as life-time hasn't expired
                    //var timedUnprotectedData = timeLimitedProtector.Unprotect(timeLimitedData);
                    //Thread.Sleep(3000);
                    //var anotherTimedUnprotectTry = timeLimitedProtector.Unprotect(timeLimitedData);
                }
                //return Json(new { data = Records.ToList() });
                return View(Records.ToList());

            }




        }
        [Authorize(Roles = "Admin,HR-Admin")]
        public IActionResult Editb4(string id)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");

            String cid = _protector.Unprotect(id);
            if (cid == null)
            {
                return NotFound();
            }
            //var aevgoal110= _AEvaluationGoals1.Entity.GetWithRawSql("SELECT *  FROM [hr].[dbo].[A_EVALUATION_GOALS1] WHERE [IDD] = @p0",Convert.ToInt32(cid)).FirstOrDefault();
            var aevgoal1 = _context.AEvaluationGoals1.Where(c => c.Idd4 == Convert.ToInt32(cid)).FirstOrDefault();

            if (aevgoal1 == null)
            {
                return NotFound();
            }
            return View(aevgoal1);
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        [Authorize(Roles = "Admin,HR-Admin")]
        public async Task<IActionResult> Editb4(AEvaluationGoal1 AEvaluationGoal1)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            var AEvaluationGoal11 = _context.AEvaluationGoals1.Where(b => b.Idd4 == AEvaluationGoal1.Idd4).FirstOrDefault();
            AEvaluationGoal11.Idd4 = AEvaluationGoal1.Idd4;
            AEvaluationGoal11.CovenantGoalsName = AEvaluationGoal1.CovenantGoalsName;
            AEvaluationGoal11.CovenantPercentageWeight = AEvaluationGoal1.CovenantPercentageWeight;
            
            // logs by easy way 
            //logs
            AGoalsLogs aa = new AGoalsLogs
            {
                requestid = Convert.ToString(AEvaluationGoal1.Idd4),
                userr = HttpContext.Session.GetString("empid"),
                tt = DateTime.Now
            };
            var model = _mapper.Map<LogModels>(aa);
          
            _context.Update(AEvaluationGoal11);//
            //_AGoalLogsRepository.InsertAGoalsLogs(aa);
            //_AGoalLogsRepository.Save();
            //_AGoalsLogs.Entity.insert(aa);
            //_AGoalsLogs.save();
            _context.AGoalsLogs.Add(aa);
            await _context.SaveChangesAsync();
            return RedirectToAction("CreateB4", "ViewModelEvalwithother1", new { area = "" });
            //return View();
        }

       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public IActionResult Create()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps.Where(c=>c.CEMPADPRTNO== HttpContext.Session.GetString("empdepid")&&c.MANAGERID== HttpContext.Session.GetString("username")||c.CEMPNO == HttpContext.Session.GetString("username")), "Cempid", "CEMPNAME");
            var empuser = _context.Cemps.Where(x => x.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
            if(empuser.CROLEID==5)
            {
                ViewData["Cempid"] = new SelectList(_context.Cemps.ToList(), "Cempid", "CEMPNAME");

            }
<<<<<<< HEAD
            AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Empno == Convert.ToInt32(HttpContext.Session.GetString("username")) && x.year == Convert.ToString(DateTime.Now.Year)).FirstOrDefault();
=======
            AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Empno == Convert.ToInt32(HttpContext.Session.GetString("username")) && x.year == "2022").FirstOrDefault();
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
            if(AEvaluationEmpemp==null)
            {
                return View();
            }
            else
            {
<<<<<<< HEAD
                ViewBag.msg = "لديك طلب ميثاق ل هذا العام   رقم  "+ AEvaluationEmpemp.Idd;
=======
                ViewBag.msg = "لديك طلب ميثاق للعام 2022  رقم  "+ AEvaluationEmpemp.Idd;
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                //ViewBag.msg = "يتم رفع طلب مثاق الاداء للعام 2022 من هنا ويرجي ضبط الوزن النسبي ولايتجاوز 100% وذلك حتي يتم حفظ الطلب ";
            }
            return View();
        }
        [HttpPost]
        [ValidateAntiForgeryToken]
        public async Task<IActionResult> Create( ViewModelEvalwithother1 ViewModelEvalwithother1)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
<<<<<<< HEAD
            AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Empno == Convert.ToInt32(ViewModelEvalwithother1.AEvaluationEmpEmpno) && x.year == Convert.ToString(DateTime.Now.Year)).FirstOrDefault();
            if (AEvaluationEmpemp != null)
            {
                ViewBag.msg = "لديك طلب ميثاق ل هذا العام    رقم  " + AEvaluationEmpemp.Idd;
=======
            AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Empno == Convert.ToInt32(ViewModelEvalwithother1.AEvaluationEmpEmpno) && x.year == "2022").FirstOrDefault();
            if (AEvaluationEmpemp != null)
            {
                ViewBag.msg = "لديك طلب ميثاق للعام 2022  رقم  " + AEvaluationEmpemp.Idd;
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
              //  ViewBag.msg = "يتم رفع طلب مثاق الاداء للعام 2022 من هنا ويرجي ضبط الوزن النسبي ولايتجاوز 100% وذلك حتي يتم حفظ الطلب ";
                return View();
            }
            // check for goals count 
            //if (ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight5 == null && ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight6 == null)
            //{
            //    if ((ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight1 + ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight2 + ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight3 + ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight4) != 100)
            //    {

            //        ViewBag.msg = "مجموع الوزن النسبي للاهداف لايساوي 100 ";
            //        return View();
            //    }
            //}
            if (ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight5 == null)
            {
                ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight5 = 0;
            }
            if (ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight6 == null)
            {
                ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight6 = 0;
            }
            if ((ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight1 + ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight2 + ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight3 + ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight4 + ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight5 + ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight6) != 100)
            {

                ViewBag.msg = "مجموع الوزن النسبي للاهداف لايساوي 100  ";
                return View();
            }
            // check for privilage to gadara 
            var emppriv = _context.Cemps.Where(x => x.Cempid ==Convert.ToString(ViewModelEvalwithother1.AEvaluationEmpEmpno)).FirstOrDefault();
            if(emppriv.CROLEID==3&& ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7 != null)
            {
                ViewBag.msg = "عذرا جدارة القيادة للوظائف الاشرافيه فقط  ";
                return View();
            }
            if (emppriv.CROLEID == 5 && ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7 != null)
            {
                ViewBag.msg = "عذرا جدارة القيادة للوظائف الاشرافيه فقط ";
                return View();
            }
            if (emppriv.CROLEID == 2 && ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7 == null)
            {
                ViewBag.msg = "يجب ادخال درجة جدارة القيادة ";
                return View();
            }
            // check for gadara count
            if (ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7==null)
            {
                ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7 = "0";
            }
           if (Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight1) + Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight2) + Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight3) + Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight4) + Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight5) + Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight6)+ Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7) != 100)
           {
                    ViewBag.msg = "مجموع الوزن النسبي للجدارات لايساوي 100  ";
                    return View();
           }
          
            if (ModelState.IsValid)
            {
                if (ViewModelEvalwithother1.AEvaluationEmpEmpno == null)
                {
                    ViewBag.msg = "يرجي اختيار اسم الموظف من القائمة   ";
                    return View();
                }
                Cemp cemp = _context.Cemps.Where(c => c.Cempid == Convert.ToString(ViewModelEvalwithother1.AEvaluationEmpEmpno)).FirstOrDefault();
                if (cemp == null)
                {
                    ViewBag.msg = "يرجي اختيار اسم الموظف من القائمة  ";
                    return View();
                }
                AEvaluationEmp aEvaluationEmp = new AEvaluationEmp
                {
                    Empno = ViewModelEvalwithother1.AEvaluationEmpEmpno,
                    Empname = cemp.CEMPNAME,
                    //Empname = HttpContext.Session.GetString("empname"),
                    Jobname = cemp.CEMPJOBNAME,
                    DepName= cemp.PARENTNAME,
                    SubDepName =cemp.DEP_NAME,
                    ManagerName = cemp.MANAGERNAME,
                    CovenantDate=DateTime.Now,
                    CovenantId=0,
                    CovenantYear=DateTime.Now.Year,
                    Managerid=Convert.ToInt32(cemp.MANAGERID),
                    Parentid=Convert.ToInt32(cemp.PARENTID),
                    Adprtno= Convert.ToInt32(cemp.CEMPADPRTNO),
                    EmpIdEnter= Convert.ToInt32(HttpContext.Session.GetString("empid")),
                    EvaEmpnoNameOut= "4211001",
                    EvaEmpnoOut= 4211001,
                    EvaEmpnoNameOut1=null,
                    Notes= "تم المراجعة",
                    TypeNo=5,
<<<<<<< HEAD
                    year= Convert.ToString(DateTime.Now.Year)
=======
                    year="2022"
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b

                };
                _context.Add(aEvaluationEmp);
                await _context.SaveChangesAsync();
             

                List<AEvaluationGoal> aEvaluationGoals = new List<AEvaluationGoal>()
                  {
                      new AEvaluationGoal{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,EmpType="مدير",CovenantGoalsSeq=1,CovenantGoalsName=ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName1,CovenantMeasurementCriteria=ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria1,CovenantPercentageWeight=ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight1,CovenantTargetedOutput=ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput1,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd),CovenantDate=DateTime.Now,EvaluationActualOutput=null,EvaluationDate=null,EvaluationDifferenceOutputs=null,EvaluationEquilibrium=null,EvaluationId=null,EvaluationResult=null,EvaluationTotal=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantWeightSum=100,EmpIdEnter=Convert.ToInt32(HttpContext.Session.GetString("empid"))},
                      new AEvaluationGoal{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,EmpType="مدير",CovenantGoalsSeq=2,CovenantGoalsName=ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName2,CovenantMeasurementCriteria=ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria2,CovenantPercentageWeight=ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight2,CovenantTargetedOutput=ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput2,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd),CovenantDate=DateTime.Now,EvaluationActualOutput=null,EvaluationDate=null,EvaluationDifferenceOutputs=null,EvaluationEquilibrium=null,EvaluationId=null,EvaluationResult=null,EvaluationTotal=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantWeightSum=100,EmpIdEnter=Convert.ToInt32(HttpContext.Session.GetString("empid"))},
                      new AEvaluationGoal{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,EmpType="مدير",CovenantGoalsSeq=3,CovenantGoalsName=ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName3,CovenantMeasurementCriteria=ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria3,CovenantPercentageWeight=ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight3,CovenantTargetedOutput=ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput3,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd),CovenantDate=DateTime.Now,EvaluationActualOutput=null,EvaluationDate=null,EvaluationDifferenceOutputs=null,EvaluationEquilibrium=null,EvaluationId=null,EvaluationResult=null,EvaluationTotal=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantWeightSum=100,EmpIdEnter=Convert.ToInt32(HttpContext.Session.GetString("empid"))},
                      new AEvaluationGoal{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,EmpType="مدير",CovenantGoalsSeq=4,CovenantGoalsName=ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName4,CovenantMeasurementCriteria=ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria4,CovenantPercentageWeight=ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight4,CovenantTargetedOutput=ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput4,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd),CovenantDate=DateTime.Now,EvaluationActualOutput=null,EvaluationDate=null,EvaluationDifferenceOutputs=null,EvaluationEquilibrium=null,EvaluationId=null,EvaluationResult=null,EvaluationTotal=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantWeightSum=100,EmpIdEnter=Convert.ToInt32(HttpContext.Session.GetString("empid"))},
                      new AEvaluationGoal{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,EmpType="مدير",CovenantGoalsSeq=5,CovenantGoalsName=ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName5,CovenantMeasurementCriteria=ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria5,CovenantPercentageWeight=ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight5,CovenantTargetedOutput=ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput5,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd),CovenantDate=DateTime.Now,EvaluationActualOutput=null,EvaluationDate=null,EvaluationDifferenceOutputs=null,EvaluationEquilibrium=null,EvaluationId=null,EvaluationResult=null,EvaluationTotal=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantWeightSum=100,EmpIdEnter=Convert.ToInt32(HttpContext.Session.GetString("empid"))},
                      new AEvaluationGoal{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,EmpType="مدير",CovenantGoalsSeq=6,CovenantGoalsName=ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName6,CovenantMeasurementCriteria=ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria6,CovenantPercentageWeight=ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight6,CovenantTargetedOutput=ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput6,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd),CovenantDate=DateTime.Now,EvaluationActualOutput=null,EvaluationDate=null,EvaluationDifferenceOutputs=null,EvaluationEquilibrium=null,EvaluationId=null,EvaluationResult=null,EvaluationTotal=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantWeightSum=100,EmpIdEnter=Convert.ToInt32(HttpContext.Session.GetString("empid"))},

                  };
                foreach (AEvaluationGoal AEvaluationGoal in aEvaluationGoals)
                {
                    _context.AEvaluationGoals.Add(AEvaluationGoal);
                }
                await _context.SaveChangesAsync();


                List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = new List<AEvaluationCompetenciesM>()
                {
                    new AEvaluationCompetenciesM{CovenantCompetenciesSeq=1,CovenantCompetencyName="حس المسؤولية",CovenantWeight=ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight1,EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantWeightSum=100,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesM{CovenantCompetenciesSeq=2,CovenantCompetencyName="التعاون",CovenantWeight=ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight2,EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantWeightSum=100,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesM{CovenantCompetenciesSeq=3,CovenantCompetencyName="التواصل",CovenantWeight=ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight3,EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantWeightSum=100,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesM{CovenantCompetenciesSeq=4,CovenantCompetencyName="تحقيق النتائج",CovenantWeight=ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight4,EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantWeightSum=100,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesM{CovenantCompetenciesSeq=5,CovenantCompetencyName="التطوير ",CovenantWeight=ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight5,EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantWeightSum=100,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesM{CovenantCompetenciesSeq=6,CovenantCompetencyName="الارتباط الوظيفي",CovenantWeight=ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight6,EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantWeightSum=100,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesM{CovenantCompetenciesSeq=7,CovenantCompetencyName="القيادة",CovenantWeight=ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7,EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantWeightSum=100,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},

                };
                foreach (AEvaluationCompetenciesM AEvaluationCompetenciesM in AEvaluationCompetenciesMs)
                {
                    _context.AEvaluationCompetenciesMs.Add(AEvaluationCompetenciesM);
                }
                await _context.SaveChangesAsync();
                //
                List<AEvaluationCompetenciesD> aEvaluationCompetenciesDs = new List<AEvaluationCompetenciesD>()
                {
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=1,CovenantCompetenciesDDesc="يتحمل مسؤولية أعماله و قراراته، ولا يلقى اللوم على الآخرين.",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel1,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=1,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=1,CovenantCompetenciesDDesc="يفهم دوره، و كيفية ارتباطه بالأهداف العامة لجهة عمله.",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel2,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=2,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=1,CovenantCompetenciesDDesc="يفصح عن ما يواجهة من تحديات بشفافية.",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel3,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=3,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=2,CovenantCompetenciesDDesc="يشارك المعلومات بانفتاح وفق متطلبات العمل.",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel4,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=1,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=2,CovenantCompetenciesDDesc="يسعى الى الاستفادة من اراء الأخرين من خارج ادارته ،و تهيئة الأخرين لدعم الأعمال التي يقوم بها من خلال بناء علاقات داعمة معهم  .",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel5,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=2,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=2,CovenantCompetenciesDDesc="يستجيب لطلبات الدعم و المساندة من الوحدات التنظيمية في جهة عمله.يستجيب لطلبات الدعم و المساندة من الوحدات التنظيمية في جهة عمله  .",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel6,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=3,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=3,CovenantCompetenciesDDesc="يستخدم التواصل المكتوب الواضح والفعال  .",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel7,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=1,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=3,CovenantCompetenciesDDesc="يستخدم التواصل الشفهي الواضح والفعال.",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel8,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=2,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=3,CovenantCompetenciesDDesc="ينصت للآخرين بعناية .",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel9,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=3,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=4,CovenantCompetenciesDDesc="يستطيع القيام بمهام متعددة و تحديد أولوياتها  حسب اهميتها النسبية.",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel10,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=1,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=4,CovenantCompetenciesDDesc="يمكن الاعتماد عليه , وينفذ مهامه في وقتها بمستوى عال من الجودة .",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel11,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=2,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=4,CovenantCompetenciesDDesc="مبادر ويعمل بدون توجيه من رئيسه عند تنفيذه لمهامه.",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel12,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=3,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=5,CovenantCompetenciesDDesc="يسعى إلى التعلم وتطوير نفسه باستمرار .",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel13,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=1,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=5,CovenantCompetenciesDDesc="يساعد الأخرين على تطوير انفسهم .",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel14,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=2,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=6,CovenantCompetenciesDDesc="لدية الاستعداد لمواجهة تحديات العمل .",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel15,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=1,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=6,CovenantCompetenciesDDesc="يتطلُّع إلى مستوى أعلى من الإنجاز والابتكار عند تنفيذ العمل.",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel16,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=2,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=6,CovenantCompetenciesDDesc="يلتزم بمواعيد العمل و يكون متواجدا عند الحاجة اليه .",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel17,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=3,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=6,CovenantCompetenciesDDesc="يركز على خدمة العملاء عند تنفيذ اعماله",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel18,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=4,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=7,CovenantCompetenciesDDesc="مرن وقادر على تنفيذ أعمال هامة فى ظروف تنطوى على قدر كبير من المخاطرة وعدم اليقين .",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel19,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=1,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=7,CovenantCompetenciesDDesc="يدعم و يشجع فريقه على تحقيق اهدافه، حتى في الظروف الصعبة  .",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel20,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=2,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=7,CovenantCompetenciesDDesc="يفكر بمنطقية و ابداع دون التأثر بتحيزاته الشخصية.",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel21,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=3,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=7,CovenantCompetenciesDDesc="يفوض الصلاحيات و يتابع النتائج  .",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel22,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=4,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},
                    new AEvaluationCompetenciesD{EmpId=ViewModelEvalwithother1.AEvaluationEmpEmpno,CovenantCompetenciesDSeq=7,CovenantCompetenciesDDesc="يوفر ويدعم فرص تطوير المرؤوسين.",CovenantCompetenciecDLevel=ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel23,EvaluationOutputCompetency=null,EvaluationResults=null,EvaluationTotal=null,CovenantCompetenciesDSeqD=5,CovenantId=_context.AEvaluationEmps.Max(u => u.Idd)},





                };
                foreach (AEvaluationCompetenciesD AEvaluationCompetenciesD in aEvaluationCompetenciesDs)
                {
                    _context.AEvaluationCompetenciesDs.Add(AEvaluationCompetenciesD);
                }
                await _context.SaveChangesAsync();
                //

                var objuser = _context.Cemps.Where(b => b.CEMPNO==Convert.ToString(ViewModelEvalwithother1.AEvaluationEmpEmpno)).FirstOrDefault();

                //var depwithmangforemp = _context.DepartWithMnagement.FirstOrDefault(m => m.CEMPADPRTNO == objuser.CEMPADPRTNO);
             
                if (HttpContext.Session.GetString("empmanagerid2") != null)
                {
                   

                    EvalDetail OfferedDetailss = new EvalDetail
                    {
                        CourcesIdoffered = aEvaluationEmp.Idd,
                        OfferedRequestFrom =Convert.ToString(ViewModelEvalwithother1.AEvaluationEmpEmpno),
                        OfferedRequestTo = cemp.MANAGERID,
                        OfferedRequestTo2 = cemp.MANAGERID2id,
                        OfferedRequestTo3 = "0",
                        OfferedRequestTo4 = "1",
                        OfferedRequestTo5 = "1",
                        OfferedRequestTypeSatus = 0,
                        OfferedRequestNotes = "",
                        Offeredoption = "4056001"   

                    };
                    _context.Add(OfferedDetailss);
                     
                    await _context.SaveChangesAsync();

                    EvalDetail2 OfferedDetailss2 = new EvalDetail2
                    {
                        CourcesIdoffered = aEvaluationEmp.Idd,
                        OfferedRequestFrom = Convert.ToString(ViewModelEvalwithother1.AEvaluationEmpEmpno),
                        OfferedRequestTo = cemp.MANAGERID,
                        OfferedRequestTo2 = cemp.MANAGERID2id,
                        OfferedRequestTo3 = "0",
                        OfferedRequestTo4 = "1",
                        OfferedRequestTo5 = "1",
                        OfferedRequestTypeSatus = 2022,
                        OfferedRequestNotes = "",
                        Offeredoption = "4056001"

                    };
                    _context.Add(OfferedDetailss2);

                    await _context.SaveChangesAsync();
                }
                else
                {
                   
                }




                EvalRequestTypeId OfferedRequestTypeIds = new EvalRequestTypeId
                {
                    CourcesIdoffered = aEvaluationEmp.Idd,
                    Offercoursefrom = Convert.ToString(ViewModelEvalwithother1.AEvaluationEmpEmpno),
                    OfferedRequestType = 0

                };
                _context.Add(OfferedRequestTypeIds);
               await _context.SaveChangesAsync();

                EvalRequestTypeId2 OfferedRequestTypeIds2 = new EvalRequestTypeId2
                {
                    CourcesIdoffered = aEvaluationEmp.Idd,
                    Offercoursefrom = Convert.ToString(ViewModelEvalwithother1.AEvaluationEmpEmpno),
                    OfferedRequestType = 2022

                };
                _context.Add(OfferedRequestTypeIds2);
                await _context.SaveChangesAsync();
                //





                return RedirectToAction(nameof(Search1));
            }
            return View(ViewModelEvalwithother1);
        }
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        // get 
        public ActionResult Detail(/*int? id*/ string id)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");
            String cid = _protector.Unprotect(id);
            if (cid == null)
            {
                return NotFound();
            }
            AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Idd == Convert.ToInt32(cid)).FirstOrDefault();
            //AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Empno == Convert.ToInt32(HttpContext.Session.GetString("username"))&&x.year=="2022").FirstOrDefault();
            //HttpContext.Session.SetString("AEvaluationEmpidd", Convert.ToString(AEvaluationEmpemp.Idd));

            //if (id == null)
            //{
            //    return NotFound();
            //}
            var vAEvaluationEmps1 = _context.AEvaluationEmps.Where(d => d.Idd == AEvaluationEmpemp.Idd).FirstOrDefault();
            //var  vAEvaluationGoals1 = _context.AEvaluationGoals.Where(d => d.CovenantId == id).OrderBy(d => d.CovenantGoalsSeq).FirstOrDefault();
            List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
            av1 = vAEvaluationGoals[0];
            av2 = vAEvaluationGoals[1];
            av3 = vAEvaluationGoals[2];
            av4 = vAEvaluationGoals[3];
            if (vAEvaluationGoals.Count > 4)
            {
                av5 = vAEvaluationGoals[4];

            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6 = vAEvaluationGoals[5];
            }
            List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            am1 = vAEvaluationCompetenciesMs[0];
            am2 = vAEvaluationCompetenciesMs[1];
            am3 = vAEvaluationCompetenciesMs[2];
            am4 = vAEvaluationCompetenciesMs[3];
            am5 = vAEvaluationCompetenciesMs[4];
            am6 = vAEvaluationCompetenciesMs[5];
            if (vAEvaluationCompetenciesMs.Count > 6)
            {

                am7 = vAEvaluationCompetenciesMs[6];
            }

            List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            ad1 = vAEvaluationCompetenciesDs[0];
            ad2 = vAEvaluationCompetenciesDs[1];
            ad3 = vAEvaluationCompetenciesDs[2];
            ad4 = vAEvaluationCompetenciesDs[3];
            ad5 = vAEvaluationCompetenciesDs[4];
            ad6 = vAEvaluationCompetenciesDs[5];
            ad7 = vAEvaluationCompetenciesDs[6];
            ad8 = vAEvaluationCompetenciesDs[7];
            ad9 = vAEvaluationCompetenciesDs[8];
            ad10 = vAEvaluationCompetenciesDs[9];
            ad11 = vAEvaluationCompetenciesDs[10];
            ad12 = vAEvaluationCompetenciesDs[11];
            ad13 = vAEvaluationCompetenciesDs[12];
            ad14 = vAEvaluationCompetenciesDs[13];
            ad15 = vAEvaluationCompetenciesDs[14];
            ad16 = vAEvaluationCompetenciesDs[15];
            ad17 = vAEvaluationCompetenciesDs[16];
            ad18 = vAEvaluationCompetenciesDs[17];
            if (vAEvaluationCompetenciesDs.Count > 18)
            {

                ad19 = vAEvaluationCompetenciesDs[18];
                ad20 = vAEvaluationCompetenciesDs[19];
                ad21 = vAEvaluationCompetenciesDs[20];
                ad22 = vAEvaluationCompetenciesDs[21];
                ad23 = vAEvaluationCompetenciesDs[22];
            }
            if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }


            return View();
            //return View(ViewModelEvalwithother1);
        }


       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        // get 
        //[MiddlewareFilter(typeof(JsReportPipeline))]
        public ActionResult Details(string id)
        {
            //HttpContext.JsReportFeature().Recipe(Recipe.ChromePdf);
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");
            String cid = _protector.Unprotect(id);
            if (cid == null)
            {
                return NotFound();
            }
            AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Idd == Convert.ToInt32(cid) /*&& x.year == "2022"*/).FirstOrDefault();
            //HttpContext.Session.SetString("AEvaluationEmpidd", Convert.ToString(AEvaluationEmpemp.Idd));

            //if (id == null)
            //{
            //    return NotFound();
            //}
            var vAEvaluationEmps1 = _context.AEvaluationEmps.Where(d => d.Idd == AEvaluationEmpemp.Idd).FirstOrDefault();
            //var  vAEvaluationGoals1 = _context.AEvaluationGoals.Where(d => d.CovenantId == id).OrderBy(d => d.CovenantGoalsSeq).FirstOrDefault();
            List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
            av1 = vAEvaluationGoals[0];
            av2 = vAEvaluationGoals[1];
            av3 = vAEvaluationGoals[2];
            av4 = vAEvaluationGoals[3];
            if (vAEvaluationGoals.Count > 4)
            {
                av5 = vAEvaluationGoals[4];

            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6 = vAEvaluationGoals[5];
            }
            List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            am1 = vAEvaluationCompetenciesMs[0];
            am2 = vAEvaluationCompetenciesMs[1];
            am3 = vAEvaluationCompetenciesMs[2];
            am4 = vAEvaluationCompetenciesMs[3];
            am5 = vAEvaluationCompetenciesMs[4];
            am6 = vAEvaluationCompetenciesMs[5];
            if (vAEvaluationCompetenciesMs.Count > 6)
            {

                am7 = vAEvaluationCompetenciesMs[6];
            }

            List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            ad1 = vAEvaluationCompetenciesDs[0];
            ad2 = vAEvaluationCompetenciesDs[1];
            ad3 = vAEvaluationCompetenciesDs[2];
            ad4 = vAEvaluationCompetenciesDs[3];
            ad5 = vAEvaluationCompetenciesDs[4];
            ad6 = vAEvaluationCompetenciesDs[5];
            ad7 = vAEvaluationCompetenciesDs[6];
            ad8 = vAEvaluationCompetenciesDs[7];
            ad9 = vAEvaluationCompetenciesDs[8];
            ad10 = vAEvaluationCompetenciesDs[9];
            ad11 = vAEvaluationCompetenciesDs[10];
            ad12 = vAEvaluationCompetenciesDs[11];
            ad13 = vAEvaluationCompetenciesDs[12];
            ad14 = vAEvaluationCompetenciesDs[13];
            ad15 = vAEvaluationCompetenciesDs[14];
            ad16 = vAEvaluationCompetenciesDs[15];
            ad17 = vAEvaluationCompetenciesDs[16];
            ad18 = vAEvaluationCompetenciesDs[17];
            if (vAEvaluationCompetenciesDs.Count > 18)
            {

                ad19 = vAEvaluationCompetenciesDs[18];
                ad20 = vAEvaluationCompetenciesDs[19];
                ad21 = vAEvaluationCompetenciesDs[20];
                ad22 = vAEvaluationCompetenciesDs[21];
                ad23 = vAEvaluationCompetenciesDs[22];
            }
            if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }


            return View();
            //return View(ViewModelEvalwithother1);
        }
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        // get 
        [MiddlewareFilter(typeof(JsReportPipeline))]
        public ActionResult Detailsp(string id)
        {
            HttpContext.JsReportFeature().Recipe(Recipe.ChromePdf);
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");
            String cid = _protector.Unprotect(id);
            if (cid == null)
            {
                return NotFound();
            }
            AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Idd == Convert.ToInt32(cid) /*&& x.year == "2022"*/).FirstOrDefault();
            EvalDetail evalDetail = _context.EvalDetailss.Where(x => x.CourcesIdoffered == Convert.ToInt32(cid) /*&& x.year == "2022"*/).FirstOrDefault();
            Cemp fapproval = _context.Cemps.Where(x => x.Cempid == evalDetail.OfferedRequestTo /*&& x.year == "2022"*/).FirstOrDefault();
            Cemp sapproval = _context.Cemps.Where(x => x.Cempid == evalDetail.OfferedRequestTo2 /*&& x.year == "2022"*/).FirstOrDefault();

            //HttpContext.Session.SetString("AEvaluationEmpidd", Convert.ToString(AEvaluationEmpemp.Idd));

            //if (id == null)
            //{
            //    return NotFound();
            //}
            var vAEvaluationEmps1 = _context.AEvaluationEmps.Where(d => d.Idd == AEvaluationEmpemp.Idd).FirstOrDefault();
            //var  vAEvaluationGoals1 = _context.AEvaluationGoals.Where(d => d.CovenantId == id).OrderBy(d => d.CovenantGoalsSeq).FirstOrDefault();
            List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
            av1 = vAEvaluationGoals[0];
            av2 = vAEvaluationGoals[1];
            av3 = vAEvaluationGoals[2];
            av4 = vAEvaluationGoals[3];
            if (vAEvaluationGoals.Count > 4)
            {
                av5 = vAEvaluationGoals[4];

            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6 = vAEvaluationGoals[5];
            }
            List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            am1 = vAEvaluationCompetenciesMs[0];
            am2 = vAEvaluationCompetenciesMs[1];
            am3 = vAEvaluationCompetenciesMs[2];
            am4 = vAEvaluationCompetenciesMs[3];
            am5 = vAEvaluationCompetenciesMs[4];
            am6 = vAEvaluationCompetenciesMs[5];
            if (vAEvaluationCompetenciesMs.Count > 6)
            {

                am7 = vAEvaluationCompetenciesMs[6];
            }

            List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            ad1 = vAEvaluationCompetenciesDs[0];
            ad2 = vAEvaluationCompetenciesDs[1];
            ad3 = vAEvaluationCompetenciesDs[2];
            ad4 = vAEvaluationCompetenciesDs[3];
            ad5 = vAEvaluationCompetenciesDs[4];
            ad6 = vAEvaluationCompetenciesDs[5];
            ad7 = vAEvaluationCompetenciesDs[6];
            ad8 = vAEvaluationCompetenciesDs[7];
            ad9 = vAEvaluationCompetenciesDs[8];
            ad10 = vAEvaluationCompetenciesDs[9];
            ad11 = vAEvaluationCompetenciesDs[10];
            ad12 = vAEvaluationCompetenciesDs[11];
            ad13 = vAEvaluationCompetenciesDs[12];
            ad14 = vAEvaluationCompetenciesDs[13];
            ad15 = vAEvaluationCompetenciesDs[14];
            ad16 = vAEvaluationCompetenciesDs[15];
            ad17 = vAEvaluationCompetenciesDs[16];
            ad18 = vAEvaluationCompetenciesDs[17];
            if (vAEvaluationCompetenciesDs.Count > 18)
            {

                ad19 = vAEvaluationCompetenciesDs[18];
                ad20 = vAEvaluationCompetenciesDs[19];
                ad21 = vAEvaluationCompetenciesDs[20];
                ad22 = vAEvaluationCompetenciesDs[21];
                ad23 = vAEvaluationCompetenciesDs[22];
            }
            if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,
                    FIRSTAPPROVAL= fapproval.CEMPNAME,
                    SECONDAPPROVAL = sapproval.CEMPNAME,
                    SECONDAPPROVALID= sapproval.Cempid,




                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    FIRSTAPPROVAL = fapproval.CEMPNAME,
                    SECONDAPPROVAL = sapproval.CEMPNAME,
                    SECONDAPPROVALID = sapproval.Cempid,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    FIRSTAPPROVAL = fapproval.CEMPNAME,
                    SECONDAPPROVAL = sapproval.CEMPNAME,
                    SECONDAPPROVALID = sapproval.Cempid,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    FIRSTAPPROVAL = fapproval.CEMPNAME,
                    SECONDAPPROVAL = sapproval.CEMPNAME,
                    SECONDAPPROVALID = sapproval.Cempid,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    FIRSTAPPROVAL = fapproval.CEMPNAME,
                    SECONDAPPROVAL = sapproval.CEMPNAME,
                    SECONDAPPROVALID = sapproval.Cempid,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,
                    FIRSTAPPROVAL = fapproval.CEMPNAME,
                    SECONDAPPROVAL = sapproval.CEMPNAME,
                    SECONDAPPROVALID = sapproval.Cempid,



                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    FIRSTAPPROVAL = fapproval.CEMPNAME,
                    SECONDAPPROVAL = sapproval.CEMPNAME,

                    SECONDAPPROVALID = sapproval.Cempid,

                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    FIRSTAPPROVAL = fapproval.CEMPNAME,
                    SECONDAPPROVAL = sapproval.CEMPNAME,
                    SECONDAPPROVALID = sapproval.Cempid,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    FIRSTAPPROVAL = fapproval.CEMPNAME,
                    SECONDAPPROVAL = sapproval.CEMPNAME,
                    SECONDAPPROVALID = sapproval.Cempid,


                };
                return View(ViewModelEvalwithother1);
            }


            return View();
            //return View(ViewModelEvalwithother1);
        }
        //
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public ActionResult Detail1(int? id)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");

            if (id == null)
            {
                return NotFound();
            }
            var vAEvaluationEmps1 = _context.AEvaluationEmps.Where(d => d.Idd == id).FirstOrDefault();
            //var  vAEvaluationGoals1 = _context.AEvaluationGoals.Where(d => d.CovenantId == id).OrderBy(d => d.CovenantGoalsSeq).FirstOrDefault();
            List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == id).OrderBy(d => d.CovenantGoalsSeq).ToList();
            av1 = vAEvaluationGoals[0];
            av2 = vAEvaluationGoals[1];
            av3 = vAEvaluationGoals[2];
            av4 = vAEvaluationGoals[3];
            if (vAEvaluationGoals.Count > 4)
            {
                av5 = vAEvaluationGoals[4];

            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6 = vAEvaluationGoals[5];
            }
            List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == id).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            am1 = vAEvaluationCompetenciesMs[0];
            am2 = vAEvaluationCompetenciesMs[1];
            am3 = vAEvaluationCompetenciesMs[2];
            am4 = vAEvaluationCompetenciesMs[3];
            am5 = vAEvaluationCompetenciesMs[4];
            am6 = vAEvaluationCompetenciesMs[5];
            if (vAEvaluationCompetenciesMs.Count > 6)
            {

                am7 = vAEvaluationCompetenciesMs[6];
            }

            List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == id).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            ad1 = vAEvaluationCompetenciesDs[0];
            ad2 = vAEvaluationCompetenciesDs[1];
            ad3 = vAEvaluationCompetenciesDs[2];
            ad4 = vAEvaluationCompetenciesDs[3];
            ad5 = vAEvaluationCompetenciesDs[4];
            ad6 = vAEvaluationCompetenciesDs[5];
            ad7 = vAEvaluationCompetenciesDs[6];
            ad8 = vAEvaluationCompetenciesDs[7];
            ad9 = vAEvaluationCompetenciesDs[8];
            ad10 = vAEvaluationCompetenciesDs[9];
            ad11 = vAEvaluationCompetenciesDs[10];
            ad12 = vAEvaluationCompetenciesDs[11];
            ad13 = vAEvaluationCompetenciesDs[12];
            ad14 = vAEvaluationCompetenciesDs[13];
            ad15 = vAEvaluationCompetenciesDs[14];
            ad16 = vAEvaluationCompetenciesDs[15];
            ad17 = vAEvaluationCompetenciesDs[16];
            ad18 = vAEvaluationCompetenciesDs[17];
            if (vAEvaluationCompetenciesDs.Count > 18)
            {

                ad19 = vAEvaluationCompetenciesDs[18];
                ad20 = vAEvaluationCompetenciesDs[19];
                ad21 = vAEvaluationCompetenciesDs[20];
                ad22 = vAEvaluationCompetenciesDs[21];
                ad23 = vAEvaluationCompetenciesDs[22];
            }
            if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }


            return View();
            //return View(ViewModelEvalwithother1);
        }


       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public ActionResult Detail11(/*int? id*/)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");

            //if (id == null)
            //{
            //    return NotFound();
            //}
            AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Empno == Convert.ToInt32(HttpContext.Session.GetString("username")) && x.year == "2021").FirstOrDefault();
            //HttpContext.Session.SetString("AEvaluationEmpidd", Convert.ToString(AEvaluationEmpemp.Idd));

            //if (id == null)
            //{
            //    return NotFound();
            //}
            var vAEvaluationEmps1 = _context.AEvaluationEmps.Where(d => d.Idd == AEvaluationEmpemp.Idd).FirstOrDefault();
            List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
            av1 = vAEvaluationGoals[0];
            av2 = vAEvaluationGoals[1];
            av3 = vAEvaluationGoals[2];
            av4 = vAEvaluationGoals[3];
            if (vAEvaluationGoals.Count > 4)
            {
                av5 = vAEvaluationGoals[4];

            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6 = vAEvaluationGoals[5];
            }
            List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            am1 = vAEvaluationCompetenciesMs[0];
            am2 = vAEvaluationCompetenciesMs[1];
            am3 = vAEvaluationCompetenciesMs[2];
            am4 = vAEvaluationCompetenciesMs[3];
            am5 = vAEvaluationCompetenciesMs[4];
            am6 = vAEvaluationCompetenciesMs[5];
            if (vAEvaluationCompetenciesMs.Count > 6)
            {

                am7 = vAEvaluationCompetenciesMs[6];
            }

            List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            ad1 = vAEvaluationCompetenciesDs[0];
            ad2 = vAEvaluationCompetenciesDs[1];
            ad3 = vAEvaluationCompetenciesDs[2];
            ad4 = vAEvaluationCompetenciesDs[3];
            ad5 = vAEvaluationCompetenciesDs[4];
            ad6 = vAEvaluationCompetenciesDs[5];
            ad7 = vAEvaluationCompetenciesDs[6];
            ad8 = vAEvaluationCompetenciesDs[7];
            ad9 = vAEvaluationCompetenciesDs[8];
            ad10 = vAEvaluationCompetenciesDs[9];
            ad11 = vAEvaluationCompetenciesDs[10];
            ad12 = vAEvaluationCompetenciesDs[11];
            ad13 = vAEvaluationCompetenciesDs[12];
            ad14 = vAEvaluationCompetenciesDs[13];
            ad15 = vAEvaluationCompetenciesDs[14];
            ad16 = vAEvaluationCompetenciesDs[15];
            ad17 = vAEvaluationCompetenciesDs[16];
            ad18 = vAEvaluationCompetenciesDs[17];
            if (vAEvaluationCompetenciesDs.Count > 18)
            {

                ad19 = vAEvaluationCompetenciesDs[18];
                ad20 = vAEvaluationCompetenciesDs[19];
                ad21 = vAEvaluationCompetenciesDs[20];
                ad22 = vAEvaluationCompetenciesDs[21];
                ad23 = vAEvaluationCompetenciesDs[22];
            }
            if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput
                    /*AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput*/,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }


            return View();
            //return View(ViewModelEvalwithother1);
        }

       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public ActionResult Detail111(/*int? id*/)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");

            //if (id == null)
            //{
            //    return NotFound();
            //}
            AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Empno == Convert.ToInt32(HttpContext.Session.GetString("username")) && x.year == "2021").FirstOrDefault();
            //HttpContext.Session.SetString("AEvaluationEmpidd", Convert.ToString(AEvaluationEmpemp.Idd));

            //if (id == null)
            //{
            //    return NotFound();
            //}
            var vAEvaluationEmps1 = _context.AEvaluationEmps.Where(d => d.Idd == AEvaluationEmpemp.Idd).FirstOrDefault();
            List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
            av1 = vAEvaluationGoals[0];
            av2 = vAEvaluationGoals[1];
            av3 = vAEvaluationGoals[2];
            av4 = vAEvaluationGoals[3];
            if (vAEvaluationGoals.Count > 4)
            {
                av5 = vAEvaluationGoals[4];

            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6 = vAEvaluationGoals[5];
            }
            List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            am1 = vAEvaluationCompetenciesMs[0];
            am2 = vAEvaluationCompetenciesMs[1];
            am3 = vAEvaluationCompetenciesMs[2];
            am4 = vAEvaluationCompetenciesMs[3];
            am5 = vAEvaluationCompetenciesMs[4];
            am6 = vAEvaluationCompetenciesMs[5];
            if (vAEvaluationCompetenciesMs.Count > 6)
            {

                am7 = vAEvaluationCompetenciesMs[6];
            }

            List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            ad1 = vAEvaluationCompetenciesDs[0];
            ad2 = vAEvaluationCompetenciesDs[1];
            ad3 = vAEvaluationCompetenciesDs[2];
            ad4 = vAEvaluationCompetenciesDs[3];
            ad5 = vAEvaluationCompetenciesDs[4];
            ad6 = vAEvaluationCompetenciesDs[5];
            ad7 = vAEvaluationCompetenciesDs[6];
            ad8 = vAEvaluationCompetenciesDs[7];
            ad9 = vAEvaluationCompetenciesDs[8];
            ad10 = vAEvaluationCompetenciesDs[9];
            ad11 = vAEvaluationCompetenciesDs[10];
            ad12 = vAEvaluationCompetenciesDs[11];
            ad13 = vAEvaluationCompetenciesDs[12];
            ad14 = vAEvaluationCompetenciesDs[13];
            ad15 = vAEvaluationCompetenciesDs[14];
            ad16 = vAEvaluationCompetenciesDs[15];
            ad17 = vAEvaluationCompetenciesDs[16];
            ad18 = vAEvaluationCompetenciesDs[17];
            if (vAEvaluationCompetenciesDs.Count > 18)
            {

                ad19 = vAEvaluationCompetenciesDs[18];
                ad20 = vAEvaluationCompetenciesDs[19];
                ad21 = vAEvaluationCompetenciesDs[20];
                ad22 = vAEvaluationCompetenciesDs[21];
                ad23 = vAEvaluationCompetenciesDs[22];
            }
            if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria
                    /*AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria*/,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                   
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,
                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //



                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //



                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //



                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //



                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,


                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,


                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,
                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,
                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //





                };
                return View(ViewModelEvalwithother1);
            }


            return View();
            //return View(ViewModelEvalwithother1);
        }

       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public ActionResult Detail1111(/*int? id*/)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");

            //if (id == null)
            //{
            //    return NotFound();
            //}
            AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Empno == Convert.ToInt32(HttpContext.Session.GetString("username")) && x.year == "2022").FirstOrDefault();
            //HttpContext.Session.SetString("AEvaluationEmpidd", Convert.ToString(AEvaluationEmpemp.Idd));

            //if (id == null)
            //{
            //    return NotFound();
            //}
            var vAEvaluationEmps1 = _context.AEvaluationEmps.Where(d => d.Idd == AEvaluationEmpemp.Idd).FirstOrDefault();
            List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
            av1 = vAEvaluationGoals[0];
            av2 = vAEvaluationGoals[1];
            av3 = vAEvaluationGoals[2];
            av4 = vAEvaluationGoals[3];
            if (vAEvaluationGoals.Count > 4)
            {
                av5 = vAEvaluationGoals[4];

            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6 = vAEvaluationGoals[5];
            }
            List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            am1 = vAEvaluationCompetenciesMs[0];
            am2 = vAEvaluationCompetenciesMs[1];
            am3 = vAEvaluationCompetenciesMs[2];
            am4 = vAEvaluationCompetenciesMs[3];
            am5 = vAEvaluationCompetenciesMs[4];
            am6 = vAEvaluationCompetenciesMs[5];
            if (vAEvaluationCompetenciesMs.Count > 6)
            {

                am7 = vAEvaluationCompetenciesMs[6];
            }

            List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            ad1 = vAEvaluationCompetenciesDs[0];
            ad2 = vAEvaluationCompetenciesDs[1];
            ad3 = vAEvaluationCompetenciesDs[2];
            ad4 = vAEvaluationCompetenciesDs[3];
            ad5 = vAEvaluationCompetenciesDs[4];
            ad6 = vAEvaluationCompetenciesDs[5];
            ad7 = vAEvaluationCompetenciesDs[6];
            ad8 = vAEvaluationCompetenciesDs[7];
            ad9 = vAEvaluationCompetenciesDs[8];
            ad10 = vAEvaluationCompetenciesDs[9];
            ad11 = vAEvaluationCompetenciesDs[10];
            ad12 = vAEvaluationCompetenciesDs[11];
            ad13 = vAEvaluationCompetenciesDs[12];
            ad14 = vAEvaluationCompetenciesDs[13];
            ad15 = vAEvaluationCompetenciesDs[14];
            ad16 = vAEvaluationCompetenciesDs[15];
            ad17 = vAEvaluationCompetenciesDs[16];
            ad18 = vAEvaluationCompetenciesDs[17];
            if (vAEvaluationCompetenciesDs.Count > 18)
            {

                ad19 = vAEvaluationCompetenciesDs[18];
                ad20 = vAEvaluationCompetenciesDs[19];
                ad21 = vAEvaluationCompetenciesDs[20];
                ad22 = vAEvaluationCompetenciesDs[21];
                ad23 = vAEvaluationCompetenciesDs[22];
            }
            if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,
                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq= vAEvaluationEmps1.comment1,

                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad23.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5   && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي",


                    commentforreq2= ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "" : "" + vAEvaluationEmps1.comment2,
                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult/100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult/100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult/100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult/100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult/100,
                    AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult6 = av6.EvaluationResult/100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal/100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,

                    commentforreq = vAEvaluationEmps1.comment1,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad23.EvaluationTotal/100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30),2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "" : "" + vAEvaluationEmps1.comment2,

                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,

                    commentforreq = vAEvaluationEmps1.comment1,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,

                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,

                    commentforreq = vAEvaluationEmps1.comment1,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,

                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal/100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,

                    commentforreq = vAEvaluationEmps1.comment1,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal/100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",


                    commentforreq2= ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" : "" + vAEvaluationEmps1.comment2,
                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal/100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,


                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,

                    commentforreq = vAEvaluationEmps1.comment1,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad23.EvaluationTotal/100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "" : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal/100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,


                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //

                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,

                    commentforreq = vAEvaluationEmps1.comment1,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal/100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,
                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal/100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,
                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //


                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,

                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal/100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",


                    commentforreq2= ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" : "" + vAEvaluationEmps1.comment2,
                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal/100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,
                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,

                    commentforreq = vAEvaluationEmps1.comment1,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal/100,
                    //

                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 0 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" : "" + vAEvaluationEmps1.comment2,

                };
                return View(ViewModelEvalwithother1);
            }


            return View();
            //return View(ViewModelEvalwithother1);
        }

       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public ActionResult Detail11111(string id)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");

            String cid = _protector.Unprotect(id);
            if (cid == null)
            {
                return NotFound();
            }
            //if (id == null)
            //{
            //    return NotFound();
            //}
<<<<<<< HEAD
            AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Idd == Convert.ToInt32(cid) /*&& x.year == "2022"*/).FirstOrDefault();
=======
            AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Idd == Convert.ToInt32(cid) && x.year == "2022").FirstOrDefault();
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
            //HttpContext.Session.SetString("AEvaluationEmpidd", Convert.ToString(AEvaluationEmpemp.Idd));

            //if (id == null)
            //{
            //    return NotFound();
            //}
            var vAEvaluationEmps1 = _context.AEvaluationEmps.Where(d => d.Idd == AEvaluationEmpemp.Idd).FirstOrDefault();
            List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
            av1 = vAEvaluationGoals[0];
            av2 = vAEvaluationGoals[1];
            av3 = vAEvaluationGoals[2];
            av4 = vAEvaluationGoals[3];
            if (vAEvaluationGoals.Count > 4)
            {
                av5 = vAEvaluationGoals[4];

            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6 = vAEvaluationGoals[5];
            }
            List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            am1 = vAEvaluationCompetenciesMs[0];
            am2 = vAEvaluationCompetenciesMs[1];
            am3 = vAEvaluationCompetenciesMs[2];
            am4 = vAEvaluationCompetenciesMs[3];
            am5 = vAEvaluationCompetenciesMs[4];
            am6 = vAEvaluationCompetenciesMs[5];
            if (vAEvaluationCompetenciesMs.Count > 6)
            {

                am7 = vAEvaluationCompetenciesMs[6];
            }

            List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            ad1 = vAEvaluationCompetenciesDs[0];
            ad2 = vAEvaluationCompetenciesDs[1];
            ad3 = vAEvaluationCompetenciesDs[2];
            ad4 = vAEvaluationCompetenciesDs[3];
            ad5 = vAEvaluationCompetenciesDs[4];
            ad6 = vAEvaluationCompetenciesDs[5];
            ad7 = vAEvaluationCompetenciesDs[6];
            ad8 = vAEvaluationCompetenciesDs[7];
            ad9 = vAEvaluationCompetenciesDs[8];
            ad10 = vAEvaluationCompetenciesDs[9];
            ad11 = vAEvaluationCompetenciesDs[10];
            ad12 = vAEvaluationCompetenciesDs[11];
            ad13 = vAEvaluationCompetenciesDs[12];
            ad14 = vAEvaluationCompetenciesDs[13];
            ad15 = vAEvaluationCompetenciesDs[14];
            ad16 = vAEvaluationCompetenciesDs[15];
            ad17 = vAEvaluationCompetenciesDs[16];
            ad18 = vAEvaluationCompetenciesDs[17];
            if (vAEvaluationCompetenciesDs.Count > 18)
            {

                ad19 = vAEvaluationCompetenciesDs[18];
                ad20 = vAEvaluationCompetenciesDs[19];
                ad21 = vAEvaluationCompetenciesDs[20];
                ad22 = vAEvaluationCompetenciesDs[21];
                ad23 = vAEvaluationCompetenciesDs[22];
            }
            if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,
                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,

                    commentforreq= vAEvaluationEmps1.comment1,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad23.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان."+ vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,

                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,

                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad23.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,

                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,

                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,

                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",
                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,

                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,


                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,

                    commentforreq = vAEvaluationEmps1.comment1,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad23.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,


                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //

                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,

                    commentforreq = vAEvaluationEmps1.comment1,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,

                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,
                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //


                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,

                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,
                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,
                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,

                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //

                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }


            return View();
            //return View(ViewModelEvalwithother1);
        }

       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public ActionResult Detail1111111(string id)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");

            String cid = _protector.Unprotect(id);
            if (cid == null)
            {
                return NotFound();
            }
            //if (id == null)
            //{
            //    return NotFound();
            //}
            AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Idd == Convert.ToInt32(cid) && x.year == "2022").FirstOrDefault();
            //HttpContext.Session.SetString("AEvaluationEmpidd", Convert.ToString(AEvaluationEmpemp.Idd));

            //if (id == null)
            //{
            //    return NotFound();
            //}
            var vAEvaluationEmps1 = _context.AEvaluationEmps.Where(d => d.Idd == AEvaluationEmpemp.Idd).FirstOrDefault();
            List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
            av1 = vAEvaluationGoals[0];
            av2 = vAEvaluationGoals[1];
            av3 = vAEvaluationGoals[2];
            av4 = vAEvaluationGoals[3];
            if (vAEvaluationGoals.Count > 4)
            {
                av5 = vAEvaluationGoals[4];

            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6 = vAEvaluationGoals[5];
            }
            List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            am1 = vAEvaluationCompetenciesMs[0];
            am2 = vAEvaluationCompetenciesMs[1];
            am3 = vAEvaluationCompetenciesMs[2];
            am4 = vAEvaluationCompetenciesMs[3];
            am5 = vAEvaluationCompetenciesMs[4];
            am6 = vAEvaluationCompetenciesMs[5];
            if (vAEvaluationCompetenciesMs.Count > 6)
            {

                am7 = vAEvaluationCompetenciesMs[6];
            }

            List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            ad1 = vAEvaluationCompetenciesDs[0];
            ad2 = vAEvaluationCompetenciesDs[1];
            ad3 = vAEvaluationCompetenciesDs[2];
            ad4 = vAEvaluationCompetenciesDs[3];
            ad5 = vAEvaluationCompetenciesDs[4];
            ad6 = vAEvaluationCompetenciesDs[5];
            ad7 = vAEvaluationCompetenciesDs[6];
            ad8 = vAEvaluationCompetenciesDs[7];
            ad9 = vAEvaluationCompetenciesDs[8];
            ad10 = vAEvaluationCompetenciesDs[9];
            ad11 = vAEvaluationCompetenciesDs[10];
            ad12 = vAEvaluationCompetenciesDs[11];
            ad13 = vAEvaluationCompetenciesDs[12];
            ad14 = vAEvaluationCompetenciesDs[13];
            ad15 = vAEvaluationCompetenciesDs[14];
            ad16 = vAEvaluationCompetenciesDs[15];
            ad17 = vAEvaluationCompetenciesDs[16];
            ad18 = vAEvaluationCompetenciesDs[17];
            if (vAEvaluationCompetenciesDs.Count > 18)
            {

                ad19 = vAEvaluationCompetenciesDs[18];
                ad20 = vAEvaluationCompetenciesDs[19];
                ad21 = vAEvaluationCompetenciesDs[20];
                ad22 = vAEvaluationCompetenciesDs[21];
                ad23 = vAEvaluationCompetenciesDs[22];
            }
            if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,
                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,

                    commentforreq = vAEvaluationEmps1.comment1,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad23.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,

                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,

                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad23.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,

                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,

                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,

                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",
                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,

                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,


                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,

                    commentforreq = vAEvaluationEmps1.comment1,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad23.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,


                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //

                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,

                    commentforreq = vAEvaluationEmps1.comment1,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,

                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,
                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //


                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,

                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,
                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,
                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,

                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //

                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }


            return View();
            //return View(ViewModelEvalwithother1);
        }
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public ActionResult Detail111111(string id)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");

            String cid = _protector.Unprotect(id);
            if (cid == null)
            {
                return NotFound();
            }
            //if (id == null)
            //{
            //    return NotFound();
            //}
<<<<<<< HEAD
            AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Idd == Convert.ToInt32(cid)/* && x.year == "2021"*/).FirstOrDefault();
=======
            AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Idd == Convert.ToInt32(cid) && x.year == "2021").FirstOrDefault();
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
            //HttpContext.Session.SetString("AEvaluationEmpidd", Convert.ToString(AEvaluationEmpemp.Idd));

            //if (id == null)
            //{
            //    return NotFound();
            //}
            var vAEvaluationEmps1 = _context.AEvaluationEmps.Where(d => d.Idd == AEvaluationEmpemp.Idd).FirstOrDefault();
            List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
            av1 = vAEvaluationGoals[0];
            av2 = vAEvaluationGoals[1];
            av3 = vAEvaluationGoals[2];
            av4 = vAEvaluationGoals[3];
            if (vAEvaluationGoals.Count > 4)
            {
                av5 = vAEvaluationGoals[4];

            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6 = vAEvaluationGoals[5];
            }
            List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            am1 = vAEvaluationCompetenciesMs[0];
            am2 = vAEvaluationCompetenciesMs[1];
            am3 = vAEvaluationCompetenciesMs[2];
            am4 = vAEvaluationCompetenciesMs[3];
            am5 = vAEvaluationCompetenciesMs[4];
            am6 = vAEvaluationCompetenciesMs[5];
            if (vAEvaluationCompetenciesMs.Count > 6)
            {

                am7 = vAEvaluationCompetenciesMs[6];
            }

            List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            ad1 = vAEvaluationCompetenciesDs[0];
            ad2 = vAEvaluationCompetenciesDs[1];
            ad3 = vAEvaluationCompetenciesDs[2];
            ad4 = vAEvaluationCompetenciesDs[3];
            ad5 = vAEvaluationCompetenciesDs[4];
            ad6 = vAEvaluationCompetenciesDs[5];
            ad7 = vAEvaluationCompetenciesDs[6];
            ad8 = vAEvaluationCompetenciesDs[7];
            ad9 = vAEvaluationCompetenciesDs[8];
            ad10 = vAEvaluationCompetenciesDs[9];
            ad11 = vAEvaluationCompetenciesDs[10];
            ad12 = vAEvaluationCompetenciesDs[11];
            ad13 = vAEvaluationCompetenciesDs[12];
            ad14 = vAEvaluationCompetenciesDs[13];
            ad15 = vAEvaluationCompetenciesDs[14];
            ad16 = vAEvaluationCompetenciesDs[15];
            ad17 = vAEvaluationCompetenciesDs[16];
            ad18 = vAEvaluationCompetenciesDs[17];
            if (vAEvaluationCompetenciesDs.Count > 18)
            {

                ad19 = vAEvaluationCompetenciesDs[18];
                ad20 = vAEvaluationCompetenciesDs[19];
                ad21 = vAEvaluationCompetenciesDs[20];
                ad22 = vAEvaluationCompetenciesDs[21];
                ad23 = vAEvaluationCompetenciesDs[22];
            }
            if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,
                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,

                    commentforreq = vAEvaluationEmps1.comment1,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad23.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,

                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,

                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad23.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,

                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,

                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,

                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",
                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,

                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,


                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,

                    commentforreq = vAEvaluationEmps1.comment1,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad23.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,


                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //

                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,

                    commentforreq = vAEvaluationEmps1.comment1,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,

                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,
                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //


                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,

                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,
                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,
                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,

                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //

                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }


            return View();
            //return View(ViewModelEvalwithother1);
        }
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        [MiddlewareFilter(typeof(JsReportPipeline))]
        public ActionResult Detail111111p(string id)
        {
            HttpContext.JsReportFeature().Recipe(Recipe.ChromePdf);
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");

            String cid = _protector.Unprotect(id);
            if (cid == null)
            {
                return NotFound();
            }
            //if (id == null)
            //{
            //    return NotFound();
            //}
            AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Idd == Convert.ToInt32(cid) /*&& x.year == "2021"*/).FirstOrDefault();
            EvalDetail evalDetail = _context.EvalDetailss.Where(x => x.CourcesIdoffered == Convert.ToInt32(cid) /*&& x.year == "2022"*/).FirstOrDefault();
            Cemp fapproval = _context.Cemps.Where(x => x.Cempid == evalDetail.OfferedRequestTo /*&& x.year == "2022"*/).FirstOrDefault();
            Cemp sapproval = _context.Cemps.Where(x => x.Cempid == evalDetail.OfferedRequestTo2 /*&& x.year == "2022"*/).FirstOrDefault();
            //HttpContext.Session.SetString("AEvaluationEmpidd", Convert.ToString(AEvaluationEmpemp.Idd));

            //if (id == null)
            //{
            //    return NotFound();
            //}
            var vAEvaluationEmps1 = _context.AEvaluationEmps.Where(d => d.Idd == AEvaluationEmpemp.Idd).FirstOrDefault();
            List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
            av1 = vAEvaluationGoals[0];
            av2 = vAEvaluationGoals[1];
            av3 = vAEvaluationGoals[2];
            av4 = vAEvaluationGoals[3];
            if (vAEvaluationGoals.Count > 4)
            {
                av5 = vAEvaluationGoals[4];

            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6 = vAEvaluationGoals[5];
            }
            List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            am1 = vAEvaluationCompetenciesMs[0];
            am2 = vAEvaluationCompetenciesMs[1];
            am3 = vAEvaluationCompetenciesMs[2];
            am4 = vAEvaluationCompetenciesMs[3];
            am5 = vAEvaluationCompetenciesMs[4];
            am6 = vAEvaluationCompetenciesMs[5];
            if (vAEvaluationCompetenciesMs.Count > 6)
            {

                am7 = vAEvaluationCompetenciesMs[6];
            }

            List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            ad1 = vAEvaluationCompetenciesDs[0];
            ad2 = vAEvaluationCompetenciesDs[1];
            ad3 = vAEvaluationCompetenciesDs[2];
            ad4 = vAEvaluationCompetenciesDs[3];
            ad5 = vAEvaluationCompetenciesDs[4];
            ad6 = vAEvaluationCompetenciesDs[5];
            ad7 = vAEvaluationCompetenciesDs[6];
            ad8 = vAEvaluationCompetenciesDs[7];
            ad9 = vAEvaluationCompetenciesDs[8];
            ad10 = vAEvaluationCompetenciesDs[9];
            ad11 = vAEvaluationCompetenciesDs[10];
            ad12 = vAEvaluationCompetenciesDs[11];
            ad13 = vAEvaluationCompetenciesDs[12];
            ad14 = vAEvaluationCompetenciesDs[13];
            ad15 = vAEvaluationCompetenciesDs[14];
            ad16 = vAEvaluationCompetenciesDs[15];
            ad17 = vAEvaluationCompetenciesDs[16];
            ad18 = vAEvaluationCompetenciesDs[17];
            if (vAEvaluationCompetenciesDs.Count > 18)
            {

                ad19 = vAEvaluationCompetenciesDs[18];
                ad20 = vAEvaluationCompetenciesDs[19];
                ad21 = vAEvaluationCompetenciesDs[20];
                ad22 = vAEvaluationCompetenciesDs[21];
                ad23 = vAEvaluationCompetenciesDs[22];
            }
            if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,
                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    FIRSTAPPROVAL = fapproval.CEMPNAME,
                    SECONDAPPROVAL = sapproval.CEMPNAME,
                    SECONDAPPROVALID = sapproval.Cempid,

                    commentforreq = vAEvaluationEmps1.comment1,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad23.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,

                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,
                    FIRSTAPPROVAL = fapproval.CEMPNAME,
                    SECONDAPPROVAL = sapproval.CEMPNAME,
                    SECONDAPPROVALID = sapproval.Cempid,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad23.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,
                    FIRSTAPPROVAL = fapproval.CEMPNAME,
                    SECONDAPPROVAL = sapproval.CEMPNAME,
                    SECONDAPPROVALID = sapproval.Cempid,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,
                    FIRSTAPPROVAL = fapproval.CEMPNAME,
                    SECONDAPPROVAL = sapproval.CEMPNAME,
                    SECONDAPPROVALID = sapproval.Cempid,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,

                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,
                    FIRSTAPPROVAL = fapproval.CEMPNAME,
                    SECONDAPPROVAL = sapproval.CEMPNAME,
                    SECONDAPPROVALID = sapproval.Cempid,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",
                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,

                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,


                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.EvaluationOutputCompetency,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    FIRSTAPPROVAL = fapproval.CEMPNAME,
                    SECONDAPPROVAL = sapproval.CEMPNAME,
                    SECONDAPPROVALID = sapproval.Cempid,
                    commentforreq = vAEvaluationEmps1.comment1,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad23.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .70 + (ad23.EvaluationTotal / 100) * .30), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 3.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 2.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) >= 1.5 && ((av1.EvaluationTotal / 100) * .70) + ((ad23.EvaluationTotal / 100) * .30) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,


                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //

                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    FIRSTAPPROVAL = fapproval.CEMPNAME,
                    SECONDAPPROVAL = sapproval.CEMPNAME,
                    SECONDAPPROVALID = sapproval.Cempid,
                    commentforreq = vAEvaluationEmps1.comment1,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,

                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    //AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    //AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,
                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    //AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //


                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,
                    FIRSTAPPROVAL = fapproval.CEMPNAME,
                    SECONDAPPROVAL = sapproval.CEMPNAME,
                    SECONDAPPROVALID = sapproval.Cempid,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //
                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,
                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    //
                    AEvaluationGoalEvaluationEquilibrium = av1.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult = av1.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium2 = av2.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult2 = av2.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium3 = av3.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult3 = av3.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium4 = av4.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult4 = av4.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium5 = av5.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult5 = av5.EvaluationResult / 100,
                    AEvaluationGoalEvaluationEquilibrium6 = av6.EvaluationEquilibrium,
                    AEvaluationGoalEvaluationResult6 = av6.EvaluationResult / 100,
                    //
                    AEvaluationGoalEvaluationTotal = av1.EvaluationTotal / 100,
                    //
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,
                    //
                    AEvaluationGoalEvaluationActualOutput = av1.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput2 = av2.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput3 = av3.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput4 = av4.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput5 = av5.EvaluationActualOutput,
                    AEvaluationGoalEvaluationActualOutput6 = av6.EvaluationActualOutput,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel01 = ad1.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel02 = ad2.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel03 = ad3.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel04 = ad4.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel05 = ad5.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel06 = ad6.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel07 = ad7.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel08 = ad8.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel09 = ad9.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel010 = ad10.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel011 = ad11.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel012 = ad12.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel013 = ad13.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel014 = ad14.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel015 = ad15.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel016 = ad16.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel017 = ad17.EvaluationOutputCompetency,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel018 = ad18.EvaluationOutputCompetency,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel019 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel020 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel021 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel022 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel023 = ad23.CovenantCompetenciecDLevel,
                    //
                    //
                    AEvaluationCompetenciesDEvaluationResults = ad1.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults2 = ad1.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults12 = ad2.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults22 = ad2.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults13 = ad3.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults23 = ad3.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults14 = ad4.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults24 = ad4.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults15 = ad5.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults25 = ad5.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults16 = ad6.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults26 = ad6.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults17 = ad7.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults27 = ad7.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults18 = ad8.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults28 = ad8.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults19 = ad9.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults29 = ad9.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults110 = ad10.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults210 = ad10.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults111 = ad11.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults211 = ad11.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults112 = ad12.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults212 = ad12.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults113 = ad13.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults213 = ad13.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults114 = ad14.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults214 = ad14.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults115 = ad15.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults215 = ad15.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults116 = ad16.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults216 = ad16.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults117 = ad17.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults217 = ad17.EvaluationResults2 / 100,
                    AEvaluationCompetenciesDEvaluationResults118 = ad18.EvaluationResults,
                    AEvaluationCompetenciesDEvaluationResults218 = ad18.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults119 = ad19.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults219 = ad19.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults120 = ad20.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults220 = ad20.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults121 = ad21.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults221 = ad21.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults122 = ad22.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults222 = ad22.EvaluationResults2 / 100,
                    //AEvaluationCompetenciesDEvaluationResults123 = ad23.EvaluationResults,
                    //AEvaluationCompetenciesDEvaluationResults223 = ad23.EvaluationResults2 / 100,
                    commentforreq = vAEvaluationEmps1.comment1,
                    FIRSTAPPROVAL = fapproval.CEMPNAME,
                    SECONDAPPROVAL = sapproval.CEMPNAME,
                    SECONDAPPROVALID = sapproval.Cempid,
                    //
                    AEvaluationCompetenciesDEvaluationTotal = ad18.EvaluationTotal / 100,
                    //

                    // calculation 

                    AEvaluationCompetenciesDEvaluationTotal11 = (double?)Math.Round(Convert.ToDecimal((av1.EvaluationTotal / 100) * .50 + (ad18.EvaluationTotal / 100) * .50), 2),
                    AEvaluationCompetenciesDEvaluationTotal111 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "ممتاز" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "جيد جدا " :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "جيد" :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "مرضي " : "غير مرضي",

                    commentforreq2 = ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 4.5 ? "تشهد الأدارة بأن الموظف قد حقق الأهداف المطلوبة منه بكل جديه وإتقان." + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 3.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 4.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 2.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 3.5 ? "" + vAEvaluationEmps1.comment2 :
                    ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) >= 1.5 && ((av1.EvaluationTotal / 100) * .50) + ((ad18.EvaluationTotal / 100) * .50) < 2.5 ? "" + vAEvaluationEmps1.comment2 : "" + vAEvaluationEmps1.comment2,


                };
                return View(ViewModelEvalwithother1);
            }


            return View();
            //return View(ViewModelEvalwithother1);
        }
<<<<<<< HEAD
        [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public ActionResult Detail111111p0(string id)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");

            String cid = _protector.Unprotect(id);
            if (cid == null)
            {
                return NotFound();
            }
            //if (id == null)
            //{
            //    return NotFound();
            //}
            AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Idd == Convert.ToInt32(cid) /*&& x.year == "2021"*/).FirstOrDefault();
            var evalDetail2 = _context.EvalDetailss2.Where(x => x.CourcesIdoffered == Convert.ToInt32(cid) /*&& x.year == "2022"*/).FirstOrDefault();
            var evalDetail2t = _context.EvalRequestTypeIds2.Where(x => x.CourcesIdoffered == Convert.ToInt32(cid)).FirstOrDefault();
            evalDetail2.OfferedRequestTo3 = "0";
            evalDetail2.OfferedRequestTypeSatus = 0;
            evalDetail2t.OfferedRequestType = 0;
            _context.EvalDetailss2.Update(evalDetail2);
            _context.EvalRequestTypeIds2.Update(evalDetail2t);
            _context.SaveChanges();

            return RedirectToAction("approveduser111", "ViewModelEvalwithother1", new { area = "" });
            //return View();
            //return View(ViewModelEvalwithother1);
        }
        [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        public ActionResult Detail111111p00(string id)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");

            String cid = _protector.Unprotect(id);
            if (cid == null)
            {
                return NotFound();
            }
            //if (id == null)
            //{
            //    return NotFound();
            //}
            AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Idd == Convert.ToInt32(cid) /*&& x.year == "2021"*/).FirstOrDefault();
            var evalDetail1 = _context.EvalDetailss.Where(x => x.CourcesIdoffered == Convert.ToInt32(cid) /*&& x.year == "2022"*/).FirstOrDefault();
            var evalDetail1t = _context.EvalRequestTypeIds.Where(x => x.CourcesIdoffered == Convert.ToInt32(cid)).FirstOrDefault();
            evalDetail1.OfferedRequestTo3 = "0";
            evalDetail1.OfferedRequestTypeSatus = 0;
            evalDetail1t.OfferedRequestType = 0;
            _context.EvalDetailss.Update(evalDetail1);
            _context.EvalRequestTypeIds.Update(evalDetail1t);
            _context.SaveChanges();

            return RedirectToAction("approveduser1111", "ViewModelEvalwithother1", new { area = "" });
            //return View();
            //return View(ViewModelEvalwithother1);
        }

        [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
=======
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b

        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult editxt(ViewModelEvalwithother1 ViewModelEvalwithother1)
        {
            var empnoted = _context.AEvaluationEmps.Where(x => x.Idd == ViewModelEvalwithother1.AEvaluationEmpIdd).FirstOrDefault();

            empnoted.comment2 = ViewModelEvalwithother1.commentforreq2;
            _context.Update(empnoted);
            _context.SaveChanges();



            return RedirectToAction("IndexOffered4", "ViewModelEvalwithother1", new { area = "" });    //_context.Update(empnoted);


            //return RedirectToAction("MyInfo", "Cemps", new { area = "" });
        }
        //[Authorize(Roles = "Admin,Manager,User,HR-Admin")]
        //[HttpPost]
        //[ValidateAntiForgeryToken]
        public void editxt1(int? i,string q)
        {
            var empnoted = _context.AEvaluationEmps.Where(x => x.Idd == i).FirstOrDefault();

            empnoted.comment2 = q;
            _context.Update(empnoted);
            _context.SaveChanges();



            //return RedirectToAction("IndexOffered4", "ViewModelEvalwithother1", new { area = "" });    //_context.Update(empnoted);


            //return RedirectToAction("MyInfo", "Cemps", new { area = "" });
        }
       [Authorize(Roles = "Admin,Manager,User,HR-Admin,HR-Operation")]
        // get 
        public ActionResult Edit(string id )
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");
            String cid = _protector.Unprotect(id);
            if (cid == null)
            {
                return NotFound();
            }
            AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Idd == Convert.ToInt32(cid)).FirstOrDefault();
            //AEvaluationEmp AEvaluationEmpemp = _context.AEvaluationEmps.Where(x => x.Empno == Convert.ToInt32(HttpContext.Session.GetString("username")) && x.year == "2022").FirstOrDefault();
            //HttpContext.Session.SetString("AEvaluationEmpidd", Convert.ToString(AEvaluationEmpemp.Idd));

            //if (id == null)
            //{
            //    return NotFound();
            //}
            var vAEvaluationEmps1 = _context.AEvaluationEmps.Where(d=>d.Idd== AEvaluationEmpemp.Idd).FirstOrDefault();
            //var  vAEvaluationGoals1 = _context.AEvaluationGoals.Where(d => d.CovenantId == id).OrderBy(d => d.CovenantGoalsSeq).FirstOrDefault();
            List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d=>d.CovenantGoalsSeq).ToList();
            av1 = vAEvaluationGoals[0];
            av2 = vAEvaluationGoals[1];
            av3 = vAEvaluationGoals[2];
            av4 = vAEvaluationGoals[3];
            if (vAEvaluationGoals.Count > 4)
            {
                av5 = vAEvaluationGoals[4];

            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6 = vAEvaluationGoals[5];
            }
            List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            am1 = vAEvaluationCompetenciesMs[0];
            am2 = vAEvaluationCompetenciesMs[1];
            am3 = vAEvaluationCompetenciesMs[2];
            am4 = vAEvaluationCompetenciesMs[3];
            am5 = vAEvaluationCompetenciesMs[4];
            am6 = vAEvaluationCompetenciesMs[5];
            if (vAEvaluationCompetenciesMs .Count>6)
            {

                am7 = vAEvaluationCompetenciesMs[6];
            }

            List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == AEvaluationEmpemp.Idd).OrderBy(d=>d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            ad1 = vAEvaluationCompetenciesDs[0];
            ad2 = vAEvaluationCompetenciesDs[1];
            ad3 = vAEvaluationCompetenciesDs[2];
            ad4 = vAEvaluationCompetenciesDs[3];
            ad5 = vAEvaluationCompetenciesDs[4];
            ad6 = vAEvaluationCompetenciesDs[5];
            ad7 = vAEvaluationCompetenciesDs[6];
            ad8 = vAEvaluationCompetenciesDs[7];
            ad9 = vAEvaluationCompetenciesDs[8];
            ad10 = vAEvaluationCompetenciesDs[9];
            ad11 = vAEvaluationCompetenciesDs[10];
            ad12 = vAEvaluationCompetenciesDs[11];
            ad13 = vAEvaluationCompetenciesDs[12];
            ad14 = vAEvaluationCompetenciesDs[13];
            ad15 = vAEvaluationCompetenciesDs[14];
            ad16 = vAEvaluationCompetenciesDs[15];
            ad17 = vAEvaluationCompetenciesDs[16];
            ad18 = vAEvaluationCompetenciesDs[17];
            if (vAEvaluationCompetenciesDs .Count>18)
            { 
           
            ad19 = vAEvaluationCompetenciesDs[18];
            ad20 = vAEvaluationCompetenciesDs[19];
            ad21 = vAEvaluationCompetenciesDs[20];
            ad22 = vAEvaluationCompetenciesDs[21];
            ad23 = vAEvaluationCompetenciesDs[22];
            }
            if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }


            return View();
            //return View(ViewModelEvalwithother1);
        }


        // get 
        public ActionResult Editmmm(string id)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");
            String cid = _protector.Unprotect(id);
            if (cid == null)
            {
                return NotFound();
            }
            ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            viewModelEvalwithother.c1 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPNAME;
            return View(viewModelEvalwithother);
        }
        [HttpPost]
        public ActionResult Editmmm(string id,string c1,int mm, ViewModelEvalwithother viewModelEvalwithother)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");
            String cid = _protector.Unprotect(id);
            if (cid == null)
            {
                return NotFound();
            }
            return View();
        }

        public IActionResult Update(ViewModelEvalwithother ViewModelEvalwithother)
        {
            string conString = this.Configuration.GetConnectionString("hr");
            using (SqlConnection con = new SqlConnection(conString))
            {

                using (SqlCommand cmd = new SqlCommand())
                {
                    cmd.CommandType = CommandType.Text;
                    cmd.Connection = con;
                    cmd.Parameters.Clear();
                    cmd.CommandText = "UPDATE [dbo].[members]  SET [status] = @Status WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe AND [announce]=@Announce ";
                    cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c13);
                    cmd.Parameters.AddWithValue("@Status", 1);
                    cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                    cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                    con.Open();
                    cmd.ExecuteNonQuery();
                    con.Close();
                }
                using (SqlCommand cmd = new SqlCommand())
                {
                    cmd.CommandType = CommandType.Text;
                    cmd.Connection = con;
                    cmd.Parameters.Clear();
                    cmd.CommandText = "UPDATE [dbo].[commite]  SET [status] = @Status WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe  ";
                    cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c1);
                    cmd.Parameters.AddWithValue("@Status", 1);
                    cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                    cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                    con.Open();
                    cmd.ExecuteNonQuery();
                    con.Close();
                }
                using (SqlCommand cmd = new SqlCommand())
                {
                    cmd.CommandType = CommandType.Text;
                    cmd.Connection = con;
                    cmd.Parameters.Clear();
                    cmd.CommandText = "INSERT INTO [dbo].[commitez] ([userid],[username],[dateexcute],[commitedescession],[userentry],[timeentry],[CourcesIdImagecert],[status]) VALUES (@UserId,@UserName,@DateExcute,@CommiteDe,@UserEntry,@TimeEntry,@Announce,@Status)";
                    cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c1);
                    cmd.Parameters.AddWithValue("@UserName", ViewModelEvalwithother.c0);
                    cmd.Parameters.AddWithValue("@DateExcute", ViewModelEvalwithother.c12);
                    cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                    cmd.Parameters.AddWithValue("@UserEntry", HttpContext.Session.GetString("username"));
                    cmd.Parameters.AddWithValue("@TimeEntry", DateTime.Now);
                    cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                    cmd.Parameters.AddWithValue("@Status", ViewModelEvalwithother.c9);
                    con.Open();
                    cmd.ExecuteNonQuery();
                    con.Close();
                }
            }
            return RedirectToAction("Uploadmmm");
        }
        public IActionResult Updatez(ViewModelEvalwithother ViewModelEvalwithother,string c10,string c11,string txtId,string txtName,string txtCountry0)
        {

            var comm = _context.commite.Where(x => x.userid == HttpContext.Session.GetString("username")&&x.commitedescession== ViewModelEvalwithother.c10).FirstOrDefault();
<<<<<<< HEAD
            var memdate = _context.Members.Where(x => x.announce == ViewModelEvalwithother.c11).FirstOrDefault();
=======
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
            string conString = this.Configuration.GetConnectionString("hr");
            using (SqlConnection con = new SqlConnection(conString))
            {
                if (comm.postion == "رئيس اللجنة")
                {
                    using (SqlCommand cmd = new SqlCommand())
                    {
                        cmd.CommandType = CommandType.Text;
                        cmd.Connection = con;
                        cmd.Parameters.Clear();
                        cmd.CommandText = "UPDATE [dbo].[members]  SET [status] = @Status WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe AND [announce]=@Announce ";
                        cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c13);
                        cmd.Parameters.AddWithValue("@Status", 1);
                        cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                        cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                        con.Open();
                        cmd.ExecuteNonQuery();
                        con.Close();
                    }
                }
                else if (comm.postion == "نائب رئيس اللجنة ")
                {
                    using (SqlCommand cmd = new SqlCommand())
                    {
                        cmd.CommandType = CommandType.Text;
                        cmd.Connection = con;
                        cmd.Parameters.Clear();
                        cmd.CommandText = "UPDATE [dbo].[members]  SET [status2] = @Status WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe AND [announce]=@Announce ";
                        cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c13);
                        cmd.Parameters.AddWithValue("@Status", 1);
                        cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                        cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                        con.Open();
                        cmd.ExecuteNonQuery();
                        con.Close();
                    }
                }
                else if (comm.postion == "عضو اللجنة1")
                {
                    using (SqlCommand cmd = new SqlCommand())
                    {
                        cmd.CommandType = CommandType.Text;
                        cmd.Connection = con;
                        cmd.Parameters.Clear();
                        cmd.CommandText = "UPDATE [dbo].[members]  SET [status3] = @Status WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe AND [announce]=@Announce ";
                        cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c13);
                        cmd.Parameters.AddWithValue("@Status", 1);
                        cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                        cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                        con.Open();
                        cmd.ExecuteNonQuery();
                        con.Close();
                    }
                }
                else if (comm.postion == "عضو اللجنة2")
                {
                    using (SqlCommand cmd = new SqlCommand())
                    {
                        cmd.CommandType = CommandType.Text;
                        cmd.Connection = con;
                        cmd.Parameters.Clear();
                        cmd.CommandText = "UPDATE [dbo].[members]  SET [status4] = @Status WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe AND [announce]=@Announce ";
                        cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c13);
                        cmd.Parameters.AddWithValue("@Status", 1);
                        cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                        cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                        con.Open();
                        cmd.ExecuteNonQuery();
                        con.Close();
                    }
                }
                else if (comm.postion == "عضو اللجنة3")
                {
                    using (SqlCommand cmd = new SqlCommand())
                    {
                        cmd.CommandType = CommandType.Text;
                        cmd.Connection = con;
                        cmd.Parameters.Clear();
                        cmd.CommandText = "UPDATE [dbo].[members]  SET [status5] = @Status WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe AND [announce]=@Announce ";
                        cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c13);
                        cmd.Parameters.AddWithValue("@Status", 1);
                        cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                        cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                        con.Open();
                        cmd.ExecuteNonQuery();
                        con.Close();
                    }
                }
                //using (SqlCommand cmd = new SqlCommand())
                //{
                //    cmd.CommandType = CommandType.Text;
                //    cmd.Connection = con;
                //    cmd.Parameters.Clear();
                //    cmd.CommandText = "UPDATE [dbo].[commite]  SET [status] = @Status WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe  ";
                //    cmd.Parameters.AddWithValue("@UserId", HttpContext.Session.GetString("username"));
                //    cmd.Parameters.AddWithValue("@Status", 1);
                //    cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                //    cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                //    con.Open();
                //    cmd.ExecuteNonQuery();
                //    con.Close();
                //}
                using (SqlCommand cmd = new SqlCommand())
                {
                    cmd.CommandType = CommandType.Text;
                    cmd.Connection = con;
                    cmd.Parameters.Clear();
                    cmd.CommandText = "INSERT INTO [dbo].[commitez] ([userid],[username],[dateexcute],[commitedescession],[userentry],[timeentry],[CourcesIdImagecert],[status],[status0]) VALUES (@UserId,@UserName,@DateExcute,@CommiteDe,@UserEntry,@TimeEntry,@Announce,@Status,@Status0)";
                    cmd.Parameters.AddWithValue("@UserId", txtId);
                    cmd.Parameters.AddWithValue("@UserName", txtName);
<<<<<<< HEAD
                    cmd.Parameters.AddWithValue("@DateExcute", memdate.dateexcute1);
=======
                    cmd.Parameters.AddWithValue("@DateExcute", ViewModelEvalwithother.c12);
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
                    cmd.Parameters.AddWithValue("@CommiteDe", c10);
                    cmd.Parameters.AddWithValue("@UserEntry", HttpContext.Session.GetString("username"));
                    cmd.Parameters.AddWithValue("@TimeEntry", DateTime.Now);
                    cmd.Parameters.AddWithValue("@Announce", c11);
                    cmd.Parameters.AddWithValue("@Status", txtCountry0);
                    cmd.Parameters.AddWithValue("@Status0", 0);
                    con.Open();
                    cmd.ExecuteNonQuery();
                    con.Close();
                }
            }
            return RedirectToAction("Uploadmmmm0", new { announce = c11 });
        }
<<<<<<< HEAD
        public IActionResult Updatez9(ViewModelEvalwithother ViewModelEvalwithother, string c10, string c11, string txtId, string txtName, string txtCountry0)
        {

            var comm = _context.commite.Where(x => x.commitedescession == ViewModelEvalwithother.c10).ToList();
            var commz= _context.commitez.Where(x => x.commitedescession == ViewModelEvalwithother.c10&&x.userid==txtId&&x.CourcesIdImagecert==c11).ToList();
            var memdate = _context.Members.Where(x => x.announce == txtCountry0).FirstOrDefault();
            string conString = this.Configuration.GetConnectionString("hr");
            using (SqlConnection con = new SqlConnection(conString))
            {
                foreach(var comm0 in comm)
                {
                    if (comm0.postion == "رئيس اللجنة")
                    {
                        using (SqlCommand cmd = new SqlCommand())
                        {
                            cmd.CommandType = CommandType.Text;
                            cmd.Connection = con;
                            cmd.Parameters.Clear();
                            cmd.CommandText = "UPDATE [dbo].[members]  SET [status] = @Status WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe AND [announce]=@Announce ";
                            cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c13);
                            cmd.Parameters.AddWithValue("@Status", 1);
                            cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                            cmd.Parameters.AddWithValue("@Announce", txtCountry0);
                            con.Open();
                            cmd.ExecuteNonQuery();
                            con.Close();
                        }
                    }
                    else if (comm0.postion == "نائب رئيس اللجنة ")
                    {
                        using (SqlCommand cmd = new SqlCommand())
                        {
                            cmd.CommandType = CommandType.Text;
                            cmd.Connection = con;
                            cmd.Parameters.Clear();
                            cmd.CommandText = "UPDATE [dbo].[members]  SET [status2] = @Status WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe AND [announce]=@Announce ";
                            cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c13);
                            cmd.Parameters.AddWithValue("@Status", 1);
                            cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                            cmd.Parameters.AddWithValue("@Announce", txtCountry0);
                            con.Open();
                            cmd.ExecuteNonQuery();
                            con.Close();
                        }
                    }
                    else if (comm0.postion == "عضو اللجنة1")
                    {
                        using (SqlCommand cmd = new SqlCommand())
                        {
                            cmd.CommandType = CommandType.Text;
                            cmd.Connection = con;
                            cmd.Parameters.Clear();
                            cmd.CommandText = "UPDATE [dbo].[members]  SET [status3] = @Status WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe AND [announce]=@Announce ";
                            cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c13);
                            cmd.Parameters.AddWithValue("@Status", 1);
                            cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                            cmd.Parameters.AddWithValue("@Announce", txtCountry0);
                            con.Open();
                            cmd.ExecuteNonQuery();
                            con.Close();
                        }
                    }
                    else if (comm0.postion == "عضو اللجنة2")
                    {
                        using (SqlCommand cmd = new SqlCommand())
                        {
                            cmd.CommandType = CommandType.Text;
                            cmd.Connection = con;
                            cmd.Parameters.Clear();
                            cmd.CommandText = "UPDATE [dbo].[members]  SET [status4] = @Status WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe AND [announce]=@Announce ";
                            cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c13);
                            cmd.Parameters.AddWithValue("@Status", 1);
                            cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                            cmd.Parameters.AddWithValue("@Announce", txtCountry0);
                            con.Open();
                            cmd.ExecuteNonQuery();
                            con.Close();
                        }
                    }
                    else if (comm0.postion == "عضو اللجنة3")
                    {
                        using (SqlCommand cmd = new SqlCommand())
                        {
                            cmd.CommandType = CommandType.Text;
                            cmd.Connection = con;
                            cmd.Parameters.Clear();
                            cmd.CommandText = "UPDATE [dbo].[members]  SET [status5] = @Status WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe AND [announce]=@Announce ";
                            cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c13);
                            cmd.Parameters.AddWithValue("@Status", 1);
                            cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                            cmd.Parameters.AddWithValue("@Announce", txtCountry0);
                            con.Open();
                            cmd.ExecuteNonQuery();
                            con.Close();
                        }
                    }

                }
                foreach (var commz0 in commz)
                {
                    using (SqlCommand cmd = new SqlCommand())
                    {
                        cmd.CommandType = CommandType.Text;
                        cmd.Connection = con;
                        cmd.Parameters.Clear();
                        cmd.CommandText = "INSERT INTO [dbo].[commitez] ([userid],[username],[dateexcute],[commitedescession],[userentry],[timeentry],[CourcesIdImagecert],[status],[status0]) VALUES (@UserId,@UserName,@DateExcute,@CommiteDe,@UserEntry,@TimeEntry,@Announce,@Status,@Status0)";
                        cmd.Parameters.AddWithValue("@UserId", txtId);
                        cmd.Parameters.AddWithValue("@UserName", txtName);
                        cmd.Parameters.AddWithValue("@DateExcute", memdate.dateexcute1);
                        cmd.Parameters.AddWithValue("@CommiteDe", c10);
                        cmd.Parameters.AddWithValue("@UserEntry",commz0.userentry /*HttpContext.Session.GetString("username")*/);
                        cmd.Parameters.AddWithValue("@TimeEntry", DateTime.Now);
                        cmd.Parameters.AddWithValue("@Announce", txtCountry0);
                        cmd.Parameters.AddWithValue("@Status",commz0.status /*txtCountry0*/);
                        cmd.Parameters.AddWithValue("@Status0", 0);
                        con.Open();
                        cmd.ExecuteNonQuery();
                        con.Close();
                    }

                }
                //using (SqlCommand cmd = new SqlCommand())
                //{
                //    cmd.CommandType = CommandType.Text;
                //    cmd.Connection = con;
                //    cmd.Parameters.Clear();
                //    cmd.CommandText = "UPDATE [dbo].[commite]  SET [status] = @Status WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe  ";
                //    cmd.Parameters.AddWithValue("@UserId", HttpContext.Session.GetString("username"));
                //    cmd.Parameters.AddWithValue("@Status", 1);
                //    cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                //    cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                //    con.Open();
                //    cmd.ExecuteNonQuery();
                //    con.Close();
                //}

                //using (SqlCommand cmd = new SqlCommand())
                //{
                //    cmd.CommandType = CommandType.Text;
                //    cmd.Connection = con;
                //    cmd.Parameters.Clear();
                //    cmd.CommandText = "INSERT INTO [dbo].[commitez] ([userid],[username],[dateexcute],[commitedescession],[userentry],[timeentry],[CourcesIdImagecert],[status],[status0]) VALUES (@UserId,@UserName,@DateExcute,@CommiteDe,@UserEntry,@TimeEntry,@Announce,@Status,@Status0)";
                //    cmd.Parameters.AddWithValue("@UserId", txtId);
                //    cmd.Parameters.AddWithValue("@UserName", txtName);
                //    cmd.Parameters.AddWithValue("@DateExcute", ViewModelEvalwithother.c12);
                //    cmd.Parameters.AddWithValue("@CommiteDe", c10);
                //    cmd.Parameters.AddWithValue("@UserEntry", HttpContext.Session.GetString("username"));
                //    cmd.Parameters.AddWithValue("@TimeEntry", DateTime.Now);
                //    cmd.Parameters.AddWithValue("@Announce", c11);
                //    cmd.Parameters.AddWithValue("@Status", txtCountry0);
                //    cmd.Parameters.AddWithValue("@Status0", 0);
                //    con.Open();
                //    cmd.ExecuteNonQuery();
                //    con.Close();
                //}
            }
            return RedirectToAction("Uploadmmmm000", new { announce = txtCountry0 });
        }
        public IActionResult Updatezv(ViewModelEvalwithother ViewModelEvalwithother, string c10, string c11, string txtId, string txtName, string txtCountry0,string c2, string c13)
        {

            string conString = this.Configuration.GetConnectionString("hr");
            using (SqlConnection con = new SqlConnection(conString))
            {
              
                using (SqlCommand cmd = new SqlCommand())
                {
                    cmd.CommandType = CommandType.Text;
                    cmd.Connection = con;
                    cmd.Parameters.Clear();
                    cmd.CommandText = "UPDATE [dbo].[EvalDetails2] SET [OfferedRequestTo]=@UserId WHERE [COURCES_IDOffered]=@UserName ";
                    cmd.Parameters.AddWithValue("@UserId", c2);
                    cmd.Parameters.AddWithValue("@UserName", c13);
                    //cmd.Parameters.AddWithValue("@DateExcute", ViewModelEvalwithother.c12);
                    //cmd.Parameters.AddWithValue("@CommiteDe", c10);
                    //cmd.Parameters.AddWithValue("@UserEntry", HttpContext.Session.GetString("username"));
                    //cmd.Parameters.AddWithValue("@TimeEntry", DateTime.Now);
                    //cmd.Parameters.AddWithValue("@Announce", c11);
                    //cmd.Parameters.AddWithValue("@Status", txtCountry0);
                    //cmd.Parameters.AddWithValue("@Status0", 0);
                    con.Open();
                    cmd.ExecuteNonQuery();
                    con.Close();
                }
            }
            return RedirectToAction("pendinguser111", new { /*announce = c11*/ });
        }
        public IActionResult Updatezv0(ViewModelEvalwithother ViewModelEvalwithother, string c10, string c11, string txtId, string txtName, string txtCountry0, string c22, string c130)
        {

            string conString = this.Configuration.GetConnectionString("hr");
            using (SqlConnection con = new SqlConnection(conString))
            {

                using (SqlCommand cmd = new SqlCommand())
                {
                    cmd.CommandType = CommandType.Text;
                    cmd.Connection = con;
                    cmd.Parameters.Clear();
                    cmd.CommandText = "UPDATE [dbo].[EvalDetails2] SET [OfferedRequestTo2]=@UserId WHERE [COURCES_IDOffered]=@UserName ";
                    cmd.Parameters.AddWithValue("@UserId", c22);
                    cmd.Parameters.AddWithValue("@UserName", c130);
                    //cmd.Parameters.AddWithValue("@DateExcute", ViewModelEvalwithother.c12);
                    //cmd.Parameters.AddWithValue("@CommiteDe", c10);
                    //cmd.Parameters.AddWithValue("@UserEntry", HttpContext.Session.GetString("username"));
                    //cmd.Parameters.AddWithValue("@TimeEntry", DateTime.Now);
                    //cmd.Parameters.AddWithValue("@Announce", c11);
                    //cmd.Parameters.AddWithValue("@Status", txtCountry0);
                    //cmd.Parameters.AddWithValue("@Status0", 0);
                    con.Open();
                    cmd.ExecuteNonQuery();
                    con.Close();
                }
            }
            return RedirectToAction("pendinguser111", new { /*announce = c11*/ });
        }
=======
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
        public IActionResult Update0(ViewModelEvalwithother ViewModelEvalwithother,string c10)
        {
            string conString = this.Configuration.GetConnectionString("hr");
            using (SqlConnection con = new SqlConnection(conString))
            {

                //using (SqlCommand cmd = new SqlCommand())
                //{
                //    cmd.CommandType = CommandType.Text;
                //    cmd.Connection = con;
                //    cmd.Parameters.Clear();
                //    cmd.CommandText = "UPDATE [dbo].[members]  SET [status] = @Status WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe AND [announce]=@Announce ";
                //    cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c13);
                //    cmd.Parameters.AddWithValue("@Status", 1);
                //    cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                //    cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                //    con.Open();
                //    cmd.ExecuteNonQuery();
                //    con.Close();
                //}
                var newone = _context.Cemps.Where(c => c.Cempid == ViewModelEvalwithother.c2).FirstOrDefault();
                if (newone == null)
                {
                    return View();
                }
                using (SqlCommand cmd = new SqlCommand())
                {
                    cmd.CommandType = CommandType.Text;
                    cmd.Connection = con;
                    cmd.Parameters.Clear();
                    cmd.CommandText = "UPDATE [dbo].[commite]  SET [userid] = @UserIdnid,username=@UserIdnname WHERE [userid] = @UserIdold AND [commitedescession]=@CommiteDe  ";
                    cmd.Parameters.AddWithValue("@UserIdnid", newone.Cempid);
                    cmd.Parameters.AddWithValue("@UserIdnname", newone.CEMPNAME);
                    cmd.Parameters.AddWithValue("@UserIdold", ViewModelEvalwithother.c1);
                    cmd.Parameters.AddWithValue("@CommiteDe", c10);
                    con.Open();
                    cmd.ExecuteNonQuery();
                    con.Close();
                }
                //using (SqlCommand cmd = new SqlCommand())
                //{
                //    cmd.CommandType = CommandType.Text;
                //    cmd.Connection = con;
                //    cmd.Parameters.Clear();
                //    cmd.CommandText = "INSERT INTO [dbo].[commitez] ([userid],[username],[dateexcute],[commitedescession],[userentry],[timeentry],[CourcesIdImagecert],[status]) VALUES (@UserId,@UserName,@DateExcute,@CommiteDe,@UserEntry,@TimeEntry,@Announce,@Status)";
                //    cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c1);
                //    cmd.Parameters.AddWithValue("@UserName", ViewModelEvalwithother.c0);
                //    cmd.Parameters.AddWithValue("@DateExcute", ViewModelEvalwithother.c12);
                //    cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                //    cmd.Parameters.AddWithValue("@UserEntry", HttpContext.Session.GetString("username"));
                //    cmd.Parameters.AddWithValue("@TimeEntry", DateTime.Now);
                //    cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                //    cmd.Parameters.AddWithValue("@Status", ViewModelEvalwithother.c9);
                //    con.Open();
                //    cmd.ExecuteNonQuery();
                //    con.Close();
                //}
            }
            return RedirectToAction("Uploadmmm0");
        }
        public IActionResult Update00(ViewModelEvalwithother ViewModelEvalwithother,string c100)
        {
            string conString = this.Configuration.GetConnectionString("hr");
            using (SqlConnection con = new SqlConnection(conString))
            {

                //using (SqlCommand cmd = new SqlCommand())
                //{
                //    cmd.CommandType = CommandType.Text;
                //    cmd.Connection = con;
                //    cmd.Parameters.Clear();
                //    cmd.CommandText = "UPDATE [dbo].[members]  SET [status] = @Status WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe AND [announce]=@Announce ";
                //    cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c13);
                //    cmd.Parameters.AddWithValue("@Status", 1);
                //    cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                //    cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                //    con.Open();
                //    cmd.ExecuteNonQuery();
                //    con.Close();
                //}
                using (SqlCommand cmd = new SqlCommand())
                {
                    cmd.CommandType = CommandType.Text;
                    cmd.Connection = con;
                    cmd.Parameters.Clear();
                    cmd.CommandText = "UPDATE [dbo].[commite]  SET [postion] =@postion WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe  ";
                    cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c1);
                    cmd.Parameters.AddWithValue("@postion", ViewModelEvalwithother.c2);
                    cmd.Parameters.AddWithValue("@CommiteDe", c100);
                    //cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                    con.Open();
                    cmd.ExecuteNonQuery();
                    con.Close();
                }
                //using (SqlCommand cmd = new SqlCommand())
                //{
                //    cmd.CommandType = CommandType.Text;
                //    cmd.Connection = con;
                //    cmd.Parameters.Clear();
                //    cmd.CommandText = "INSERT INTO [dbo].[commitez] ([userid],[username],[dateexcute],[commitedescession],[userentry],[timeentry],[CourcesIdImagecert],[status]) VALUES (@UserId,@UserName,@DateExcute,@CommiteDe,@UserEntry,@TimeEntry,@Announce,@Status)";
                //    cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c1);
                //    cmd.Parameters.AddWithValue("@UserName", ViewModelEvalwithother.c0);
                //    cmd.Parameters.AddWithValue("@DateExcute", ViewModelEvalwithother.c12);
                //    cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                //    cmd.Parameters.AddWithValue("@UserEntry", HttpContext.Session.GetString("username"));
                //    cmd.Parameters.AddWithValue("@TimeEntry", DateTime.Now);
                //    cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                //    cmd.Parameters.AddWithValue("@Status", ViewModelEvalwithother.c9);
                //    con.Open();
                //    cmd.ExecuteNonQuery();
                //    con.Close();
                //}
            }
            return RedirectToAction("Uploadmmm0");
        }
        public IActionResult Update000(ViewModelEvalwithother ViewModelEvalwithother, string c1000, string[] DynamicTextBox1)
        {
            JavaScriptSerializer serializer = new JavaScriptSerializer();
            ViewBag.Values = serializer.Serialize(DynamicTextBox1);
            string conString = this.Configuration.GetConnectionString("hr");

            
                using (SqlConnection con = new SqlConnection(conString))
            {

                //using (SqlCommand cmd = new SqlCommand())
                //{
                //    cmd.CommandType = CommandType.Text;
                //    cmd.Connection = con;
                //    cmd.Parameters.Clear();
                //    cmd.CommandText = "UPDATE [dbo].[members]  SET [status] = @Status WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe AND [announce]=@Announce ";
                //    cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c13);
                //    cmd.Parameters.AddWithValue("@Status", 1);
                //    cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                //    cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                //    con.Open();
                //    cmd.ExecuteNonQuery();
                //    con.Close();
                //}
                //using (SqlCommand cmd = new SqlCommand())
                //{
                //    cmd.CommandType = CommandType.Text;
                //    cmd.Connection = con;
                //    cmd.Parameters.Clear();
                //    cmd.CommandText = "UPDATE [dbo].[commite]  SET [postion] =@postion WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe  ";
                //    cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c1);
                //    cmd.Parameters.AddWithValue("@postion", ViewModelEvalwithother.c2);
                //    cmd.Parameters.AddWithValue("@CommiteDe", c1000);
                //    //cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                //    con.Open();
                //    cmd.ExecuteNonQuery();
                //    con.Close();
                //}
                for (int i = 0; i < DynamicTextBox1.Length; i++)
                {


                    using (SqlCommand cmd = new SqlCommand())
                    {
                        cmd.CommandType = CommandType.Text;
                        cmd.Connection = con;
                        cmd.Parameters.Clear();
                        cmd.CommandText = "INSERT INTO [dbo].[membersz] ([userid],[username],[dateexcute],[dateexcute1],[commitedescession],[userentry],[timeentry],[status],[announce],[announcetxt]) VALUES (@UserId,@UserName,@DateExcute,@DateExcute1,@CommiteDe,@UserEntry,@TimeEntry,@Status,@Announce,@Announcetxt)";
                        cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c1);
                        cmd.Parameters.AddWithValue("@UserName", ViewModelEvalwithother.c0);
                        cmd.Parameters.AddWithValue("@DateExcute", DateTime.Now.Date);
                        cmd.Parameters.AddWithValue("@DateExcute1", DateTime.Now.Date);
                        cmd.Parameters.AddWithValue("@CommiteDe", c1000);
                        cmd.Parameters.AddWithValue("@UserEntry", HttpContext.Session.GetString("username"));
                        cmd.Parameters.AddWithValue("@TimeEntry", DateTime.Now);
                        cmd.Parameters.AddWithValue("@Status", 0);
                        cmd.Parameters.AddWithValue("@Announce", DynamicTextBox1[i].ToString() ?? "");
                        cmd.Parameters.AddWithValue("@Announcetxt", DynamicTextBox1[i].ToString() ?? "");

                        con.Open();
                        cmd.ExecuteNonQuery();
                        con.Close();
                    }
                }
            }
            return RedirectToAction("Uploadmmm0");
        }
        public IActionResult Update0000(ViewModelEvalwithother ViewModelEvalwithother, string c10000, string[] DynamicTextBox1)
        {
            JavaScriptSerializer serializer = new JavaScriptSerializer();
            ViewBag.Values = serializer.Serialize(DynamicTextBox1);
            string conString = this.Configuration.GetConnectionString("hr");


            using (SqlConnection con = new SqlConnection(conString))
            {

                //using (SqlCommand cmd = new SqlCommand())
                //{
                //    cmd.CommandType = CommandType.Text;
                //    cmd.Connection = con;
                //    cmd.Parameters.Clear();
                //    cmd.CommandText = "UPDATE [dbo].[members]  SET [status] = @Status WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe AND [announce]=@Announce ";
                //    cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c13);
                //    cmd.Parameters.AddWithValue("@Status", 1);
                //    cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                //    cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                //    con.Open();
                //    cmd.ExecuteNonQuery();
                //    con.Close();
                //}
                //using (SqlCommand cmd = new SqlCommand())
                //{
                //    cmd.CommandType = CommandType.Text;
                //    cmd.Connection = con;
                //    cmd.Parameters.Clear();
                //    cmd.CommandText = "UPDATE [dbo].[commite]  SET [postion] =@postion WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe  ";
                //    cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c1);
                //    cmd.Parameters.AddWithValue("@postion", ViewModelEvalwithother.c2);
                //    cmd.Parameters.AddWithValue("@CommiteDe", c1000);
                //    //cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                //    con.Open();
                //    cmd.ExecuteNonQuery();
                //    con.Close();
                //}
                for (int i = 0; i < DynamicTextBox1.Length; i++)
                {


                    using (SqlCommand cmd = new SqlCommand())
                    {
                        cmd.CommandType = CommandType.Text;
                        cmd.Connection = con;
                        cmd.Parameters.Clear();
                        cmd.CommandText = "DELETE FROM  [dbo].[membersz] WHERE  [userid]=@UserId AND [username]=@UserName AND [commitedescession]=@CommiteDe AND [userentry]=@UserEntry AND [announce]=@Announce AND [announcetxt]=@Announcetxt";
                        cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c1);
                        cmd.Parameters.AddWithValue("@UserName", ViewModelEvalwithother.c0);
                        cmd.Parameters.AddWithValue("@DateExcute", DateTime.Now.Date);
                        cmd.Parameters.AddWithValue("@DateExcute1", DateTime.Now.Date);
                        cmd.Parameters.AddWithValue("@CommiteDe", c10000);
                        cmd.Parameters.AddWithValue("@UserEntry", HttpContext.Session.GetString("username"));
                        cmd.Parameters.AddWithValue("@TimeEntry", DateTime.Now);
                        cmd.Parameters.AddWithValue("@Status", 0);
                        cmd.Parameters.AddWithValue("@Announce", DynamicTextBox1[i].ToString() ?? "");
                        cmd.Parameters.AddWithValue("@Announcetxt", DynamicTextBox1[i].ToString() ?? "");

                        con.Open();
                        cmd.ExecuteNonQuery();
                        con.Close();
                    }
                }
            }
            return RedirectToAction("Uploadmmm0");
        }
        public IActionResult Update1(ViewModelEvalwithother ViewModelEvalwithother, string c10000, string[] DynamicTextBox1)
        {
            JavaScriptSerializer serializer = new JavaScriptSerializer();
            ViewBag.Values = serializer.Serialize(DynamicTextBox1);
            string conString = this.Configuration.GetConnectionString("hr");


            using (SqlConnection con = new SqlConnection(conString))
            {

                //using (SqlCommand cmd = new SqlCommand())
                //{
                //    cmd.CommandType = CommandType.Text;
                //    cmd.Connection = con;
                //    cmd.Parameters.Clear();
                //    cmd.CommandText = "UPDATE [dbo].[members]  SET [status] = @Status WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe AND [announce]=@Announce ";
                //    cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c13);
                //    cmd.Parameters.AddWithValue("@Status", 1);
                //    cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                //    cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                //    con.Open();
                //    cmd.ExecuteNonQuery();
                //    con.Close();
                //}
                //using (SqlCommand cmd = new SqlCommand())
                //{
                //    cmd.CommandType = CommandType.Text;
                //    cmd.Connection = con;
                //    cmd.Parameters.Clear();
                //    cmd.CommandText = "UPDATE [dbo].[commite]  SET [postion] =@postion WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe  ";
                //    cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c1);
                //    cmd.Parameters.AddWithValue("@postion", ViewModelEvalwithother.c2);
                //    cmd.Parameters.AddWithValue("@CommiteDe", c1000);
                //    //cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                //    con.Open();
                //    cmd.ExecuteNonQuery();
                //    con.Close();
                //}
                for (int i = 0; i < DynamicTextBox1.Length; i++)
                {


                    using (SqlCommand cmd = new SqlCommand())
                    {
                        cmd.CommandType = CommandType.Text;
                        cmd.Connection = con;
                        cmd.Parameters.Clear();
                        cmd.CommandText = "INSERT INTO [dbo].[memberszz] ([userid],[username],[dateexcute],[dateexcute1],[commitedescession],[userentry],[timeentry],[status],[announce],[announcetxt]) VALUES (@UserId,@UserName,@DateExcute,@DateExcute1,@CommiteDe,@UserEntry,@TimeEntry,@Status,@Announce,@Announcetxt)";
                        cmd.Parameters.AddWithValue("@UserId", DynamicTextBox1[i].ToString());
                        cmd.Parameters.AddWithValue("@UserName", _context.Cemps.Where(z=>z.Cempid== DynamicTextBox1[i].ToString()).FirstOrDefault().CEMPNAME??"");
                        cmd.Parameters.AddWithValue("@DateExcute", DateTime.Now.Date);
                        cmd.Parameters.AddWithValue("@DateExcute1", DateTime.Now.Date);
                        cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                        cmd.Parameters.AddWithValue("@UserEntry", HttpContext.Session.GetString("username"));
                        cmd.Parameters.AddWithValue("@TimeEntry", DateTime.Now);
                        cmd.Parameters.AddWithValue("@Status", 0);
                        cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11 ?? "");
                        cmd.Parameters.AddWithValue("@Announcetxt", ViewModelEvalwithother.c1 ?? "");

                        con.Open();
                        cmd.ExecuteNonQuery();
                        con.Close();
                    }
                }
            }
            return RedirectToAction("Uploadmmm1");
        }
        public IActionResult Update10(ViewModelEvalwithother ViewModelEvalwithother, string c10000, string[] DynamicTextBox1)
        {
            JavaScriptSerializer serializer = new JavaScriptSerializer();
            ViewBag.Values = serializer.Serialize(DynamicTextBox1);
            string conString = this.Configuration.GetConnectionString("hr");


            using (SqlConnection con = new SqlConnection(conString))
            {

                //using (SqlCommand cmd = new SqlCommand())
                //{
                //    cmd.CommandType = CommandType.Text;
                //    cmd.Connection = con;
                //    cmd.Parameters.Clear();
                //    cmd.CommandText = "UPDATE [dbo].[members]  SET [status] = @Status WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe AND [announce]=@Announce ";
                //    cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c13);
                //    cmd.Parameters.AddWithValue("@Status", 1);
                //    cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                //    cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                //    con.Open();
                //    cmd.ExecuteNonQuery();
                //    con.Close();
                //}
                //using (SqlCommand cmd = new SqlCommand())
                //{
                //    cmd.CommandType = CommandType.Text;
                //    cmd.Connection = con;
                //    cmd.Parameters.Clear();
                //    cmd.CommandText = "UPDATE [dbo].[commite]  SET [postion] =@postion WHERE [userid] = @UserId AND [commitedescession]=@CommiteDe  ";
                //    cmd.Parameters.AddWithValue("@UserId", ViewModelEvalwithother.c1);
                //    cmd.Parameters.AddWithValue("@postion", ViewModelEvalwithother.c2);
                //    cmd.Parameters.AddWithValue("@CommiteDe", c1000);
                //    //cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11);
                //    con.Open();
                //    cmd.ExecuteNonQuery();
                //    con.Close();
                //}
                for (int i = 0; i < DynamicTextBox1.Length; i++)
                {


                    using (SqlCommand cmd = new SqlCommand())
                    {
                        cmd.CommandType = CommandType.Text;
                        cmd.Connection = con;
                        cmd.Parameters.Clear();
                        cmd.CommandText = "DELETE FROM  [dbo].[memberszz] WHERE  [userid]=@UserId AND [username]=@UserName AND [commitedescession]=@CommiteDe AND [userentry]=@UserEntry AND [announce]=@Announce AND [announcetxt]=@Announcetxt";
                        cmd.Parameters.AddWithValue("@UserId", DynamicTextBox1[i].ToString());
                        cmd.Parameters.AddWithValue("@UserName", _context.Cemps.Where(z => z.Cempid == DynamicTextBox1[i].ToString()).FirstOrDefault().CEMPNAME ?? "");
                        cmd.Parameters.AddWithValue("@DateExcute", DateTime.Now.Date);
                        cmd.Parameters.AddWithValue("@DateExcute1", DateTime.Now.Date);
                        cmd.Parameters.AddWithValue("@CommiteDe", ViewModelEvalwithother.c10);
                        cmd.Parameters.AddWithValue("@UserEntry", HttpContext.Session.GetString("username"));
                        cmd.Parameters.AddWithValue("@TimeEntry", DateTime.Now);
                        cmd.Parameters.AddWithValue("@Status", 0);
                        cmd.Parameters.AddWithValue("@Announce", ViewModelEvalwithother.c11 ?? "");
                        cmd.Parameters.AddWithValue("@Announcetxt", ViewModelEvalwithother.c1 ?? "");

                        con.Open();
                        cmd.ExecuteNonQuery();
                        con.Close();
                    }
                }
            }
            return RedirectToAction("Uploadmmm1");
        }
        public JsonResult EditCustomer([FromBody] Cemp cust, string Id,string Cempid)
        {

            String cid = _protector.Unprotect(cust.EncryptedId);
            //String cid = "4281001";
            if (cid == null)
            {
                //return NotFound();
            }
            ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            viewModelEvalwithother.c0 = _context.Cemps.Where(xx => xx.CEMPPASSWRD == cid).FirstOrDefault().Cempid;
            viewModelEvalwithother.c1 = _context.Cemps.Where(xx => xx.CEMPPASSWRD == cid).FirstOrDefault().CEMPNAME;
            viewModelEvalwithother.c2 = _context.Cemps.Where(xx => xx.CEMPPASSWRD == cid).FirstOrDefault().CEMPJOBNAME;
            viewModelEvalwithother.c3 = _context.Cemps.Where(xx => xx.CEMPPASSWRD == cid).FirstOrDefault().grade;
            viewModelEvalwithother.c4 = _context.Cemps.Where(xx => xx.CEMPPASSWRD == cid).FirstOrDefault().CLSSNO;
            viewModelEvalwithother.c5 = _context.Cemps.Where(xx => xx.CEMPPASSWRD == cid).FirstOrDefault().DEP_NAME;
            viewModelEvalwithother.c6 = _context.Cemps.Where(xx => xx.CEMPPASSWRD == cid).FirstOrDefault().PARENTNAME;
            viewModelEvalwithother.c7 =Convert.ToDateTime( _context.Cemps.Where(xx => xx.CEMPPASSWRD == cid).FirstOrDefault().CEMPHIRINGDATEHIJRA).ToShortDateString();
            viewModelEvalwithother.c8 = Convert.ToDateTime(_context.Cemps.Where(xx => xx.CEMPPASSWRD == cid).FirstOrDefault().CEMPLASTUPGRADEHIJRA).ToShortDateString();
            viewModelEvalwithother.c10 = _context.Members.Where(xx => xx.userid == cid&&xx.status==0).FirstOrDefault().commitedescession;
            viewModelEvalwithother.c11 = _context.Members.Where(xx => xx.userid == cid && xx.status == 0).FirstOrDefault().announce;
            viewModelEvalwithother.c12 = _context.Members.Where(xx => xx.userid == cid && xx.status == 0).FirstOrDefault().dateexcute.Value.ToShortDateString().ToString();
            viewModelEvalwithother.c13 = _context.Cemps.Where(xx => xx.CEMPPASSWRD == cid).FirstOrDefault().CEMPPASSWRD;
            //int id = Convert.ToInt32(cust.Id);
            //ViewModelEvalwithother customer = new ViewModelEvalwithother();
            //customer.Id = id;
            //customer.Name = GetCustomers(id).FirstOrDefault().Name;
            //customer.Country = GetCustomers(id).FirstOrDefault().Country;
            //customer.Customers = GetCustomers(null);
            return Json(viewModelEvalwithother);
        }
        public JsonResult EditCustomer0([FromBody] Cemp cust, string Id, string Cempid)
        {

            String cid = _protector.Unprotect(cust.EncryptedId);
            //String cid = "4281001";
            if (cid == null)
            {
                //return NotFound();
            }
            ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            viewModelEvalwithother.c0 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().Cempid;
            viewModelEvalwithother.c1 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPNAME;
            viewModelEvalwithother.c2 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPJOBNAME;
            viewModelEvalwithother.c3 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().grade;
            viewModelEvalwithother.c4 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CLSSNO;
            viewModelEvalwithother.c5 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().DEP_NAME;
            viewModelEvalwithother.c6 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().PARENTNAME;
            viewModelEvalwithother.c7 = Convert.ToDateTime(_context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPHIRINGDATEHIJRA).ToShortDateString();
            viewModelEvalwithother.c8 = Convert.ToDateTime(_context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPLASTUPGRADEHIJRA).ToShortDateString();
            viewModelEvalwithother.c10 = _context.commite.Where(xx => xx.userid == cid && xx.commitedescession == cust.CEMPNO).FirstOrDefault().commitedescession;
            //viewModelEvalwithother.c11 = _context.Members.Where(xx => xx.userid == cid && xx.status == 0).FirstOrDefault().announce;
            //viewModelEvalwithother.c12 = _context.Members.Where(xx => xx.userid == cid && xx.status == 0).FirstOrDefault().dateexcute.Value.ToShortDateString().ToString();
            viewModelEvalwithother.c13 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD;
            //int id = Convert.ToInt32(cust.Id);
            //ViewModelEvalwithother customer = new ViewModelEvalwithother();
            //customer.Id = id;
            //customer.Name = GetCustomers(id).FirstOrDefault().Name;
            //customer.Country = GetCustomers(id).FirstOrDefault().Country;
            //customer.Customers = GetCustomers(null);
            return Json(viewModelEvalwithother);
        }
        public JsonResult EditCustomer00([FromBody] Cemp cust, string Id, string Cempid)
        {

            String cid = _protector.Unprotect(cust.EncryptedId);
            //String cid = "4281001";
            if (cid == null)
            {
                //return NotFound();
            }
            ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            viewModelEvalwithother.c0 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().Cempid;
            viewModelEvalwithother.c1 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPNAME;
            viewModelEvalwithother.c2 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPJOBNAME;
            viewModelEvalwithother.c3 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().grade;
            viewModelEvalwithother.c4 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CLSSNO;
            viewModelEvalwithother.c5 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().DEP_NAME;
            viewModelEvalwithother.c6 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().PARENTNAME;
            viewModelEvalwithother.c7 = Convert.ToDateTime(_context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPHIRINGDATEHIJRA).ToShortDateString();
            viewModelEvalwithother.c8 = Convert.ToDateTime(_context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPLASTUPGRADEHIJRA).ToShortDateString();
            viewModelEvalwithother.c10 = _context.commite.Where(xx => xx.userid == cid && xx.commitedescession == cust.CEMPNO).FirstOrDefault().commitedescession;
            //viewModelEvalwithother.c11 = _context.Members.Where(xx => xx.userid == cid && xx.status == 0).FirstOrDefault().announce;
            //viewModelEvalwithother.c12 = _context.Members.Where(xx => xx.userid == cid && xx.status == 0).FirstOrDefault().dateexcute.Value.ToShortDateString().ToString();
            viewModelEvalwithother.c13 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD;
            //int id = Convert.ToInt32(cust.Id);
            //ViewModelEvalwithother customer = new ViewModelEvalwithother();
            //customer.Id = id;
            //customer.Name = GetCustomers(id).FirstOrDefault().Name;
            //customer.Country = GetCustomers(id).FirstOrDefault().Country;
            //customer.Customers = GetCustomers(null);
            return Json(viewModelEvalwithother);
        }
        public JsonResult EditCustomer000([FromBody] Cemp cust, string Id, string Cempid)
        {

            String cid = _protector.Unprotect(cust.EncryptedId);
            //String cid = "4281001";
            if (cid == null)
            {
                //return NotFound();
            }
            ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            viewModelEvalwithother.c0 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().Cempid;
            viewModelEvalwithother.c1 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPNAME;
            viewModelEvalwithother.c2 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPJOBNAME;
            viewModelEvalwithother.c3 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().grade;
            viewModelEvalwithother.c4 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CLSSNO;
            viewModelEvalwithother.c5 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().DEP_NAME;
            viewModelEvalwithother.c6 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().PARENTNAME;
            viewModelEvalwithother.c7 = Convert.ToDateTime(_context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPHIRINGDATEHIJRA).ToShortDateString();
            viewModelEvalwithother.c8 = Convert.ToDateTime(_context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPLASTUPGRADEHIJRA).ToShortDateString();
            viewModelEvalwithother.c10 = _context.commite.Where(xx => xx.userid == cid && xx.commitedescession == cust.CEMPNO).FirstOrDefault().commitedescession;
            //viewModelEvalwithother.c11 = _context.Members.Where(xx => xx.userid == cid && xx.status == 0).FirstOrDefault().announce;
            //viewModelEvalwithother.c12 = _context.Members.Where(xx => xx.userid == cid && xx.status == 0).FirstOrDefault().dateexcute.Value.ToShortDateString().ToString();
            viewModelEvalwithother.c13 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD;
            //int id = Convert.ToInt32(cust.Id);
            //ViewModelEvalwithother customer = new ViewModelEvalwithother();
            //customer.Id = id;
            //customer.Name = GetCustomers(id).FirstOrDefault().Name;
            //customer.Country = GetCustomers(id).FirstOrDefault().Country;
            //customer.Customers = GetCustomers(null);
            return Json(viewModelEvalwithother);
        }
        public JsonResult EditCustomer0000([FromBody] Cemp cust, string Id, string Cempid)
        {

            String cid = _protector.Unprotect(cust.EncryptedId);
            //String cid = "4281001";
            if (cid == null)
            {
                //return NotFound();
            }
            ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            viewModelEvalwithother.c0 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().Cempid;
            viewModelEvalwithother.c1 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPNAME;
            viewModelEvalwithother.c2 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPJOBNAME;
            viewModelEvalwithother.c3 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().grade;
            viewModelEvalwithother.c4 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CLSSNO;
            viewModelEvalwithother.c5 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().DEP_NAME;
            viewModelEvalwithother.c6 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().PARENTNAME;
            viewModelEvalwithother.c7 = Convert.ToDateTime(_context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPHIRINGDATEHIJRA).ToShortDateString();
            viewModelEvalwithother.c8 = Convert.ToDateTime(_context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPLASTUPGRADEHIJRA).ToShortDateString();
            viewModelEvalwithother.c10 = _context.commite.Where(xx => xx.userid == cid && xx.commitedescession == cust.CEMPNO).FirstOrDefault().commitedescession;
            //viewModelEvalwithother.c11 = _context.Members.Where(xx => xx.userid == cid && xx.status == 0).FirstOrDefault().announce;
            //viewModelEvalwithother.c12 = _context.Members.Where(xx => xx.userid == cid && xx.status == 0).FirstOrDefault().dateexcute.Value.ToShortDateString().ToString();
            viewModelEvalwithother.c13 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD;
            //int id = Convert.ToInt32(cust.Id);
            //ViewModelEvalwithother customer = new ViewModelEvalwithother();
            //customer.Id = id;
            //customer.Name = GetCustomers(id).FirstOrDefault().Name;
            //customer.Country = GetCustomers(id).FirstOrDefault().Country;
            //customer.Customers = GetCustomers(null);
            return Json(viewModelEvalwithother);
        }
        public JsonResult EditCustomer1([FromBody] Cemp cust,[FromBody] ViewModelEvalwithother ViewModelEvalwithother,string EncryptedId, string Id, string Cempid)
        {

            String cid = _protector.Unprotect(cust.EncryptedId);
            //String cid = "4281001";
            if (cid == null)
            {
                //return NotFound();
            }
            ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            viewModelEvalwithother.c0 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().Cempid;
            viewModelEvalwithother.c1 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPNAME;
            viewModelEvalwithother.c2 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPJOBNAME;
            viewModelEvalwithother.c3 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().grade;
            viewModelEvalwithother.c4 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CLSSNO;
            viewModelEvalwithother.c5 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().DEP_NAME;
            viewModelEvalwithother.c6 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().PARENTNAME;
            viewModelEvalwithother.c7 = Convert.ToDateTime(_context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPHIRINGDATEHIJRA).ToShortDateString();
            viewModelEvalwithother.c8 = Convert.ToDateTime(_context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPLASTUPGRADEHIJRA).ToShortDateString();
            viewModelEvalwithother.c10 = _context.Members.Where(xx => xx.userid == _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD && xx.commitedescession == cust.CEMPNO&&xx.announce== cust.CEMPPASSWRD1).FirstOrDefault().commitedescession;
            viewModelEvalwithother.c11 = _context.Members.Where(xx => xx.userid == _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD && xx.commitedescession == cust.CEMPNO && xx.announce == cust.CEMPPASSWRD1).FirstOrDefault().announce;
            viewModelEvalwithother.c12 = _context.Members.Where(xx => xx.userid == _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD).FirstOrDefault().dateexcute.Value.ToShortDateString().ToString();
            viewModelEvalwithother.c13 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD;
            //int id = Convert.ToInt32(cust.Id);
            //ViewModelEvalwithother customer = new ViewModelEvalwithother();
            //customer.Id = id;
            //customer.Name = GetCustomers(id).FirstOrDefault().Name;
            //customer.Country = GetCustomers(id).FirstOrDefault().Country;
            //customer.Customers = GetCustomers(null);
            return Json(viewModelEvalwithother);
        }
<<<<<<< HEAD
        public JsonResult EditCustomer19([FromBody] Cemp cust, [FromBody] ViewModelEvalwithother ViewModelEvalwithother, string EncryptedId, string Id, string Cempid)
        {

            String cid = _protector.Unprotect(cust.EncryptedId);
            //String cid = "4281001";
            if (cid == null)
            {
                //return NotFound();
            }
            ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            viewModelEvalwithother.c0 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().Cempid;
            viewModelEvalwithother.c1 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPNAME;
            viewModelEvalwithother.c2 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPJOBNAME;
            viewModelEvalwithother.c3 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().grade;
            viewModelEvalwithother.c4 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CLSSNO;
            viewModelEvalwithother.c5 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().DEP_NAME;
            viewModelEvalwithother.c6 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().PARENTNAME;
            viewModelEvalwithother.c7 = Convert.ToDateTime(_context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPHIRINGDATEHIJRA).ToShortDateString();
            viewModelEvalwithother.c8 = Convert.ToDateTime(_context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPLASTUPGRADEHIJRA).ToShortDateString();
            viewModelEvalwithother.c10 = _context.Members.Where(xx => xx.userid == _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD && xx.commitedescession == cust.CEMPNO && xx.announce == cust.CEMPPASSWRD1).FirstOrDefault().commitedescession;
            viewModelEvalwithother.c11 = _context.Members.Where(xx => xx.userid == _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD && xx.commitedescession == cust.CEMPNO && xx.announce == cust.CEMPPASSWRD1).FirstOrDefault().announce;
            viewModelEvalwithother.c12 = _context.Members.Where(xx => xx.userid == _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD).FirstOrDefault().dateexcute.Value.ToShortDateString().ToString();
            viewModelEvalwithother.c13 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD;
            //int id = Convert.ToInt32(cust.Id);
            //ViewModelEvalwithother customer = new ViewModelEvalwithother();
            //customer.Id = id;
            //customer.Name = GetCustomers(id).FirstOrDefault().Name;
            //customer.Country = GetCustomers(id).FirstOrDefault().Country;
            //customer.Customers = GetCustomers(null);
            return Json(viewModelEvalwithother);
        }
=======
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
        public JsonResult EditCustomer10([FromBody] Cemp cust, string Id, string Cempid)
        {

            String cid = _protector.Unprotect(cust.EncryptedId);
            //String cid = "4281001";
            if (cid == null)
            {
                //return NotFound();
            }
            ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            viewModelEvalwithother.c0 = _context.Cemps.Where(xx => xx.CEMPPASSWRD == cid).FirstOrDefault().Cempid;
            viewModelEvalwithother.c1 = _context.Cemps.Where(xx => xx.CEMPPASSWRD == cid).FirstOrDefault().CEMPNAME;
            viewModelEvalwithother.c2 = _context.Cemps.Where(xx => xx.CEMPPASSWRD == cid).FirstOrDefault().CEMPJOBNAME;
            viewModelEvalwithother.c3 = _context.Cemps.Where(xx => xx.CEMPPASSWRD == cid).FirstOrDefault().grade;
            viewModelEvalwithother.c4 = _context.Cemps.Where(xx => xx.CEMPPASSWRD == cid).FirstOrDefault().CLSSNO;
            viewModelEvalwithother.c5 = _context.Cemps.Where(xx => xx.CEMPPASSWRD == cid).FirstOrDefault().DEP_NAME;
            viewModelEvalwithother.c6 = _context.Cemps.Where(xx => xx.CEMPPASSWRD == cid).FirstOrDefault().PARENTNAME;
            viewModelEvalwithother.c7 = Convert.ToDateTime(_context.Cemps.Where(xx => xx.CEMPPASSWRD == cid).FirstOrDefault().CEMPHIRINGDATEHIJRA).ToShortDateString();
            viewModelEvalwithother.c8 = Convert.ToDateTime(_context.Cemps.Where(xx => xx.CEMPPASSWRD == cid).FirstOrDefault().CEMPLASTUPGRADEHIJRA).ToShortDateString();
            viewModelEvalwithother.c10 = _context.Members.Where(xx => xx.userid == cid && xx.commitedescession == cust.CEMPNO && xx.announce == cust.CEMPPASSWRD1).FirstOrDefault().commitedescession;
            viewModelEvalwithother.c11 = _context.Members.Where(xx => xx.userid == cid && xx.commitedescession == cust.CEMPNO && xx.announce == cust.CEMPPASSWRD1).FirstOrDefault().announce;
            //viewModelEvalwithother.c12 = _context.Members.Where(xx => xx.userid == cid && xx.status == 0).FirstOrDefault().dateexcute.Value.ToShortDateString().ToString();
            //viewModelEvalwithother.c13 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD;
            //int id = Convert.ToInt32(cust.Id);
            //ViewModelEvalwithother customer = new ViewModelEvalwithother();
            //customer.Id = id;
            //customer.Name = GetCustomers(id).FirstOrDefault().Name;
            //customer.Country = GetCustomers(id).FirstOrDefault().Country;
            //customer.Customers = GetCustomers(null);
            return Json(viewModelEvalwithother);
        }
<<<<<<< HEAD
        public JsonResult EditCustomer1v([FromBody] Cemp cust, [FromBody] ViewModelEvalwithother ViewModelEvalwithother, string EncryptedId, string Id, string Cempid)
        {

            String cid = _protector.Unprotect(cust.EncryptedId);
            //String cid = "4281001";
            if (cid == null)
            {
                //return NotFound();
            }
            ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            //viewModelEvalwithother.c0 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().Cempid;
            //viewModelEvalwithother.c1 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPNAME;
            //viewModelEvalwithother.c2 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPJOBNAME;
            //viewModelEvalwithother.c3 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().grade;
            //viewModelEvalwithother.c4 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CLSSNO;
            //viewModelEvalwithother.c5 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().DEP_NAME;
            //viewModelEvalwithother.c6 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().PARENTNAME;
            //viewModelEvalwithother.c7 = Convert.ToDateTime(_context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPHIRINGDATEHIJRA).ToShortDateString();
            //viewModelEvalwithother.c8 = Convert.ToDateTime(_context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPLASTUPGRADEHIJRA).ToShortDateString();
            //viewModelEvalwithother.c10 = _context.Members.Where(xx => xx.userid == _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD && xx.commitedescession == cust.CEMPNO && xx.announce == cust.CEMPPASSWRD1).FirstOrDefault().commitedescession;
            //viewModelEvalwithother.c11 = _context.Members.Where(xx => xx.userid == _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD && xx.commitedescession == cust.CEMPNO && xx.announce == cust.CEMPPASSWRD1).FirstOrDefault().announce;
            //viewModelEvalwithother.c12 = _context.Members.Where(xx => xx.userid == _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD).FirstOrDefault().dateexcute.Value.ToShortDateString().ToString();
            //viewModelEvalwithother.c13 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD;
            viewModelEvalwithother.c13 =Convert.ToString( _context.AEvaluationEmps.Where(X=>X.Idd==Convert.ToInt32(cid)).FirstOrDefault().Idd);
            //int id = Convert.ToInt32(cust.Id);
            //ViewModelEvalwithother customer = new ViewModelEvalwithother();
            //customer.Id = id;
            //customer.Name = GetCustomers(id).FirstOrDefault().Name;
            //customer.Country = GetCustomers(id).FirstOrDefault().Country;
            //customer.Customers = GetCustomers(null);
            return Json(viewModelEvalwithother);
        }
        public JsonResult EditCustomer1v0([FromBody] Cemp cust, [FromBody] ViewModelEvalwithother ViewModelEvalwithother, string EncryptedId, string Id, string Cempid)
        {

            String cid = _protector.Unprotect(cust.EncryptedId);
            //String cid = "4281001";
            if (cid == null)
            {
                //return NotFound();
            }
            ViewModelEvalwithother viewModelEvalwithother = new ViewModelEvalwithother();
            //viewModelEvalwithother.c0 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().Cempid;
            //viewModelEvalwithother.c1 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPNAME;
            //viewModelEvalwithother.c2 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPJOBNAME;
            //viewModelEvalwithother.c3 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().grade;
            //viewModelEvalwithother.c4 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CLSSNO;
            //viewModelEvalwithother.c5 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().DEP_NAME;
            //viewModelEvalwithother.c6 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().PARENTNAME;
            //viewModelEvalwithother.c7 = Convert.ToDateTime(_context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPHIRINGDATEHIJRA).ToShortDateString();
            //viewModelEvalwithother.c8 = Convert.ToDateTime(_context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPLASTUPGRADEHIJRA).ToShortDateString();
            //viewModelEvalwithother.c10 = _context.Members.Where(xx => xx.userid == _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD && xx.commitedescession == cust.CEMPNO && xx.announce == cust.CEMPPASSWRD1).FirstOrDefault().commitedescession;
            //viewModelEvalwithother.c11 = _context.Members.Where(xx => xx.userid == _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD && xx.commitedescession == cust.CEMPNO && xx.announce == cust.CEMPPASSWRD1).FirstOrDefault().announce;
            //viewModelEvalwithother.c12 = _context.Members.Where(xx => xx.userid == _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD).FirstOrDefault().dateexcute.Value.ToShortDateString().ToString();
            //viewModelEvalwithother.c13 = _context.Cemps.Where(xx => xx.Cempid == cid).FirstOrDefault().CEMPPASSWRD;
            viewModelEvalwithother.c13 = Convert.ToString(_context.AEvaluationEmps.Where(X => X.Idd == Convert.ToInt32(cid)).FirstOrDefault().Idd);
            //int id = Convert.ToInt32(cust.Id);
            //ViewModelEvalwithother customer = new ViewModelEvalwithother();
            //customer.Id = id;
            //customer.Name = GetCustomers(id).FirstOrDefault().Name;
            //customer.Country = GetCustomers(id).FirstOrDefault().Country;
            //customer.Customers = GetCustomers(null);
            return Json(viewModelEvalwithother);
        }
=======
>>>>>>> 5e413685df04d775df33e2d553756a01df850c9b
        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Edit(ViewModelEvalwithother1 ViewModelEvalwithother1)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            //if (ViewModelEvalwithother1.AEvaluationEmpIdd == null)
            //{
            //    return NotFound();
            //}

            if (ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight5 == null)
            {
                ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight5 = 0;
            }
            if (ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight6 == null)
            {
                ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight6 = 0;
            }
            if ((ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight1 + ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight2 + ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight3 + ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight4 + ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight5 + ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight6) != 100)
            {

                ViewBag.msg = "مجموع الوزن النسبي للاهداف لايساوي 100  ";
                return View();
            }
            // check for privilage to gadara 
            var emppriv = _context.Cemps.Where(x => x.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
            if (emppriv.CROLEID == 3 && ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7 != null)
            {
                ViewBag.msg = "عذرا جدارة القيادة للوظائف الاشرافيه فقط  ";
                return View();
            }
            if (emppriv.CROLEID == 5 && ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7 != null)
            {
                ViewBag.msg = "عذرا جدارة القيادة للوظائف الاشرافيه فقط  ";
                return View();
            }
            // check for gadara count
            if (ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7 == null)
            {
                ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7 = "0";
            }
            if (Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight1) + Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight2) + Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight3) + Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight4) + Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight5) + Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight6) + Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7) != 100)
            {
                ViewBag.msg = "مجموع الوزن النسبي للجدارات لايساوي 100  ";
                return View();
            }
            //if (ViewModelEvalwithother1.AEvaluationEmpEmpno == null)
            //{
            //    ViewBag.msg = "يرجي اختيار اسم الموظف من القائمة   ";
            //    return View();
            //}

            List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == ViewModelEvalwithother1.AEvaluationEmpIdd).ToList();
            av1 = vAEvaluationGoals[0];
            av2 = vAEvaluationGoals[1];
            av3 = vAEvaluationGoals[2];
            av4 = vAEvaluationGoals[3];
            if (vAEvaluationGoals.Count >4)
            {
                av5 = vAEvaluationGoals[4];

            }
            if (vAEvaluationGoals.Count >5)
            {
                av6 = vAEvaluationGoals[5];
            }
            
            av1.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
            av1.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName1;
            av1.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria1;
            av1.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight1;
            av1.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput1;
            av2.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
            av2.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName2;
            av2.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria2;
            av2.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight2;
            av2.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput2;
            av3.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
            av3.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName3;
            av3.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria3;
            av3.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight3;
            av3.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput3;
            av4.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
            av4.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName4;
            av4.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria4;
            av4.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight4;
            av4.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput4;
            if (vAEvaluationGoals.Count > 4)
            {
                av5.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
                av5.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName5;
                av5.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria5;
                av5.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight5;
                av5.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput5;
            }
            if (vAEvaluationGoals.Count >5)
            {
                av6.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
                av6.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName6;
                av6.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria6;
                av6.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight6;
                av6.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput6;
            }
            List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == ViewModelEvalwithother1.AEvaluationEmpIdd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            am1 = vAEvaluationCompetenciesMs[0];
            am2 = vAEvaluationCompetenciesMs[1];
            am3 = vAEvaluationCompetenciesMs[2];
            am4 = vAEvaluationCompetenciesMs[3];
            am5 = vAEvaluationCompetenciesMs[4];
            am6 = vAEvaluationCompetenciesMs[5];
            if (vAEvaluationCompetenciesMs.Count > 6)
            {
                am7 = vAEvaluationCompetenciesMs[6];
            }
            //am7 = vAEvaluationCompetenciesMs[6];
            am1.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight1;
            am2.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight2;
            am3.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight3;
            am4.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight4;
            am5.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight5;
            am6.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight6;
            if (vAEvaluationCompetenciesMs.Count > 6)
            {

             am7.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7;
            }
            List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == ViewModelEvalwithother1.AEvaluationEmpIdd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            ad1 = vAEvaluationCompetenciesDs[0];
            ad2 = vAEvaluationCompetenciesDs[1];
            ad3 = vAEvaluationCompetenciesDs[2];
            ad4 = vAEvaluationCompetenciesDs[3];
            ad5 = vAEvaluationCompetenciesDs[4];
            ad6 = vAEvaluationCompetenciesDs[5];
            ad7 = vAEvaluationCompetenciesDs[6];
            ad8 = vAEvaluationCompetenciesDs[7];
            ad9 = vAEvaluationCompetenciesDs[8];
            ad10 = vAEvaluationCompetenciesDs[9];
            ad11 = vAEvaluationCompetenciesDs[10];
            ad12 = vAEvaluationCompetenciesDs[11];
            ad13 = vAEvaluationCompetenciesDs[12];
            ad14 = vAEvaluationCompetenciesDs[13];
            ad15 = vAEvaluationCompetenciesDs[14];
            ad16 = vAEvaluationCompetenciesDs[15];
            ad17 = vAEvaluationCompetenciesDs[16];
            ad18 = vAEvaluationCompetenciesDs[17];
            if (vAEvaluationCompetenciesDs.Count > 18)
            {
                ad19 = vAEvaluationCompetenciesDs[18];
                ad20 = vAEvaluationCompetenciesDs[19];
                ad21 = vAEvaluationCompetenciesDs[20];
                ad22 = vAEvaluationCompetenciesDs[21];
                ad23 = vAEvaluationCompetenciesDs[22];
            }
            ad1.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel1;
            ad2.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel2;
            ad3.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel3;
            ad4.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel4;
            ad5.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel5;
            ad6.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel6;
            ad7.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel7;
            ad8.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel8;
            ad9.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel9;
            ad10.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel10;
            ad11.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel11;
            ad12.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel12;
            ad13.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel13;
            ad14.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel14;
            ad15.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel15;
            ad16.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel16;
            ad17.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel17;
            ad18.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel18;
            if (vAEvaluationCompetenciesDs.Count > 18)
            {
                ad19.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel19;
                ad20.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel20;
                ad21.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel21;
                ad22.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel22;
                ad23.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel23;
            }
            //if (ModelState.IsValid)
            //{
            // create log 
            Aevallog aevallog = new Aevallog()
            {
                Editdate=DateTime.Now,
                Useredit= HttpContext.Session.GetString("username"),
                Evid=Convert.ToString(ViewModelEvalwithother1.AEvaluationGoalCovenantId)

            };
            _context.Add(aevallog);

              
                _context.Update(av1);
                _context.Update(av2);
                _context.Update(av3);
                _context.Update(av4);
            if (vAEvaluationGoals.Count >4)
            {
                _context.Update(av5);
                // create new goal like in edit for form 

            }
            if (vAEvaluationGoals.Count >5)
            {
                _context.Update(av6);
            }
            if (ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName5 != null&& vAEvaluationGoals.Count ==4)
            {
                AEvaluationGoal aEvaluationGoal5 = new AEvaluationGoal { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, EmpType = "مدير", CovenantGoalsSeq = 5, CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName5, CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria5, CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight5, CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput5, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId, CovenantDate = DateTime.Now, EvaluationActualOutput = null, EvaluationDate = null, EvaluationDifferenceOutputs = null, EvaluationEquilibrium = null, EvaluationId = null, EvaluationResult = null, EvaluationTotal = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantWeightSum = 100, EmpIdEnter = Convert.ToInt32(HttpContext.Session.GetString("empid")) };
                _context.Add(aEvaluationGoal5);

            }
            if (ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName6 != null && vAEvaluationGoals.Count == 5)
            {
                AEvaluationGoal aEvaluationGoal6 = new AEvaluationGoal { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, EmpType = "مدير", CovenantGoalsSeq = 6, CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName6, CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria6, CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight6, CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput6, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId, CovenantDate = DateTime.Now, EvaluationActualOutput = null, EvaluationDate = null, EvaluationDifferenceOutputs = null, EvaluationEquilibrium = null, EvaluationId = null, EvaluationResult = null, EvaluationTotal = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantWeightSum = 100, EmpIdEnter = Convert.ToInt32(HttpContext.Session.GetString("empid")) };
                _context.Add(aEvaluationGoal6);

            }

                _context.Update(am1);
                _context.Update(am2);
                _context.Update(am3);
                _context.Update(am4);
                _context.Update(am5);
            if (vAEvaluationCompetenciesMs.Count > 6)
            {
                _context.Update(am7);
            }
            if (ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7!=null&& vAEvaluationCompetenciesMs.Count ==6)
            {
                AEvaluationCompetenciesM aEvaluationCompetenciesM7 = new AEvaluationCompetenciesM { CovenantCompetenciesSeq = 7, CovenantCompetencyName = "القيادة", CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7, EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantWeightSum = 100, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                _context.Add(aEvaluationCompetenciesM7);
            }

                _context.Update(ad1);
                _context.Update(ad2);
                _context.Update(ad3);
                _context.Update(ad4);
                _context.Update(ad5);

                _context.Update(ad6);
                _context.Update(ad7);
                _context.Update(ad8);
                _context.Update(ad9);
                _context.Update(ad10);
                _context.Update(ad11);

                _context.Update(ad12);
                _context.Update(ad13);
                _context.Update(ad14);
                _context.Update(ad15);
                _context.Update(ad16);
                _context.Update(ad17);
                _context.Update(ad18);
            if (vAEvaluationCompetenciesDs.Count > 18)
            {
                _context.Update(ad19);
                _context.Update(ad20);
                _context.Update(ad21);
                _context.Update(ad22);
                _context.Update(ad23);


            }
            if (ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel19 != null&& vAEvaluationCompetenciesDs.Count ==18)
            {
                AEvaluationCompetenciesD aEvaluationCompetenciesD19 = new AEvaluationCompetenciesD { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantCompetenciesDSeq = 7, CovenantCompetenciesDDesc = "مرن وقادر على تنفيذ أعمال هامة فى ظروف تنطوى على قدر كبير من المخاطرة وعدم اليقين .", CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel19, EvaluationOutputCompetency = null, EvaluationResults = null, EvaluationTotal = null, CovenantCompetenciesDSeqD = 1, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                AEvaluationCompetenciesD aEvaluationCompetenciesD20 = new AEvaluationCompetenciesD { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantCompetenciesDSeq = 7, CovenantCompetenciesDDesc = "يدعم و يشجع فريقه على تحقيق اهدافه، حتى في الظروف الصعبة  .", CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel20, EvaluationOutputCompetency = null, EvaluationResults = null, EvaluationTotal = null, CovenantCompetenciesDSeqD = 2, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                AEvaluationCompetenciesD aEvaluationCompetenciesD21 = new AEvaluationCompetenciesD { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantCompetenciesDSeq = 7, CovenantCompetenciesDDesc = "يفكر بمنطقية و ابداع دون التأثر بتحيزاته الشخصية.", CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel21, EvaluationOutputCompetency = null, EvaluationResults = null, EvaluationTotal = null, CovenantCompetenciesDSeqD = 3, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                AEvaluationCompetenciesD aEvaluationCompetenciesD22 = new AEvaluationCompetenciesD { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantCompetenciesDSeq = 7, CovenantCompetenciesDDesc = "يفوض الصلاحيات و يتابع النتائج  .", CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel22, EvaluationOutputCompetency = null, EvaluationResults = null, EvaluationTotal = null, CovenantCompetenciesDSeqD = 4, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                AEvaluationCompetenciesD aEvaluationCompetenciesD23 = new AEvaluationCompetenciesD { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantCompetenciesDSeq = 7, CovenantCompetenciesDDesc = "يوفر ويدعم فرص تطوير المرؤوسين.", CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel23, EvaluationOutputCompetency = null, EvaluationResults = null, EvaluationTotal = null, CovenantCompetenciesDSeqD = 5, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                
                _context.Add(aEvaluationCompetenciesD19);
                _context.Add(aEvaluationCompetenciesD20);
                _context.Add(aEvaluationCompetenciesD21);
                _context.Add(aEvaluationCompetenciesD22);
                _context.Add(aEvaluationCompetenciesD23);
            }



            _context.SaveChanges();





                return RedirectToAction(nameof(Search1));
            //}
            return View(ViewModelEvalwithother1);



        }



        // get 
        public ActionResult Edit1(string? id)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");

            String cid = _protector.Unprotect(id);
            if (cid == null)
            {
                return NotFound();
            }
            

            var vAEvaluationEmps1 = _context.AEvaluationEmps.Where(d => d.Idd ==Convert.ToInt32(cid)).FirstOrDefault();
            //var  vAEvaluationGoals1 = _context.AEvaluationGoals.Where(d => d.CovenantId == id).OrderBy(d => d.CovenantGoalsSeq).FirstOrDefault();
            List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == vAEvaluationEmps1.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
            av1 = vAEvaluationGoals[0];
            av2 = vAEvaluationGoals[1];
            av3 = vAEvaluationGoals[2];
            av4 = vAEvaluationGoals[3];
            if (vAEvaluationGoals.Count > 4)
            {
                av5 = vAEvaluationGoals[4];

            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6 = vAEvaluationGoals[5];
            }
            List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == vAEvaluationEmps1.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            am1 = vAEvaluationCompetenciesMs[0];
            am2 = vAEvaluationCompetenciesMs[1];
            am3 = vAEvaluationCompetenciesMs[2];
            am4 = vAEvaluationCompetenciesMs[3];
            am5 = vAEvaluationCompetenciesMs[4];
            am6 = vAEvaluationCompetenciesMs[5];
            if (vAEvaluationCompetenciesMs.Count > 6)
            {

                am7 = vAEvaluationCompetenciesMs[6];
            }

            List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == vAEvaluationEmps1.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            ad1 = vAEvaluationCompetenciesDs[0];
            ad2 = vAEvaluationCompetenciesDs[1];
            ad3 = vAEvaluationCompetenciesDs[2];
            ad4 = vAEvaluationCompetenciesDs[3];
            ad5 = vAEvaluationCompetenciesDs[4];
            ad6 = vAEvaluationCompetenciesDs[5];
            ad7 = vAEvaluationCompetenciesDs[6];
            ad8 = vAEvaluationCompetenciesDs[7];
            ad9 = vAEvaluationCompetenciesDs[8];
            ad10 = vAEvaluationCompetenciesDs[9];
            ad11 = vAEvaluationCompetenciesDs[10];
            ad12 = vAEvaluationCompetenciesDs[11];
            ad13 = vAEvaluationCompetenciesDs[12];
            ad14 = vAEvaluationCompetenciesDs[13];
            ad15 = vAEvaluationCompetenciesDs[14];
            ad16 = vAEvaluationCompetenciesDs[15];
            ad17 = vAEvaluationCompetenciesDs[16];
            ad18 = vAEvaluationCompetenciesDs[17];
            if (vAEvaluationCompetenciesDs.Count > 18)
            {

                ad19 = vAEvaluationCompetenciesDs[18];
                ad20 = vAEvaluationCompetenciesDs[19];
                ad21 = vAEvaluationCompetenciesDs[20];
                ad22 = vAEvaluationCompetenciesDs[21];
                ad23 = vAEvaluationCompetenciesDs[22];
            }
            if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }


            return View();
            //return View(ViewModelEvalwithother1);
        }




        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Edit1(ViewModelEvalwithother1 ViewModelEvalwithother1)
        {
            if(HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            //if (ViewModelEvalwithother1.AEvaluationEmpIdd == null)
            //{
            //    return NotFound();
            //}
            if (ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight5 == null)
            {
                ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight5 = 0;
            }
            if (ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight6 == null)
            {
                ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight6 = 0;
            }
            if ((ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight1 + ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight2 + ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight3 + ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight4 + ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight5 + ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight6) != 100)
            {

                ViewBag.msg = "مجموع الوزن النسبي للاهداف لايساوي 100  ";
                return View();
            }
            // check for privilage to gadara 
            var emppriv = _context.Cemps.Where(x => x.Cempid == HttpContext.Session.GetString("username")).FirstOrDefault();
            if (emppriv.CROLEID == 3 && ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7 != null)
            {
                ViewBag.msg = "عذرا جدارة القيادة للوظائف الاشرافيه فقط  ";
                return View();
            }
            if (emppriv.CROLEID == 5 && ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7 != null)
            {
                ViewBag.msg = "عذرا جدارة القيادة للوظائف الاشرافيه فقط  ";
                return View();
            }
            // check for gadara count
            if (ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7 == null)
            {
                ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7 = "0";
            }
            if (Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight1) + Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight2) + Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight3) + Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight4) + Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight5) + Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight6) + Convert.ToDouble(ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7) != 100)
            {
                ViewBag.msg = "مجموع الوزن النسبي للجدارات لايساوي 100  ";
                return View();
            }
            //if (ViewModelEvalwithother1.AEvaluationEmpEmpno == null)
            //{
            //    ViewBag.msg = "يرجي اختيار اسم الموظف من القائمة   ";
            //    return View();
            //}
            List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == ViewModelEvalwithother1.AEvaluationEmpIdd).ToList();
            av1 = vAEvaluationGoals[0];
            av2 = vAEvaluationGoals[1];
            av3 = vAEvaluationGoals[2];
            av4 = vAEvaluationGoals[3];
            if (vAEvaluationGoals.Count > 4)
            {
                av5 = vAEvaluationGoals[4];

            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6 = vAEvaluationGoals[5];
            }

            av1.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
            av1.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName1;
            av1.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria1;
            av1.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight1;
            av1.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput1;
            av2.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
            av2.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName2;
            av2.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria2;
            av2.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight2;
            av2.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput2;
            av3.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
            av3.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName3;
            av3.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria3;
            av3.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight3;
            av3.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput3;
            av4.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
            av4.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName4;
            av4.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria4;
            av4.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight4;
            av4.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput4;
            if (vAEvaluationGoals.Count > 4)
            {
                av5.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
                av5.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName5;
                av5.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria5;
                av5.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight5;
                av5.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput5;
            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
                av6.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName6;
                av6.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria6;
                av6.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight6;
                av6.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput6;
            }
            List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == ViewModelEvalwithother1.AEvaluationEmpIdd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            am1 = vAEvaluationCompetenciesMs[0];
            am2 = vAEvaluationCompetenciesMs[1];
            am3 = vAEvaluationCompetenciesMs[2];
            am4 = vAEvaluationCompetenciesMs[3];
            am5 = vAEvaluationCompetenciesMs[4];
            am6 = vAEvaluationCompetenciesMs[5];
            if (vAEvaluationCompetenciesMs.Count > 6)
            {
                am7 = vAEvaluationCompetenciesMs[6];
            }
            //am7 = vAEvaluationCompetenciesMs[6];
            am1.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight1;
            am2.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight2;
            am3.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight3;
            am4.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight4;
            am5.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight5;
            am6.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight6;
            if (vAEvaluationCompetenciesMs.Count > 6)
            {

                am7.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7;
            }
            List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == ViewModelEvalwithother1.AEvaluationEmpIdd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            ad1 = vAEvaluationCompetenciesDs[0];
            ad2 = vAEvaluationCompetenciesDs[1];
            ad3 = vAEvaluationCompetenciesDs[2];
            ad4 = vAEvaluationCompetenciesDs[3];
            ad5 = vAEvaluationCompetenciesDs[4];
            ad6 = vAEvaluationCompetenciesDs[5];
            ad7 = vAEvaluationCompetenciesDs[6];
            ad8 = vAEvaluationCompetenciesDs[7];
            ad9 = vAEvaluationCompetenciesDs[8];
            ad10 = vAEvaluationCompetenciesDs[9];
            ad11 = vAEvaluationCompetenciesDs[10];
            ad12 = vAEvaluationCompetenciesDs[11];
            ad13 = vAEvaluationCompetenciesDs[12];
            ad14 = vAEvaluationCompetenciesDs[13];
            ad15 = vAEvaluationCompetenciesDs[14];
            ad16 = vAEvaluationCompetenciesDs[15];
            ad17 = vAEvaluationCompetenciesDs[16];
            ad18 = vAEvaluationCompetenciesDs[17];
            if (vAEvaluationCompetenciesDs.Count > 18)
            {
                ad19 = vAEvaluationCompetenciesDs[18];
                ad20 = vAEvaluationCompetenciesDs[19];
                ad21 = vAEvaluationCompetenciesDs[20];
                ad22 = vAEvaluationCompetenciesDs[21];
                ad23 = vAEvaluationCompetenciesDs[22];
            }
            ad1.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel1;
            ad2.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel2;
            ad3.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel3;
            ad4.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel4;
            ad5.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel5;
            ad6.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel6;
            ad7.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel7;
            ad8.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel8;
            ad9.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel9;
            ad10.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel10;
            ad11.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel11;
            ad12.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel12;
            ad13.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel13;
            ad14.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel14;
            ad15.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel15;
            ad16.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel16;
            ad17.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel17;
            ad18.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel18;
            if (vAEvaluationCompetenciesDs.Count > 18)
            {
                ad19.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel19;
                ad20.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel20;
                ad21.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel21;
                ad22.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel22;
                ad23.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel23;
            }
            //if (ModelState.IsValid)
            //{
            // create log 
            Aevallog aevallog = new Aevallog()
            {
                Editdate = DateTime.Now,
                Useredit = HttpContext.Session.GetString("username"),
                Evid = Convert.ToString(ViewModelEvalwithother1.AEvaluationGoalCovenantId)

            };
            _context.Add(aevallog);


            _context.Update(av1);
            _context.Update(av2);
            _context.Update(av3);
            _context.Update(av4);
            if (vAEvaluationGoals.Count > 4)
            {
                _context.Update(av5);
                // create new goal like in edit for form 

            }
            if (vAEvaluationGoals.Count > 5)
            {
                _context.Update(av6);
            }
            if (ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName5 != null && vAEvaluationGoals.Count == 4)
            {
                AEvaluationGoal aEvaluationGoal5 = new AEvaluationGoal { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, EmpType = "مدير", CovenantGoalsSeq = 5, CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName5, CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria5, CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight5, CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput5, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId, CovenantDate = DateTime.Now, EvaluationActualOutput = null, EvaluationDate = null, EvaluationDifferenceOutputs = null, EvaluationEquilibrium = null, EvaluationId = null, EvaluationResult = null, EvaluationTotal = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantWeightSum = 100, EmpIdEnter = Convert.ToInt32(HttpContext.Session.GetString("empid")) };
                _context.Add(aEvaluationGoal5);

            }
            if (ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName6 != null && vAEvaluationGoals.Count == 5)
            {
                AEvaluationGoal aEvaluationGoal6 = new AEvaluationGoal { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, EmpType = "مدير", CovenantGoalsSeq = 6, CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName6, CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria6, CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight6, CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput6, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId, CovenantDate = DateTime.Now, EvaluationActualOutput = null, EvaluationDate = null, EvaluationDifferenceOutputs = null, EvaluationEquilibrium = null, EvaluationId = null, EvaluationResult = null, EvaluationTotal = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantWeightSum = 100, EmpIdEnter = Convert.ToInt32(HttpContext.Session.GetString("empid")) };
                _context.Add(aEvaluationGoal6);

            }

            _context.Update(am1);
            _context.Update(am2);
            _context.Update(am3);
            _context.Update(am4);
            _context.Update(am5);
            if (vAEvaluationCompetenciesMs.Count > 6)
            {
                _context.Update(am7);
            }
            if (ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7 != null && vAEvaluationCompetenciesMs.Count == 6)
            {
                AEvaluationCompetenciesM aEvaluationCompetenciesM7 = new AEvaluationCompetenciesM { CovenantCompetenciesSeq = 7, CovenantCompetencyName = "القيادة", CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7, EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantWeightSum = 100, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                _context.Add(aEvaluationCompetenciesM7);
            }

            _context.Update(ad1);
            _context.Update(ad2);
            _context.Update(ad3);
            _context.Update(ad4);
            _context.Update(ad5);

            _context.Update(ad6);
            _context.Update(ad7);
            _context.Update(ad8);
            _context.Update(ad9);
            _context.Update(ad10);
            _context.Update(ad11);

            _context.Update(ad12);
            _context.Update(ad13);
            _context.Update(ad14);
            _context.Update(ad15);
            _context.Update(ad16);
            _context.Update(ad17);
            _context.Update(ad18);
            if (vAEvaluationCompetenciesDs.Count > 18)
            {
                _context.Update(ad19);
                _context.Update(ad20);
                _context.Update(ad21);
                _context.Update(ad22);
                _context.Update(ad23);


            }
            if (ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel19 != null && vAEvaluationCompetenciesDs.Count == 18)
            {
                AEvaluationCompetenciesD aEvaluationCompetenciesD19 = new AEvaluationCompetenciesD { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantCompetenciesDSeq = 7, CovenantCompetenciesDDesc = "مرن وقادر على تنفيذ أعمال هامة فى ظروف تنطوى على قدر كبير من المخاطرة وعدم اليقين .", CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel19, EvaluationOutputCompetency = null, EvaluationResults = null, EvaluationTotal = null, CovenantCompetenciesDSeqD = 1, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                AEvaluationCompetenciesD aEvaluationCompetenciesD20 = new AEvaluationCompetenciesD { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantCompetenciesDSeq = 7, CovenantCompetenciesDDesc = "يدعم و يشجع فريقه على تحقيق اهدافه، حتى في الظروف الصعبة  .", CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel20, EvaluationOutputCompetency = null, EvaluationResults = null, EvaluationTotal = null, CovenantCompetenciesDSeqD = 2, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                AEvaluationCompetenciesD aEvaluationCompetenciesD21 = new AEvaluationCompetenciesD { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantCompetenciesDSeq = 7, CovenantCompetenciesDDesc = "يفكر بمنطقية و ابداع دون التأثر بتحيزاته الشخصية.", CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel21, EvaluationOutputCompetency = null, EvaluationResults = null, EvaluationTotal = null, CovenantCompetenciesDSeqD = 3, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                AEvaluationCompetenciesD aEvaluationCompetenciesD22 = new AEvaluationCompetenciesD { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantCompetenciesDSeq = 7, CovenantCompetenciesDDesc = "يفوض الصلاحيات و يتابع النتائج  .", CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel22, EvaluationOutputCompetency = null, EvaluationResults = null, EvaluationTotal = null, CovenantCompetenciesDSeqD = 4, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                AEvaluationCompetenciesD aEvaluationCompetenciesD23 = new AEvaluationCompetenciesD { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantCompetenciesDSeq = 7, CovenantCompetenciesDDesc = "يوفر ويدعم فرص تطوير المرؤوسين.", CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel23, EvaluationOutputCompetency = null, EvaluationResults = null, EvaluationTotal = null, CovenantCompetenciesDSeqD = 5, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };

                _context.Add(aEvaluationCompetenciesD19);
                _context.Add(aEvaluationCompetenciesD20);
                _context.Add(aEvaluationCompetenciesD21);
                _context.Add(aEvaluationCompetenciesD22);
                _context.Add(aEvaluationCompetenciesD23);
            }



            _context.SaveChanges();





            return RedirectToAction(nameof(IndexOffered3));
            //}
            return View(ViewModelEvalwithother1);



        }


        // get 
        public ActionResult Edit11(string? id)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");

            String cid = _protector.Unprotect(id);
            if (cid == null)
            {
                return NotFound();
            }


            var vAEvaluationEmps1 = _context.AEvaluationEmps.Where(d => d.Idd == Convert.ToInt32(cid)).FirstOrDefault();
            //var  vAEvaluationGoals1 = _context.AEvaluationGoals.Where(d => d.CovenantId == id).OrderBy(d => d.CovenantGoalsSeq).FirstOrDefault();
            List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == vAEvaluationEmps1.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
            av1 = vAEvaluationGoals[0];
            av2 = vAEvaluationGoals[1];
            av3 = vAEvaluationGoals[2];
            av4 = vAEvaluationGoals[3];
            if (vAEvaluationGoals.Count > 4)
            {
                av5 = vAEvaluationGoals[4];

            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6 = vAEvaluationGoals[5];
            }
            List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == vAEvaluationEmps1.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            am1 = vAEvaluationCompetenciesMs[0];
            am2 = vAEvaluationCompetenciesMs[1];
            am3 = vAEvaluationCompetenciesMs[2];
            am4 = vAEvaluationCompetenciesMs[3];
            am5 = vAEvaluationCompetenciesMs[4];
            am6 = vAEvaluationCompetenciesMs[5];
            if (vAEvaluationCompetenciesMs.Count > 6)
            {

                am7 = vAEvaluationCompetenciesMs[6];
            }

            List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == vAEvaluationEmps1.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            ad1 = vAEvaluationCompetenciesDs[0];
            ad2 = vAEvaluationCompetenciesDs[1];
            ad3 = vAEvaluationCompetenciesDs[2];
            ad4 = vAEvaluationCompetenciesDs[3];
            ad5 = vAEvaluationCompetenciesDs[4];
            ad6 = vAEvaluationCompetenciesDs[5];
            ad7 = vAEvaluationCompetenciesDs[6];
            ad8 = vAEvaluationCompetenciesDs[7];
            ad9 = vAEvaluationCompetenciesDs[8];
            ad10 = vAEvaluationCompetenciesDs[9];
            ad11 = vAEvaluationCompetenciesDs[10];
            ad12 = vAEvaluationCompetenciesDs[11];
            ad13 = vAEvaluationCompetenciesDs[12];
            ad14 = vAEvaluationCompetenciesDs[13];
            ad15 = vAEvaluationCompetenciesDs[14];
            ad16 = vAEvaluationCompetenciesDs[15];
            ad17 = vAEvaluationCompetenciesDs[16];
            ad18 = vAEvaluationCompetenciesDs[17];
            if (vAEvaluationCompetenciesDs.Count > 18)
            {

                ad19 = vAEvaluationCompetenciesDs[18];
                ad20 = vAEvaluationCompetenciesDs[19];
                ad21 = vAEvaluationCompetenciesDs[20];
                ad22 = vAEvaluationCompetenciesDs[21];
                ad23 = vAEvaluationCompetenciesDs[22];
            }
            if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }


            return View();
            //return View(ViewModelEvalwithother1);
        }




        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Edit11(ViewModelEvalwithother1 ViewModelEvalwithother1)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            //if (ViewModelEvalwithother1.AEvaluationEmpIdd == null)
            //{
            //    return NotFound();
            //}
            var vAEvaluationEmps11 = _context.AEvaluationEmps.Where(d => d.Idd == ViewModelEvalwithother1.AEvaluationEmpIdd).FirstOrDefault();
            List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == ViewModelEvalwithother1.AEvaluationEmpIdd).ToList();
            av1 = vAEvaluationGoals[0];
            av2 = vAEvaluationGoals[1];
            av3 = vAEvaluationGoals[2];
            av4 = vAEvaluationGoals[3];
            if (vAEvaluationGoals.Count > 4)
            {
                av5 = vAEvaluationGoals[4];

            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6 = vAEvaluationGoals[5];
            }

            av1.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
            av1.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName1;
            av1.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria1;
            av1.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight1;
            av1.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput1;
            av1.EvaluationActualOutput = ViewModelEvalwithother1.AEvaluationGoalEvaluationActualOutput;
            av1.EvaluationDifferenceOutputs=(av1.EvaluationActualOutput - av1.CovenantTargetedOutput);
            double fc = Convert.ToDouble(av1.EvaluationActualOutput) / Convert.ToDouble(av1.CovenantTargetedOutput);
            if ( fc >1 )
            {
                av1.EvaluationEquilibrium = 5;
            }
            else if (fc >= 0.9 && fc <= 1 )
            {
                av1.EvaluationEquilibrium = 4;
            }
            else if (fc >= 0.8 &&  fc <0.9)
            {
                av1.EvaluationEquilibrium = 3;
            }
            else if (fc >= 0.6 && fc < 0.8)
            {
                av1.EvaluationEquilibrium = 2;
            }
            else if (fc < 0.6)
            {
                av1.EvaluationEquilibrium = 1;
            }
            av1.EvaluationResult = av1.EvaluationEquilibrium * av1.CovenantPercentageWeight;
            av2.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
            av2.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName2;
            av2.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria2;
            av2.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight2;
            av2.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput2;
            av2.EvaluationActualOutput = ViewModelEvalwithother1.AEvaluationGoalEvaluationActualOutput2;
            av2.EvaluationDifferenceOutputs = (av2.EvaluationActualOutput - av2.CovenantTargetedOutput);
            double fc2 = (double)(av2.EvaluationActualOutput / av2.CovenantTargetedOutput);
            if (fc2 > 1)
            {
                av2.EvaluationEquilibrium = 5;
            }
            else if (fc2 >= .9 && fc2 <= 1)
            {
                av2.EvaluationEquilibrium = 4;
            }
            else if (fc2 >= .8 && fc2 < .9)
            {
                av2.EvaluationEquilibrium = 3;
            }
            else if (fc2 >= .6 && fc2 < .8)
            {
                av2.EvaluationEquilibrium = 2;
            }
            else if (fc2 < .6)
            {
                av2.EvaluationEquilibrium = 1;
            }
            av2.EvaluationResult = av2.EvaluationEquilibrium * av2.CovenantPercentageWeight;
            av3.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
            av3.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName3;
            av3.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria3;
            av3.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight3;
            av3.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput3;
            av3.EvaluationActualOutput = ViewModelEvalwithother1.AEvaluationGoalEvaluationActualOutput3;
            av3.EvaluationDifferenceOutputs = (av3.EvaluationActualOutput - av3.CovenantTargetedOutput);
            double fc3 = (double)(av3.EvaluationActualOutput / av3.CovenantTargetedOutput);
            if (fc3 > 1)
            {
                av3.EvaluationEquilibrium = 5;
            }
            else if (fc3 >= .9 && fc3 <= 1)
            {
                av3.EvaluationEquilibrium = 4;
            }
            else if (fc3 >= .8 && fc3 < .9)
            {
                av3.EvaluationEquilibrium = 3;
            }
            else if (fc3 >= .6 && fc3 < .8)
            {
                av3.EvaluationEquilibrium = 2;
            }
            else if (fc3 < .6)
            {
                av3.EvaluationEquilibrium = 1;
            }
            av3.EvaluationResult = av3.EvaluationEquilibrium * av3.CovenantPercentageWeight;
            av4.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
            av4.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName4;
            av4.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria4;
            av4.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight4;
            av4.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput4;
            av4.EvaluationActualOutput = ViewModelEvalwithother1.AEvaluationGoalEvaluationActualOutput4;
            av4.EvaluationDifferenceOutputs = (av4.EvaluationActualOutput - av4.CovenantTargetedOutput);
            double fc4 = (double)(av4.EvaluationActualOutput / av4.CovenantTargetedOutput);
            if (fc4 > 1)
            {
                av4.EvaluationEquilibrium = 5;
            }
            else if (fc4 >= .9 && fc4 <= 1)
            {
                av4.EvaluationEquilibrium = 4;
            }
            else if (fc4 >= .8 && fc4 < .9)
            {
                av4.EvaluationEquilibrium = 3;
            }
            else if (fc4 >= .6 && fc4 < .8)
            {
                av4.EvaluationEquilibrium = 2;
            }
            else if (fc4 < .6)
            {
                av4.EvaluationEquilibrium = 1;
            }
            av4.EvaluationResult = av4.EvaluationEquilibrium * av4.CovenantPercentageWeight;
            av1.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult;
            av2.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult;
            av3.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult;
            av4.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult;
            if (vAEvaluationGoals.Count > 4)
            {
                av5.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
                av5.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName5;
                av5.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria5;
                av5.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight5;
                av5.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput5==null?0: ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput5;
                av5.EvaluationActualOutput = ViewModelEvalwithother1.AEvaluationGoalEvaluationActualOutput5==null? 0 : ViewModelEvalwithother1.AEvaluationGoalEvaluationActualOutput5;
                av5.EvaluationDifferenceOutputs = (av5.EvaluationActualOutput - av5.CovenantTargetedOutput);
                double fc5 = (double)(av5.EvaluationActualOutput / av5.CovenantTargetedOutput);
                av5.EvaluationEquilibrium = 0;
                if (fc5 > 1)
                {
                    av5.EvaluationEquilibrium = 5;
                }
                else if (fc5 >= .9 && fc5 <= 1)
                {
                    av5.EvaluationEquilibrium = 4;
                }
                else if (fc5 >= .8 && fc5 < .9)
                {
                    av5.EvaluationEquilibrium = 3;
                }
                else if (fc5 >= .6 && fc5 < .8)
                {
                    av5.EvaluationEquilibrium = 2;
                }
                else if (fc5 < .6)
                {
                    av5.EvaluationEquilibrium = 1;
                }
                av5.CovenantPercentageWeight = av5.CovenantPercentageWeight == null ? 0 : av5.CovenantPercentageWeight;
                av5.EvaluationResult = av5.EvaluationEquilibrium * av5.CovenantPercentageWeight;
                av1.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult+ av5.EvaluationResult;
                av2.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult+ av5.EvaluationResult;
                av3.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult+ av5.EvaluationResult;
                av4.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult+ av5.EvaluationResult;
                av5.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult + av5.EvaluationResult;

            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
                av6.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName6;
                av6.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria6;
                av6.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight6;
                av6.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput6==null?0: ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput6;
                av6.EvaluationActualOutput = ViewModelEvalwithother1.AEvaluationGoalEvaluationActualOutput6==null?0: ViewModelEvalwithother1.AEvaluationGoalEvaluationActualOutput6;
                av6.EvaluationDifferenceOutputs = (av6.EvaluationActualOutput - av6.CovenantTargetedOutput);
                double fc6 = (double)(av6.EvaluationActualOutput / av6.CovenantTargetedOutput);
                av6.EvaluationEquilibrium = 0;
                if (fc6 > 1)
                {
                    av6.EvaluationEquilibrium = 5;
                }
                else if (fc6 >= .9 && fc6 <= 1)
                {
                    av6.EvaluationEquilibrium = 4;
                }
                else if (fc6 >= .8 && fc6 < .9)
                {
                    av6.EvaluationEquilibrium = 3;
                }
                else if (fc6 >= .6 && fc6 < .8)
                {
                    av6.EvaluationEquilibrium = 2;
                }
                else if (fc6 < .6)
                {
                    av6.EvaluationEquilibrium = 1;
                }
                av6.CovenantPercentageWeight = av6.CovenantPercentageWeight == null ? 0 : av6.CovenantPercentageWeight;
                av6.EvaluationResult = av6.EvaluationEquilibrium * av6.CovenantPercentageWeight;
                av1.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult + av5.EvaluationResult+ av6.EvaluationResult;
                av2.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult + av5.EvaluationResult+ av6.EvaluationResult;
                av3.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult + av5.EvaluationResult+ av6.EvaluationResult;
                av4.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult + av5.EvaluationResult+ av6.EvaluationResult;
                av5.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult + av5.EvaluationResult+ av6.EvaluationResult;
                av6.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult + av5.EvaluationResult + av6.EvaluationResult;
            }
            List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == ViewModelEvalwithother1.AEvaluationEmpIdd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            am1 = vAEvaluationCompetenciesMs[0];
            am2 = vAEvaluationCompetenciesMs[1];
            am3 = vAEvaluationCompetenciesMs[2];
            am4 = vAEvaluationCompetenciesMs[3];
            am5 = vAEvaluationCompetenciesMs[4];
            am6 = vAEvaluationCompetenciesMs[5];
            if (vAEvaluationCompetenciesMs.Count > 6)
            {
                am7 = vAEvaluationCompetenciesMs[6];
            }
            //am7 = vAEvaluationCompetenciesMs[6];
            am1.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight1;
            am2.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight2;
            am3.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight3;
            am4.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight4;
            am5.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight5;
            am6.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight6;
            if (vAEvaluationCompetenciesMs.Count > 6)
            {

                am7.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7==null?"0": ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7;
            }
            List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == ViewModelEvalwithother1.AEvaluationEmpIdd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            ad1 = vAEvaluationCompetenciesDs[0];
            ad2 = vAEvaluationCompetenciesDs[1];
            ad3 = vAEvaluationCompetenciesDs[2];
            ad4 = vAEvaluationCompetenciesDs[3];
            ad5 = vAEvaluationCompetenciesDs[4];
            ad6 = vAEvaluationCompetenciesDs[5];
            ad7 = vAEvaluationCompetenciesDs[6];
            ad8 = vAEvaluationCompetenciesDs[7];
            ad9 = vAEvaluationCompetenciesDs[8];
            ad10 = vAEvaluationCompetenciesDs[9];
            ad11 = vAEvaluationCompetenciesDs[10];
            ad12 = vAEvaluationCompetenciesDs[11];
            ad13 = vAEvaluationCompetenciesDs[12];
            ad14 = vAEvaluationCompetenciesDs[13];
            ad15 = vAEvaluationCompetenciesDs[14];
            ad16 = vAEvaluationCompetenciesDs[15];
            ad17 = vAEvaluationCompetenciesDs[16];
            ad18 = vAEvaluationCompetenciesDs[17];
            if (vAEvaluationCompetenciesDs.Count > 18)
            {
                ad19 = vAEvaluationCompetenciesDs[18];
                ad20 = vAEvaluationCompetenciesDs[19];
                ad21 = vAEvaluationCompetenciesDs[20];
                ad22 = vAEvaluationCompetenciesDs[21];
                ad23 = vAEvaluationCompetenciesDs[22];
            }
            ad1.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel1;
            ad1.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel01;
            double cd1 = (double)(ad1.EvaluationOutputCompetency / ad1.CovenantCompetenciecDLevel);
            if (cd1 >=1)
            {
                ad1.EvaluationResults = 5;
            }
            else if(cd1 >=.8&& cd1<1)
            {
                ad1.EvaluationResults = 4;
            }
            else if (cd1 >= .6 && cd1 < .8)
            {
                ad1.EvaluationResults = 3;
            }
            else if (cd1 >= .4 && cd1 < .6)
            {
                ad1.EvaluationResults = 2;
            }
            else if (cd1 < .4)
            {
                ad1.EvaluationResults = 1;
            }
            //ad1.EvaluationResults2 = (Convert.ToDouble(am1.CovenantWeight) * ad1.EvaluationResults);
            ad2.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel2;
            ad2.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel02;
            double cd2 = (double)(ad2.EvaluationOutputCompetency / ad2.CovenantCompetenciecDLevel);

            if (cd2 >= 1)
            {
                ad2.EvaluationResults = 5;
            }
            else if (cd2 >= .8 && cd2 < 1)
            {
                ad2.EvaluationResults = 4;
            }
            else if (cd2 >= .6 && cd2 < .8)
            {
                ad2.EvaluationResults = 3;
            }
            else if (cd2 >= .4 && cd2 < .6)
            {
                ad2.EvaluationResults = 2;
            }
            else if (cd2 < .4)
            {
                ad2.EvaluationResults = 1;
            }
            //ad2.EvaluationResults2 = (Convert.ToDouble(am1.CovenantWeight) * ad2.EvaluationResults);
            ad3.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel3;
            ad3.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel03;
            double cd3 = (double)(ad3.EvaluationOutputCompetency / ad3.CovenantCompetenciecDLevel);
            if (cd3 >= 1)
            {
                ad3.EvaluationResults = 5;
            }
            else if (cd3 >= .8 && cd3 <1)
            {
                ad3.EvaluationResults = 4;
            }
            else if (cd3 >= .6 && cd3 < .8)
            {
                ad3.EvaluationResults = 3;
            }
            else if (cd3 >= .4 && cd3 < .6)
            {
                ad3.EvaluationResults = 2;
            }
            else if (cd3 < .4)
            {
                ad3.EvaluationResults = 1;
            }
            ad1.EvaluationResults2 = (Convert.ToDouble(am1.CovenantWeight) * (ad1.EvaluationResults+ ad2.EvaluationResults+ ad3.EvaluationResults)/3);
            ad2.EvaluationResults2 = (Convert.ToDouble(am1.CovenantWeight) * (ad1.EvaluationResults + ad2.EvaluationResults + ad3.EvaluationResults) / 3);
            ad3.EvaluationResults2 = (Convert.ToDouble(am1.CovenantWeight) * (ad1.EvaluationResults + ad2.EvaluationResults + ad3.EvaluationResults) / 3);
            ad4.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel4;
            ad4.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel04;
            double cd4 = (double)(ad4.EvaluationOutputCompetency / ad4.CovenantCompetenciecDLevel);
            if (cd4 >= 1)
            {
                ad4.EvaluationResults = 5;
            }
            else if (cd4 >= .8 && cd4 < 1)
            {
                ad4.EvaluationResults = 4;
            }
            else if (cd4 >= .6 && cd4 < .8)
            {
                ad4.EvaluationResults = 3;
            }
            else if (cd4 >= .4 && cd4 < .6)
            {
                ad4.EvaluationResults = 2;
            }
            else if (cd4 < .4)
            {
                ad4.EvaluationResults = 1;
            }
            //ad4.EvaluationResults2 = (Convert.ToDouble(am2.CovenantWeight) * ad4.EvaluationResults);
            ad5.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel5;
            ad5.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel05;
            double cd5 = (double)(ad5.EvaluationOutputCompetency / ad5.CovenantCompetenciecDLevel);
            if (cd5 >= 1)
            {
                ad5.EvaluationResults = 5;
            }
            else if (cd5 >= .8 && cd5 < 1)
            {
                ad5.EvaluationResults = 4;
            }
            else if (cd5 >= .6 && cd5 < .8)
            {
                ad5.EvaluationResults = 3;
            }
            else if (cd5 >= .4 && cd5 < .6)
            {
                ad5.EvaluationResults = 2;
            }
            else if (cd5 < .4)
            {
                ad5.EvaluationResults = 1;
            }
            //ad5.EvaluationResults2 = (Convert.ToDouble(am2.CovenantWeight) * ad5.EvaluationResults);
            ad6.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel6;
            ad6.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel06;
            double cd6 = (double)(ad6.EvaluationOutputCompetency / ad6.CovenantCompetenciecDLevel);
            if (cd6 >= 1)
            {
                ad6.EvaluationResults = 5;
            }
            else if (cd6 >= .8 && cd6 < 1)
            {
                ad6.EvaluationResults = 4;
            }
            else if (cd6 >= .6 && cd6 < .8)
            {
                ad6.EvaluationResults = 3;
            }
            else if (cd6 >= .4 && cd6 < .6)
            {
                ad6.EvaluationResults = 2;
            }
            else if (cd6 < .4)
            {
                ad6.EvaluationResults = 1;
            }
            ad4.EvaluationResults2 = (Convert.ToDouble(am2.CovenantWeight) * (ad4.EvaluationResults+ ad5.EvaluationResults+ ad6.EvaluationResults)/3);
            ad5.EvaluationResults2 = (Convert.ToDouble(am2.CovenantWeight) * (ad4.EvaluationResults + ad5.EvaluationResults + ad6.EvaluationResults) / 3);
            ad6.EvaluationResults2 = (Convert.ToDouble(am2.CovenantWeight) * (ad4.EvaluationResults + ad5.EvaluationResults + ad6.EvaluationResults) / 3);
            ad7.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel7;
            ad7.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel07;
            double cd7 = (double)(ad7.EvaluationOutputCompetency / ad7.CovenantCompetenciecDLevel);
            if (cd7 >= 1)
            {
                ad7.EvaluationResults = 5;
            }
            else if (cd7 >= .8 && cd7 < 1)
            {
                ad7.EvaluationResults = 4;
            }
            else if (cd7 >= .6 && cd7 < .8)
            {
                ad7.EvaluationResults = 3;
            }
            else if (cd7 >= .4 && cd7 < .6)
            {
                ad7.EvaluationResults = 2;
            }
            else if (cd7 < .4)
            {
                ad7.EvaluationResults = 1;
            }
            //ad7.EvaluationResults2 = (Convert.ToDouble(am3.CovenantWeight) * ad7.EvaluationResults);
            ad8.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel8;
            ad8.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel08;
            double cd8 = (double)(ad8.EvaluationOutputCompetency / ad8.CovenantCompetenciecDLevel);
            if (cd8 >= 1)
            {
                ad8.EvaluationResults = 5;
            }
            else if (cd8 >= .8 && cd8 < 1)
            {
                ad8.EvaluationResults = 4;
            }
            else if (cd8 >= .6 && cd8 < .8)
            {
                ad8.EvaluationResults = 3;
            }
            else if (cd8 >= .4 && cd8 < .6)
            {
                ad8.EvaluationResults = 2;
            }
            else if (cd8 < .4)
            {
                ad8.EvaluationResults = 1;
            }
            //ad8.EvaluationResults2 = (Convert.ToDouble(am3.CovenantWeight) * ad8.EvaluationResults);
            ad9.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel9;
            ad9.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel09;
            double cd9 = (double)(ad9.EvaluationOutputCompetency / ad9.CovenantCompetenciecDLevel);
            if (cd9 >=1)
            {
                ad9.EvaluationResults = 5;
            }
            else if (cd9 >= .8 && cd9 < 1)
            {
                ad9.EvaluationResults = 4;
            }
            else if (cd9 >= .6 && cd9 < .8)
            {
                ad9.EvaluationResults = 3;
            }
            else if (cd9 >= .4 && cd9 < .6)
            {
                ad9.EvaluationResults = 2;
            }
            else if (cd9 < .4)
            {
                ad9.EvaluationResults = 1;
            }
            ad7.EvaluationResults2 = (Convert.ToDouble(am3.CovenantWeight) * (ad7.EvaluationResults+ ad8.EvaluationResults+ ad9.EvaluationResults)/3);
            ad8.EvaluationResults2 = (Convert.ToDouble(am3.CovenantWeight) * (ad7.EvaluationResults + ad8.EvaluationResults + ad9.EvaluationResults) / 3);
            ad9.EvaluationResults2 = (Convert.ToDouble(am3.CovenantWeight) * (ad7.EvaluationResults + ad8.EvaluationResults + ad9.EvaluationResults) / 3);
            ad10.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel10;
            ad10.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel010;
            double cd10 = (double)(ad10.EvaluationOutputCompetency / ad10.CovenantCompetenciecDLevel);
            if (cd10 >= 1)
            {
                ad10.EvaluationResults = 5;
            }
            else if (cd10 >= .8 && cd10 < 1)
            {
                ad10.EvaluationResults = 4;
            }
            else if (cd10 >= .6 && cd10 < .8)
            {
                ad10.EvaluationResults = 3;
            }
            else if (cd10 >= .4 && cd10 < .6)
            {
                ad10.EvaluationResults = 2;
            }
            else if (cd10 < .4)
            {
                ad10.EvaluationResults = 1;
            }
            //ad10.EvaluationResults2 = (Convert.ToDouble(am4.CovenantWeight) * ad10.EvaluationResults);
            ad11.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel11;
            ad11.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel011;
            double cd11 = (double)(ad11.EvaluationOutputCompetency / ad11.CovenantCompetenciecDLevel);
            if (cd11 >= 1)
            {
                ad11.EvaluationResults = 5;
            }
            else if (cd11 >= .8 && cd11 < 1)
            {
                ad11.EvaluationResults = 4;
            }
            else if (cd11 >= .6 && cd11 < .8)
            {
                ad11.EvaluationResults = 3;
            }
            else if (cd11 >= .4 && cd11 < .6)
            {
                ad11.EvaluationResults = 2;
            }
            else if (cd11 < .4)
            {
                ad11.EvaluationResults = 1;
            }
            //ad11.EvaluationResults2 = (Convert.ToDouble(am4.CovenantWeight) * ad11.EvaluationResults);
            ad12.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel12;
            ad12.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel012;
            double cd12 = (double)(ad12.EvaluationOutputCompetency / ad12.CovenantCompetenciecDLevel);
            if (cd12 >= 1)
            {
                ad12.EvaluationResults = 5;
            }
            else if (cd12 >= .8 && cd12 < 1)
            {
                ad12.EvaluationResults = 4;
            }
            else if (cd12 >= .6 && cd12 < .8)
            {
                ad12.EvaluationResults = 3;
            }
            else if (cd12 >= .4 && cd12 < .6)
            {
                ad12.EvaluationResults = 2;
            }
            else if (cd12 < .4)
            {
                ad12.EvaluationResults = 1;
            }
            ad10.EvaluationResults2 = (Convert.ToDouble(am4.CovenantWeight) * (ad10.EvaluationResults+ ad11.EvaluationResults+ ad12.EvaluationResults)/3);
            ad11.EvaluationResults2 = (Convert.ToDouble(am4.CovenantWeight) * (ad10.EvaluationResults + ad11.EvaluationResults + ad12.EvaluationResults) / 3);
            ad12.EvaluationResults2 = (Convert.ToDouble(am4.CovenantWeight) * (ad10.EvaluationResults + ad11.EvaluationResults + ad12.EvaluationResults) / 3);
            ad13.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel13;
            ad13.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel013;
            double cd13 = (double)(ad13.EvaluationOutputCompetency / ad13.CovenantCompetenciecDLevel);
            if (cd13 >= 1)
            {
                ad13.EvaluationResults = 5;
            }
            else if (cd13 >= .8 && cd13 < 1)
            {
                ad13.EvaluationResults = 4;
            }
            else if (cd13 >= .6 && cd13 < .8)
            {
                ad13.EvaluationResults = 3;
            }
            else if (cd13 >= .4 && cd13 < .6)
            {
                ad13.EvaluationResults = 2;
            }
            else if (cd13 < .4)
            {
                ad13.EvaluationResults = 1;
            }
            //ad13.EvaluationResults2 = (Convert.ToDouble(am5.CovenantWeight) * ad13.EvaluationResults);
            ad14.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel14;
            ad14.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel014;
            double cd14 = (double)(ad14.EvaluationOutputCompetency / ad14.CovenantCompetenciecDLevel);
            if (cd14 >= 1)
            {
                ad14.EvaluationResults = 5;
            }
            else if (cd14 >= .8 && cd14 < 1)
            {
                ad14.EvaluationResults = 4;
            }
            else if (cd14 >= .6 && cd14 < .8)
            {
                ad14.EvaluationResults = 3;
            }
            else if (cd14 >= .4 && cd14 < .6)
            {
                ad14.EvaluationResults = 2;
            }
            else if (cd14 < .4)
            {
                ad14.EvaluationResults = 1;
            }
            ad13.EvaluationResults2 = (Convert.ToDouble(am5.CovenantWeight) * (ad13.EvaluationResults+ ad14.EvaluationResults)/2);
            ad14.EvaluationResults2 = (Convert.ToDouble(am5.CovenantWeight) * (ad13.EvaluationResults + ad14.EvaluationResults) / 2);
            ad15.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel15;
            ad15.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel015;
            double cd15 = (double)(ad15.EvaluationOutputCompetency / ad15.CovenantCompetenciecDLevel);
            if (cd15 >= 1)
            {
                ad15.EvaluationResults = 5;
            }
            else if (cd15 >= .8 && cd15 < 1)
            {
                ad15.EvaluationResults = 4;
            }
            else if (cd15 >= .6 && cd15 < .8)
            {
                ad15.EvaluationResults = 3;
            }
            else if (cd15 >= .4 && cd15 < .6)
            {
                ad15.EvaluationResults = 2;
            }
            else if (cd15 < .4)
            {
                ad15.EvaluationResults = 1;
            }
            //ad15.EvaluationResults2 = (Convert.ToDouble(am6.CovenantWeight) * ad15.EvaluationResults);
            ad16.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel16;
            ad16.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel016;
            double cd16 = (double)(ad16.EvaluationOutputCompetency / ad16.CovenantCompetenciecDLevel);
            if (cd16 >= 1)
            {
                ad16.EvaluationResults = 5;
            }
            else if (cd16 >= .8 && cd16 < 1)
            {
                ad16.EvaluationResults = 4;
            }
            else if (cd16 >= .6 && cd16 < .8)
            {
                ad16.EvaluationResults = 3;
            }
            else if (cd16 >= .4 && cd16 < .6)
            {
                ad16.EvaluationResults = 2;
            }
            else if (cd16 < .4)
            {
                ad16.EvaluationResults = 1;
            }
            //ad16.EvaluationResults2 = (Convert.ToDouble(am6.CovenantWeight) * ad16.EvaluationResults);
            ad17.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel17;
            ad17.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel017;
            double cd17 = (double)(ad17.EvaluationOutputCompetency / ad17.CovenantCompetenciecDLevel);
            if (cd17 >= 1)
            {
                ad17.EvaluationResults = 5;
            }
            else if (cd17 >= .8 && cd17 < 1)
            {
                ad17.EvaluationResults = 4;
            }
            else if (cd17 >= .6 && cd17 < .8)
            {
                ad17.EvaluationResults = 3;
            }
            else if (cd17 >= .4 && cd17 < .6)
            {
                ad17.EvaluationResults = 2;
            }
            else if (cd17 < .4)
            {
                ad17.EvaluationResults = 1;
            }
            //ad17.EvaluationResults2 = (Convert.ToDouble(am6.CovenantWeight) * ad17.EvaluationResults);
            ad18.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel18;
            ad18.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel018;
            double cd18 = (double)(ad18.EvaluationOutputCompetency / ad18.CovenantCompetenciecDLevel);
            if (cd18 >= 1)
            {
                ad18.EvaluationResults = 5;
            }
            else if (cd18 >= .8 && cd18 < 1)
            {
                ad18.EvaluationResults = 4;
            }
            else if (cd18 >= .6 && cd18 < .8)
            {
                ad18.EvaluationResults = 3;
            }
            else if (cd18 >= .4 && cd18 < .6)
            {
                ad18.EvaluationResults = 2;
            }
            else if (cd18 < .4)
            {
                ad18.EvaluationResults = 1;
            }
            ad15.EvaluationResults2 = (Convert.ToDouble(am6.CovenantWeight) * (ad15.EvaluationResults+ ad16.EvaluationResults+ ad17.EvaluationResults+ ad18.EvaluationResults)/4);
            ad16.EvaluationResults2 = (Convert.ToDouble(am6.CovenantWeight) * (ad15.EvaluationResults + ad16.EvaluationResults + ad17.EvaluationResults + ad18.EvaluationResults) / 4);
            ad17.EvaluationResults2 = (Convert.ToDouble(am6.CovenantWeight) * (ad15.EvaluationResults + ad16.EvaluationResults + ad17.EvaluationResults + ad18.EvaluationResults) / 4);
            ad18.EvaluationResults2 = (Convert.ToDouble(am6.CovenantWeight) * (ad15.EvaluationResults + ad16.EvaluationResults + ad17.EvaluationResults + ad18.EvaluationResults) / 4);
            ad18.EvaluationTotal =  ad18.EvaluationResults2 + ad14.EvaluationResults2
                + ad12.EvaluationResults2 + ad9.EvaluationResults2
                + ad6.EvaluationResults2 + ad3.EvaluationResults2;
            if (vAEvaluationCompetenciesDs.Count > 18)
            {
                ad19.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel19==null?0 : ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel19;
                ad19.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel019==null?0: ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel019;
                double cd19 = (double)(ad19.EvaluationOutputCompetency / ad19.CovenantCompetenciecDLevel);
                ad19.EvaluationResults = 0;
                if (cd19 >= 1)
                {
                    ad19.EvaluationResults = 5;
                }
                else if (cd19 >= .8 && cd19 < 1)
                {
                    ad19.EvaluationResults = 4;
                }
                else if (cd19 >= .6 && cd19 < .8)
                {
                    ad19.EvaluationResults = 3;
                }
                else if (cd19 >= .4 && cd19 < .6)
                {
                    ad19.EvaluationResults = 2;
                }
                else if (cd19 < .4)
                {
                    ad19.EvaluationResults = 1;
                }
                //ad19.EvaluationResults2 = (Convert.ToDouble(am7.CovenantWeight) * ad19.EvaluationResults);
                ad20.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel20==null?0: ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel20;
                ad20.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel020==null?0: ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel020;
                double cd20 = (double)(ad20.EvaluationOutputCompetency / ad20.CovenantCompetenciecDLevel);
                ad20.EvaluationResults = 0;
                if (cd20 >= 1)
                {
                    ad20.EvaluationResults = 5;
                }
                else if (cd20 >= .8 && cd20 <1)
                {
                    ad20.EvaluationResults = 4;
                }
                else if (cd20 >= .6 && cd20 < .8)
                {
                    ad20.EvaluationResults = 3;
                }
                else if (cd20 >= .4 && cd20 < .6)
                {
                    ad20.EvaluationResults = 2;
                }
                else if (cd20 < .4)
                {
                    ad20.EvaluationResults = 1;
                }
                //ad20.EvaluationResults2 = (Convert.ToDouble(am7.CovenantWeight) * ad20.EvaluationResults);
                ad21.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel21==null?0: ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel21;
                ad21.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel021==null?0: ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel021;
                double cd21 = (double)(ad21.EvaluationOutputCompetency / ad21.CovenantCompetenciecDLevel);
                ad21.EvaluationResults = 0;
                if (cd21 >= 1)
                {
                    ad21.EvaluationResults = 5;
                }
                else if (cd21 >= .8 && cd21 < 1)
                {
                    ad21.EvaluationResults = 4;
                }
                else if (cd21 >= .6 && cd21 < .8)
                {
                    ad21.EvaluationResults = 3;
                }
                else if (cd21 >= .4 && cd21 < .6)
                {
                    ad21.EvaluationResults = 2;
                }
                else if (cd21 < .4)
                {
                    ad21.EvaluationResults = 1;
                }
                //ad21.EvaluationResults2 = (Convert.ToDouble(am7.CovenantWeight) * ad21.EvaluationResults);
                ad22.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel22==null?0: ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel22;
                ad22.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel022==null?0: ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel022;
                double cd22 = (double)(ad22.EvaluationOutputCompetency / ad22.CovenantCompetenciecDLevel);
                ad22.EvaluationResults = 0;
                if (cd22 >= 1)
                {
                    ad22.EvaluationResults = 5;
                }
                else if (cd22 >= .8 && cd22 < 1)
                {
                    ad22.EvaluationResults = 4;
                }
                else if (cd22 >= .6 && cd22 < .8)
                {
                    ad22.EvaluationResults = 3;
                }
                else if (cd22 >= .4 && cd22 < .6)
                {
                    ad22.EvaluationResults = 2;
                }
                else if (cd22 < .4)
                {
                    ad22.EvaluationResults = 1;
                }
                //ad22.EvaluationResults2 = (Convert.ToDouble(am7.CovenantWeight) * ad22.EvaluationResults);
                ad23.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel23==null?0: ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel23;
                ad23.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel023==null?0: ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel023;
                double cd23 = (double)(ad23.EvaluationOutputCompetency / ad23.CovenantCompetenciecDLevel);
                ad23.EvaluationResults = 0;
                if (cd23 >= 1)
                {
                    ad23.EvaluationResults = 5;
                }
                else if (cd23 >= .8 && cd23 < 1)
                {
                    ad23.EvaluationResults = 4;
                }
                else if (cd23 >= .6 && cd23 < .8)
                {
                    ad23.EvaluationResults = 3;
                }
                else if (cd23 >= .4 && cd23 < .6)
                {
                    ad23.EvaluationResults = 2;
                }
                else if (cd23 < .4)
                {
                    ad23.EvaluationResults = 1;
                }

                ad19.EvaluationResults2 = (Convert.ToDouble(am7.CovenantWeight) * (ad19.EvaluationResults+ ad20.EvaluationResults+ ad21.EvaluationResults+ ad22.EvaluationResults+ ad23.EvaluationResults) /5);
                ad20.EvaluationResults2 = (Convert.ToDouble(am7.CovenantWeight) * (ad19.EvaluationResults + ad20.EvaluationResults + ad21.EvaluationResults + ad22.EvaluationResults + ad23.EvaluationResults) / 5);
                ad21.EvaluationResults2 = (Convert.ToDouble(am7.CovenantWeight) * (ad19.EvaluationResults + ad20.EvaluationResults + ad21.EvaluationResults + ad22.EvaluationResults + ad23.EvaluationResults) / 5);
                ad22.EvaluationResults2 = (Convert.ToDouble(am7.CovenantWeight) * (ad19.EvaluationResults + ad20.EvaluationResults + ad21.EvaluationResults + ad22.EvaluationResults + ad23.EvaluationResults) / 5);
                ad23.EvaluationResults2 = (Convert.ToDouble(am7.CovenantWeight) * (ad19.EvaluationResults + ad20.EvaluationResults + ad21.EvaluationResults + ad22.EvaluationResults + ad23.EvaluationResults) / 5);



                ad23.EvaluationTotal = ad23.EvaluationResults2+ ad18.EvaluationResults2 + ad14.EvaluationResults2 
                + ad12.EvaluationResults2 + ad9.EvaluationResults2 
                + ad6.EvaluationResults2 +  ad3.EvaluationResults2;
            }
            //if (ModelState.IsValid)
            //{
            // create log 
            Aeval2log aevallog = new Aeval2log()
            {
                Editdate = DateTime.Now,
                Useredit = HttpContext.Session.GetString("username"),
                Evid = Convert.ToString(ViewModelEvalwithother1.AEvaluationGoalCovenantId)

            };
            _context.Add(aevallog);

            // create comment for request
            //AEvaluationEmpComment AEvaluationEmpComment1 = new AEvaluationEmpComment()
            //{
            //    datecomment = DateTime.Now,
            //    commentby = HttpContext.Session.GetString("username"),
            //    covenreqid = Convert.ToString(ViewModelEvalwithother1.AEvaluationGoalCovenantId),
            //    commentforreq= ViewModelEvalwithother1.commentforreq

            //};
            //_context.Add(AEvaluationEmpComment1);
            //
            vAEvaluationEmps11.comment1 = ViewModelEvalwithother1.commentforreq;
            _context.Update(vAEvaluationEmps11);
            _context.Update(av1);
            _context.Update(av2);
            _context.Update(av3);
            _context.Update(av4);
            if (vAEvaluationGoals.Count > 4)
            {
                _context.Update(av5);
                // create new goal like in edit for form 

            }
            if (vAEvaluationGoals.Count > 5)
            {
                _context.Update(av6);
            }
            if (ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName5 != null && vAEvaluationGoals.Count == 4)
            {
                AEvaluationGoal aEvaluationGoal5 = new AEvaluationGoal { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, EmpType = "مدير", CovenantGoalsSeq = 5, CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName5, CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria5, CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight5, CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput5, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId, CovenantDate = DateTime.Now, EvaluationActualOutput = ViewModelEvalwithother1.AEvaluationGoalEvaluationActualOutput5, EvaluationDate = null, EvaluationDifferenceOutputs = null, EvaluationEquilibrium = null, EvaluationId = null, EvaluationResult = null, EvaluationTotal = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantWeightSum = 100, EmpIdEnter = Convert.ToInt32(HttpContext.Session.GetString("empid")) };
                _context.Add(aEvaluationGoal5);

            }
            if (ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName6 != null && vAEvaluationGoals.Count == 5)
            {
                AEvaluationGoal aEvaluationGoal6 = new AEvaluationGoal { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, EmpType = "مدير", CovenantGoalsSeq = 6, CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName6, CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria6, CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight6, CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput6, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId, CovenantDate = DateTime.Now, EvaluationActualOutput = ViewModelEvalwithother1.AEvaluationGoalEvaluationActualOutput6, EvaluationDate = null, EvaluationDifferenceOutputs = null, EvaluationEquilibrium = null, EvaluationId = null, EvaluationResult = null, EvaluationTotal = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantWeightSum = 100, EmpIdEnter = Convert.ToInt32(HttpContext.Session.GetString("empid")) };
                _context.Add(aEvaluationGoal6);

            }

            _context.Update(am1);
            _context.Update(am2);
            _context.Update(am3);
            _context.Update(am4);
            _context.Update(am5);
            if (vAEvaluationCompetenciesMs.Count > 6)
            {
                _context.Update(am7);
            }
            if (ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7 != null && vAEvaluationCompetenciesMs.Count == 6)
            {
                AEvaluationCompetenciesM aEvaluationCompetenciesM7 = new AEvaluationCompetenciesM { CovenantCompetenciesSeq = 7, CovenantCompetencyName = "القيادة", CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7, EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantWeightSum = 100, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                _context.Add(aEvaluationCompetenciesM7);
            }

            _context.Update(ad1);
            _context.Update(ad2);
            _context.Update(ad3);
            _context.Update(ad4);
            _context.Update(ad5);

            _context.Update(ad6);
            _context.Update(ad7);
            _context.Update(ad8);
            _context.Update(ad9);
            _context.Update(ad10);
            _context.Update(ad11);

            _context.Update(ad12);
            _context.Update(ad13);
            _context.Update(ad14);
            _context.Update(ad15);
            _context.Update(ad16);
            _context.Update(ad17);
            _context.Update(ad18);
            if (vAEvaluationCompetenciesDs.Count > 18)
            {
                _context.Update(ad19);
                _context.Update(ad20);
                _context.Update(ad21);
                _context.Update(ad22);
                _context.Update(ad23);


            }
            if (ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel19 != null && vAEvaluationCompetenciesDs.Count == 18)
            {
                AEvaluationCompetenciesD aEvaluationCompetenciesD19 = new AEvaluationCompetenciesD { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantCompetenciesDSeq = 7, CovenantCompetenciesDDesc = "مرن وقادر على تنفيذ أعمال هامة فى ظروف تنطوى على قدر كبير من المخاطرة وعدم اليقين .", CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel19, EvaluationOutputCompetency = null, EvaluationResults = null, EvaluationTotal = null, CovenantCompetenciesDSeqD = 1, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                AEvaluationCompetenciesD aEvaluationCompetenciesD20 = new AEvaluationCompetenciesD { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantCompetenciesDSeq = 7, CovenantCompetenciesDDesc = "يدعم و يشجع فريقه على تحقيق اهدافه، حتى في الظروف الصعبة  .", CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel20, EvaluationOutputCompetency = null, EvaluationResults = null, EvaluationTotal = null, CovenantCompetenciesDSeqD = 2, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                AEvaluationCompetenciesD aEvaluationCompetenciesD21 = new AEvaluationCompetenciesD { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantCompetenciesDSeq = 7, CovenantCompetenciesDDesc = "يفكر بمنطقية و ابداع دون التأثر بتحيزاته الشخصية.", CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel21, EvaluationOutputCompetency = null, EvaluationResults = null, EvaluationTotal = null, CovenantCompetenciesDSeqD = 3, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                AEvaluationCompetenciesD aEvaluationCompetenciesD22 = new AEvaluationCompetenciesD { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantCompetenciesDSeq = 7, CovenantCompetenciesDDesc = "يفوض الصلاحيات و يتابع النتائج  .", CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel22, EvaluationOutputCompetency = null, EvaluationResults = null, EvaluationTotal = null, CovenantCompetenciesDSeqD = 4, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                AEvaluationCompetenciesD aEvaluationCompetenciesD23 = new AEvaluationCompetenciesD { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantCompetenciesDSeq = 7, CovenantCompetenciesDDesc = "يوفر ويدعم فرص تطوير المرؤوسين.", CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel23, EvaluationOutputCompetency = null, EvaluationResults = null, EvaluationTotal = null, CovenantCompetenciesDSeqD = 5, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };

                _context.Add(aEvaluationCompetenciesD19);
                _context.Add(aEvaluationCompetenciesD20);
                _context.Add(aEvaluationCompetenciesD21);
                _context.Add(aEvaluationCompetenciesD22);
                _context.Add(aEvaluationCompetenciesD23);
            }



            _context.SaveChanges();





            return RedirectToAction(nameof(Search));
            //}
            return View(ViewModelEvalwithother1);



        }

        // get 
        public ActionResult Edit11m(string? id)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);

            ViewData["Cempid"] = new SelectList(_context.Cemps, "Cempid", "CEMPNAME");

            String cid = _protector.Unprotect(id);
            if (cid == null)
            {
                return NotFound();
            }


            var vAEvaluationEmps1 = _context.AEvaluationEmps.Where(d => d.Idd == Convert.ToInt32(cid)).FirstOrDefault();
            //var  vAEvaluationGoals1 = _context.AEvaluationGoals.Where(d => d.CovenantId == id).OrderBy(d => d.CovenantGoalsSeq).FirstOrDefault();
            List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == vAEvaluationEmps1.Idd).OrderBy(d => d.CovenantGoalsSeq).ToList();
            av1 = vAEvaluationGoals[0];
            av2 = vAEvaluationGoals[1];
            av3 = vAEvaluationGoals[2];
            av4 = vAEvaluationGoals[3];
            if (vAEvaluationGoals.Count > 4)
            {
                av5 = vAEvaluationGoals[4];

            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6 = vAEvaluationGoals[5];
            }
            List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == vAEvaluationEmps1.Idd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            am1 = vAEvaluationCompetenciesMs[0];
            am2 = vAEvaluationCompetenciesMs[1];
            am3 = vAEvaluationCompetenciesMs[2];
            am4 = vAEvaluationCompetenciesMs[3];
            am5 = vAEvaluationCompetenciesMs[4];
            am6 = vAEvaluationCompetenciesMs[5];
            if (vAEvaluationCompetenciesMs.Count > 6)
            {

                am7 = vAEvaluationCompetenciesMs[6];
            }

            List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == vAEvaluationEmps1.Idd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            ad1 = vAEvaluationCompetenciesDs[0];
            ad2 = vAEvaluationCompetenciesDs[1];
            ad3 = vAEvaluationCompetenciesDs[2];
            ad4 = vAEvaluationCompetenciesDs[3];
            ad5 = vAEvaluationCompetenciesDs[4];
            ad6 = vAEvaluationCompetenciesDs[5];
            ad7 = vAEvaluationCompetenciesDs[6];
            ad8 = vAEvaluationCompetenciesDs[7];
            ad9 = vAEvaluationCompetenciesDs[8];
            ad10 = vAEvaluationCompetenciesDs[9];
            ad11 = vAEvaluationCompetenciesDs[10];
            ad12 = vAEvaluationCompetenciesDs[11];
            ad13 = vAEvaluationCompetenciesDs[12];
            ad14 = vAEvaluationCompetenciesDs[13];
            ad15 = vAEvaluationCompetenciesDs[14];
            ad16 = vAEvaluationCompetenciesDs[15];
            ad17 = vAEvaluationCompetenciesDs[16];
            ad18 = vAEvaluationCompetenciesDs[17];
            if (vAEvaluationCompetenciesDs.Count > 18)
            {

                ad19 = vAEvaluationCompetenciesDs[18];
                ad20 = vAEvaluationCompetenciesDs[19];
                ad21 = vAEvaluationCompetenciesDs[20];
                ad22 = vAEvaluationCompetenciesDs[21];
                ad23 = vAEvaluationCompetenciesDs[22];
            }
            if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 23 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 4)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 7 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 5)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    //AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    //AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    //AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    //AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }
            else if (vAEvaluationCompetenciesMs.Count == 6 && vAEvaluationCompetenciesDs.Count == 18 && vAEvaluationGoals.Count == 6)
            {
                ViewModelEvalwithother1 ViewModelEvalwithother1 = new ViewModelEvalwithother1
                {
                    AEvaluationEmpIdd = vAEvaluationEmps1.Idd,
                    AEvaluationEmpEmpno = vAEvaluationEmps1.Empno,
                    AEvaluationEmpEmpname = vAEvaluationEmps1.Empname,
                    AEvaluationGoalCovenantId = av1.CovenantId,
                    AEvaluationGoalCovenantGoalsName1 = av1.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName2 = av2.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName3 = av3.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName4 = av4.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName5 = av5.CovenantGoalsName,
                    AEvaluationGoalCovenantGoalsName6 = av6.CovenantGoalsName,
                    AEvaluationGoalCovenantMeasurementCriteria1 = av1.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria2 = av2.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria3 = av3.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria4 = av4.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria5 = av5.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantMeasurementCriteria6 = av6.CovenantMeasurementCriteria,
                    AEvaluationGoalCovenantPercentageWeight1 = av1.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight2 = av2.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight3 = av3.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight4 = av4.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight5 = av5.CovenantPercentageWeight,
                    AEvaluationGoalCovenantPercentageWeight6 = av6.CovenantPercentageWeight,
                    AEvaluationGoalCovenantTargetedOutput1 = av1.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput2 = av2.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput3 = av3.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput4 = av4.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput5 = av5.CovenantTargetedOutput,
                    AEvaluationGoalCovenantTargetedOutput6 = av6.CovenantTargetedOutput,
                    AEvaluationCompetenciesMCovenantWeight1 = am1.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight2 = am2.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight3 = am3.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight4 = am4.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight5 = am5.CovenantWeight,
                    AEvaluationCompetenciesMCovenantWeight6 = am6.CovenantWeight,
                    //AEvaluationCompetenciesMCovenantWeight7 = am7.CovenantWeight,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel1 = ad1.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel2 = ad2.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel3 = ad3.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel4 = ad4.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel5 = ad5.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel6 = ad6.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel7 = ad7.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel8 = ad8.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel9 = ad9.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel10 = ad10.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel11 = ad11.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel12 = ad12.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel13 = ad13.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel14 = ad14.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel15 = ad15.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel16 = ad16.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel17 = ad17.CovenantCompetenciecDLevel,
                    AEvaluationCompetenciesDCovenantCompetenciecDLevel18 = ad18.CovenantCompetenciecDLevel,

                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel19 = ad19.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel20 = ad20.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel21 = ad21.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel22 = ad22.CovenantCompetenciecDLevel,
                    //AEvaluationCompetenciesDCovenantCompetenciecDLevel23 = ad23.CovenantCompetenciecDLevel,





                };
                return View(ViewModelEvalwithother1);
            }


            return View();
            //return View(ViewModelEvalwithother1);
        }




        [HttpPost]
        [ValidateAntiForgeryToken]
        public ActionResult Edit11m(ViewModelEvalwithother1 ViewModelEvalwithother1)
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            //if (ViewModelEvalwithother1.AEvaluationEmpIdd == null)
            //{
            //    return NotFound();
            //}
            var vAEvaluationEmps11 = _context.AEvaluationEmps.Where(d => d.Idd == ViewModelEvalwithother1.AEvaluationEmpIdd).FirstOrDefault();
            List<AEvaluationGoal> vAEvaluationGoals = _context.AEvaluationGoals.Where(d => d.CovenantId == ViewModelEvalwithother1.AEvaluationEmpIdd).ToList();
            av1 = vAEvaluationGoals[0];
            av2 = vAEvaluationGoals[1];
            av3 = vAEvaluationGoals[2];
            av4 = vAEvaluationGoals[3];
            if (vAEvaluationGoals.Count > 4)
            {
                av5 = vAEvaluationGoals[4];

            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6 = vAEvaluationGoals[5];
            }

            av1.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
            av1.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName1;
            av1.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria1;
            av1.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight1;
            av1.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput1;
            av1.EvaluationActualOutput = ViewModelEvalwithother1.AEvaluationGoalEvaluationActualOutput;
            av1.EvaluationDifferenceOutputs = (av1.EvaluationActualOutput - av1.CovenantTargetedOutput);
            double fc = Convert.ToDouble(av1.EvaluationActualOutput) / Convert.ToDouble(av1.CovenantTargetedOutput);
            if (fc > 1)
            {
                av1.EvaluationEquilibrium = 5;
            }
            else if (fc >= 0.9 && fc <= 1)
            {
                av1.EvaluationEquilibrium = 4;
            }
            else if (fc >= 0.8 && fc < 0.9)
            {
                av1.EvaluationEquilibrium = 3;
            }
            else if (fc >= 0.6 && fc < 0.8)
            {
                av1.EvaluationEquilibrium = 2;
            }
            else if (fc < 0.6)
            {
                av1.EvaluationEquilibrium = 1;
            }
            av1.EvaluationResult = av1.EvaluationEquilibrium * av1.CovenantPercentageWeight;
            av2.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
            av2.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName2;
            av2.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria2;
            av2.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight2;
            av2.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput2;
            av2.EvaluationActualOutput = ViewModelEvalwithother1.AEvaluationGoalEvaluationActualOutput2;
            av2.EvaluationDifferenceOutputs = (av2.EvaluationActualOutput - av2.CovenantTargetedOutput);
            double fc2 = (double)(av2.EvaluationActualOutput / av2.CovenantTargetedOutput);
            if (fc2 > 1)
            {
                av2.EvaluationEquilibrium = 5;
            }
            else if (fc2 >= .9 && fc2 <= 1)
            {
                av2.EvaluationEquilibrium = 4;
            }
            else if (fc2 >= .8 && fc2 < .9)
            {
                av2.EvaluationEquilibrium = 3;
            }
            else if (fc2 >= .6 && fc2 < .8)
            {
                av2.EvaluationEquilibrium = 2;
            }
            else if (fc2 < .6)
            {
                av2.EvaluationEquilibrium = 1;
            }
            av2.EvaluationResult = av2.EvaluationEquilibrium * av2.CovenantPercentageWeight;
            av3.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
            av3.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName3;
            av3.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria3;
            av3.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight3;
            av3.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput3;
            av3.EvaluationActualOutput = ViewModelEvalwithother1.AEvaluationGoalEvaluationActualOutput3;
            av3.EvaluationDifferenceOutputs = (av3.EvaluationActualOutput - av3.CovenantTargetedOutput);
            double fc3 = (double)(av3.EvaluationActualOutput / av3.CovenantTargetedOutput);
            if (fc3 > 1)
            {
                av3.EvaluationEquilibrium = 5;
            }
            else if (fc3 >= .9 && fc3 <= 1)
            {
                av3.EvaluationEquilibrium = 4;
            }
            else if (fc3 >= .8 && fc3 < .9)
            {
                av3.EvaluationEquilibrium = 3;
            }
            else if (fc3 >= .6 && fc3 < .8)
            {
                av3.EvaluationEquilibrium = 2;
            }
            else if (fc3 < .6)
            {
                av3.EvaluationEquilibrium = 1;
            }
            av3.EvaluationResult = av3.EvaluationEquilibrium * av3.CovenantPercentageWeight;
            av4.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
            av4.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName4;
            av4.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria4;
            av4.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight4;
            av4.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput4;
            av4.EvaluationActualOutput = ViewModelEvalwithother1.AEvaluationGoalEvaluationActualOutput4;
            av4.EvaluationDifferenceOutputs = (av4.EvaluationActualOutput - av4.CovenantTargetedOutput);
            double fc4 = (double)(av4.EvaluationActualOutput / av4.CovenantTargetedOutput);
            if (fc4 > 1)
            {
                av4.EvaluationEquilibrium = 5;
            }
            else if (fc4 >= .9 && fc4 <= 1)
            {
                av4.EvaluationEquilibrium = 4;
            }
            else if (fc4 >= .8 && fc4 < .9)
            {
                av4.EvaluationEquilibrium = 3;
            }
            else if (fc4 >= .6 && fc4 < .8)
            {
                av4.EvaluationEquilibrium = 2;
            }
            else if (fc4 < .6)
            {
                av4.EvaluationEquilibrium = 1;
            }
            av4.EvaluationResult = av4.EvaluationEquilibrium * av4.CovenantPercentageWeight;
            av1.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult;
            av2.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult;
            av3.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult;
            av4.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult;
            if (vAEvaluationGoals.Count > 4)
            {
                av5.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
                av5.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName5;
                av5.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria5;
                av5.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight5;
                av5.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput5 == null ? 0 : ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput5;
                av5.EvaluationActualOutput = ViewModelEvalwithother1.AEvaluationGoalEvaluationActualOutput5 == null ? 0 : ViewModelEvalwithother1.AEvaluationGoalEvaluationActualOutput5;
                av5.EvaluationDifferenceOutputs = (av5.EvaluationActualOutput - av5.CovenantTargetedOutput);
                double fc5 = (double)(av5.EvaluationActualOutput / av5.CovenantTargetedOutput);
                av5.EvaluationEquilibrium = 0;
                if (fc5 > 1)
                {
                    av5.EvaluationEquilibrium = 5;
                }
                else if (fc5 >= .9 && fc5 <= 1)
                {
                    av5.EvaluationEquilibrium = 4;
                }
                else if (fc5 >= .8 && fc5 < .9)
                {
                    av5.EvaluationEquilibrium = 3;
                }
                else if (fc5 >= .6 && fc5 < .8)
                {
                    av5.EvaluationEquilibrium = 2;
                }
                else if (fc5 < .6)
                {
                    av5.EvaluationEquilibrium = 1;
                }
                av5.CovenantPercentageWeight = av5.CovenantPercentageWeight == null ? 0 : av5.CovenantPercentageWeight;
                av5.EvaluationResult = av5.EvaluationEquilibrium * av5.CovenantPercentageWeight;
                av1.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult + av5.EvaluationResult;
                av2.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult + av5.EvaluationResult;
                av3.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult + av5.EvaluationResult;
                av4.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult + av5.EvaluationResult;
                av5.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult + av5.EvaluationResult;

            }
            if (vAEvaluationGoals.Count > 5)
            {
                av6.CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId;
                av6.CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName6;
                av6.CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria6;
                av6.CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight6;
                av6.CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput6 == null ? 0 : ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput6;
                av6.EvaluationActualOutput = ViewModelEvalwithother1.AEvaluationGoalEvaluationActualOutput6 == null ? 0 : ViewModelEvalwithother1.AEvaluationGoalEvaluationActualOutput6;
                av6.EvaluationDifferenceOutputs = (av6.EvaluationActualOutput - av6.CovenantTargetedOutput);
                double fc6 = (double)(av6.EvaluationActualOutput / av6.CovenantTargetedOutput);
                av6.EvaluationEquilibrium = 0;
                if (fc6 > 1)
                {
                    av6.EvaluationEquilibrium = 5;
                }
                else if (fc6 >= .9 && fc6 <= 1)
                {
                    av6.EvaluationEquilibrium = 4;
                }
                else if (fc6 >= .8 && fc6 < .9)
                {
                    av6.EvaluationEquilibrium = 3;
                }
                else if (fc6 >= .6 && fc6 < .8)
                {
                    av6.EvaluationEquilibrium = 2;
                }
                else if (fc6 < .6)
                {
                    av6.EvaluationEquilibrium = 1;
                }
                av6.CovenantPercentageWeight = av6.CovenantPercentageWeight == null ? 0 : av6.CovenantPercentageWeight;
                av6.EvaluationResult = av6.EvaluationEquilibrium * av6.CovenantPercentageWeight;
                av1.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult + av5.EvaluationResult + av6.EvaluationResult;
                av2.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult + av5.EvaluationResult + av6.EvaluationResult;
                av3.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult + av5.EvaluationResult + av6.EvaluationResult;
                av4.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult + av5.EvaluationResult + av6.EvaluationResult;
                av5.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult + av5.EvaluationResult + av6.EvaluationResult;
                av6.EvaluationTotal = av1.EvaluationResult + av2.EvaluationResult + av3.EvaluationResult + av4.EvaluationResult + av5.EvaluationResult + av6.EvaluationResult;
            }
            List<AEvaluationCompetenciesM> vAEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.Where(d => d.CovenantId == ViewModelEvalwithother1.AEvaluationEmpIdd).OrderBy(d => d.CovenantCompetenciesSeq).ToList();
            am1 = vAEvaluationCompetenciesMs[0];
            am2 = vAEvaluationCompetenciesMs[1];
            am3 = vAEvaluationCompetenciesMs[2];
            am4 = vAEvaluationCompetenciesMs[3];
            am5 = vAEvaluationCompetenciesMs[4];
            am6 = vAEvaluationCompetenciesMs[5];
            if (vAEvaluationCompetenciesMs.Count > 6)
            {
                am7 = vAEvaluationCompetenciesMs[6];
            }
            //am7 = vAEvaluationCompetenciesMs[6];
            am1.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight1;
            am2.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight2;
            am3.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight3;
            am4.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight4;
            am5.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight5;
            am6.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight6;
            if (vAEvaluationCompetenciesMs.Count > 6)
            {

                am7.CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7 == null ? "0" : ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7;
            }
            List<AEvaluationCompetenciesD> vAEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.Where(d => d.CovenantId == ViewModelEvalwithother1.AEvaluationEmpIdd).OrderBy(d => d.CovenantCompetenciesDSeq).ThenBy(d => d.CovenantCompetenciesDSeqD).ToList();
            ad1 = vAEvaluationCompetenciesDs[0];
            ad2 = vAEvaluationCompetenciesDs[1];
            ad3 = vAEvaluationCompetenciesDs[2];
            ad4 = vAEvaluationCompetenciesDs[3];
            ad5 = vAEvaluationCompetenciesDs[4];
            ad6 = vAEvaluationCompetenciesDs[5];
            ad7 = vAEvaluationCompetenciesDs[6];
            ad8 = vAEvaluationCompetenciesDs[7];
            ad9 = vAEvaluationCompetenciesDs[8];
            ad10 = vAEvaluationCompetenciesDs[9];
            ad11 = vAEvaluationCompetenciesDs[10];
            ad12 = vAEvaluationCompetenciesDs[11];
            ad13 = vAEvaluationCompetenciesDs[12];
            ad14 = vAEvaluationCompetenciesDs[13];
            ad15 = vAEvaluationCompetenciesDs[14];
            ad16 = vAEvaluationCompetenciesDs[15];
            ad17 = vAEvaluationCompetenciesDs[16];
            ad18 = vAEvaluationCompetenciesDs[17];
            if (vAEvaluationCompetenciesDs.Count > 18)
            {
                ad19 = vAEvaluationCompetenciesDs[18];
                ad20 = vAEvaluationCompetenciesDs[19];
                ad21 = vAEvaluationCompetenciesDs[20];
                ad22 = vAEvaluationCompetenciesDs[21];
                ad23 = vAEvaluationCompetenciesDs[22];
            }
            ad1.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel1;
            ad1.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel01;
            double cd1 = (double)(ad1.EvaluationOutputCompetency / ad1.CovenantCompetenciecDLevel);
            if (cd1 >= 1)
            {
                ad1.EvaluationResults = 5;
            }
            else if (cd1 >= .8 && cd1 < 1)
            {
                ad1.EvaluationResults = 4;
            }
            else if (cd1 >= .6 && cd1 < .8)
            {
                ad1.EvaluationResults = 3;
            }
            else if (cd1 >= .4 && cd1 < .6)
            {
                ad1.EvaluationResults = 2;
            }
            else if (cd1 < .4)
            {
                ad1.EvaluationResults = 1;
            }
            //ad1.EvaluationResults2 = (Convert.ToDouble(am1.CovenantWeight) * ad1.EvaluationResults);
            ad2.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel2;
            ad2.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel02;
            double cd2 = (double)(ad2.EvaluationOutputCompetency / ad2.CovenantCompetenciecDLevel);

            if (cd2 >= 1)
            {
                ad2.EvaluationResults = 5;
            }
            else if (cd2 >= .8 && cd2 < 1)
            {
                ad2.EvaluationResults = 4;
            }
            else if (cd2 >= .6 && cd2 < .8)
            {
                ad2.EvaluationResults = 3;
            }
            else if (cd2 >= .4 && cd2 < .6)
            {
                ad2.EvaluationResults = 2;
            }
            else if (cd2 < .4)
            {
                ad2.EvaluationResults = 1;
            }
            //ad2.EvaluationResults2 = (Convert.ToDouble(am1.CovenantWeight) * ad2.EvaluationResults);
            ad3.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel3;
            ad3.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel03;
            double cd3 = (double)(ad3.EvaluationOutputCompetency / ad3.CovenantCompetenciecDLevel);
            if (cd3 >= 1)
            {
                ad3.EvaluationResults = 5;
            }
            else if (cd3 >= .8 && cd3 < 1)
            {
                ad3.EvaluationResults = 4;
            }
            else if (cd3 >= .6 && cd3 < .8)
            {
                ad3.EvaluationResults = 3;
            }
            else if (cd3 >= .4 && cd3 < .6)
            {
                ad3.EvaluationResults = 2;
            }
            else if (cd3 < .4)
            {
                ad3.EvaluationResults = 1;
            }
            ad1.EvaluationResults2 = (Convert.ToDouble(am1.CovenantWeight) * (ad1.EvaluationResults + ad2.EvaluationResults + ad3.EvaluationResults) / 3);
            ad2.EvaluationResults2 = (Convert.ToDouble(am1.CovenantWeight) * (ad1.EvaluationResults + ad2.EvaluationResults + ad3.EvaluationResults) / 3);
            ad3.EvaluationResults2 = (Convert.ToDouble(am1.CovenantWeight) * (ad1.EvaluationResults + ad2.EvaluationResults + ad3.EvaluationResults) / 3);
            ad4.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel4;
            ad4.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel04;
            double cd4 = (double)(ad4.EvaluationOutputCompetency / ad4.CovenantCompetenciecDLevel);
            if (cd4 >= 1)
            {
                ad4.EvaluationResults = 5;
            }
            else if (cd4 >= .8 && cd4 < 1)
            {
                ad4.EvaluationResults = 4;
            }
            else if (cd4 >= .6 && cd4 < .8)
            {
                ad4.EvaluationResults = 3;
            }
            else if (cd4 >= .4 && cd4 < .6)
            {
                ad4.EvaluationResults = 2;
            }
            else if (cd4 < .4)
            {
                ad4.EvaluationResults = 1;
            }
            //ad4.EvaluationResults2 = (Convert.ToDouble(am2.CovenantWeight) * ad4.EvaluationResults);
            ad5.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel5;
            ad5.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel05;
            double cd5 = (double)(ad5.EvaluationOutputCompetency / ad5.CovenantCompetenciecDLevel);
            if (cd5 >= 1)
            {
                ad5.EvaluationResults = 5;
            }
            else if (cd5 >= .8 && cd5 < 1)
            {
                ad5.EvaluationResults = 4;
            }
            else if (cd5 >= .6 && cd5 < .8)
            {
                ad5.EvaluationResults = 3;
            }
            else if (cd5 >= .4 && cd5 < .6)
            {
                ad5.EvaluationResults = 2;
            }
            else if (cd5 < .4)
            {
                ad5.EvaluationResults = 1;
            }
            //ad5.EvaluationResults2 = (Convert.ToDouble(am2.CovenantWeight) * ad5.EvaluationResults);
            ad6.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel6;
            ad6.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel06;
            double cd6 = (double)(ad6.EvaluationOutputCompetency / ad6.CovenantCompetenciecDLevel);
            if (cd6 >= 1)
            {
                ad6.EvaluationResults = 5;
            }
            else if (cd6 >= .8 && cd6 < 1)
            {
                ad6.EvaluationResults = 4;
            }
            else if (cd6 >= .6 && cd6 < .8)
            {
                ad6.EvaluationResults = 3;
            }
            else if (cd6 >= .4 && cd6 < .6)
            {
                ad6.EvaluationResults = 2;
            }
            else if (cd6 < .4)
            {
                ad6.EvaluationResults = 1;
            }
            ad4.EvaluationResults2 = (Convert.ToDouble(am2.CovenantWeight) * (ad4.EvaluationResults + ad5.EvaluationResults + ad6.EvaluationResults) / 3);
            ad5.EvaluationResults2 = (Convert.ToDouble(am2.CovenantWeight) * (ad4.EvaluationResults + ad5.EvaluationResults + ad6.EvaluationResults) / 3);
            ad6.EvaluationResults2 = (Convert.ToDouble(am2.CovenantWeight) * (ad4.EvaluationResults + ad5.EvaluationResults + ad6.EvaluationResults) / 3);
            ad7.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel7;
            ad7.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel07;
            double cd7 = (double)(ad7.EvaluationOutputCompetency / ad7.CovenantCompetenciecDLevel);
            if (cd7 >= 1)
            {
                ad7.EvaluationResults = 5;
            }
            else if (cd7 >= .8 && cd7 < 1)
            {
                ad7.EvaluationResults = 4;
            }
            else if (cd7 >= .6 && cd7 < .8)
            {
                ad7.EvaluationResults = 3;
            }
            else if (cd7 >= .4 && cd7 < .6)
            {
                ad7.EvaluationResults = 2;
            }
            else if (cd7 < .4)
            {
                ad7.EvaluationResults = 1;
            }
            //ad7.EvaluationResults2 = (Convert.ToDouble(am3.CovenantWeight) * ad7.EvaluationResults);
            ad8.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel8;
            ad8.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel08;
            double cd8 = (double)(ad8.EvaluationOutputCompetency / ad8.CovenantCompetenciecDLevel);
            if (cd8 >= 1)
            {
                ad8.EvaluationResults = 5;
            }
            else if (cd8 >= .8 && cd8 < 1)
            {
                ad8.EvaluationResults = 4;
            }
            else if (cd8 >= .6 && cd8 < .8)
            {
                ad8.EvaluationResults = 3;
            }
            else if (cd8 >= .4 && cd8 < .6)
            {
                ad8.EvaluationResults = 2;
            }
            else if (cd8 < .4)
            {
                ad8.EvaluationResults = 1;
            }
            //ad8.EvaluationResults2 = (Convert.ToDouble(am3.CovenantWeight) * ad8.EvaluationResults);
            ad9.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel9;
            ad9.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel09;
            double cd9 = (double)(ad9.EvaluationOutputCompetency / ad9.CovenantCompetenciecDLevel);
            if (cd9 >= 1)
            {
                ad9.EvaluationResults = 5;
            }
            else if (cd9 >= .8 && cd9 < 1)
            {
                ad9.EvaluationResults = 4;
            }
            else if (cd9 >= .6 && cd9 < .8)
            {
                ad9.EvaluationResults = 3;
            }
            else if (cd9 >= .4 && cd9 < .6)
            {
                ad9.EvaluationResults = 2;
            }
            else if (cd9 < .4)
            {
                ad9.EvaluationResults = 1;
            }
            ad7.EvaluationResults2 = (Convert.ToDouble(am3.CovenantWeight) * (ad7.EvaluationResults + ad8.EvaluationResults + ad9.EvaluationResults) / 3);
            ad8.EvaluationResults2 = (Convert.ToDouble(am3.CovenantWeight) * (ad7.EvaluationResults + ad8.EvaluationResults + ad9.EvaluationResults) / 3);
            ad9.EvaluationResults2 = (Convert.ToDouble(am3.CovenantWeight) * (ad7.EvaluationResults + ad8.EvaluationResults + ad9.EvaluationResults) / 3);
            ad10.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel10;
            ad10.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel010;
            double cd10 = (double)(ad10.EvaluationOutputCompetency / ad10.CovenantCompetenciecDLevel);
            if (cd10 >= 1)
            {
                ad10.EvaluationResults = 5;
            }
            else if (cd10 >= .8 && cd10 < 1)
            {
                ad10.EvaluationResults = 4;
            }
            else if (cd10 >= .6 && cd10 < .8)
            {
                ad10.EvaluationResults = 3;
            }
            else if (cd10 >= .4 && cd10 < .6)
            {
                ad10.EvaluationResults = 2;
            }
            else if (cd10 < .4)
            {
                ad10.EvaluationResults = 1;
            }
            //ad10.EvaluationResults2 = (Convert.ToDouble(am4.CovenantWeight) * ad10.EvaluationResults);
            ad11.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel11;
            ad11.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel011;
            double cd11 = (double)(ad11.EvaluationOutputCompetency / ad11.CovenantCompetenciecDLevel);
            if (cd11 >= 1)
            {
                ad11.EvaluationResults = 5;
            }
            else if (cd11 >= .8 && cd11 < 1)
            {
                ad11.EvaluationResults = 4;
            }
            else if (cd11 >= .6 && cd11 < .8)
            {
                ad11.EvaluationResults = 3;
            }
            else if (cd11 >= .4 && cd11 < .6)
            {
                ad11.EvaluationResults = 2;
            }
            else if (cd11 < .4)
            {
                ad11.EvaluationResults = 1;
            }
            //ad11.EvaluationResults2 = (Convert.ToDouble(am4.CovenantWeight) * ad11.EvaluationResults);
            ad12.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel12;
            ad12.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel012;
            double cd12 = (double)(ad12.EvaluationOutputCompetency / ad12.CovenantCompetenciecDLevel);
            if (cd12 >= 1)
            {
                ad12.EvaluationResults = 5;
            }
            else if (cd12 >= .8 && cd12 < 1)
            {
                ad12.EvaluationResults = 4;
            }
            else if (cd12 >= .6 && cd12 < .8)
            {
                ad12.EvaluationResults = 3;
            }
            else if (cd12 >= .4 && cd12 < .6)
            {
                ad12.EvaluationResults = 2;
            }
            else if (cd12 < .4)
            {
                ad12.EvaluationResults = 1;
            }
            ad10.EvaluationResults2 = (Convert.ToDouble(am4.CovenantWeight) * (ad10.EvaluationResults + ad11.EvaluationResults + ad12.EvaluationResults) / 3);
            ad11.EvaluationResults2 = (Convert.ToDouble(am4.CovenantWeight) * (ad10.EvaluationResults + ad11.EvaluationResults + ad12.EvaluationResults) / 3);
            ad12.EvaluationResults2 = (Convert.ToDouble(am4.CovenantWeight) * (ad10.EvaluationResults + ad11.EvaluationResults + ad12.EvaluationResults) / 3);
            ad13.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel13;
            ad13.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel013;
            double cd13 = (double)(ad13.EvaluationOutputCompetency / ad13.CovenantCompetenciecDLevel);
            if (cd13 >= 1)
            {
                ad13.EvaluationResults = 5;
            }
            else if (cd13 >= .8 && cd13 < 1)
            {
                ad13.EvaluationResults = 4;
            }
            else if (cd13 >= .6 && cd13 < .8)
            {
                ad13.EvaluationResults = 3;
            }
            else if (cd13 >= .4 && cd13 < .6)
            {
                ad13.EvaluationResults = 2;
            }
            else if (cd13 < .4)
            {
                ad13.EvaluationResults = 1;
            }
            //ad13.EvaluationResults2 = (Convert.ToDouble(am5.CovenantWeight) * ad13.EvaluationResults);
            ad14.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel14;
            ad14.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel014;
            double cd14 = (double)(ad14.EvaluationOutputCompetency / ad14.CovenantCompetenciecDLevel);
            if (cd14 >= 1)
            {
                ad14.EvaluationResults = 5;
            }
            else if (cd14 >= .8 && cd14 < 1)
            {
                ad14.EvaluationResults = 4;
            }
            else if (cd14 >= .6 && cd14 < .8)
            {
                ad14.EvaluationResults = 3;
            }
            else if (cd14 >= .4 && cd14 < .6)
            {
                ad14.EvaluationResults = 2;
            }
            else if (cd14 < .4)
            {
                ad14.EvaluationResults = 1;
            }
            ad13.EvaluationResults2 = (Convert.ToDouble(am5.CovenantWeight) * (ad13.EvaluationResults + ad14.EvaluationResults) / 2);
            ad14.EvaluationResults2 = (Convert.ToDouble(am5.CovenantWeight) * (ad13.EvaluationResults + ad14.EvaluationResults) / 2);
            ad15.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel15;
            ad15.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel015;
            double cd15 = (double)(ad15.EvaluationOutputCompetency / ad15.CovenantCompetenciecDLevel);
            if (cd15 >= 1)
            {
                ad15.EvaluationResults = 5;
            }
            else if (cd15 >= .8 && cd15 < 1)
            {
                ad15.EvaluationResults = 4;
            }
            else if (cd15 >= .6 && cd15 < .8)
            {
                ad15.EvaluationResults = 3;
            }
            else if (cd15 >= .4 && cd15 < .6)
            {
                ad15.EvaluationResults = 2;
            }
            else if (cd15 < .4)
            {
                ad15.EvaluationResults = 1;
            }
            //ad15.EvaluationResults2 = (Convert.ToDouble(am6.CovenantWeight) * ad15.EvaluationResults);
            ad16.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel16;
            ad16.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel016;
            double cd16 = (double)(ad16.EvaluationOutputCompetency / ad16.CovenantCompetenciecDLevel);
            if (cd16 >= 1)
            {
                ad16.EvaluationResults = 5;
            }
            else if (cd16 >= .8 && cd16 < 1)
            {
                ad16.EvaluationResults = 4;
            }
            else if (cd16 >= .6 && cd16 < .8)
            {
                ad16.EvaluationResults = 3;
            }
            else if (cd16 >= .4 && cd16 < .6)
            {
                ad16.EvaluationResults = 2;
            }
            else if (cd16 < .4)
            {
                ad16.EvaluationResults = 1;
            }
            //ad16.EvaluationResults2 = (Convert.ToDouble(am6.CovenantWeight) * ad16.EvaluationResults);
            ad17.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel17;
            ad17.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel017;
            double cd17 = (double)(ad17.EvaluationOutputCompetency / ad17.CovenantCompetenciecDLevel);
            if (cd17 >= 1)
            {
                ad17.EvaluationResults = 5;
            }
            else if (cd17 >= .8 && cd17 < 1)
            {
                ad17.EvaluationResults = 4;
            }
            else if (cd17 >= .6 && cd17 < .8)
            {
                ad17.EvaluationResults = 3;
            }
            else if (cd17 >= .4 && cd17 < .6)
            {
                ad17.EvaluationResults = 2;
            }
            else if (cd17 < .4)
            {
                ad17.EvaluationResults = 1;
            }
            //ad17.EvaluationResults2 = (Convert.ToDouble(am6.CovenantWeight) * ad17.EvaluationResults);
            ad18.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel18;
            ad18.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel018;
            double cd18 = (double)(ad18.EvaluationOutputCompetency / ad18.CovenantCompetenciecDLevel);
            if (cd18 >= 1)
            {
                ad18.EvaluationResults = 5;
            }
            else if (cd18 >= .8 && cd18 < 1)
            {
                ad18.EvaluationResults = 4;
            }
            else if (cd18 >= .6 && cd18 < .8)
            {
                ad18.EvaluationResults = 3;
            }
            else if (cd18 >= .4 && cd18 < .6)
            {
                ad18.EvaluationResults = 2;
            }
            else if (cd18 < .4)
            {
                ad18.EvaluationResults = 1;
            }
            ad15.EvaluationResults2 = (Convert.ToDouble(am6.CovenantWeight) * (ad15.EvaluationResults + ad16.EvaluationResults + ad17.EvaluationResults + ad18.EvaluationResults) / 4);
            ad16.EvaluationResults2 = (Convert.ToDouble(am6.CovenantWeight) * (ad15.EvaluationResults + ad16.EvaluationResults + ad17.EvaluationResults + ad18.EvaluationResults) / 4);
            ad17.EvaluationResults2 = (Convert.ToDouble(am6.CovenantWeight) * (ad15.EvaluationResults + ad16.EvaluationResults + ad17.EvaluationResults + ad18.EvaluationResults) / 4);
            ad18.EvaluationResults2 = (Convert.ToDouble(am6.CovenantWeight) * (ad15.EvaluationResults + ad16.EvaluationResults + ad17.EvaluationResults + ad18.EvaluationResults) / 4);
            ad18.EvaluationTotal = ad18.EvaluationResults2 + ad14.EvaluationResults2
                + ad12.EvaluationResults2 + ad9.EvaluationResults2
                + ad6.EvaluationResults2 + ad3.EvaluationResults2;
            if (vAEvaluationCompetenciesDs.Count > 18)
            {
                ad19.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel19 == null ? 0 : ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel19;
                ad19.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel019 == null ? 0 : ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel019;
                double cd19 = (double)(ad19.EvaluationOutputCompetency / ad19.CovenantCompetenciecDLevel);
                ad19.EvaluationResults = 0;
                if (cd19 >= 1)
                {
                    ad19.EvaluationResults = 5;
                }
                else if (cd19 >= .8 && cd19 < 1)
                {
                    ad19.EvaluationResults = 4;
                }
                else if (cd19 >= .6 && cd19 < .8)
                {
                    ad19.EvaluationResults = 3;
                }
                else if (cd19 >= .4 && cd19 < .6)
                {
                    ad19.EvaluationResults = 2;
                }
                else if (cd19 < .4)
                {
                    ad19.EvaluationResults = 1;
                }
                //ad19.EvaluationResults2 = (Convert.ToDouble(am7.CovenantWeight) * ad19.EvaluationResults);
                ad20.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel20 == null ? 0 : ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel20;
                ad20.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel020 == null ? 0 : ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel020;
                double cd20 = (double)(ad20.EvaluationOutputCompetency / ad20.CovenantCompetenciecDLevel);
                ad20.EvaluationResults = 0;
                if (cd20 >= 1)
                {
                    ad20.EvaluationResults = 5;
                }
                else if (cd20 >= .8 && cd20 < 1)
                {
                    ad20.EvaluationResults = 4;
                }
                else if (cd20 >= .6 && cd20 < .8)
                {
                    ad20.EvaluationResults = 3;
                }
                else if (cd20 >= .4 && cd20 < .6)
                {
                    ad20.EvaluationResults = 2;
                }
                else if (cd20 < .4)
                {
                    ad20.EvaluationResults = 1;
                }
                //ad20.EvaluationResults2 = (Convert.ToDouble(am7.CovenantWeight) * ad20.EvaluationResults);
                ad21.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel21 == null ? 0 : ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel21;
                ad21.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel021 == null ? 0 : ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel021;
                double cd21 = (double)(ad21.EvaluationOutputCompetency / ad21.CovenantCompetenciecDLevel);
                ad21.EvaluationResults = 0;
                if (cd21 >= 1)
                {
                    ad21.EvaluationResults = 5;
                }
                else if (cd21 >= .8 && cd21 < 1)
                {
                    ad21.EvaluationResults = 4;
                }
                else if (cd21 >= .6 && cd21 < .8)
                {
                    ad21.EvaluationResults = 3;
                }
                else if (cd21 >= .4 && cd21 < .6)
                {
                    ad21.EvaluationResults = 2;
                }
                else if (cd21 < .4)
                {
                    ad21.EvaluationResults = 1;
                }
                //ad21.EvaluationResults2 = (Convert.ToDouble(am7.CovenantWeight) * ad21.EvaluationResults);
                ad22.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel22 == null ? 0 : ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel22;
                ad22.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel022 == null ? 0 : ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel022;
                double cd22 = (double)(ad22.EvaluationOutputCompetency / ad22.CovenantCompetenciecDLevel);
                ad22.EvaluationResults = 0;
                if (cd22 >= 1)
                {
                    ad22.EvaluationResults = 5;
                }
                else if (cd22 >= .8 && cd22 < 1)
                {
                    ad22.EvaluationResults = 4;
                }
                else if (cd22 >= .6 && cd22 < .8)
                {
                    ad22.EvaluationResults = 3;
                }
                else if (cd22 >= .4 && cd22 < .6)
                {
                    ad22.EvaluationResults = 2;
                }
                else if (cd22 < .4)
                {
                    ad22.EvaluationResults = 1;
                }
                //ad22.EvaluationResults2 = (Convert.ToDouble(am7.CovenantWeight) * ad22.EvaluationResults);
                ad23.CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel23 == null ? 0 : ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel23;
                ad23.EvaluationOutputCompetency = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel023 == null ? 0 : ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel023;
                double cd23 = (double)(ad23.EvaluationOutputCompetency / ad23.CovenantCompetenciecDLevel);
                ad23.EvaluationResults = 0;
                if (cd23 >= 1)
                {
                    ad23.EvaluationResults = 5;
                }
                else if (cd23 >= .8 && cd23 < 1)
                {
                    ad23.EvaluationResults = 4;
                }
                else if (cd23 >= .6 && cd23 < .8)
                {
                    ad23.EvaluationResults = 3;
                }
                else if (cd23 >= .4 && cd23 < .6)
                {
                    ad23.EvaluationResults = 2;
                }
                else if (cd23 < .4)
                {
                    ad23.EvaluationResults = 1;
                }

                ad19.EvaluationResults2 = (Convert.ToDouble(am7.CovenantWeight) * (ad19.EvaluationResults + ad20.EvaluationResults + ad21.EvaluationResults + ad22.EvaluationResults + ad23.EvaluationResults) / 5);
                ad20.EvaluationResults2 = (Convert.ToDouble(am7.CovenantWeight) * (ad19.EvaluationResults + ad20.EvaluationResults + ad21.EvaluationResults + ad22.EvaluationResults + ad23.EvaluationResults) / 5);
                ad21.EvaluationResults2 = (Convert.ToDouble(am7.CovenantWeight) * (ad19.EvaluationResults + ad20.EvaluationResults + ad21.EvaluationResults + ad22.EvaluationResults + ad23.EvaluationResults) / 5);
                ad22.EvaluationResults2 = (Convert.ToDouble(am7.CovenantWeight) * (ad19.EvaluationResults + ad20.EvaluationResults + ad21.EvaluationResults + ad22.EvaluationResults + ad23.EvaluationResults) / 5);
                ad23.EvaluationResults2 = (Convert.ToDouble(am7.CovenantWeight) * (ad19.EvaluationResults + ad20.EvaluationResults + ad21.EvaluationResults + ad22.EvaluationResults + ad23.EvaluationResults) / 5);



                ad23.EvaluationTotal = ad23.EvaluationResults2 + ad18.EvaluationResults2 + ad14.EvaluationResults2
                + ad12.EvaluationResults2 + ad9.EvaluationResults2
                + ad6.EvaluationResults2 + ad3.EvaluationResults2;
            }
            //if (ModelState.IsValid)
            //{
            // create log 
            Aeval2log aevallog = new Aeval2log()
            {
                Editdate = DateTime.Now,
                Useredit = HttpContext.Session.GetString("username"),
                Evid = Convert.ToString(ViewModelEvalwithother1.AEvaluationGoalCovenantId)

            };
            _context.Add(aevallog);
            // create comment for request
            //AEvaluationEmpComment AEvaluationEmpComment1 = new AEvaluationEmpComment()
            //{
            //    datecomment = DateTime.Now,
            //    commentby = HttpContext.Session.GetString("username"),
            //    covenreqid = Convert.ToString(ViewModelEvalwithother1.AEvaluationGoalCovenantId),
            //    commentforreq = ViewModelEvalwithother1.commentforreq

            //};
            //_context.Add(AEvaluationEmpComment1);
            //
             vAEvaluationEmps11.comment1 = ViewModelEvalwithother1.commentforreq;
            _context.Update(vAEvaluationEmps11);
            _context.Update(av1);
            _context.Update(av2);
            _context.Update(av3);
            _context.Update(av4);
            if (vAEvaluationGoals.Count > 4)
            {
                _context.Update(av5);
                // create new goal like in edit for form 

            }
            if (vAEvaluationGoals.Count > 5)
            {
                _context.Update(av6);
            }
            if (ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName5 != null && vAEvaluationGoals.Count == 4)
            {
                AEvaluationGoal aEvaluationGoal5 = new AEvaluationGoal { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, EmpType = "مدير", CovenantGoalsSeq = 5, CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName5, CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria5, CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight5, CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput5, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId, CovenantDate = DateTime.Now, EvaluationActualOutput = ViewModelEvalwithother1.AEvaluationGoalEvaluationActualOutput5, EvaluationDate = null, EvaluationDifferenceOutputs = null, EvaluationEquilibrium = null, EvaluationId = null, EvaluationResult = null, EvaluationTotal = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantWeightSum = 100, EmpIdEnter = Convert.ToInt32(HttpContext.Session.GetString("empid")) };
                _context.Add(aEvaluationGoal5);

            }
            if (ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName6 != null && vAEvaluationGoals.Count == 5)
            {
                AEvaluationGoal aEvaluationGoal6 = new AEvaluationGoal { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, EmpType = "مدير", CovenantGoalsSeq = 6, CovenantGoalsName = ViewModelEvalwithother1.AEvaluationGoalCovenantGoalsName6, CovenantMeasurementCriteria = ViewModelEvalwithother1.AEvaluationGoalCovenantMeasurementCriteria6, CovenantPercentageWeight = ViewModelEvalwithother1.AEvaluationGoalCovenantPercentageWeight6, CovenantTargetedOutput = ViewModelEvalwithother1.AEvaluationGoalCovenantTargetedOutput6, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId, CovenantDate = DateTime.Now, EvaluationActualOutput = ViewModelEvalwithother1.AEvaluationGoalEvaluationActualOutput6, EvaluationDate = null, EvaluationDifferenceOutputs = null, EvaluationEquilibrium = null, EvaluationId = null, EvaluationResult = null, EvaluationTotal = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantWeightSum = 100, EmpIdEnter = Convert.ToInt32(HttpContext.Session.GetString("empid")) };
                _context.Add(aEvaluationGoal6);

            }

            _context.Update(am1);
            _context.Update(am2);
            _context.Update(am3);
            _context.Update(am4);
            _context.Update(am5);
            if (vAEvaluationCompetenciesMs.Count > 6)
            {
                _context.Update(am7);
            }
            if (ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7 != null && vAEvaluationCompetenciesMs.Count == 6)
            {
                AEvaluationCompetenciesM aEvaluationCompetenciesM7 = new AEvaluationCompetenciesM { CovenantCompetenciesSeq = 7, CovenantCompetencyName = "القيادة", CovenantWeight = ViewModelEvalwithother1.AEvaluationCompetenciesMCovenantWeight7, EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantWeightSum = 100, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                _context.Add(aEvaluationCompetenciesM7);
            }

            _context.Update(ad1);
            _context.Update(ad2);
            _context.Update(ad3);
            _context.Update(ad4);
            _context.Update(ad5);

            _context.Update(ad6);
            _context.Update(ad7);
            _context.Update(ad8);
            _context.Update(ad9);
            _context.Update(ad10);
            _context.Update(ad11);

            _context.Update(ad12);
            _context.Update(ad13);
            _context.Update(ad14);
            _context.Update(ad15);
            _context.Update(ad16);
            _context.Update(ad17);
            _context.Update(ad18);
            if (vAEvaluationCompetenciesDs.Count > 18)
            {
                _context.Update(ad19);
                _context.Update(ad20);
                _context.Update(ad21);
                _context.Update(ad22);
                _context.Update(ad23);


            }
            if (ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel19 != null && vAEvaluationCompetenciesDs.Count == 18)
            {
                AEvaluationCompetenciesD aEvaluationCompetenciesD19 = new AEvaluationCompetenciesD { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantCompetenciesDSeq = 7, CovenantCompetenciesDDesc = "مرن وقادر على تنفيذ أعمال هامة فى ظروف تنطوى على قدر كبير من المخاطرة وعدم اليقين .", CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel19, EvaluationOutputCompetency = null, EvaluationResults = null, EvaluationTotal = null, CovenantCompetenciesDSeqD = 1, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                AEvaluationCompetenciesD aEvaluationCompetenciesD20 = new AEvaluationCompetenciesD { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantCompetenciesDSeq = 7, CovenantCompetenciesDDesc = "يدعم و يشجع فريقه على تحقيق اهدافه، حتى في الظروف الصعبة  .", CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel20, EvaluationOutputCompetency = null, EvaluationResults = null, EvaluationTotal = null, CovenantCompetenciesDSeqD = 2, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                AEvaluationCompetenciesD aEvaluationCompetenciesD21 = new AEvaluationCompetenciesD { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantCompetenciesDSeq = 7, CovenantCompetenciesDDesc = "يفكر بمنطقية و ابداع دون التأثر بتحيزاته الشخصية.", CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel21, EvaluationOutputCompetency = null, EvaluationResults = null, EvaluationTotal = null, CovenantCompetenciesDSeqD = 3, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                AEvaluationCompetenciesD aEvaluationCompetenciesD22 = new AEvaluationCompetenciesD { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantCompetenciesDSeq = 7, CovenantCompetenciesDDesc = "يفوض الصلاحيات و يتابع النتائج  .", CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel22, EvaluationOutputCompetency = null, EvaluationResults = null, EvaluationTotal = null, CovenantCompetenciesDSeqD = 4, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };
                AEvaluationCompetenciesD aEvaluationCompetenciesD23 = new AEvaluationCompetenciesD { EmpId = ViewModelEvalwithother1.AEvaluationEmpEmpno, CovenantCompetenciesDSeq = 7, CovenantCompetenciesDDesc = "يوفر ويدعم فرص تطوير المرؤوسين.", CovenantCompetenciecDLevel = ViewModelEvalwithother1.AEvaluationCompetenciesDCovenantCompetenciecDLevel23, EvaluationOutputCompetency = null, EvaluationResults = null, EvaluationTotal = null, CovenantCompetenciesDSeqD = 5, CovenantId = ViewModelEvalwithother1.AEvaluationGoalCovenantId };

                _context.Add(aEvaluationCompetenciesD19);
                _context.Add(aEvaluationCompetenciesD20);
                _context.Add(aEvaluationCompetenciesD21);
                _context.Add(aEvaluationCompetenciesD22);
                _context.Add(aEvaluationCompetenciesD23);
            }



            _context.SaveChanges();





            return RedirectToAction(nameof(IndexOffered4));
            //}
            return View(ViewModelEvalwithother1);



        }
        //get
        public ActionResult IndexOffered3()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            TempData["user"] = HttpContext.Session.GetString("username");

            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail> EvalDetails = _context.EvalDetailss.ToList();
            List<EvalRequestTypeId> EvalRequestTypeIds = _context.EvalRequestTypeIds.ToList();
            //List<Evalcomment> evalcommentss = _context.EvalComments.ToList();
            List<Cemp> cemps = _context.Cemps.ToList();


            var Records = from e in AEvaluationEmps
                              //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                              //from d in table1.ToList()
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join f in EvalDetails on e.Idd equals f.CourcesIdoffered into table4
                          from f in table4.ToList()
                          where f.OfferedRequestTypeSatus == 0
                          where (f.OfferedRequestTo == HttpContext.Session.GetString("empid") && f.OfferedRequestTo3 == "0") || (f.OfferedRequestTo2 == HttpContext.Session.GetString("empid") && f.OfferedRequestTo4 == "0") || (f.Offeredoption == HttpContext.Session.GetString("empid") && f.OfferedRequestTo5 == "0")
                          join h in EvalRequestTypeIds on e.Idd equals h.CourcesIdoffered into table5
                          from h in table5.ToList()
                          where h.OfferedRequestType == 0
                          join m in cemps on e.Empno equals Convert.ToInt32(m.Cempid) into table404
                          from m in table404.ToList()
                          where m.status!="1"





                          select new ViewModelEvalwithother
                          {
                              AEvaluationEmp = e,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              evalDetail = f,
                              evalRequestTypeId = h,
                              cemp=m,

                          };
            foreach (var emp in Records.ToList())
            {
                var stringId = emp.AEvaluationEmp.Idd.ToString();
                emp.AEvaluationEmp.EncryptedIdd = _protector.Protect(stringId);
                TempData["eval2emp"] = emp.evalDetail.OfferedRequestTo.ToString() == emp.evalDetail.OfferedRequestTo2.ToString() ? "" : emp.evalDetail.OfferedRequestTo2.ToString();
                //emp.AEvaluationGoal.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesM.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesD.EncryptedCovenantId= _protector.Protect(stringId);

                ////Previous code removed for the example clarity
                //var timeLimitedProtector = _protector.ToTimeLimitedDataProtector();
                //var timeLimitedData = timeLimitedProtector.Protect("Test timed protector", lifetime: TimeSpan.FromSeconds(2));
                ////just to test that this action works as long as life-time hasn't expired
                //var timedUnprotectedData = timeLimitedProtector.Unprotect(timeLimitedData);
                //Thread.Sleep(3000);
                //var anotherTimedUnprotectTry = timeLimitedProtector.Unprotect(timeLimitedData);
            }



            return View(Records);


        }
        //get
        public ActionResult IndexOffered4()
        {
            if (HttpContext.Session.GetString("username") == null)
            {
                return RedirectToAction("Show", "Account", new { area = "" });
            }
            List<MenuModels> _menus = _context.menuemodelss.Where(x => x.RoleId == HttpContext.Session.GetInt32("emprole")).Select(x => new MenuModels
            {
                MainMenuId = x.MainMenuId,
                SubMenuNamear = x.SubMenuNamear,
                id = x.id,
                SubMenuNameen = x.SubMenuNameen,
                ControllerName = x.ControllerName,
                ActionName = x.ActionName,
                RoleId = x.RoleId,
                mmodule = x.mmodule,
                treeroot = x.treeroot
                //RoleName = x.tblRole.Roles
            }).ToList(); //Get the Menu details from entity and bind it in MenuModels list. 
            //ViewBag.MenuMaster = _menus;
            TempData["MenuMaster"] = JsonConvert.SerializeObject(_menus);
            TempData["user"] = HttpContext.Session.GetString("username");

            List<AEvaluationEmp> AEvaluationEmps = _context.AEvaluationEmps.ToList();
            List<AEvaluationGoal> AEvaluationGoals = _context.AEvaluationGoals.ToList();
            List<AEvaluationCompetenciesM> AEvaluationCompetenciesMs = _context.AEvaluationCompetenciesMs.ToList();
            List<AEvaluationCompetenciesD> AEvaluationCompetenciesDs = _context.AEvaluationCompetenciesDs.ToList();
            List<EvalDetail2> EvalDetails2 = _context.EvalDetailss2.ToList();
            List<EvalRequestTypeId2> EvalRequestTypeIds2 = _context.EvalRequestTypeIds2.ToList();
            List<EvalRequestTypeId> EvalRequestTypeIds = _context.EvalRequestTypeIds.ToList();
            //List<Evalcomment> evalcommentss = _context.EvalComments.ToList();
            List<Cemp> cemps = _context.Cemps.ToList();

            var Records = from e in AEvaluationEmps
                              //join d in AEvaluationGoals on e.Idd equals d.CovenantId into table1
                              //from d in table1.ToList()
                              //join i in AEvaluationCompetenciesMs on e.Idd equals i.CovenantId into table2
                              //from i in table2.ToList() /*where i.Cempid== HttpContext.Session.GetString("empid")*/
                              //join j in AEvaluationCompetenciesDs on e.Idd equals j.CovenantId into table3
                              //from j in table3.ToList()
                          join f in EvalDetails2 on e.Idd equals f.CourcesIdoffered into table4
                          from f in table4.ToList()
                          where f.OfferedRequestTypeSatus == 0
                          where (f.OfferedRequestTo == HttpContext.Session.GetString("empid") && f.OfferedRequestTo3 == "0") || (f.OfferedRequestTo2 == HttpContext.Session.GetString("empid") && f.OfferedRequestTo4 == "0") || (f.Offeredoption == HttpContext.Session.GetString("empid") && f.OfferedRequestTo5 == "0")
                          join h in EvalRequestTypeIds2 on e.Idd equals h.CourcesIdoffered into table5
                          from h in table5.ToList()
                          where h.OfferedRequestType == 0
                          join hh in EvalRequestTypeIds on e.Idd equals hh.CourcesIdoffered into table5h
                          from hh in table5h.ToList()
                          where hh.OfferedRequestType == 1
                          join m in cemps on e.Empno equals Convert.ToInt32(m.Cempid) into table404
                          from m in table404.ToList()
                          where m.status != "1"



                          select new ViewModelEvalwithother
                          {
                              AEvaluationEmp = e,
                              //AEvaluationGoal = d,
                              //AEvaluationCompetenciesM = i,
                              //AEvaluationCompetenciesD = j,
                              evalDetail2 = f,
                              evalRequestTypeId2 = h,
                              cemp = m,
                          };
            foreach (var emp in Records.ToList())
            {
                var stringId = emp.AEvaluationEmp.Idd.ToString();
                emp.AEvaluationEmp.EncryptedIdd = _protector.Protect(stringId);
                //emp.evalDetail2.OfferedRequestTo2 = emp.evalDetail2.OfferedRequestTo2 == "4419011" ? emp.evalDetail2.OfferedRequestTo : emp.evalDetail2.OfferedRequestTo2;
                //TempData["x"] = emp.evalDetail2.OfferedRequestTo2;
                TempData["eval2emp"] = emp.evalDetail2.OfferedRequestTo.ToString()==emp.evalDetail2.OfferedRequestTo2.ToString()?"": emp.evalDetail2.OfferedRequestTo2.ToString();
                //emp.AEvaluationGoal.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesM.EncryptedCovenantId= _protector.Protect(stringId);
                //emp.AEvaluationCompetenciesD.EncryptedCovenantId= _protector.Protect(stringId);

                ////Previous code removed for the example clarity
                //var timeLimitedProtector = _protector.ToTimeLimitedDataProtector();
                //var timeLimitedData = timeLimitedProtector.Protect("Test timed protector", lifetime: TimeSpan.FromSeconds(2));
                ////just to test that this action works as long as life-time hasn't expired
                //var timedUnprotectedData = timeLimitedProtector.Unprotect(timeLimitedData);
                //Thread.Sleep(3000);
                //var anotherTimedUnprotectTry = timeLimitedProtector.Unprotect(timeLimitedData);
            }
            //var c = TempData["x"].ToString();
            return View(Records);


        }


    }
}
